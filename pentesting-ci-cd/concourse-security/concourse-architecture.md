# Concourse Architecture

## Concourse Architecture

{% hint style="success" %}
学习和练习 AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
学习和练习 GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>支持 HackTricks</summary>

* 查看 [**订阅计划**](https://github.com/sponsors/carlospolop)!
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram 群组**](https://t.me/peass) 或 **关注** 我们在 **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **通过提交 PRs 分享黑客技巧到** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库。

</details>
{% endhint %}

[**来自 Concourse 文档的相关数据:**](https://concourse-ci.org/internals.html)

### Architecture

![](<../../.gitbook/assets/image (187).png>)

#### ATC: web UI & build scheduler

ATC 是 Concourse 的核心。它运行 **web UI 和 API**，负责所有流水线的 **调度**。它 **连接到 PostgreSQL**，用于存储流水线数据（包括构建日志）。

[checker](https://concourse-ci.org/checker.html) 的职责是持续检查资源的新版本。[scheduler](https://concourse-ci.org/scheduler.html) 负责为作业调度构建，[build tracker](https://concourse-ci.org/build-tracker.html) 负责运行任何已调度的构建。[garbage collector](https://concourse-ci.org/garbage-collector.html) 是清理机制，用于删除任何未使用或过时的对象，如容器和卷。

#### TSA: worker registration & forwarding

TSA 是一个 **定制的 SSH 服务器**，专用于安全地 **注册** [**workers**](https://concourse-ci.org/internals.html#architecture-worker) 到 [ATC](https://concourse-ci.org/internals.html#component-atc)。

TSA **默认监听端口 `2222`**，通常与 [ATC](https://concourse-ci.org/internals.html#component-atc) 共置，并位于负载均衡器后面。

**TSA 通过 SSH 连接实现 CLI**，支持 [**这些命令**](https://concourse-ci.org/internals.html#component-tsa)。

#### Workers

为了执行任务，concourse 必须有一些 workers。这些 workers 通过 [TSA](https://concourse-ci.org/internals.html#component-tsa) **注册自己**，并运行 [**Garden**](https://github.com/cloudfoundry-incubator/garden) 和 [**Baggageclaim**](https://github.com/concourse/baggageclaim) 服务。

* **Garden**: 这是 **容器管理 API**，通常通过 **HTTP** 在 **端口 7777** 运行。
* **Baggageclaim**: 这是 **卷管理 API**，通常通过 **HTTP** 在 **端口 7788** 运行。

## References

* [https://concourse-ci.org/internals.html](https://concourse-ci.org/internals.html)

{% hint style="success" %}
学习和练习 AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
学习和练习 GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>支持 HackTricks</summary>

* 查看 [**订阅计划**](https://github.com/sponsors/carlospolop)!
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram 群组**](https://t.me/peass) 或 **关注** 我们在 **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **通过提交 PRs 分享黑客技巧到** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库。

</details>
{% endhint %}
