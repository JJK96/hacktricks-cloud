# Osnovne informacije o Jenkins-u

{% hint style="success" %}
Naučite i vežbajte AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Naučite i vežbajte GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podržite HackTricks</summary>

* Pogledajte [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitter-u** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Delite hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

## Pristup

### Korisničko ime + Lozinka

Najčešći način prijavljivanja u Jenkins je sa korisničkim imenom ili lozinkom.

### Kolačić

Ako se **ovlašćeni kolačić ukrade**, može se koristiti za pristup sesiji korisnika. Kolačić se obično zove `JSESSIONID.*`. (Korisnik može prekinuti sve svoje sesije, ali prvo mora saznati da je kolačić ukraden).

### SSO/Pluginovi

Jenkins može biti konfigurisan pomoću pluginova da bude **dostupan putem treće strane SSO**.

### Tokeni

**Korisnici mogu generisati tokene** kako bi omogućili aplikacijama da ih imitiraju putem CLI ili REST API.

### SSH Ključevi

Ova komponenta pruža ugrađeni SSH server za Jenkins. To je alternativni interfejs za [Jenkins CLI](https://www.jenkins.io/doc/book/managing/cli/), i komande se mogu pozivati na ovaj način koristeći bilo koji SSH klijent. (Iz [dokumentacije](https://plugins.jenkins.io/sshd/))

## Autorizacija

U `/configureSecurity` je moguće **konfigurisati metod autorizacije Jenkins-a**. Postoji nekoliko opcija:

* **Svi mogu raditi bilo šta**: Čak i anonimni pristup može administrirati server
* **Legacy mode**: Isto kao Jenkins <1.164. Ako imate **"admin" ulogu**, biće vam dodeljena **puna kontrola** nad sistemom, a **inače** (uključujući **anonimne** korisnike) imaćete **pristup za čitanje**.
* **Prijavljeni korisnici mogu raditi bilo šta**: U ovom režimu, svaki **prijavljeni korisnik dobija punu kontrolu** nad Jenkins-om. Jedini korisnik koji neće imati punu kontrolu je **anonimni korisnik**, koji dobija samo **pristup za čitanje**.
* **Matrix-based security**: Možete konfigurisati **ko može raditi šta** u tabeli. Svaka **kolona** predstavlja **dozvolu**. Svaki **red** **predstavlja** **korisnika ili grupu/ulogu.** Ovo uključuje posebnog korisnika '**anonimni**', koji predstavlja **neautentifikovane korisnike**, kao i '**autentifikovani**', koji predstavlja **sve autentifikovane korisnike**.

![](<../../.gitbook/assets/image (149).png>)

* **Project-based Matrix Authorization Strategy:** Ovaj režim je **proširenje** na "**Matrix-based security**" koje omogućava dodatnu ACL matricu da bude **definisana za svaki projekat posebno.**
* **Role-Based Strategy:** Omogućava definisanje autorizacija koristeći **strategiju zasnovanu na ulogama**. Upravljajte ulogama u `/role-strategy`.

## **Security Realm**

U `/configureSecurity` je moguće **konfigurisati sigurnosnu oblast.** Podrazumevano Jenkins uključuje podršku za nekoliko različitih sigurnosnih oblasti:

* **Delegate to servlet container**: Za **delegiranje autentifikacije servlet kontejneru koji pokreće Jenkins kontroler**, kao što je [Jetty](https://www.eclipse.org/jetty/).
* **Jenkins’ own user database:** Koristite **Jenkins-ovu ugrađenu bazu podataka korisnika** za autentifikaciju umesto delegiranja na eksterni sistem. Ovo je podrazumevano omogućeno.
* **LDAP**: Delegirajte svu autentifikaciju na konfigurisani LDAP server, uključujući i korisnike i grupe.
* **Unix user/group database**: **Delegira autentifikaciju na osnovnu Unix** OS-nivo bazu podataka korisnika na Jenkins kontroleru. Ovaj režim će takođe omogućiti ponovnu upotrebu Unix grupa za autorizaciju.

Pluginovi mogu pružiti dodatne sigurnosne oblasti koje mogu biti korisne za integraciju Jenkins-a u postojeće identitetske sisteme, kao što su:

* [Active Directory](https://plugins.jenkins.io/active-directory)
* [GitHub Authentication](https://plugins.jenkins.io/github-oauth)
* [Atlassian Crowd 2](https://plugins.jenkins.io/crowd2)

## Jenkins Nodes, Agents & Executors

Definicije iz [dokumentacije](https://www.jenkins.io/doc/book/managing/nodes/):

**Nodes** su **mašine** na kojima se pokreću **agenti za izgradnju**. Jenkins prati svaki priključeni node za prostor na disku, slobodan privremeni prostor, slobodan swap, vreme/sinhronizaciju sata i vreme odziva. Node se isključuje ako bilo koja od ovih vrednosti pređe konfigurisan prag.

**Agents** **upravljaju** **izvršavanjem zadataka** u ime Jenkins kontrolera koristeći **izvršitelje**. Agent može koristiti bilo koji operativni sistem koji podržava Java. Alati potrebni za izgradnju i testiranje su instalirani na node-u gde agent radi; mogu **biti instalirani direktno ili u kontejneru** (Docker ili Kubernetes). Svaki **agent je zapravo proces sa svojim PID-om** na host mašini.

**Executor** je **slot za izvršavanje zadataka**; zapravo, to je **nit u agentu**. **Broj izvršitelja** na node-u definiše broj **istovremenih zadataka** koji mogu biti izvršeni na tom node-u u jednom trenutku. Drugim rečima, ovo određuje **broj istovremenih Pipeline `stages`** koji mogu biti izvršeni na tom node-u u jednom trenutku.

## Jenkins Secrets

### Enkripcija tajni i kredencijala

Definicija iz [dokumentacije](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials): Jenkins koristi **AES za enkripciju i zaštitu tajni**, kredencijala i njihovih odgovarajućih enkripcijskih ključeva. Ovi enkripcijski ključevi su pohranjeni u `$JENKINS_HOME/secrets/` zajedno sa glavnim ključem koji se koristi za zaštitu tih ključeva. Ovaj direktorijum treba biti konfigurisan tako da samo operativni sistem korisnik pod kojim Jenkins kontroler radi ima pristup za čitanje i pisanje u ovaj direktorijum (tj. `chmod` vrednost `0700` ili korišćenjem odgovarajućih atributa datoteka). **Glavni ključ** (ponekad nazvan "ključ za enkripciju ključeva" u kriptožargonu) je **pohranjen \_nekriptovan**\_ na Jenkins kontroler fajl sistemu u **`$JENKINS_HOME/secrets/master.key`** što ne štiti od napadača sa direktnim pristupom toj datoteci. Većina korisnika i programera će koristiti ove enkripcijske ključeve indirektno putem ili [Secret](https://javadoc.jenkins.io/byShortName/Secret) API za enkripciju generičkih tajnih podataka ili putem kredencijala API. Za kriptokuriozne, Jenkins koristi AES u cipher block chaining (CBC) režimu sa PKCS#5 padding-om i slučajnim IV-ovima za enkripciju instanci [CryptoConfidentialKey](https://javadoc.jenkins.io/byShortName/CryptoConfidentialKey) koje su pohranjene u `$JENKINS_HOME/secrets/` sa imenom datoteke koje odgovara njihovom `CryptoConfidentialKey` id-u. Uobičajeni id-evi ključeva uključuju:

* `hudson.util.Secret`: koristi se za generičke tajne;
* `com.cloudbees.plugins.credentials.SecretBytes.KEY`: koristi se za neke tipove kredencijala;
* `jenkins.model.Jenkins.crumbSalt`: koristi se od strane [CSRF mehanizma zaštite](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery); i

### Pristup kredencijalima

Kredencijali mogu biti **opseg globalnim provajderima** (`/credentials/`) koji mogu biti pristupni bilo kojem konfigurisanom projektu, ili mogu biti opseg **specifičnim projektima** (`/job/<project-name>/configure`) i stoga dostupni samo iz specifičnog projekta.

Prema [**dokumentaciji**](https://www.jenkins.io/blog/2019/02/21/credentials-masking/): Kredencijali koji su u opsegu su dostupni pipeline-u bez ograničenja. Da bi se **sprečilo slučajno izlaganje u logu izgradnje**, kredencijali su **maskirani** iz redovnog izlaza, tako da pozivanje `env` (Linux) ili `set` (Windows), ili programi koji ispisuju svoje okruženje ili parametre **ne bi otkrili ih u logu izgradnje** korisnicima koji inače ne bi imali pristup kredencijalima.

**Zato, da bi izveo kredencijale, napadač treba, na primer, da ih base64 kodira.**

## Reference

* [https://www.jenkins.io/doc/book/security/managing-security/](https://www.jenkins.io/doc/book/security/managing-security/)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)
* [https://www.jenkins.io/doc/developer/security/secrets/](https://www.jenkins.io/doc/developer/security/secrets/)
* [https://www.jenkins.io/blog/2019/02/21/credentials-masking/](https://www.jenkins.io/blog/2019/02/21/credentials-masking/)
* [https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery)
* [https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)

{% hint style="success" %}
Naučite i vežbajte AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Naučite i vežbajte GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podržite HackTricks</summary>

* Pogledajte [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitter-u** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Delite hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
