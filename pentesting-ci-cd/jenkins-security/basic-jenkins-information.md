# Taarifa za Msingi za Jenkins

{% hint style="success" %}
Jifunze & fanya mazoezi ya AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze & fanya mazoezi ya GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mipango ya usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Ufikiaji

### Jina la Mtumiaji + Nenosiri

Njia ya kawaida ya kuingia kwenye Jenkins ni kwa jina la mtumiaji au nenosiri.

### Cookie

Ikiwa **cookie iliyoidhinishwa itaibiwa**, inaweza kutumika kufikia kikao cha mtumiaji. Cookie kawaida huitwa `JSESSIONID.*`. (Mtumiaji anaweza kumaliza vikao vyake vyote, lakini atahitaji kujua kwanza kwamba cookie iliibiwa).

### SSO/Plugins

Jenkins inaweza kusanidiwa kwa kutumia plugins kuwa **inayopatikana kupitia SSO ya wahusika wengine**.

### Tokens

**Watumiaji wanaweza kuzalisha tokens** ili kutoa ufikiaji kwa programu kuiga wao kupitia CLI au REST API.

### SSH Keys

Sehemu hii inatoa seva ya SSH iliyojengwa ndani kwa Jenkins. Ni kiolesura mbadala kwa [Jenkins CLI](https://www.jenkins.io/doc/book/managing/cli/), na amri zinaweza kutekelezwa kwa njia hii kwa kutumia mteja wowote wa SSH. (Kutoka [docs](https://plugins.jenkins.io/sshd/))

## Uidhinishaji

Katika `/configureSecurity` inawezekana **kusimamia njia ya uidhinishaji ya Jenkins**. Kuna chaguzi kadhaa:

* **Mtu yeyote anaweza kufanya chochote**: Hata ufikiaji wa bila jina unaweza kusimamia seva.
* **Legacy mode**: Kama Jenkins <1.164. Ikiwa una **"jukumu la admin"**, utapewa **udhibiti kamili** wa mfumo, na **vinginevyo** (ikiwa ni pamoja na **watumiaji wasiojulikana**) utakuwa na **ufikiaji wa kusoma**.
* **Watumiaji walioingia wanaweza kufanya chochote**: Katika hali hii, kila **mtumiaji aliyeingia anapata udhibiti kamili** wa Jenkins. Mtumiaji pekee ambaye hatakuwa na udhibiti kamili ni **mtumiaji asiyejulikana**, ambaye anapata tu **ufikiaji wa kusoma**.
* **Matrix-based security**: Unaweza kusanidi **nani anaweza kufanya nini** katika jedwali. Kila **safu** inawakilisha **ruhusa**. Kila **safu** **inawakilisha** **mtumiaji au kikundi/jukumu.** Hii inajumuisha mtumiaji maalum '**asiyejulikana**', ambaye anawakilisha **watumiaji wasiojulikana**, pamoja na '**aliyeidhinishwa**', ambaye anawakilisha **watumiaji wote walioidhinishwa**.

![](<../../.gitbook/assets/image (149).png>)

* **Project-based Matrix Authorization Strategy:** Hali hii ni **nyongeza** kwa "**Matrix-based security**" ambayo inaruhusu ACL matrix ya ziada **kusanidiwa kwa kila mradi kando.**
* **Role-Based Strategy:** Inaruhusu kusanidi uidhinishaji kwa kutumia **mkakati wa msingi wa jukumu**. Simamia majukumu katika `/role-strategy`.

## **Security Realm**

Katika `/configureSecurity` inawezekana **kusimamia security realm.** Kwa default Jenkins inajumuisha msaada kwa Security Realms kadhaa tofauti:

* **Delegate to servlet container**: Kwa **kuwakilisha uthibitishaji kwa servlet container inayoendesha Jenkins controller**, kama [Jetty](https://www.eclipse.org/jetty/).
* **Jenkins‚Äô own user database:** Tumia **hifadhi ya data ya watumiaji iliyojengwa ndani ya Jenkins** kwa uthibitishaji badala ya kuwakilisha kwa mfumo wa nje. Hii imewezeshwa kwa default.
* **LDAP**: Wawakilishe uthibitishaji wote kwa seva ya LDAP iliyosanidiwa, ikiwa ni pamoja na watumiaji na vikundi.
* **Unix user/group database**: **Wawakilishe uthibitishaji kwa hifadhi ya data ya watumiaji ya Unix** kwenye kiwango cha OS kwenye Jenkins controller. Hali hii pia itaruhusu matumizi tena ya vikundi vya Unix kwa uidhinishaji.

Plugins zinaweza kutoa security realms za ziada ambazo zinaweza kuwa muhimu kwa kuingiza Jenkins katika mifumo ya utambulisho iliyopo, kama:

* [Active Directory](https://plugins.jenkins.io/active-directory)
* [GitHub Authentication](https://plugins.jenkins.io/github-oauth)
* [Atlassian Crowd 2](https://plugins.jenkins.io/crowd2)

## Jenkins Nodes, Agents & Executors

Maelezo kutoka [docs](https://www.jenkins.io/doc/book/managing/nodes/):

**Nodes** ni **mashine** ambazo **agents za kujenga zinaendesha**. Jenkins inafuatilia kila node iliyounganishwa kwa nafasi ya diski, nafasi ya muda ya bure, nafasi ya kubadilisha ya bure, wakati wa saa/sinkroni na muda wa majibu. Node inachukuliwa nje ya mtandao ikiwa thamani yoyote ya hizi inatoka nje ya kizingiti kilichosanidiwa.

**Agents** **zinasimamia** **utekelezaji wa kazi** kwa niaba ya Jenkins controller kwa **kutumia executors**. Agent inaweza kutumia mfumo wowote wa uendeshaji unaounga mkono Java. Zana zinazohitajika kwa ajili ya kujenga na kupima zinawekwa kwenye node ambapo agent inaendesha; zinaweza **kuwekwa moja kwa moja au kwenye kontena** (Docker au Kubernetes). Kila **agent kimsingi ni mchakato na PID yake mwenyewe** kwenye mashine mwenyeji.

**Executor** ni **nafasi ya utekelezaji wa kazi**; kimsingi, ni **thread katika agent**. **Idadi ya executors** kwenye node inafafanua idadi ya **kazi za wakati mmoja** ambazo zinaweza kutekelezwa kwenye node hiyo kwa wakati mmoja. Kwa maneno mengine, hii inaamua **idadi ya `stages` za Pipeline za wakati mmoja** ambazo zinaweza kutekelezwa kwenye node hiyo kwa wakati mmoja.

## Siri za Jenkins

### Usimbaji wa Siri na Nenosiri

Maelezo kutoka [docs](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials): Jenkins hutumia **AES kusimba na kulinda siri**, nenosiri, na funguo zao za usimbaji. Funguo hizi za usimbaji zinahifadhiwa katika `$JENKINS_HOME/secrets/` pamoja na funguo kuu zinazotumika kulinda funguo hizo. Saraka hii inapaswa kusanidiwa ili mtumiaji wa mfumo wa uendeshaji ambaye Jenkins controller inaendesha kama ana ufikiaji wa kusoma na kuandika kwenye saraka hii (yaani, thamani ya `chmod` ya `0700` au kutumia sifa sahihi za faili). **Funguo kuu** (wakati mwingine hujulikana kama "key encryption key" katika lugha ya usimbaji) **imehifadhiwa \_bila kusimbwa\_** kwenye mfumo wa faili wa Jenkins controller katika **`$JENKINS_HOME/secrets/master.key`** ambayo haikulindi dhidi ya washambuliaji wenye ufikiaji wa moja kwa moja kwa faili hiyo. Watumiaji na watengenezaji wengi watatumia funguo hizi za usimbaji kwa njia isiyo ya moja kwa moja kupitia API ya [Secret](https://javadoc.jenkins.io/byShortName/Secret) kwa kusimba data ya siri ya jumla au kupitia API ya nenosiri. Kwa wale wanaopenda usimbaji, Jenkins hutumia AES katika hali ya cipher block chaining (CBC) na padding ya PKCS#5 na IVs za nasibu kusimba matukio ya [CryptoConfidentialKey](https://javadoc.jenkins.io/byShortName/CryptoConfidentialKey) ambayo yanahifadhiwa katika `$JENKINS_HOME/secrets/` na jina la faili linalolingana na id ya `CryptoConfidentialKey` yao. Id za funguo za kawaida ni pamoja na:

* `hudson.util.Secret`: hutumika kwa siri za jumla;
* `com.cloudbees.plugins.credentials.SecretBytes.KEY`: hutumika kwa aina fulani za nenosiri;
* `jenkins.model.Jenkins.crumbSalt`: hutumika na [CSRF protection mechanism](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery); na

### Ufikiaji wa Nenosiri

Nenosiri linaweza **kupangwa kwa watoa huduma wa kimataifa** (`/credentials/`) ambao wanaweza kufikiwa na mradi wowote uliosanidiwa, au linaweza kupangwa kwa **miradi maalum** (`/job/<project-name>/configure`) na hivyo kufikiwa tu kutoka kwa mradi maalum.

Kulingana na [**docs**](https://www.jenkins.io/blog/2019/02/21/credentials-masking/): Nenosiri lililo katika wigo linapatikana kwa pipeline bila kizuizi. Ili **kuzuia kufichuliwa kwa bahati mbaya katika logi ya kujenga**, nenosiri **limefichwa** kutoka kwa pato la kawaida, hivyo mwito wa `env` (Linux) au `set` (Windows), au programu zinazochapisha mazingira yao au vigezo hazitafichua katika logi ya kujenga kwa watumiaji ambao hawana ufikiaji wa nenosiri.

**Ndiyo maana ili kutoa nenosiri nje, mshambuliaji anahitaji, kwa mfano, kulisimba kwa base64.**

## Marejeleo

* [https://www.jenkins.io/doc/book/security/managing-security/](https://www.jenkins.io/doc/book/security/managing-security/)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)
* [https://www.jenkins.io/doc/developer/security/secrets/](https://www.jenkins.io/doc/developer/security/secrets/)
* [https://www.jenkins.io/blog/2019/02/21/credentials-masking/](https://www.jenkins.io/blog/2019/02/21/credentials-masking/)
* [https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery)
* [https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)

{% hint style="success" %}
Jifunze & fanya mazoezi ya AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze & fanya mazoezi ya GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mipango ya usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
