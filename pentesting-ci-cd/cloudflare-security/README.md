# Cloudflare Sekuriteit

<details>

<summary><strong>Leer AWS hak vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

In 'n Cloudflare-rekening is daar sekere **algemene instellings en dienste** wat opgestel kan word. Op hierdie bladsy gaan ons die **sekuriteitsverwante instellings van elke afdeling analiseer:**

<figure><img src="../../.gitbook/assets/image (117).png" alt=""><figcaption></figcaption></figure>

## Webwerwe

Hersien elkeen met:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

### Domeinregistrasie

* [ ] In **`Oordrag Domeine`** kontroleer dat dit nie moontlik is om enige domein oor te dra nie.

Hersien elkeen met:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

## Analitika

_Ek kon niks vind om vir 'n konfigurasie-sekuriteitsondersoek te kontroleer nie._

## Bladsye

Op elke Cloudflare-bladsy:

* [ ] Kontroleer vir **sensitiewe inligting** in die **`Bou-log`**.
* [ ] Kontroleer vir **sensitiewe inligting** in die **Github-opgaaf** wat aan die bladsye toegewys is.
* [ ] Kontroleer vir potensi√´le github-opgaaf-kompromis deur **werkstroombevelinspuiting** of `pull_request_target`-kompromis. Meer inligting in die [**Github-sekuriteitsbladsy**](../github-security/).
* [ ] Kontroleer vir **kwesbare funksies** in die `/fuctions`-gids (indien enige), kontroleer die **aanstuurders** in die `_aanstuurders`-l√™er (indien enige) en **sleutelgekonfigureerde koppe** in die `_koppe`-l√™er (indien enige).
* [ ] Kontroleer vir **kwesbaarhede** in die **webbladsy** via **blackbox** of **whitebox** as jy die kode kan **toegang**.
* [ ] In die besonderhede van elke bladsy `/<bladsy_id>/bladsye/sien/bloklys/instellings/funksies`. Kontroleer vir **sensitiewe inligting** in die **`Omgevingsveranderlikes`**.
* [ ] In die besonderhedebladsy kontroleer ook die **boubevel** en **hoofgids** vir **potensi√´le inspuitings** om die bladsy te kompromitteer.

## **Werker**

Op elke Cloudflare-werker kontroleer:

* [ ] Die aanstuurders: Wat laat die werker aanspor? Kan 'n **gebruiker data stuur** wat deur die werker **gebruik** sal word?
* [ ] In die **`Instellings`**, kontroleer vir **`Veranderlikes`** wat **sensitiewe inligting** bevat
* [ ] Kontroleer die **kode van die werker** en soek na **kwesbaarhede** (veral op plekke waar die gebruiker die insette kan bestuur)
* Kontroleer vir SSRFs wat die aangeduide bladsy terugstuur wat jy kan beheer
* Kontroleer XSSs wat JS uitvoer binne 'n svg-beeld
* Dit is moontlik dat die werker met ander interne dienste interaksie het. Byvoorbeeld, 'n werker kan met 'n R2-emmer interaksie h√™ wat inligting daarin stoor wat uit die inset verkry is. In daardie geval sou dit nodig wees om te kontroleer watter vermo√´ns die werker oor die R2-emmer het en hoe dit van die gebruikerinset misbruik kan word.

{% hint style="warning" %}
Let daarop dat 'n **Werker standaard 'n URL** soos `<werker-naam>.<rekening>.workers.dev` gegee word. Die gebruiker kan dit na 'n **subdomein** instel, maar jy kan dit altyd met daardie **oorspronklike URL** benader as jy dit weet.
{% endhint %}

## R2

Op elke R2-emmer kontroleer:

* [ ] Stel **CORS-beleid** in.

## Stroom

TODO

## Beelde

TODO

## Sekuriteitsentrum

* [ ] Indien moontlik, voer 'n **`Sekuriteitsinsigte`** **skandering** en 'n **`Infrastruktuur`** **skandering** uit, aangesien dit interessante inligting **sekuriteitsgewys sal beklemtoon**.
* [ ] Kontroleer net hierdie inligting vir sekuriteitsmisconfiguraties en interessante inligting

## Draaikruis

TODO

## **Nul Vertroue**

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Massaomleidings

{% hint style="info" %}
In teenstelling met [Dinamiese Omleidings](https://developers.cloudflare.com/rules/url-forwarding/dynamic-redirects/), [**Massaomleidings**](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/) is in wese staties ‚Äî hulle ondersteun **geen stringvervangingsoperasies** of regul√™re uitdrukkings nie. Jy kan egter URL-omleidingsparameters konfigureer wat hul URL-passingsgedrag en hul uitvoertydgedrag be√Ønvloed.
{% endhint %}

* [ ] Kontroleer dat die **uitdrukkings** en **vereistes** vir omleidings **sin maak**.
* [ ] Kontroleer ook vir **sensitiewe verborge eindpunte** wat interessante inligting bevat.

## Kennisgewings

* [ ] Kontroleer die **kennisgewings.** Hierdie kennisgewings word vir sekuriteit aanbeveel:
* `Gebruiksgebaseerde fakturering`
* `HTTP DDoS Aanvalwaarskuwing`
* `Laag 3/4 DDoS Aanvalwaarskuwing`
* `Gevorderde HTTP DDoS Aanvalwaarskuwing`
* `Gevorderde Laag 3/4 DDoS Aanvalwaarskuwing`
* `Vloeigebaseerde Monitering: Volumetriese Aanval`
* `Roetelekdeteksie Waarskuwing`
* `Toegang mTLS Sertifikaat Vervalwaarskuwing`
* `SSL vir SaaS Aangepaste Gasnaam Waarskuwing`
* `Universel SSL Waarskuwing`
* `Skripsie Moniter Nuwe Kodeveranderingsdeteksie Waarskuwing`
* `Skripsie Moniter Nuwe Domeinwaarskuwing`
* `Skripsie Moniter Nuwe Skadelike Domeinwaarskuwing`
* `Skripsie Moniter Nuwe Skadelike Skripswaarskuwing`
* `Skripsie Moniter Nuwe Skadelike URL-waarskuwing`
* `Skripsie Moniter Nuwe Skripte Waarskuwing`
* `Skripsie Moniter Nuwe Skrips Oorskry Max URL-lengte Waarskuwing`
* `Gevorderde Sekuriteitsgebeure Waarskuwing`
* `Sekuriteitsgebeure Waarskuwing`
* [ ] Kontroleer al die **bestemmings**, aangesien daar **sensitiewe inligting** (basiese http-outentifisering) in webhook-url's kan wees. Maak ook seker dat webhook-url's **HTTPS** gebruik
* [ ] As 'n ekstra kontrole, kan jy probeer om **'n cloudflare-kennisgewing te impersoneer** na 'n derde party, miskien kan jy op een of ander manier **iets gevaarliks inspuit**

## Rekeningbestuur

* [ ] Dit is moontlik om die **laaste 4 syfers van die kredietkaart**, **vervaldatum** en **faktuuraanspraak** in **`Fakturering` -> `Betalingsinligting`** te sien.
* [ ] Dit is moontlik om die **plan tipe** wat in die rekening gebruik word in **`Fakturering` -> `Intekeninge`** te sien.
* In **`Lede`** is dit moontlik om al die lede van die rekening en hul **rol** te sien. Let daarop dat as die plan tipe nie Onderneming is nie, slegs 2 rolle bestaan: Administrateur en Super Administrateur. Maar as die gebruikte **plan Onderneming is**, kan [**meer rolle**](https://developers.cloudflare.com/fundamentals/account-and-billing/account-setup/account-roles/) gebruik word om die beginsel van die minste bevoorregting te volg.
* Daarom word dit waar moontlik aanbeveel om die **Ondernemingsplan** te gebruik.
* [ ] In Lede is dit moontlik om te sien watter **lede** 2FA geaktiveer het. **Elke** gebruiker behoort dit geaktiveer te h√™.

{% hint style="info" %}
Let daarop dat gelukkig die rol **`Administrateur`** nie toestemming gee om lidmaatskappe te bestuur (**kan nie bevoorregtinge eskaleer of nuwe lede uitnooi** nie)
{% endhint %}
## DDoS Ondersoek

[Kyk na hierdie deel](cloudflare-domains.md#cloudflare-ddos-protection).

<details>

<summary><strong>Leer AWS hakwerk vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
