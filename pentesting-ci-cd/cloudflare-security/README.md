# Cloudflare Güvenliği

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana kadar öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini alın**](https://peass.creator-spring.com)
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu keşfedin
* **Katılın** 💬 [**Discord grubumuza**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarınızı paylaşarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına PR göndererek destek olun.

</details>

Bir Cloudflare hesabında yapılandırılabilen bazı **genel ayarlar ve hizmetler** bulunmaktadır. Bu sayfada her bölümün **güvenlikle ilgili ayarlarını analiz edeceğiz:**

<figure><img src="../../.gitbook/assets/image (117).png" alt=""><figcaption></figcaption></figure>

## Web Siteleri

Her birini gözden geçirin:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

### Alan Kaydı

* [ ] **`Alanları Transfer Et`** bölümünde herhangi bir alanın transfer edilemeyeceğini kontrol edin.

Her birini gözden geçirin:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

## Analizler

_Bir yapılandırma güvenlik incelemesi için kontrol edilecek bir şey bulamadım._

## Sayfalar

Her Cloudflare sayfasında:

* [ ] **`Build log`** içinde **duyarlı bilgileri** kontrol edin.
* [ ] Sayfalara atanan **Github deposunda** **duyarlı bilgileri** kontrol edin.
* [ ] **Workflow komut enjeksiyonu** veya `pull_request_target` kompromisine karşı potansiyel github repo kompromisini kontrol edin. Daha fazla bilgi için [**Github Güvenlik sayfasına**](../github-security/) bakın.
* [ ] `/fuctions` dizinindeki **zafiyetli fonksiyonları**, `_redirects` dosyasındaki **yönlendirmeleri** (varsa) ve `_headers` dosyasındaki **yanlış yapılandırılmış başlıkları** kontrol edin.
* [ ] **Web sayfasındaki zafiyetleri** **siyah kutu** veya **beyaz kutu** ile kontrol edin, eğer **koda erişebiliyorsanız**
* [ ] Her sayfanın ayrıntılarında `/<sayfa_id>/pages/view/blocklist/settings/functions`. **`Çevre değişkenlerinde`** **duyarlı bilgileri** kontrol edin.
* [ ] Ayrıca ayrıntılar sayfasında **derleme komutunu** ve **kök dizinini** kontrol edin, sayfayı tehlikeye atacak **potansiyel enjeksiyonlar** için.

## **Çalışanlar**

Her Cloudflare çalışanını kontrol edin:

* [ ] Tetikleyiciler: Çalışanı tetikleyen nedir? Bir **kullanıcı veri gönderebilir** mi ve bu veri çalışan tarafından **kullanılabilir mi**?
* [ ] **`Ayarlar`** bölümünde, **duyarlı bilgileri** içeren **`Değişkenleri`** kontrol edin
* [ ] Çalışanın **kodunu kontrol edin** ve **zafiyetleri arayın** (özellikle kullanıcının girdiyi yönetebileceği yerlerde)
* Kontrol edin, kontrol edebileceğiniz belirtilen sayfayı döndüren SSRF'leri
* JS'yi bir svg görüntüsü içinde çalıştıran XSS'leri kontrol edin
* Çalışanın diğer iç hizmetlerle etkileşimde bulunması mümkündür. Örneğin, bir çalışan girdiden elde edilen bilgileri içinde depolayan bir R2 kovasıyla etkileşimde olabilir. Bu durumda, çalışanın R2 kovası üzerinde hangi yetkilere sahip olduğunu ve kullanıcı girdisinden nasıl kötüye kullanılabileceğini kontrol etmek gerekecektir.

{% hint style="warning" %}
Varsayılan olarak bir **Çalışana** `<worker-adı>.<hesap>.workers.dev` gibi bir URL verilir. Kullanıcı bunu bir **alt alan adına** ayarlayabilir ancak bildiğiniz takdirde her zaman o **orijinal URL** ile erişebilirsiniz.
{% endhint %}

## R2

Her R2 kovasında kontrol edin:

* [ ] **CORS Politikasını** yapılandırın.

## Akış

TODO

## Görüntüler

TODO

## Güvenlik Merkezi

* [ ] Mümkünse, **`Güvenlik İncelemeleri`** **taraması** ve **`Altyapı`** **taraması** çalıştırın, çünkü bunlar ilginç bilgileri **güvenlik açısından vurgulayacaktır**.
* [ ] Sadece güvenlik yanlış yapılandırmaları ve ilginç bilgiler için bu bilgileri kontrol edin

## Turnike

TODO

## **Sıfır Güven**

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Toplu Yönlendirmeler

{% hint style="info" %}
[Dinamik Yönlendirmeler](https://developers.cloudflare.com/rules/url-forwarding/dynamic-redirects/) ile farklı olarak, [**Toplu Yönlendirmeler**](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/) temelde statiktir - **herhangi bir dize değiştirme** işlemini veya düzenli ifadeleri **desteklemezler**. Ancak, URL yönlendirme parametrelerini yapılandırabilir ve bunların URL eşleme davranışını ve çalışma zamanı davranışını etkileyebilirsiniz.
{% endhint %}

* [ ] Yönlendirmeler için **ifadeleri** ve **gereksinimleri** kontrol edin.
* İlginç bilgiler içeren **duyarlı gizli uç noktaları** için de kontrol edin.

## Bildirimler

* [ ] **Bildirimleri** kontrol edin. Bu bildirimler güvenlik için önerilir:
* `Kullanıma Dayalı Faturalandırma`
* `HTTP DDoS Saldırı Uyarısı`
* `Katman 3/4 DDoS Saldırı Uyarısı`
* `Gelişmiş HTTP DDoS Saldırı Uyarısı`
* `Gelişmiş Katman 3/4 DDoS Saldırı Uyarısı`
* `Akış Tabanlı İzleme: Hacimsel Saldırı`
* `Rota Sızıntısı Algılama Uyarısı`
* `Erişim mTLS Sertifika Süresi Uyarısı`
* `SSL için SaaS Özel Ana Bilgisayar Adı Uyarısı`
* `Evrensel SSL Uyarısı`
* `Komut İzleyici Yeni Kod Değişikliği Algılama Uyarısı`
* `Komut İzleyici Yeni Alan Adı Uyarısı`
* `Komut İzleyici Yeni Zararlı Alan Adı Uyarısı`
* `Komut İzleyici Yeni Zararlı Komut Uyarısı`
* `Komut İzleyici Yeni Zararlı URL Uyarısı`
* `Komut İzleyici Yeni Komutlar Uyarısı`
* `Komut İzleyici Yeni Komut Maksimum URL Uzunluğunu Aşıyor Uyarısı`
* `Gelişmiş Güvenlik Olayları Uyarısı`
* `Güvenlik Olayları Uyarısı`
* [ ] Tüm **hedefleri** kontrol edin, çünkü webhook URL'lerinde **duyarlı bilgiler** (temel http kimlik doğrulaması) olabilir. Ayrıca webhook URL'lerinin **HTTPS** kullandığından emin olun
* [ ] Ek bir kontrol olarak, bir **cloudflare bildirimini** üçüncü bir tarafa **taklit etmeyi** deneyebilirsiniz, belki bir şekilde **tehlikeli bir şey enjekte edebilirsiniz**

## Hesabı Yönet

* [ ] **`Faturalandırma` -> `Ödeme bilgileri`** bölümünde **kredi kartının son 4 rakamını**, **son kullanma tarihini** ve **fatura adresini** görebilirsiniz.
* [ ] Hesapta kullanılan **plan türünü** **`Faturalandırma` -> `Abonelikler`** bölümünde görebilirsiniz.
* **`Üyeler`** bölümünde hesabın tüm üyelerini ve **rollerini** görebilirsiniz. Plan türü Enterprise değilse, yalnızca 2 rol bulunur: Yönetici ve Süper Yönetici. Ancak kullanılan **plan Enterprise ise**, [**daha fazla rol**](https://developers.cloudflare.com/fundamentals/account-and-billing/account-setup/account-roles/) en az ayrıcalık ilkesini takip etmek için kullanılabilir.
* Bu nedenle, mümkün olduğunda **Enterprise planını** kullanmanız **tavsiye edilir**.
* Üyelerde hangi **üyelerin 2FA'yı etkinleştirdiğini** kontrol edebilirsiniz. **Her** kullanıcının bunu etkinleştirmesi gerekmektedir.

{% hint style="info" %}
Neyse ki **`Yönetici`** rolü varsayılan olarak üyelikleri yönetme izni vermez (**aşama haklarını yükseltemez veya yeni üyeleri davet edemez**)
{% endhint %}
## DDoS İncelemesi

[Şu bölüme bakın](cloudflare-domains.md#cloudflare-ddos-protection).

<details>

<summary><strong>Sıfırdan kahraman olmak için AWS hackleme öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARI**]'na(https://github.com/sponsors/carlospolop) göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'da takip edin.**
* **Hacking püf noktalarınızı paylaşarak PR'lar göndererek HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>
