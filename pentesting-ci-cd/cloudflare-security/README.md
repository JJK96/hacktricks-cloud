# 클라우드플레어 보안

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)를 통해 AWS 해킹을 처음부터 전문가까지 배우세요</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사가 HackTricks에 광고되길 원하거나 HackTricks를 PDF로 다운로드하길 원한다면** [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 굿즈**](https://peass.creator-spring.com)를 구매하세요
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 당사의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
* **💬 [Discord 그룹](https://discord.gg/hRep4RUj7f)** 또는 [**텔레그램 그룹**](https://t.me/peass)에 **가입**하거나 **트위터** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**를 팔로우**하세요.
* **해킹 트릭을 공유하려면** [**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소로 PR을 제출하세요.

</details>

클라우드플레어 계정에는 구성할 수 있는 **일반 설정 및 서비스**가 있습니다. 이 페이지에서는 각 섹션의 **보안 관련 설정을 분석**할 것입니다:

<figure><img src="../../.gitbook/assets/image (117).png" alt=""><figcaption></figcaption></figure>

## 웹사이트

각각을 다음과 함께 검토하세요:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

### 도메인 등록

* [ ] **`도메인 이전`**에서 어떤 도메인도 이전할 수 없는지 확인하세요.

각각을 다음과 함께 검토하세요:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

## 분석

_구성 보안 검토를 위해 확인할 사항을 찾지 못했습니다._

## 페이지

각 클라우드플레어 페이지에서:

* [ ] **`빌드 로그`**에서 **민감한 정보**를 확인하세요.
* [ ] 페이지에 할당된 **Github 저장소**에서 **민감한 정보**를 확인하세요.
* [ ] **워크플로우 명령 삽입** 또는 `pull_request_target` 침해를 통한 잠재적인 github 저장소 침해를 확인하세요. 자세한 정보는 [**Github 보안 페이지**](../github-security/)에서 확인하세요.
* [ ] `/fuctions` 디렉토리(있는 경우)의 **취약한 기능**, `_redirects` 파일(있는 경우)의 **리다이렉트**, `_headers` 파일(있는 경우)의 **구성되지 않은 헤더**를 확인하세요.
* [ ] **웹 페이지**의 **취약점**을 **블랙박스** 또는 **화이트박스**를 통해 확인하세요. **코드에 액세스할 수 있다면**
* [ ] 각 페이지의 세부 정보 `/<page_id>/pages/view/blocklist/settings/functions`. **`환경 변수`**에서 **민감한 정보**를 확인하세요.
* [ ] 세부 페이지에서 **빌드 명령** 및 **루트 디렉토리**를 확인하여 페이지를 침해할 **잠재적인 삽입**을 확인하세요.

## **워커**

각 클라우드플레어 워커에서 확인하세요:

* [ ] 트리거: 워커를 트리거하는 요소는 무엇인가요? **사용자가 보낸 데이터**가 워커에서 **사용**될 수 있나요?
* [ ] **`설정`**에서 **민감한 정보**를 포함하는 **`변수`**를 확인하세요.
* 워커의 **코드**를 확인하고 **취약점**을 검색하세요(특히 사용자가 입력을 관리할 수 있는 곳에서)
* 제어할 수 있는 지정된 페이지를 반환하는 **SSRFs** 확인
* **SVG 이미지 내에서 JS를 실행하는** XSS 확인
* 워커가 다른 내부 서비스와 상호 작용할 수 있습니다. 예를 들어, 워커는 입력에서 얻은 정보를 저장하는 R2 버킷과 상호 작용할 수 있습니다. 이 경우 워커가 R2 버킷에 대해 어떤 권한을 갖고 있으며 사용자 입력에서 어떻게 남용될 수 있는지 확인해야 합니다.

{% hint style="warning" %}
기본적으로 **워커는 `<worker-name>.<account>.workers.dev`와 같은 URL**이 제공됩니다. 사용자는 **하위 도메인**으로 설정할 수 있지만 알고 있다면 항상 해당 **원래 URL**로 액세스할 수 있습니다.
{% endhint %}

## R2

각 R2 버킷에서 확인하세요:

* [ ] **CORS 정책** 구성하세요.

## 스트림

진행 중

## 이미지

진행 중

## 보안 센터

* [ ] 가능하다면 **`보안 인사이트`** **스캔** 및 **`인프라`** **스캔**을 실행하세요. 이러한 스캔은 흥미로운 정보를 **보안 측면**에서 강조할 것입니다.
* [ ] 보안 구성 오류 및 흥미로운 정보를 확인하세요

## Turnstile

진행 중

## **제로 트러스트**

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## 대량 리디렉션

{% hint style="info" %}
[**동적 리디렉션**](https://developers.cloudflare.com/rules/url-forwarding/dynamic-redirects/)과 달리 [**대량 리디렉션**](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/)은 본질적으로 정적입니다 — **문자열 대체** 작업이나 정규 표현식을 **지원하지 않습니다**. 그러나 URL 일치 동작 및 런타임 동작에 영향을 주는 URL 리디렉션 매개변수를 구성할 수 있습니다.
{% endhint %}

* [ ] 리디렉션을 위한 **표현식** 및 **요구 사항**이 **유효한지** 확인하세요.
* [ ] **민감한 숨겨진 엔드포인트** 및 흥미로운 정보를 포함하는지 확인하세요.

## 알림

* [ ] **알림**을 확인하세요. 이러한 알림은 보안을 위해 권장됩니다:
* `사용량 기반 요금 청구`
* `HTTP DDoS 공격 경고`
* `레이어 3/4 DDoS 공격 경고`
* `고급 HTTP DDoS 공격 경고`
* `고급 레이어 3/4 DDoS 공격 경고`
* `흐름 기반 모니터링: 부피 공격`
* `경로 누출 감지 경고`
* `액세스 mTLS 인증서 만료 경고`
* `SaaS 사용자 정의 호스트명을 위한 SSL 경고`
* `Universal SSL 경고`
* `스크립트 모니터 새 코드 변경 감지 경고`
* `스크립트 모니터 새 도메인 경고`
* `스크립트 모니터 새 악성 도메인 경고`
* `스크립트 모니터 새 악성 스크립트 경고`
* `스크립트 모니터 새 악성 URL 경고`
* `스크립트 모니터 새 스크립트 경고`
* `스크립트 모니터 새 스크립트가 최대 URL 길이를 초과하는 경고`
* `고급 보안 이벤트 경고`
* `보안 이벤트 경고`
* [ ] 모든 **대상**을 확인하세요. 웹훅 URL에 **민감한 정보**(기본 http 인증)가 포함될 수 있습니다. 또한 웹훅 URL이 **HTTPS**를 사용하는지 확인하세요.
* [ ] 추가로, **클라우드플레어 알림**을 **위조**하여 제3자에게 전송해볼 수 있습니다. 어떻게든 **위험한 것을 삽입**할 수 있을지도 모릅니다.

## 계정 관리

* [ ] **`결제` -> `결제 정보`**에서 **신용카드의 마지막 4자리**, **만료 시간** 및 **청구 주소**를 볼 수 있습니다.
* [ ] 계정에서 사용 중인 **요금제 유형**을 **`결제` -> `구독`**에서 확인할 수 있습니다.
* **`멤버`**에서 계정의 모든 멤버와 그들의 **역할**을 확인할 수 있습니다. 요금제 유형이 Enterprise가 아닌 경우, 관리자 및 최고 관리자 두 가지 역할만 존재합니다. 그러나 사용 중인 **요금제가 Enterprise인 경우** [**더 많은 역할**](https://developers.cloudflare.com/fundamentals/account-and-billing/account-setup/account-roles/)을 사용하여 최소 권한 원칙을 준수할 수 있습니다.
* 따라서 가능한 경우 **Enterprise 요금제**를 사용하는 것이 **권장**됩니다.
* [ ] 멤버에서 **2단계 인증(2FA)이 활성화**된 사용자를 확인할 수 있습니다. **모든** 사용자가 활성화되어야 합니다.

{% hint style="info" %}
관리자 역할은 **멤버십 관리 권한을 부여하지 않습니다(권한 상승 또는 새 멤버 초대 불가)**
{% endhint %}
## DDoS 조사

[이 부분을 확인하십시오](cloudflare-domains.md#cloudflare-ddos-protection).

<details>

<summary><strong>제로부터 영웅이 될 때까지 AWS 해킹을 배우세요</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사가 HackTricks에 광고되길 원하거나** **PDF 형식의 HackTricks를 다운로드하길 원한다면** [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 굿즈**](https://peass.creator-spring.com)를 구매하세요
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 저희의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
* **💬 [**디스코드 그룹**](https://discord.gg/hRep4RUj7f)에 가입하거나 [**텔레그램 그룹**](https://t.me/peass)에 가입하거나** **트위터** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**를 팔로우하세요.**
* **해킹 트릭을 공유하려면** [**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 PR을 제출하세요.

</details>
