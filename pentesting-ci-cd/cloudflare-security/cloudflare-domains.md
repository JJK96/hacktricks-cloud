# Cloudflare 域名

<details>

{% hint style="success" %}
学习和实践 AWS 黑客技术：<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks 培训 AWS 红队专家 (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
学习和实践 GCP 黑客技术：<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks 培训 GCP 红队专家 (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>支持 HackTricks</summary>

* 检查[**订阅计划**](https://github.com/sponsors/carlospolop)!
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**电报群组**](https://t.me/peass) 或 **关注**我们的 **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* 通过向 [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库提交 PR 来分享黑客技巧。

</details>
{% endhint %}

在 Cloudflare 中配置的每个 TLD 中，都可以配置一些**常规设置和服务**。在本页中，我们将**分析每个部分与安全相关的设置**：

<figure><img src="../../.gitbook/assets/image (101).png" alt=""><figcaption></figcaption></figure>

## 概述

* [ ] 了解账户中服务的**使用情况**
* [ ] 查找**区域 ID** 和**账户 ID**

## 分析

* [ ] 在**`安全`**中检查是否有任何**速率限制**

## DNS

* [ ] 检查 DNS **记录**中的**有趣**（敏感？）数据
* [ ] 检查可能包含**敏感信息**的**子域**，仅基于**名称**（如 admin173865324.domin.com）
* [ ] 检查**未**被**代理**的网页
* [ ] 检查可以通过 CNAME 或 IP 地址**直接访问**的**代理网页**
* [ ] 检查是否启用了**DNSSEC**
* [ ] 检查所有 CNAME 中是否**使用了 CNAME 平铺**
* 这可能对**隐藏子域接管漏洞**和提高加载时间有所帮助
* [ ] 检查域名是否**不易受欺骗攻击**的

## **电子邮件**

待办事项

## Spectrum

待办事项

## SSL/TLS

### **概述**

* [ ] **SSL/TLS 加密**应为**完整**或**完全（严格）**。其他任何选项都会在某个时候发送**明文流量**。
* [ ] 应启用**SSL/TLS 推荐器**

### 边缘证书

* [ ] 应启用**始终使用 HTTPS**
* [ ] 应启用**HTTP 严格传输安全性 (HSTS)**
* [ ] **最低 TLS 版本**应为 1.2
* [ ] 应启用**TLS 1.3**
* [ ] 应启用**自动 HTTPS 重写**
* [ ] 应启用**证书透明监控**

## **安全**

* [ ] 在**`WAF`**部分，检查是否使用**防火墙**和**速率限制规则**以防止滥用。
* **`绕过`**操作将为请求**禁用 Cloudflare 安全**功能。不应使用此功能。
* [ ] 在**`页面防护`**部分，建议检查是否**已启用**，如果使用了任何页面
* [ ] 在**`API 防护`**部分，建议检查是否**已启用**，如果在 Cloudflare 中公开了任何 API
* [ ] 在**`DDoS`**部分，建议启用**DDoS 保护**
* [ ] 在**`设置`**部分：
* [ ] 检查**`安全级别`**是否为**中等**或更高
* [ ] 检查**`挑战通过率`**最多为 1 小时
* [ ] 检查**`浏览器完整性检查`**是否**已启用**
* [ ] 检查**`隐私通行证支持`**是否**已启用**

### **CloudFlare DDoS 保护**

* 如果可以，启用**机器人对抗模式**或**超级机器人对抗模式**。如果您正在保护某些通过程序访问的 API（例如从 JS 前端页面），您可能无法在不破坏该访问的情况下启用此功能。
* 在**WAF**中：您可以通过 URL 路径或**验证的机器人**（速率限制规则）创建**速率限制**，或者基于 IP、Cookie、引荐来源等**阻止访问**。因此，您可以阻止不来自网页或没有 Cookie 的请求。
* 如果攻击来自**验证的机器人**，至少**向机器人添加速率限制**。
* 如果攻击针对**特定路径**，作为预防机制，在此路径中添加**速率限制**。
* 您还可以在 WAF 中的**工具**中**列入白名单** IP 地址、IP 范围、国家或 ASNs。
* 检查**托管规则**是否还有助于防止漏洞利用。
* 在**工具**部分，您可以**阻止或向特定 IP** 和**用户代理**发出挑战。
* 在 DDoS 中，您可以**覆盖某些规则以使其更严格**。
* **设置**：将**安全级别**设置为**高**，如果您受到攻击，则设置为**受到攻击**，并确保**已启用浏览器完整性检查**。
* 在 Cloudflare 域名 -> 分析 -> 安全 -> 检查是否已启用**速率限制**
* 在 Cloudflare 域名 -> 安全 -> 事件 -> 检查是否检测到**恶意事件**

## 访问

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## 速度

_我找不到与安全相关的任何选项_

## 缓存

* [ ] 在**`配置`**部分考虑启用**CSAM 扫描工具**

## **工作程序路由**

_您应该已经检查了_ [_cloudflare 工作程序_](./#workers)

## 规则

待办事项

## 网络

* [ ] 如果启用了**`HTTP/2`**，应启用**`HTTP/2 到源`**
* [ ] 应启用**`HTTP/3（使用 QUIC）`**
* 如果您的**用户**的**隐私**很重要，请确保**已启用洋葱路由**

## **流量**

待办事项

## 自定义页面

* [ ] 可选择在触发与安全相关的错误时配置自定义页面（如阻止、速率限制或我受到攻击模式）
## 应用程序

TODO

## Scrape Shield

* [ ] 检查 **电子邮件地址混淆** 是否已**启用**
* [ ] 检查 **服务器端排除** 是否已**启用**

## **Zaraz**

TODO

## **Web3**

TODO

<details>

{% hint style="success" %}
学习并实践 AWS 黑客技术：<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks 培训 AWS 红队专家 (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
学习并实践 GCP 黑客技术：<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks 培训 GCP 红队专家 (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>支持 HackTricks</summary>

* 检查 [**订阅计划**](https://github.com/sponsors/carlospolop)!
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**电报群组**](https://t.me/peass) 或 **关注** 我们的 **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* 通过向 [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库提交 PR 来分享黑客技巧。

</details>
{% endhint %}
