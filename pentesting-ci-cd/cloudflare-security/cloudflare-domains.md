# Cloudflare Domains

<details>

{% hint style="success" %}
Lernen Sie und √ºben Sie AWS-Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Lernen Sie und √ºben Sie GCP-Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositorys senden.

</details>
{% endhint %}

In jedem TLD, der in Cloudflare konfiguriert ist, gibt es einige **allgemeine Einstellungen und Dienste**, die konfiguriert werden k√∂nnen. Auf dieser Seite werden wir die **sicherheitsrelevanten Einstellungen jeder Sektion analysieren:**

<figure><img src="../../.gitbook/assets/image (101).png" alt=""><figcaption></figcaption></figure>

## √úberblick

* [ ] Erhalten Sie ein Gef√ºhl daf√ºr, **wie stark** die Dienste des Kontos **genutzt** werden
* [ ] Finden Sie auch die **Zonen-ID** und die **Kontonummer**

## Analytik

* [ ] √úberpr√ºfen Sie in **`Sicherheit`**, ob es ein **Rate-Limiting** gibt

## DNS

* [ ] √úberpr√ºfen Sie **interessante** (sensible?) Daten in DNS-**Eintr√§gen**
* [ ] √úberpr√ºfen Sie **Subdomains**, die m√∂glicherweise **sensible Informationen** enthalten, basierend nur auf dem **Namen** (wie admin173865324.domin.com)
* [ ] √úberpr√ºfen Sie Webseiten, die **nicht** **geproxied** sind
* [ ] √úberpr√ºfen Sie **geproxiede Webseiten**, die direkt √ºber CNAME oder IP-Adresse **aufgerufen werden k√∂nnen**
* [ ] √úberpr√ºfen Sie, ob **DNSSEC** aktiviert ist
* [ ] √úberpr√ºfen Sie, ob **CNAME-Flattening** in **allen CNAMEs verwendet wird**
* Dies k√∂nnte n√ºtzlich sein, um **Subdomain-√úbernahmeschwachstellen zu verbergen** und die Ladezeiten zu verbessern
* [ ] √úberpr√ºfen Sie, dass die Domains [**nicht anf√§llig f√ºr Spoofing sind**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing)

## **E-Mail**

TODO

## Spectrum

TODO

## SSL/TLS

### **√úberblick**

* [ ] Die **SSL/TLS-Verschl√ºsselung** sollte **Vollst√§ndig** oder **Vollst√§ndig (Strikt)** sein. Jede andere wird den Datenverkehr **im Klartext** an einem Punkt senden.
* [ ] Der **SSL/TLS-Empfehler** sollte aktiviert sein

### Edge-Zertifikate

* [ ] **Immer HTTPS verwenden** sollte aktiviert sein
* [ ] **HTTP Strict Transport Security (HSTS)** sollte aktiviert sein
* [ ] Die **minimale TLS-Version sollte 1.2** sein
* [ ] **TLS 1.3 sollte aktiviert sein**
* [ ] **Automatische HTTPS-Umschreibungen** sollten aktiviert sein
* [ ] Die **Zertifikatstransparenz√ºberwachung** sollte aktiviert sein

## **Sicherheit**

* [ ] Im Abschnitt **`WAF`** ist es interessant zu √ºberpr√ºfen, ob **Firewall**- und **Rate-Limiting-Regeln verwendet werden**, um Missbr√§uche zu verhindern.
* Die **`Bypass`**-Aktion wird die Sicherheitsfunktionen von Cloudflare f√ºr eine Anfrage **deaktivieren**. Sie sollte nicht verwendet werden.
* [ ] Im Abschnitt **`Page Shield`** wird empfohlen zu √ºberpr√ºfen, ob es aktiviert ist, wenn eine Seite verwendet wird
* [ ] Im Abschnitt **`API Shield`** wird empfohlen zu √ºberpr√ºfen, ob es aktiviert ist, wenn eine API in Cloudflare freigegeben ist
* [ ] Im Abschnitt **`DDoS`** wird empfohlen, die **DDoS-Schutzma√ünahmen zu aktivieren**
* [ ] Im Abschnitt **`Einstellungen`**:
* [ ] √úberpr√ºfen Sie, ob der **`Sicherheitslevel`** mindestens **mittel** ist
* [ ] √úberpr√ºfen Sie, ob die **`Challenge-Passage`** maximal 1 Stunde betr√§gt
* [ ] √úberpr√ºfen Sie, ob die **`Browser-Integrit√§tspr√ºfung`** aktiviert ist
* [ ] √úberpr√ºfen Sie, ob die **`Privacy Pass-Unterst√ºtzung`** aktiviert ist

### **CloudFlare DDoS-Schutz**

* Wenn m√∂glich, aktivieren Sie den **Bot Fight Mode** oder den **Super Bot Fight Mode**. Wenn Sie ein API sch√ºtzen, das programmgesteuert aufgerufen wird (zum Beispiel von einer JS-Frontend-Seite). M√∂glicherweise k√∂nnen Sie dies nicht aktivieren, ohne diesen Zugriff zu unterbrechen.
* Im **WAF**: Sie k√∂nnen **Rate-Limits nach URL-Pfad** oder f√ºr **verifizierte Bots** (Rate-Limiting-Regeln) erstellen oder den Zugriff basierend auf IP, Cookie, Referrer... blockieren). So k√∂nnten Sie Anfragen blockieren, die nicht von einer Webseite stammen oder kein Cookie haben.
* Wenn der Angriff von einem **verifizierten Bot** ausgeht, f√ºgen Sie zumindest **Rate-Limits f√ºr Bots** hinzu.
* Wenn der Angriff auf einen **bestimmten Pfad** erfolgt, f√ºgen Sie als Pr√§ventionsmechanismus ein **Rate-Limit** in diesem Pfad hinzu.
* Sie k√∂nnen auch IP-Adressen, IP-Bereiche, L√§nder oder ASNs aus den **Tools** im WAF **whitelisten**.
* √úberpr√ºfen Sie, ob **Managed Rules** auch dazu beitragen k√∂nnten, Schwachstellen-Exploits zu verhindern.
* Im Abschnitt **Tools** k√∂nnen Sie **bestimmten IPs** und **Benutzeragenten** den **Zugriff blockieren oder eine Herausforderung geben**.
* Bei DDoS k√∂nnten Sie **einige Regeln au√üer Kraft setzen, um sie restriktiver zu gestalten**.
* **Einstellungen**: Setzen Sie den **Sicherheitslevel** auf **Hoch** und auf **Unter Angriff**, wenn Sie unter Angriff stehen, und stellen Sie sicher, dass die **Browser-Integrit√§tspr√ºfung aktiviert ist**.
* In Cloudflare-Domains -> Analytik -> Sicherheit -> √úberpr√ºfen Sie, ob **Rate-Limiting** aktiviert ist
* In Cloudflare-Domains -> Sicherheit -> Ereignisse -> √úberpr√ºfen Sie auf **erkannte b√∂sartige Ereignisse**

## Zugriff

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Geschwindigkeit

_Ich konnte keine Option finden, die mit Sicherheit in Verbindung steht_

## Caching

* [ ] In der **`Konfiguration`**-Sektion sollten Sie das **CSAM-Scanning-Tool** aktivieren

## **Worker-Routen**

_Sie sollten bereits_ [_Cloudflare-Worker_](./#workers) _√ºberpr√ºft haben_

## Regeln

TODO

## Netzwerk

* [ ] Wenn **`HTTP/2` aktiviert** ist, sollte **`HTTP/2 to Origin` aktiviert** sein
* [ ] **`HTTP/3 (mit QUIC)` sollte aktiviert sein**
* Wenn die **Privatsph√§re** Ihrer **Benutzer** wichtig ist, stellen Sie sicher, dass **`Onion Routing` aktiviert** ist

## **Traffic**

TODO

## Benutzerdefinierte Seiten

* [ ] Es ist optional, benutzerdefinierte Seiten zu konfigurieren, wenn ein Fehler im Zusammenhang mit Sicherheit ausgel√∂st wird (wie eine Blockierung, Rate-Limiting oder Ich bin im Angriffsmodus)
## Apps

TODO

## Scrape Shield

* [ ] √úberpr√ºfen Sie, ob die **E-Mail-Adressen-Verschleierung** aktiviert ist
* [ ] √úberpr√ºfen Sie, ob die **Server-seitige Ausschl√ºsse** aktiviert sind

## **Zaraz**

TODO

## **Web3**

TODO

<details>

{% hint style="success" %}
Lernen Sie und √ºben Sie AWS-Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Lernen Sie und √ºben Sie GCP-Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositorys einreichen.

</details>
{% endhint %}
