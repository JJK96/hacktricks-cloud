# Dominios de Cloudflare

<details>

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci√≥n**](https://github.com/sponsors/carlospolop)!
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>
{% endhint %}

En cada TLD configurado en Cloudflare hay algunas **configuraciones y servicios generales** que se pueden configurar. En esta p√°gina vamos a **analizar las configuraciones relacionadas con la seguridad de cada secci√≥n:**

<figure><img src="../../.gitbook/assets/image (101).png" alt=""><figcaption></figcaption></figure>

## Resumen

* [ ] Obtener una idea de **cu√°nto** se utilizan los servicios de la cuenta
* [ ] Encontrar tambi√©n el **ID de zona** y el **ID de cuenta**

## Anal√≠ticas

* [ ] En **`Seguridad`** verificar si hay alg√∫n **L√≠mite de tasa**

## DNS

* [ ] Verificar datos **interesantes** (¬øsensibles?) en los **registros** de DNS
* [ ] Buscar **subdominios** que podr√≠an contener **informaci√≥n sensible** solo bas√°ndose en el **nombre** (como admin173865324.domin.com)
* [ ] Verificar las p√°ginas web que **no est√°n** **proxyadas**
* [ ] Verificar las p√°ginas web **proxyadas** que pueden ser **accedidas directamente** por CNAME o direcci√≥n IP
* [ ] Verificar que **DNSSEC** est√© **habilitado**
* [ ] Verificar que se est√© utilizando **Aplanamiento de CNAME** en **todos los CNAMEs**
* Esto podr√≠a ser √∫til para **ocultar vulnerabilidades de toma de subdominio** y mejorar los tiempos de carga
* [ ] Verificar que los dominios [**no sean vulnerables al spoofing**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing)

## **Correo electr√≥nico**

TODO

## Espectro

TODO

## SSL/TLS

### **Resumen**

* [ ] La **encriptaci√≥n SSL/TLS** deber√≠a ser **Completa** o **Completa (estricta)**. Cualquier otra enviar√° **tr√°fico en texto claro** en alg√∫n momento.
* [ ] El **Recomendador SSL/TLS** deber√≠a estar habilitado

### Certificados de Borde

* [ ] **Usar siempre HTTPS** deber√≠a estar **habilitado**
* [ ] **Seguridad de transporte estricta de HTTP (HSTS)** deber√≠a estar **habilitada**
* [ ] La **Versi√≥n m√≠nima de TLS** deber√≠a ser 1.2
* [ ] **TLS 1.3** deber√≠a estar habilitado
* [ ] **Redirecciones autom√°ticas de HTTPS** deber√≠an estar **habilitadas**
* [ ] El **Monitoreo de Transparencia de Certificados** deber√≠a estar **habilitado**

## **Seguridad**

* [ ] En la secci√≥n **`WAF`** es interesante verificar que se est√©n utilizando reglas de **Firewall** y **l√≠mites de tasa** para prevenir abusos.
* La acci√≥n de **`Bypass`** deshabilitar√° las caracter√≠sticas de seguridad de Cloudflare para una solicitud. No deber√≠a ser utilizada.
* [ ] En la secci√≥n **`Page Shield`** se recomienda verificar que est√© **habilitado** si se utiliza alguna p√°gina
* [ ] En la secci√≥n **`API Shield`** se recomienda verificar que est√© **habilitado** si alguna API est√° expuesta en Cloudflare
* [ ] En la secci√≥n **`DDoS`** se recomienda habilitar las protecciones **DDoS**
* [ ] En la secci√≥n **`Configuraciones`**:
* [ ] Verificar que el **`Nivel de Seguridad`** sea **medio** o mayor
* [ ] Verificar que el **`Paso de Desaf√≠o`** sea de m√°ximo 1 hora
* [ ] Verificar que la **`Comprobaci√≥n de Integridad del Navegador`** est√© **habilitada**
* [ ] Verificar que el **`Soporte de Pase de Privacidad`** est√© **habilitado**

### **Protecci√≥n DDoS de CloudFlare**

* Si es posible, habilitar el **Modo de Lucha contra Bots** o el **Modo Super Bot Fight**. Si est√°s protegiendo alguna API accedida program√°ticamente (desde una p√°gina de frontend de JS, por ejemplo). Es posible que no puedas habilitar esto sin interrumpir ese acceso.
* En **WAF**: Puedes crear **l√≠mites de tasa por ruta de URL** o para **bots verificados** (reglas de l√≠mite de tasa), o para **bloquear el acceso** basado en IP, Cookie, referente...). As√≠ podr√≠as bloquear solicitudes que no provengan de una p√°gina web o que no tengan una cookie.
* Si el ataque proviene de un **bot verificado**, al menos **agrega un l√≠mite de tasa** a los bots.
* Si el ataque es a una **ruta espec√≠fica**, como mecanismo de prevenci√≥n, agrega un **l√≠mite de tasa** en esta ruta.
* Tambi√©n puedes **poner en lista blanca** direcciones IP, rangos de IP, pa√≠ses o ASNs desde las **Herramientas** en WAF.
* Verifica si las **reglas administradas** tambi√©n podr√≠an ayudar a prevenir la explotaci√≥n de vulnerabilidades.
* En la secci√≥n **Herramientas** puedes **bloquear o desafiar a IPs espec√≠ficas** y **agentes de usuario.**
* En DDoS podr√≠as **anular algunas reglas para hacerlas m√°s restrictivas**.
* **Configuraciones**: Establece el **Nivel de Seguridad** en **Alto** y en **Bajo Ataque** si est√°s Bajo Ataque y verifica que la **Comprobaci√≥n de Integridad del Navegador est√© habilitada**.
* En Dominios de Cloudflare -> Anal√≠ticas -> Seguridad -> Verifica si est√° habilitado el **l√≠mite de tasa**
* En Dominios de Cloudflare -> Seguridad -> Eventos -> Verifica los **Eventos maliciosos detectados**

## Acceso

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Velocidad

_No pude encontrar ninguna opci√≥n relacionada con la seguridad_

## Cach√©

* [ ] En la secci√≥n **`Configuraci√≥n`** considera habilitar la **Herramienta de Escaneo CSAM**

## **Rutas de Workers**

_Ya deber√≠as haber verificado_ [_workers de Cloudflare_](./#workers)

## Reglas

TODO

## Red

* [ ] Si **`HTTP/2`** est√° **habilitado**, **`HTTP/2 a Origen`** deber√≠a estar **habilitado**
* [ ] **`HTTP/3 (con QUIC)`** deber√≠a estar **habilitado**
* [ ] Si la **privacidad** de tus **usuarios** es importante, aseg√∫rate de que **`Enrutamiento de Cebolla`** est√© **habilitado**

## **Tr√°fico**

TODO

## P√°ginas Personalizadas

* [ ] Es opcional configurar p√°ginas personalizadas cuando se activa un error relacionado con la seguridad (como un bloqueo, l√≠mite de tasa o modo de Estoy bajo ataque)
## Aplicaciones

TODO

## Protecci√≥n contra Scraping

* [ ] Verificar que la **Ofuscaci√≥n de Direcciones de Correo Electr√≥nico** est√© **habilitada**
* [ ] Verificar que las **Exclusiones del Lado del Servidor** est√©n **habilitadas**

## **Zaraz**

TODO

## **Web3**

TODO

<details>

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Entrenamiento HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Entrenamiento HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci√≥n**](https://github.com/sponsors/carlospolop)!
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
