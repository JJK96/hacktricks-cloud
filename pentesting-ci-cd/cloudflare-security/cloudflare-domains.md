# Cloudflare Domains

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

Σε κάθε TLD που έχει ρυθμιστεί στο Cloudflare υπάρχουν κάποιες **γενικές ρυθμίσεις και υπηρεσίες** που μπορούν να ρυθμιστούν. Σε αυτή τη σελίδα θα **αναλύσουμε τις ρυθμίσεις που σχετίζονται με την ασφάλεια κάθε ενότητας:**

<figure><img src="../../.gitbook/assets/image (101).png" alt=""><figcaption></figcaption></figure>

### Επισκόπηση

* [ ] Αποκτήστε μια αίσθηση του **πόσο** χρησιμοποιούνται οι υπηρεσίες του λογαριασμού **χρησιμοποιούνται**
* [ ] Βρείτε επίσης το **zone ID** και το **account ID**

### Αναλύσεις

* [ ] Στην **`Ασφάλεια`** ελέγξτε αν υπάρχει οποιοδήποτε **Rate limiting**

### DNS

* [ ] Ελέγξτε **ενδιαφέροντα** (ευαίσθητα;) δεδομένα στα DNS **αρχεία**
* [ ] Ελέγξτε για **subdomains** που θα μπορούσαν να περιέχουν **ευαίσθητες πληροφορίες** μόνο με βάση το **όνομα** (όπως admin173865324.domin.com)
* [ ] Ελέγξτε για ιστοσελίδες που **δεν είναι** **προξενημένες**
* [ ] Ελέγξτε για **προξενημένες ιστοσελίδες** που μπορούν να **προσεγγιστούν απευθείας** μέσω CNAME ή διεύθυνσης IP
* [ ] Ελέγξτε ότι το **DNSSEC** είναι **ενεργοποιημένο**
* [ ] Ελέγξτε ότι το **CNAME Flattening** είναι **χρησιμοποιούμενο** σε **όλα τα CNAMEs**
* Αυτό μπορεί να είναι χρήσιμο για να **κρύψει τις ευπάθειες ανάληψης subdomain** και να βελτιώσει τους χρόνους φόρτωσης
* [ ] Ελέγξτε ότι τα domains [**δεν είναι ευάλωτα σε spoofing**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing)

### **Email**

TODO

### Spectrum

TODO

### SSL/TLS

#### **Επισκόπηση**

* [ ] Η **κρυπτογράφηση SSL/TLS** θα πρέπει να είναι **Πλήρης** ή **Πλήρης (Αυστηρή)**. Οποιαδήποτε άλλη θα στείλει **clear-text traffic** σε κάποιο σημείο.
* [ ] Ο **Συστήματος SSL/TLS** θα πρέπει να είναι ενεργοποιημένος

#### Πιστοποιητικά Edge

* [ ] **Πάντα Χρησιμοποιήστε HTTPS** θα πρέπει να είναι **ενεργοποιημένο**
* [ ] **HTTP Strict Transport Security (HSTS)** θα πρέπει να είναι **ενεργοποιημένο**
* [ ] **Η Ελάχιστη Έκδοση TLS θα πρέπει να είναι 1.2**
* [ ] **TLS 1.3 θα πρέπει να είναι ενεργοποιημένο**
* [ ] **Αυτόματες Επαναγραφές HTTPS** θα πρέπει να είναι **ενεργοποιημένες**
* [ ] **Παρακολούθηση Διαφάνειας Πιστοποιητικών** θα πρέπει να είναι **ενεργοποιημένη**

### **Ασφάλεια**

* [ ] Στην ενότητα **`WAF`** είναι ενδιαφέρον να ελέγξετε ότι οι **κανόνες Firewall** και **rate limiting χρησιμοποιούνται** για να αποτρέψουν καταχρήσεις.
* Η ενέργεια **`Bypass`** θα **απενεργοποιήσει τις δυνατότητες ασφάλειας του Cloudflare** για ένα αίτημα. Δεν θα πρέπει να χρησιμοποιείται.
* [ ] Στην ενότητα **`Page Shield`** συνιστάται να ελέγξετε ότι είναι **ενεργοποιημένο** αν χρησιμοποιείται κάποια σελίδα
* [ ] Στην ενότητα **`API Shield`** συνιστάται να ελέγξετε ότι είναι **ενεργοποιημένο** αν εκτίθεται κάποια API στο Cloudflare
* [ ] Στην ενότητα **`DDoS`** συνιστάται να ενεργοποιήσετε τις **προστασίες DDoS**
* [ ] Στην ενότητα **`Ρυθμίσεις`**:
* [ ] Ελέγξτε ότι το **`Επίπεδο Ασφάλειας`** είναι **μεσαίο** ή μεγαλύτερο
* [ ] Ελέγξτε ότι το **`Challenge Passage`** είναι 1 ώρα το πολύ
* [ ] Ελέγξτε ότι το **`Έλεγχος Ακεραιότητας Περιηγητή`** είναι **ενεργοποιημένο**
* [ ] Ελέγξτε ότι η **`Υποστήριξη Privacy Pass`** είναι **ενεργοποιημένη**

#### **Προστασία DDoS CloudFlare**

* Αν μπορείτε, ενεργοποιήστε το **Bot Fight Mode** ή το **Super Bot Fight Mode**. Αν προστατεύετε κάποια API που προσπελάζεται προγραμματικά (από μια σελίδα JS front end για παράδειγμα). Μπορεί να μην μπορείτε να το ενεργοποιήσετε χωρίς να σπάσετε αυτή την πρόσβαση.
* Στο **WAF**: Μπορείτε να δημιουργήσετε **rate limits κατά URL path** ή για **επιβεβαιωμένα bots** (κανόνες rate limiting), ή να **μπλοκάρετε την πρόσβαση** με βάση IP, Cookie, referrer...). Έτσι μπορείτε να μπλοκάρετε αιτήματα που δεν προέρχονται από μια ιστοσελίδα ή δεν έχουν cookie.
* Αν η επίθεση προέρχεται από ένα **επιβεβαιωμένο bot**, τουλάχιστον **προσθέστε ένα rate limit** για τα bots.
* Αν η επίθεση είναι σε ένα **συγκεκριμένο path**, ως μηχανισμός πρόληψης, προσθέστε ένα **rate limit** σε αυτό το path.
* Μπορείτε επίσης να **whitelist** διευθύνσεις IP, εύρη IP, χώρες ή ASNs από τα **Εργαλεία** στο WAF.
* Ελέγξτε αν οι **Διαχειριζόμενοι κανόνες** θα μπορούσαν επίσης να βοηθήσουν στην πρόληψη εκμεταλλεύσεων ευπαθειών.
* Στην ενότητα **Εργαλεία** μπορείτε να **μπλοκάρετε ή να δώσετε μια πρόκληση σε συγκεκριμένες IPs** και **user agents.**
* Στο DDoS μπορείτε να **παρακάμψετε κάποιους κανόνες για να τους κάνετε πιο περιοριστικούς**.
* **Ρυθμίσεις**: Ρυθμίστε το **Επίπεδο Ασφάλειας** σε **Υψηλό** και σε **Υπό Επίθεση** αν είστε Υπό Επίθεση και ότι ο **Έλεγχος Ακεραιότητας Περιηγητή είναι ενεργοποιημένος**.
* Στο Cloudflare Domains -> Αναλύσεις -> Ασφάλεια -> Ελέγξτε αν είναι ενεργοποιημένο το **rate limit**
* Στο Cloudflare Domains -> Ασφάλεια -> Γεγονότα -> Ελέγξτε για **ανιχνευμένα κακόβουλα Γεγονότα**

### Πρόσβαση

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

### Ταχύτητα

_Δεν μπόρεσα να βρω καμία επιλογή σχετική με την ασφάλεια_

### Κρυφή μνήμη

* [ ] Στην ενότητα **`Ρύθμιση`** σκεφτείτε να ενεργοποιήσετε το **Εργαλείο Σάρωσης CSAM**

### **Διαδρομές Εργατών**

_Θα έπρεπε ήδη να έχετε ελέγξει_ [_cloudflare workers_](./#workers)

### Κανόνες

TODO

### Δίκτυο

* [ ] Αν το **`HTTP/2`** είναι **ενεργοποιημένο**, το **`HTTP/2 to Origin`** θα πρέπει να είναι **ενεργοποιημένο**
* [ ] **`HTTP/3 (με QUIC)`** θα πρέπει να είναι **ενεργοποιημένο**
* [ ] Αν η **ιδιωτικότητα** των **χρηστών** σας είναι σημαντική, βεβαιωθείτε ότι το **`Onion Routing`** είναι **ενεργοποιημένο**

### **Κίνηση**

TODO

### Προσαρμοσμένες Σελίδες

* [ ] Είναι προαιρετικό να ρυθμίσετε προσαρμοσμένες σελίδες όταν προκληθεί ένα σφάλμα σχετικό με την ασφάλεια (όπως μπλοκάρισμα, rate limiting ή είμαι σε κατάσταση επίθεσης)

### Εφαρμογές

TODO

### Scrape Shield

* [ ] Ελέγξτε ότι η **Απόκρυψη Διευθύνσεων Email** είναι **ενεργοποιημένη**
* [ ] Ελέγξτε ότι οι **Εξαιρέσεις Server-side** είναι **ενεργοποιημένες**

### **Zaraz**

TODO

### **Web3**

TODO

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
