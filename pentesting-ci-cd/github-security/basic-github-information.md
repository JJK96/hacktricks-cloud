# Basic Github Information

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Structure

Η βασική δομή του περιβάλλοντος github μιας μεγάλης **εταιρείας** είναι να κατέχει μια **επιχείρηση** που κατέχει **πολλές οργανώσεις** και η κάθε μία από αυτές μπορεί να περιέχει **πολλούς αποθετηρίους** και **πολλές ομάδες**. Οι μικρότερες εταιρείες μπορεί να **κατέχουν μόνο μία οργάνωση και καμία επιχείρηση**.

Από την οπτική γωνία του χρήστη, ένας **χρήστης** μπορεί να είναι **μέλος** **διαφορετικών επιχειρήσεων και οργανώσεων**. Μέσα σε αυτές, ο χρήστης μπορεί να έχει **διαφορετικούς ρόλους επιχείρησης, οργάνωσης και αποθετηρίου**.

Επιπλέον, ένας χρήστης μπορεί να είναι **μέλος διαφορετικών ομάδων** με διαφορετικούς ρόλους επιχείρησης, οργάνωσης ή αποθετηρίου.

Και τέλος, **οι αποθετήριοι μπορεί να έχουν ειδικούς μηχανισμούς προστασίας**.

## Privileges

### Enterprise Roles

* **Enterprise owner**: Άτομα με αυτόν τον ρόλο μπορούν να **διαχειρίζονται διαχειριστές, να διαχειρίζονται οργανώσεις εντός της επιχείρησης, να διαχειρίζονται ρυθμίσεις επιχείρησης, να επιβάλλουν πολιτική σε οργανώσεις**. Ωστόσο, **δεν μπορούν να έχουν πρόσβαση στις ρυθμίσεις ή το περιεχόμενο της οργάνωσης** εκτός αν γίνουν ιδιοκτήτες οργάνωσης ή τους δοθεί άμεση πρόσβαση σε αποθετήριο που ανήκει σε οργάνωση.
* **Enterprise members**: Τα μέλη των οργανώσεων που ανήκουν στην επιχείρησή σας είναι επίσης **αυτόματα μέλη της επιχείρησης**.

### Organization Roles

Σε μια οργάνωση, οι χρήστες μπορούν να έχουν διαφορετικούς ρόλους:

* **Organization owners**: Οι ιδιοκτήτες οργανώσεων έχουν **πλήρη διοικητική πρόσβαση στην οργάνωσή σας**. Αυτός ο ρόλος θα πρέπει να περιορίζεται, αλλά όχι σε λιγότερους από δύο ανθρώπους, στην οργάνωσή σας.
* **Organization members**: Ο **προεπιλεγμένος**, μη διοικητικός ρόλος για **άτομα σε μια οργάνωση** είναι το μέλος οργάνωσης. Από προεπιλογή, τα μέλη της οργάνωσης **έχουν έναν αριθμό δικαιωμάτων**.
* **Billing managers**: Οι διαχειριστές χρέωσης είναι χρήστες που μπορούν να **διαχειρίζονται τις ρυθμίσεις χρέωσης για την οργάνωσή σας**, όπως πληροφορίες πληρωμής.
* **Security Managers**: Είναι ένας ρόλος που οι ιδιοκτήτες οργανώσεων μπορούν να αναθέσουν σε οποιαδήποτε ομάδα σε μια οργάνωση. Όταν εφαρμοστεί, δίνει σε κάθε μέλος της ομάδας δικαιώματα να **διαχειρίζεται ειδοποιήσεις και ρυθμίσεις ασφαλείας σε όλη την οργάνωσή σας, καθώς και δικαιώματα ανάγνωσης για όλους τους αποθετηρίους** στην οργάνωση.
* Αν η οργάνωσή σας έχει μια ομάδα ασφαλείας, μπορείτε να χρησιμοποιήσετε τον ρόλο του διαχειριστή ασφαλείας για να δώσετε στα μέλη της ομάδας την ελάχιστη πρόσβαση που χρειάζονται στην οργάνωση.
* **Github App managers**: Για να επιτρέψετε σε επιπλέον χρήστες να **διαχειρίζονται τις εφαρμογές GitHub που ανήκουν σε μια οργάνωση**, ένας ιδιοκτήτης μπορεί να τους χορηγήσει δικαιώματα διαχειριστή εφαρμογών GitHub.
* **Outside collaborators**: Ένας εξωτερικός συνεργάτης είναι ένα άτομο που έχει **πρόσβαση σε έναν ή περισσότερους αποθετηρίους οργανώσεων αλλά δεν είναι ρητά μέλος** της οργάνωσης.

Μπορείτε να **συγκρίνετε τα δικαιώματα** αυτών των ρόλων σε αυτόν τον πίνακα: [https://docs.github.com/en/organizations/managing-peoples-access-to-your-organization-with-roles/roles-in-an-organization#permissions-for-organization-roles](https://docs.github.com/en/organizations/managing-peoples-access-to-your-organization-with-roles/roles-in-an-organization#permissions-for-organization-roles)

### Members Privileges

Στο _https://github.com/organizations/\<org\_name>/settings/member\_privileges_ μπορείτε να δείτε τα **δικαιώματα που θα έχουν οι χρήστες απλώς και μόνο επειδή είναι μέλη της οργάνωσης**.

Οι ρυθμίσεις που έχουν ρυθμιστεί εδώ θα υποδεικνύουν τα εξής δικαιώματα των μελών της οργάνωσης:

* Να είναι διαχειριστής, συγγραφέας, αναγνώστης ή χωρίς δικαιώματα σε όλους τους αποθετηρίους της οργάνωσης.
* Αν τα μέλη μπορούν να δημιουργούν ιδιωτικούς, εσωτερικούς ή δημόσιους αποθετηρίους.
* Αν είναι δυνατή η δημιουργία αντιγράφων αποθετηρίων
* Αν είναι δυνατή η πρόσκληση εξωτερικών συνεργατών
* Αν μπορούν να δημοσιευτούν δημόσιες ή ιδιωτικές τοποθεσίες
* Τα δικαιώματα που έχουν οι διαχειριστές στους αποθετηρίους
* Αν τα μέλη μπορούν να δημιουργούν νέες ομάδες

### Repository Roles

Από προεπιλογή, οι ρόλοι αποθετηρίου δημιουργούνται:

* **Read**: Συνιστάται για **μη κωδικοποιητές συνεργάτες** που θέλουν να δουν ή να συζητήσουν το έργο σας
* **Triage**: Συνιστάται για **συνεργάτες που χρειάζεται να διαχειρίζονται ενεργά ζητήματα και αιτήματα έλξης** χωρίς δικαιώματα εγγραφής
* **Write**: Συνιστάται για συνεργάτες που **σπρώχνουν ενεργά στο έργο σας**
* **Maintain**: Συνιστάται για **διαχειριστές έργων που χρειάζεται να διαχειρίζονται το αποθετήριο** χωρίς πρόσβαση σε ευαίσθητες ή καταστροφικές ενέργειες
* **Admin**: Συνιστάται για άτομα που χρειάζονται **πλήρη πρόσβαση στο έργο**, συμπεριλαμβανομένων ευαίσθητων και καταστροφικών ενεργειών όπως η διαχείριση ασφαλείας ή η διαγραφή ενός αποθετηρίου

Μπορείτε να **συγκρίνετε τα δικαιώματα** κάθε ρόλου σε αυτόν τον πίνακα [https://docs.github.com/en/organizations/managing-access-to-your-organizations-repositories/repository-roles-for-an-organization#permissions-for-each-role](https://docs.github.com/en/organizations/managing-access-to-your-organizations-repositories/repository-roles-for-an-organization#permissions-for-each-role)

Μπορείτε επίσης να **δημιουργήσετε τους δικούς σας ρόλους** στο _https://github.com/organizations/\<org\_name>/settings/roles_

### Teams

Μπορείτε να **καταγράψετε τις ομάδες που έχουν δημιουργηθεί σε μια οργάνωση** στο _https://github.com/orgs/\<org\_name>/teams_. Σημειώστε ότι για να δείτε τις ομάδες που είναι παιδιά άλλων ομάδων, πρέπει να έχετε πρόσβαση σε κάθε γονική ομάδα.

### Users

Οι χρήστες μιας οργάνωσης μπορούν να **καταγραφούν** στο _https://github.com/orgs/\<org\_name>/people._

Στις πληροφορίες κάθε χρήστη μπορείτε να δείτε τις **ομάδες στις οποίες είναι μέλος ο χρήστης**, και τους **αποθετηρίους στους οποίους έχει πρόσβαση ο χρήστης**.

## Github Authentication

Το Github προσφέρει διαφορετικούς τρόπους για να πιστοποιήσετε τον λογαριασμό σας και να εκτελέσετε ενέργειες εκ μέρους σας.

### Web Access

Αποκτώντας πρόσβαση στο **github.com**, μπορείτε να συνδεθείτε χρησιμοποιώντας το **όνομα χρήστη και τον κωδικό πρόσβασης** (και μια **2FA ενδεχομένως**).

### **SSH Keys**

Μπορείτε να ρυθμίσετε τον λογαριασμό σας με ένα ή περισσότερα δημόσια κλειδιά που επιτρέπουν στο σχετικό **ιδιωτικό κλειδί να εκτελεί ενέργειες εκ μέρους σας.** [https://github.com/settings/keys](https://github.com/settings/keys)

#### **GPG Keys**

Δεν μπορείτε να προσποιηθείτε τον χρήστη με αυτά τα κλειδιά, αλλά αν δεν το χρησιμοποιείτε, μπορεί να είναι δυνατόν να **ανακαλυφθείτε για την αποστολή commits χωρίς υπογραφή**. Μάθετε περισσότερα για [την προσεκτική λειτουργία εδώ](https://docs.github.com/en/authentication/managing-commit-signature-verification/displaying-verification-statuses-for-all-of-your-commits#about-vigilant-mode).

### **Personal Access Tokens**

Μπορείτε να δημιουργήσετε προσωπικό διακριτικό πρόσβασης για να **δώσετε σε μια εφαρμογή πρόσβαση στον λογαριασμό σας**. Κατά τη δημιουργία ενός προσωπικού διακριτικού πρόσβασης, ο **χρήστης** πρέπει να **καθορίσει** τα **δικαιώματα** που θα έχει το **διακριτικό**. [https://github.com/settings/tokens](https://github.com/settings/tokens)

### Oauth Applications

Οι εφαρμογές Oauth μπορεί να σας ζητήσουν δικαιώματα **για να αποκτήσουν πρόσβαση σε μέρος των πληροφοριών σας στο github ή να σας προσποιηθούν** για να εκτελέσουν ορισμένες ενέργειες. Ένα κοινό παράδειγμα αυτής της λειτουργικότητας είναι το **κουμπί σύνδεσης με το github** που μπορεί να βρείτε σε ορισμένες πλατφόρμες.

* Μπορείτε να **δημιουργήσετε** τις δικές σας **εφαρμογές Oauth** στο [https://github.com/settings/developers](https://github.com/settings/developers)
* Μπορείτε να δείτε όλες τις **εφαρμογές Oauth που έχουν πρόσβαση στον λογαριασμό σας** στο [https://github.com/settings/applications](https://github.com/settings/applications)
* Μπορείτε να δείτε τις **σκοπούς που μπορούν να ζητήσουν οι εφαρμογές Oauth** στο [https://docs.github.com/en/developers/apps/building-oauth-apps/scopes-for-oauth-apps](https://docs.github.com/en/developers/apps/building-oauth-apps/scopes-for-oauth-apps)
* Μπορείτε να δείτε την πρόσβαση τρίτων εφαρμογών σε μια **οργάνωση** στο _https://github.com/organizations/\<org\_name>/settings/oauth\_application\_policy_

Ορισμένες **συστάσεις ασφαλείας**:

* Μια **Εφαρμογή OAuth** θα πρέπει πάντα να **ενεργεί ως ο αυθεντικοποιημένος χρήστης GitHub σε όλο το GitHub** (για παράδειγμα, όταν παρέχει ειδοποιήσεις χρηστών) και με πρόσβαση μόνο στους καθορισμένους σκοπούς.
* Μια Εφαρμογή OAuth μπορεί να χρησιμοποιηθεί ως πάροχος ταυτότητας ενεργοποιώντας μια "Σύνδεση με το GitHub" για τον αυθεντικοποιημένο χρήστη.
* **Μην** δημιουργείτε μια **Εφαρμογή OAuth** αν θέλετε η εφαρμογή σας να ενεργεί σε **ένα μόνο αποθετήριο**. Με το `repo` OAuth scope, οι Εφαρμογές OAuth μπορούν να **ενεργούν σε _όλα_** τα αποθετήρια του αυθεντικοποιημένου χρήστη.
* **Μην** δημιουργείτε μια Εφαρμογή OAuth για να ενεργεί ως εφαρμογή για την **ομάδα ή την εταιρεία σας**. Οι Εφαρμογές OAuth αυθεντικοποιούνται ως **ένας μόνο χρήστης**, οπότε αν ένα άτομο δημιουργήσει μια Εφαρμογή OAuth για να τη χρησιμοποιήσει η εταιρεία και στη συνέχεια φύγει από την εταιρεία, κανείς άλλος δεν θα έχει πρόσβαση σε αυτήν.
* **Περισσότερα** εδώ [here](https://docs.github.com/en/developers/apps/getting-started-with-apps/about-apps#about-oauth-apps).

### Github Applications

Οι εφαρμογές Github μπορούν να ζητήσουν δικαιώματα για να **αποκτήσουν πρόσβαση στις πληροφορίες σας στο github ή να σας προσποιηθούν** για να εκτελέσουν συγκεκριμένες ενέργειες σε συγκεκριμένους πόρους. Στις Εφαρμογές Github πρέπει να καθορίσετε τους αποθετηρίους στους οποίους θα έχει πρόσβαση η εφαρμογή.

* Για να εγκαταστήσετε μια Εφαρμογή GitHub, πρέπει να είστε **ιδιοκτήτης οργάνωσης ή να έχετε δικαιώματα διαχειριστή** σε ένα αποθετήριο.
* Η Εφαρμογή GitHub θα πρέπει να **συνδεθεί με έναν προσωπικό λογαριασμό ή μια οργάνωση**.
* Μπορείτε να δημιουργήσετε τη δική σας εφαρμογή Github στο [https://github.com/settings/apps](https://github.com/settings/apps)
* Μπορείτε να δείτε όλες τις **εφαρμογές Github που έχουν πρόσβαση στον λογαριασμό σας** στο [https://github.com/settings/apps/authorizations](https://github.com/settings/apps/authorizations)
* Αυτές είναι οι **API Endpoints για τις Εφαρμογές Github** [https://docs.github.com/en/rest/overview/endpoints-available-for-github-app](https://docs.github.com/en/rest/overview/endpoints-available-for-github-apps). Ανάλογα με τα δικαιώματα της Εφαρμογής, θα μπορεί να έχει πρόσβαση σε ορισμένες από αυτές
* Μπορείτε να δείτε τις εγκατεστημένες εφαρμογές σε μια **οργάνωση** στο _https://github.com/organizations/\<org\_name>/settings/installations_

Ορισμένες συστάσεις ασφαλείας:

* Μια Εφαρμογή GitHub θα πρέπει να **λαμβάνει ενέργειες ανεξάρτητα από έναν χρήστη** (εκτός αν η εφαρμογή χρησιμοποιεί ένα [token χρήστη προς διακομιστή](https://docs.github.com/en/apps/building-github-apps/identifying-and-authorizing-users-for-github-apps#user-to-server-requests)). Για να διατηρήσετε τα tokens πρόσβασης χρήστη προς διακομιστή πιο ασφαλή, μπορείτε να χρησιμοποιήσετε tokens πρόσβασης που θα λήγουν μετά από 8 ώρες και ένα refresh token που μπορεί να ανταλλαγεί για ένα νέο token πρόσβασης. Για περισσότερες πληροφορίες, δείτε "[Ανανέωση tokens πρόσβασης χρήστη προς διακομιστή](https://docs.github.com/en/apps/building-github-apps/refreshing-user-to-server-access-tokens)."
* Βεβαιωθείτε ότι η Εφαρμογή GitHub ενσωματώνεται με **συγκεκριμένους αποθετηρίους**.
* Η Εφαρμογή GitHub θα πρέπει να **συνδεθεί με έναν προσωπικό λογαριασμό ή μια οργάνωση**.
* Μην περιμένετε από την Εφαρμογή GitHub να γνωρίζει και να κάνει τα πάντα που μπορεί να κάνει ένας χρήστης.
* **Μην χρησιμοποιείτε μια Εφαρμογή GitHub αν χρειάζεστε απλώς μια υπηρεσία "Σύνδεση με το GitHub"**. Αλλά μια Εφαρμογή GitHub μπορεί να χρησιμοποιήσει μια [ροή ταυτοποίησης χρήστη](https://docs.github.com/en/apps/building-github-apps/identifying-and-authorizing-users-for-github-apps) για να συνδέσει τους χρήστες _και_ να κάνει άλλες ενέργειες.
* Μην δημιουργείτε μια Εφαρμογή GitHub αν _μόνο_ θέλετε να ενεργείτε ως χρήστης GitHub και να κάνετε τα πάντα που μπορεί να κάνει αυτός ο χρήστης.
* Αν χρησιμοποιείτε την εφαρμογή σας με τις GitHub Actions και θέλετε να τροποποιήσετε τα αρχεία ροής εργασίας, πρέπει να αυθεντικοποιηθείτε εκ μέρους του χρήστη με ένα token OAuth που περιλαμβάνει το `workflow` scope. Ο χρήστης πρέπει να έχει δικαιώματα διαχειριστή ή εγγραφής στο αποθετήριο που περιέχει το αρχείο ροής εργασίας. Για περισσότερες πληροφορίες, δείτε "[Κατανόηση των σκοπών για τις εφαρμογές OAuth](https://docs.github.com/en/apps/building-oauth-apps/understanding-scopes-for-oauth-apps/#available-scopes)."
* **Περισσότερα** εδώ [here](https://docs.github.com/en/developers/apps/getting-started-with-apps/about-apps#about-github-apps).

### Github Actions

Αυτό **δεν είναι τρόπος αυθεντικοποίησης στο github**, αλλά μια **κακόβουλη** ενέργεια Github θα μπορούσε να αποκτήσει **μη εξουσιοδοτημένη πρόσβαση στο github** και **ανάλογα** με τα **δικαιώματα** που δίνονται στην ενέργεια, θα μπορούσαν να γίνουν αρκετές **διαφορετικές επιθέσεις**. Δείτε παρακάτω για περισσότερες πληροφορίες.

## Git Actions

Οι ενέργειες Git επιτρέπουν την αυτοματοποίηση της **εκτέλεσης κώδικα όταν συμβαίνει ένα γεγονός**. Συνήθως, ο εκτελούμενος κώδικας είναι **κάπως σχετικός με τον κώδικα του αποθετηρίου** (ίσως να δημιουργήσει ένα κοντέινερ docker ή να ελέγξει ότι το PR δεν περιέχει μυστικά).

### Configuration

Στο _https://github.com/organizations/\<org\_name>/settings/actions_ είναι δυνατόν να ελέγξετε τη **ρύθμιση των ενεργειών github** για την οργάνωση.

Είναι δυνατόν να απαγορευτεί η χρήση των ενεργειών github εντελώς, **να επιτραπούν όλες οι ενέργειες github**, ή να επιτραπούν μόνο ορισμένες ενέργειες.

Είναι επίσης δυνατόν να ρυθμίσετε **ποιος χρειάζεται έγκριση για να εκτελέσει μια Ενέργεια Github** και τα **δικαιώματα του GITHUB\_TOKEN** μιας Ενέργειας Github όταν εκτελείται.

### Git Secrets

Οι Ενέργειες Github συνήθως χρειάζονται κάποιο είδος μυστικών για να αλληλεπιδρούν με το github ή τρίτες εφαρμογές. Για να **αποφευχθεί η τοποθέτησή τους σε καθαρό κείμενο** στο αποθετήριο, το github επιτρέπει την τοποθέτησή τους ως **Μυστικά**.

Αυτά τα μυστικά μπορούν να ρυθμιστούν **για το αποθετήριο ή για όλη την οργάνωση**. Στη συνέχεια, προκειμένου η **Ενέργεια να μπορεί να έχει πρόσβαση στο μυστικό**, πρέπει να το δηλώσετε ως εξής:
```yaml
steps:
- name: Hello world action
with: # Set the secret as an input
super_secret: ${{ secrets.SuperSecret }}
env: # Or as an environment variable
super_secret: ${{ secrets.SuperSecret }}
```
#### Παράδειγμα χρησιμοποιώντας Bash <a href="#example-using-bash" id="example-using-bash"></a>
```yaml
steps:
- shell: bash
env:
SUPER_SECRET: ${{ secrets.SuperSecret }}
run: |
example-command "$SUPER_SECRET"
```
{% hint style="warning" %}
Τα μυστικά **μπορούν να προσπελαστούν μόνο από τις Github Actions** που τα έχουν δηλωμένα.

Μόλις ρυθμιστούν στο repo ή στις οργανώσεις, **οι χρήστες του github δεν θα μπορούν να τα προσπελάσουν ξανά**, θα μπορούν μόνο να **τα αλλάξουν**.
{% endhint %}

Επομένως, **ο μόνος τρόπος να κλέψετε τα μυστικά του github είναι να μπορείτε να έχετε πρόσβαση στη μηχανή που εκτελεί την Github Action** (σε αυτή την περίπτωση θα μπορείτε να έχετε πρόσβαση μόνο στα μυστικά που έχουν δηλωθεί για την Action).

### Git Environments

Το Github επιτρέπει τη δημιουργία **περιβαλλόντων** όπου μπορείτε να αποθηκεύσετε **μυστικά**. Στη συνέχεια, μπορείτε να δώσετε στην github action πρόσβαση στα μυστικά μέσα στο περιβάλλον με κάτι σαν:
```yaml
jobs:
deployment:
runs-on: ubuntu-latest
environment: env_name
```
Μπορείτε να ρυθμίσετε ένα περιβάλλον να είναι **προσβάσιμο** από **όλα τα branches** (προεπιλογή), **μόνο από προστατευμένα** branches ή να **καθορίσετε** ποια branches μπορούν να έχουν πρόσβαση σε αυτό.\
Μπορεί επίσης να ορίσει έναν **αριθμό απαιτούμενων αναθεωρήσεων** πριν από την **εκτέλεση** μιας **ενέργειας** χρησιμοποιώντας ένα **περιβάλλον** ή να **περιμένει** κάποιο **χρόνο** πριν επιτρέψει τις αναπτύξεις να προχωρήσουν.

### Git Action Runner

Μια Github Action μπορεί να **εκτελείται μέσα στο περιβάλλον github** ή μπορεί να εκτελείται σε μια **υποδομή τρίτου μέρους** που έχει ρυθμιστεί από τον χρήστη.

Πολλές οργανώσεις θα επιτρέψουν την εκτέλεση Github Actions σε μια **υποδομή τρίτου μέρους** καθώς συνήθως είναι **φθηνότερη**.

Μπορείτε να **καταγράψετε τους αυτο-φιλοξενούμενους runners** μιας οργάνωσης στο _https://github.com/organizations/\<org\_name>/settings/actions/runners_

Ο τρόπος για να βρείτε ποιες **Github Actions εκτελούνται σε μη υποδομή github** είναι να αναζητήσετε το `runs-on: self-hosted` στη διαμόρφωση yaml της Github Action.

Δεν είναι **δυνατό να εκτελέσετε μια Github Action μιας οργάνωσης μέσα σε ένα αυτο-φιλοξενούμενο box** μιας διαφορετικής οργάνωσης επειδή **δημιουργείται ένα μοναδικό token για τον Runner** κατά την ρύθμισή του για να γνωρίζει πού ανήκει ο runner.

Εάν ο προσαρμοσμένος **Github Runner είναι ρυθμισμένος σε μια μηχανή μέσα σε AWS ή GCP** για παράδειγμα, η Action **θα μπορούσε να έχει πρόσβαση στο endpoint μεταδεδομένων** και να **κλέψει το token του λογαριασμού υπηρεσίας** με τον οποίο λειτουργεί η μηχανή.

### Git Action Compromise

Εάν όλες οι ενέργειες (ή μια κακόβουλη ενέργεια) επιτρέπονται, ένας χρήστης θα μπορούσε να χρησιμοποιήσει μια **Github action** που είναι **κακόβουλη** και θα **συμβιβάσει** το **container** όπου εκτελείται.

{% hint style="danger" %}
Μια **κακόβουλη Github Action** που εκτελείται θα μπορούσε να **καταχραστεί** από τον επιτιθέμενο για να:

* **Κλέψει όλα τα μυστικά** στα οποία έχει πρόσβαση η Action
* **Μετακινηθεί οριζόντια** εάν η Action εκτελείται μέσα σε μια **υποδομή τρίτου μέρους** όπου το SA token που χρησιμοποιείται για να τρέξει η μηχανή μπορεί να προσπελαστεί (πιθανώς μέσω της υπηρεσίας μεταδεδομένων)
* **Καταχραστεί το token** που χρησιμοποιείται από το **workflow** για να **κλέψει τον κώδικα του repo** όπου εκτελείται η Action ή **ακόμα και να τον τροποποιήσει**.
{% endhint %}

## Branch Protections

Οι προστασίες branches έχουν σχεδιαστεί για να **μην δίνουν πλήρη έλεγχο ενός αποθετηρίου** στους χρήστες. Ο στόχος είναι να **θέσουν αρκετές μεθόδους προστασίας πριν μπορέσουν να γράψουν κώδικα μέσα σε κάποιο branch**.

Οι **προστασίες branches ενός αποθετηρίου** μπορούν να βρεθούν στο _https://github.com/\<orgname>/\<reponame>/settings/branches_

{% hint style="info" %}
Δεν είναι **δυνατό να ορίσετε μια προστασία branch σε επίπεδο οργάνωσης**. Έτσι, όλες τους πρέπει να δηλωθούν σε κάθε repo.
{% endhint %}

Διαφορετικές προστασίες μπορούν να εφαρμοστούν σε ένα branch (όπως στο master):

* Μπορείτε να **απαιτήσετε μια PR πριν από τη συγχώνευση** (έτσι δεν μπορείτε να συγχωνεύσετε απευθείας κώδικα πάνω στο branch). Εάν αυτό επιλεγεί, διαφορετικές άλλες προστασίες μπορούν να ισχύουν:
* **Απαιτήστε έναν αριθμό εγκρίσεων**. Είναι πολύ συνηθισμένο να απαιτείται 1 ή 2 περισσότερα άτομα να εγκρίνουν την PR σας ώστε ένας μόνο χρήστης να μην μπορεί να συγχωνεύσει κώδικα απευθείας.
* **Ανακαλέστε τις εγκρίσεις όταν προστεθούν νέες δεσμεύσεις**. Διαφορετικά, ένας χρήστης μπορεί να εγκρίνει νόμιμο κώδικα και στη συνέχεια ο χρήστης θα μπορούσε να προσθέσει κακόβουλο κώδικα και να τον συγχωνεύσει.
* **Απαιτήστε αναθεωρήσεις από τους Code Owners**. Τουλάχιστον 1 κάτοχος κώδικα του repo πρέπει να εγκρίνει την PR (έτσι οι "τυχαίοι" χρήστες δεν μπορούν να την εγκρίνουν)
* **Περιορίστε ποιοι μπορούν να ανακαλέσουν τις αναθεωρήσεις αιτημάτων έλξης.** Μπορείτε να καθορίσετε άτομα ή ομάδες που επιτρέπεται να ανακαλέσουν τις αναθεωρήσεις αιτημάτων έλξης.
* **Επιτρέψτε σε καθορισμένους ηθοποιούς να παρακάμψουν τις απαιτήσεις αιτημάτων έλξης**. Αυτοί οι χρήστες θα μπορούν να παρακάμψουν προηγούμενους περιορισμούς.
* **Απαιτήστε οι έλεγχοι κατάστασης να περάσουν πριν από τη συγχώνευση.** Ορισμένοι έλεγχοι πρέπει να περάσουν πριν μπορέσετε να συγχωνεύσετε τη δέσμευση (όπως μια github action που ελέγχει ότι δεν υπάρχει κανένα μυστικό σε καθαρό κείμενο).
* **Απαιτήστε την επίλυση συνομιλιών πριν από τη συγχώνευση**. Όλα τα σχόλια στον κώδικα πρέπει να έχουν επιλυθεί πριν μπορέσει να συγχωνευθεί η PR.
* **Απαιτήστε υπογεγραμμένες δεσμεύσεις**. Οι δεσμεύσεις πρέπει να είναι υπογεγραμμένες.
* **Απαιτήστε γραμμική ιστορία.** Αποτρέψτε τις συγχωνεύσεις δεσμεύσεων να αποστέλλονται σε αντίστοιχα branches.
* **Συμπεριλάβετε τους διαχειριστές**. Εάν αυτό δεν έχει ρυθμιστεί, οι διαχειριστές μπορούν να παρακάμψουν τους περιορισμούς.
* **Περιορίστε ποιοι μπορούν να στείλουν σε αντίστοιχα branches**. Περιορίστε ποιοι μπορούν να στείλουν μια PR.

{% hint style="info" %}
Όπως μπορείτε να δείτε, ακόμη και αν καταφέρατε να αποκτήσετε κάποια διαπιστευτήρια ενός χρήστη, **τα repos μπορεί να είναι προστατευμένα αποτρέποντάς σας να στείλετε κώδικα στο master** για παράδειγμα για να συμβιβάσετε την CI/CD pipeline.
{% endhint %}

## References

* [https://docs.github.com/en/organizations/managing-access-to-your-organizations-repositories/repository-roles-for-an-organization](https://docs.github.com/en/organizations/managing-access-to-your-organizations-repositories/repository-roles-for-an-organization)
* [https://docs.github.com/en/enterprise-server@3.3/admin/user-management/managing-users-in-your-enterprise/roles-in-an-enterprise](https://docs.github.com/en/enterprise-server@3.3/admin/user-management/managing-users-in-your-enterprise/roles-in-an-enterprise)[https://docs.github.com/en/enterprise-server](https://docs.github.com/en/enterprise-server@3.3/admin/user-management/managing-users-in-your-enterprise/roles-in-an-enterprise)
* [https://docs.github.com/en/get-started/learning-about-github/access-permissions-on-github](https://docs.github.com/en/get-started/learning-about-github/access-permissions-on-github)
* [https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-github-user-account/managing-user-account-settings/permission-levels-for-user-owned-project-boards](https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-github-user-account/managing-user-account-settings/permission-levels-for-user-owned-project-boards)
* [https://docs.github.com/en/actions/security-guides/encrypted-secrets](https://docs.github.com/en/actions/security-guides/encrypted-secrets)

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστήριξη HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε κόλπα hacking υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
