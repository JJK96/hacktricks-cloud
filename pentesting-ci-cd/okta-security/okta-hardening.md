# Okta Hardening

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) of the [**telegram group**](https://t.me/peass) of **follow** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Directory

### People

Vanuit 'n aanvaller se perspektief is dit baie interessant aangesien jy **al die geregistreerde gebruikers** sal kan sien, hul **e-pos** adresse, die **groepe** waaraan hulle behoort, **profiele** en selfs **toestelle** (selfone saam met hul OSs).

Vir 'n whitebox-oorsig, kyk dat daar nie verskeie "**Pending user action**" en "**Password reset**" is nie.

### Groups

Hier vind jy al die geskepte groepe in Okta. Dit is interessant om die verskillende groepe (stel van **toestemmings**) wat aan **gebruikers** toegeken kan word, te verstaan.\
Dit is moontlik om die **mense wat in groepe ingesluit is** en **toepassings wat aan elke groep toegewys is** te sien.

Enige groep met die naam **admin** is interessant, veral die groep **Global Administrators,** kyk na die lede om te leer wie die mees bevoorregte lede is.

Vanuit 'n whitebox-oorsig, daar **moet nie meer as 5 globale admins wees nie** (beter as daar net 2 of 3 is).

### Devices

Vind hier 'n **lys van al die toestelle** van al die gebruikers. Jy kan ook sien of dit **aktief bestuur** word of nie.

### Profile Editor

Hier is dit moontlik om te sien hoe sleutel-inligting soos voorname, vanne, e-posse, gebruikersname... gedeel word tussen Okta en ander toepassings. Dit is interessant omdat as 'n gebruiker kan **'n veld in Okta wysig** (soos sy naam of e-pos) wat dan deur 'n **eksterne toepassing** gebruik word om die gebruiker te **identifiseer**, 'n insider kan probeer om **ander rekeninge oor te neem**.

Boonop, in die profiel **`User (default)`** van Okta kan jy sien **watter velde** elke **gebruiker** het en watter velde **skryfbaar** is deur gebruikers. As jy nie die admin-paneel kan sien nie, gaan net na **werk jou profiel** inligting op en jy sal sien watter velde jy kan opdateer (let daarop dat om 'n e-posadres op te dateer jy dit sal moet verifieer).

### Directory Integrations

Directories laat jou toe om mense van bestaande bronne in te voer. Ek dink hier sal jy die gebruikers sien wat van ander directories ingevoer is.

Ek het dit nie gesien nie, maar ek dink dit is interessant om uit te vind **ander directories wat Okta gebruik om gebruikers in te voer** sodat as jy daardie directory **kompromitteer** jy dalk sekere attribuutwaardes in die gebruikers wat in Okta geskep is kan stel en **miskien die Okta-omgewing kompromitteer**.

### Profile Sources

'n Profielbron is 'n **toepassing wat as 'n bron van waarheid optree** vir gebruikersprofielkenmerke. 'n Gebruiker kan slegs deur 'n enkele toepassing of directory op 'n slag verkry word.

Ek het dit nie gesien nie, so enige inligting oor sekuriteit en hacking rakende hierdie opsie word waardeer.

## Customizations

### Brands

Kyk in die **Domains**-oortjie van hierdie afdeling na die e-posadresse wat gebruik word om e-posse te stuur en die pasgemaakte domein binne Okta van die maatskappy (wat jy waarskynlik reeds ken).

Boonop, in die **Setting**-oortjie, as jy admin is, kan jy "**Use a custom sign-out page**" en 'n pasgemaakte URL stel.

### SMS

Niks interessant hier nie.

### End-User Dashboard

Jy kan hier toepassings vind wat gekonfigureer is, maar ons sal die besonderhede daarvan later in 'n ander afdeling sien.

### Other

Interessante instelling, maar niks super interessant vanuit 'n sekuriteitsoogpunt nie.

## Applications

### Applications

Hier kan jy al die **gekonfigureerde toepassings** en hul besonderhede vind: Wie het toegang tot hulle, hoe dit gekonfigureer is (SAML, OPenID), URL om aan te meld, die mappings tussen Okta en die toepassing...

In die **`Sign On`**-oortjie is daar ook 'n veld genaamd **`Password reveal`** wat 'n gebruiker sal toelaat om **sy wagwoord te onthul** wanneer hy die toepassinginstellings nagaan. Om die instellings van 'n toepassing vanaf die Gebruikerspaneel na te gaan, klik op die 3 kolletjies:

<figure><img src="../../.gitbook/assets/image (283).png" alt=""><figcaption></figcaption></figure>

En jy kan 'n paar meer besonderhede oor die toepassing sien (soos die wagwoord onthul funksie, as dit geaktiveer is):

<figure><img src="../../.gitbook/assets/image (220).png" alt=""><figcaption></figcaption></figure>

## Identity Governance

### Access Certifications

Gebruik Access Certifications om ouditveldtogte te skep om jou gebruikers se toegang tot hulpbronne periodiek te hersien en toegang outomaties goed te keur of te herroep wanneer nodig.

Ek het dit nie gebruik gesien nie, maar ek dink dat vanuit 'n verdedigingspunt van siening dit 'n goeie funksie is.

## Security

### General

* **Security notification emails**: Alles moet geaktiveer wees.
* **CAPTCHA integration**: Dit word aanbeveel om ten minste die onsigbare reCaptcha te stel
* **Organization Security**: Alles kan geaktiveer word en aktiverings-e-posse moet nie lank duur nie (7 dae is ok)
* **User enumeration prevention**: Beide moet geaktiveer wees
* Let daarop dat User Enumeration Prevention nie in werking tree as enige van die volgende toestande toegelaat word nie (Sien [User management](https://help.okta.com/oie/en-us/Content/Topics/users-groups-profiles/usgp-main.htm) vir meer inligting):
* Self-Service Registration
* JIT flows with email authentication
* **Okta ThreatInsight settings**: Log en dwing sekuriteit af gebaseer op bedreigingsvlak

### HealthInsight

Hier is dit moontlik om korrek en **gevaarlik** gekonfigureerde **instellings** te vind.

### Authenticators

Hier kan jy al die verifikasie metodes vind wat 'n gebruiker kan gebruik: Wagwoord, telefoon, e-pos, kode, WebAuthn... Deur op die Wagwoord-verifikator te klik, kan jy die **wagwoordbeleid** sien. Kyk dat dit sterk is.

In die **Enrollment**-oortjie kan jy sien hoe diegene wat vereis of opsioneel is:

<figure><img src="../../.gitbook/assets/image (143).png" alt=""><figcaption></figcaption></figure>

Dit word aanbeveel om Telefoon te deaktiveer. Die sterkste is waarskynlik 'n kombinasie van wagwoord, e-pos en WebAuthn.

### Authentication policies

Elke toepassing het 'n verifikasiebeleid. Die verifikasiebeleid verifieer dat gebruikers wat probeer om by die toepassing aan te meld aan spesifieke voorwaardes voldoen, en dit dwing faktorvereistes af gebaseer op daardie voorwaardes.

Hier kan jy die **vereistes om toegang tot elke toepassing te kry** vind. Dit word aanbeveel om ten minste wagwoord en 'n ander metode vir elke toepassing te vereis. Maar as 'n aanvaller jy iets swakker vind, kan jy dalk dit aanval.

### Global Session Policy

Hier kan jy die sessiebeleide vind wat aan verskillende groepe toegewys is. Byvoorbeeld:

<figure><img src="../../.gitbook/assets/image (245).png" alt=""><figcaption></figcaption></figure>

Dit word aanbeveel om MFA te vereis, die sessie-leeftyd tot 'n paar uur te beperk, nie sessiekoekies oor blaaieruitbreidings te behou nie en die ligging en Identiteitsverskaffer te beperk (as dit moontlik is). Byvoorbeeld, as elke gebruiker van 'n land moet aanmeld, kan jy slegs hierdie ligging toelaat.

### Identity Providers

Identity Providers (IdPs) is dienste wat **gebruikersrekeninge bestuur**. Deur IdPs in Okta by te voeg, kan jou eindgebruikers **self registreer** met jou pasgemaakte toepassings deur eers met 'n sosiale rekening of 'n slimkaart te verifieer.

Op die Identity Providers-bladsy kan jy sosiale aanmeldings (IdPs) byvoeg en Okta as 'n diensverskaffer (SP) konfigureer deur inkomende SAML by te voeg. Nadat jy IdPs bygevoeg het, kan jy roeteringsre√´ls opstel om gebruikers na 'n IdP te lei gebaseer op konteks, soos die gebruiker se ligging, toestel of e-posdomein.

**As enige identiteitsverskaffer gekonfigureer is** vanuit 'n aanvaller en verdediger se perspektief, kyk daardie konfigurasie en **as die bron regtig betroubaar is** aangesien 'n aanvaller wat dit kompromitteer ook toegang tot die Okta-omgewing kan kry.

### Delegated Authentication

Gedelegeerde verifikasie laat gebruikers toe om by Okta aan te meld deur geloofsbriewe vir hul organisasie se **Active Directory (AD) of LDAP**-bediener in te voer.

Kyk weer hierna, aangesien 'n aanvaller wat 'n organisasie se AD kompromitteer, dalk na Okta kan draai danksy hierdie instelling.

### Network

'n Netwerk-sone is 'n konfigureerbare grens wat jy kan gebruik om **toegang tot rekenaars en toestelle** in jou organisasie te **verleen of te beperk** gebaseer op die **IP-adres** wat toegang versoek. Jy kan 'n netwerk-sone definieer deur een of meer individuele IP-adresse, reekse van IP-adresse of geografiese liggings te spesifiseer.

Nadat jy een of meer netwerk-sones gedefinieer het, kan jy **hulle gebruik in Global Session Policies**, **verifikasiebeleide**, VPN-kennisgewings en **roeteringsre√´ls**.

Vanuit 'n aanvaller se perspektief is dit interessant om te weet watter IPs toegelaat word (en kyk of enige **IPs meer bevoorreg is** as ander). Vanuit 'n aanvaller se perspektief, as die gebruikers van 'n spesifieke IP-adres of streek moet toegang kry, kyk dat hierdie funksie behoorlik gebruik word.

### Device Integrations

* **Endpoint Management**: Eindpuntbestuur is 'n voorwaarde wat in 'n verifikasiebeleid toegepas kan word om te verseker dat bestuurde toestelle toegang tot 'n toepassing het.
* Ek het dit nog nie gebruik gesien nie. TODO
* **Notification services**: Ek het dit nog nie gebruik gesien nie. TODO

### API

Jy kan Okta API-tokens op hierdie bladsy skep, en diegene wat **geskep is**, hul **voorregte**, **verval** tyd en **Origin URLs** sien. Let daarop dat 'n API-tokens gegenereer word met die toestemmings van die gebruiker wat die token geskep het en slegs geldig is as die **gebruiker** wat hulle geskep het **aktief** is.

Die **Trusted Origins** verleen toegang tot webwerwe wat jy beheer en vertrou om toegang tot jou Okta-org deur die Okta API te kry.

Daar moet nie baie API-tokens wees nie, aangesien as daar is, 'n aanvaller kan probeer om toegang tot hulle te kry en hulle te gebruik.

## Workflow

### Automations

Automations laat jou toe om outomatiese aksies te skep wat uitgevoer word gebaseer op 'n stel sneller toestande wat tydens die lewensiklus van eindgebruikers voorkom.

Byvoorbeeld, 'n voorwaarde kan wees "User inactivity in Okta" of "User password expiration in Okta" en die aksie kan wees "Send email to the user" of "Change user lifecycle state in Okta".

## Reports

### Reports

Laai logs af. Hulle word **gestuur** na die **e-posadres** van die huidige rekening.

### System Log

Hier kan jy die **logs van die aksies wat deur gebruikers uitgevoer is** vind met baie besonderhede soos aanmelding in Okta of in toepassings deur Okta.

### Import Monitoring

Dit kan **logs van die ander platforms** wat met Okta toegang verkry word, invoer.

### Rate limits

Kyk na die API-tempo perke wat bereik is.

## Settings

### Account

Hier kan jy **generiese inligting** oor die Okta-omgewing vind, soos die maatskappy se naam, adres, **e-pos faktuur kontak**, **e-pos tegniese kontak** en ook wie Okta-opdaterings moet ontvang en watter soort Okta-opdaterings.

### Downloads

Hier kan jy Okta-agente aflaai om Okta met ander tegnologie√´ te sinkroniseer.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) of the [**telegram group**](https://t.me/peass) of **follow** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
