# Okta Hardening

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Dizin

### People

Bir saldırganın bakış açısından, **kayıtlı tüm kullanıcıları**, **e-posta** adreslerini, parçası oldukları **grupları**, **profilleri** ve hatta **cihazları** (işletim sistemleriyle birlikte mobil cihazlar) görebileceğiniz için bu çok ilginçtir.

Bir beyaz kutu incelemesi için, birkaç "**Kullanıcı eylemi bekleniyor**" ve "**Şifre sıfırlama**" olmadığını kontrol edin.

### Groups

Bu, Okta'da oluşturulan tüm grupları bulduğunuz yerdir. **Kullanıcılara** verilebilecek farklı grupları (**izin setleri**) anlamak ilginçtir.\
Gruplar içindeki **kişileri** ve her gruba **atanan uygulamaları** görmek mümkündür.

Tabii ki, **admin** adını taşıyan herhangi bir grup ilginçtir, özellikle **Global Yöneticiler** grubu, en ayrıcalıklı üyelerin kimler olduğunu öğrenmek için üyeleri kontrol edin.

Bir beyaz kutu incelemesinde, **5'ten fazla global yönetici olmamalıdır** (2 veya 3 olması daha iyidir).

### Devices

Burada tüm kullanıcıların **tüm cihazlarının bir listesini** bulun. Ayrıca **aktif olarak yönetilip yönetilmediğini** de görebilirsiniz.

### Profile Editor

Burada, adlar, soyadlar, e-postalar, kullanıcı adları gibi anahtar bilgilerin Okta ve diğer uygulamalar arasında nasıl paylaşıldığını gözlemlemek mümkündür. Bu ilginçtir çünkü bir kullanıcı **Okta'da bir alanı** (ad veya e-posta gibi) **değiştirebilirse** ve bu alan daha sonra bir **dış uygulama** tarafından kullanıcıyı **tanımlamak** için kullanılırsa, bir iç kişi **diğer hesapları ele geçirmeye** çalışabilir.

Ayrıca, Okta'daki **`Kullanıcı (varsayılan)`** profilinde her **kullanıcının** hangi alanlara sahip olduğunu ve hangilerinin **kullanıcılar tarafından yazılabilir** olduğunu görebilirsiniz. Yönetici panelini göremiyorsanız, sadece **profil bilgilerinizi güncelleyin** ve hangi alanları güncelleyebileceğinizi göreceksiniz (bir e-posta adresini güncellemek için doğrulamanız gerektiğini unutmayın).

### Directory Integrations

Dizinler, mevcut kaynaklardan insanları içe aktarmanıza olanak tanır. Burada diğer dizinlerden içe aktarılan kullanıcıları göreceğinizi tahmin ediyorum.

Görmedim, ama Okta'nın kullanıcıları içe aktarmak için kullandığı **diğer dizinleri bulmak** ilginç olabilir, böylece o dizini **ele geçirirseniz** Okta'da oluşturulan kullanıcıların bazı öznitelik değerlerini ayarlayabilir ve **belki Okta ortamını ele geçirebilirsiniz**.

### Profile Sources

Bir profil kaynağı, kullanıcı profil öznitelikleri için **doğruluk kaynağı olarak hareket eden bir uygulamadır**. Bir kullanıcı aynı anda yalnızca tek bir uygulama veya dizin tarafından kaynaklanabilir.

Görmedim, bu seçenekle ilgili güvenlik ve hacking hakkında herhangi bir bilgi takdir edilir.

## Customizations

### Brands

Bu bölümün **Alanlar** sekmesinde e-posta göndermek için kullanılan e-posta adreslerini ve şirketin Okta içindeki özel alan adını (muhtemelen zaten bildiğiniz) kontrol edin.

Ayrıca, **Ayarlar** sekmesinde, yöneticiyseniz, "**Özel bir oturum kapatma sayfası kullanın**" ve özel bir URL ayarlayın.

### SMS

Burada ilginç bir şey yok.

### End-User Dashboard

Burada yapılandırılmış uygulamaları bulabilirsiniz, ancak bunların ayrıntılarını daha sonra farklı bir bölümde göreceğiz.

### Other

İlginç ayar, ancak güvenlik açısından süper ilginç bir şey yok.

## Applications

### Applications

Burada tüm **yapılandırılmış uygulamaları** ve ayrıntılarını bulabilirsiniz: Kimlerin erişimi var, nasıl yapılandırılmış (SAML, OpenID), giriş URL'si, Okta ve uygulama arasındaki eşlemeler...

**`Sign On`** sekmesinde, bir kullanıcının **şifresini ortaya çıkarmasına** izin verecek **`Password reveal`** adlı bir alan da vardır. Kullanıcı Panelinden bir uygulamanın ayarlarını kontrol etmek için 3 noktaya tıklayın:

<figure><img src="../../.gitbook/assets/image (283).png" alt=""><figcaption></figcaption></figure>

Ve uygulama hakkında bazı ayrıntıları görebilirsiniz (şifre gösterme özelliği gibi, etkinse):

<figure><img src="../../.gitbook/assets/image (220).png" alt=""><figcaption></figcaption></figure>

## Identity Governance

### Access Certifications

Erişim Sertifikalarını kullanarak kullanıcılarınızın kaynaklara erişimini periyodik olarak gözden geçirmek ve gerektiğinde erişimi otomatik olarak onaylamak veya iptal etmek için denetim kampanyaları oluşturun.

Kullanıldığını görmedim, ancak savunma açısından güzel bir özellik olduğunu tahmin ediyorum.

## Security

### General

* **Güvenlik bildirim e-postaları**: Hepsi etkinleştirilmelidir.
* **CAPTCHA entegrasyonu**: En azından görünmez reCaptcha ayarlamanız önerilir.
* **Organizasyon Güvenliği**: Her şey etkinleştirilebilir ve etkinleştirme e-postaları uzun sürmemelidir (7 gün yeterlidir).
* **Kullanıcı numaralandırma önleme**: Her ikisi de etkinleştirilmelidir.
* Kullanıcı Numaralandırma Önlemenin, aşağıdaki koşullardan herhangi biri izin verilirse etkili olmadığını unutmayın (daha fazla bilgi için [Kullanıcı yönetimi](https://help.okta.com/oie/en-us/Content/Topics/users-groups-profiles/usgp-main.htm) bölümüne bakın):
* Self-Service Registration
* JIT akışları e-posta kimlik doğrulaması ile
* **Okta ThreatInsight ayarları**: Tehdit seviyesine göre güvenliği kaydedin ve uygulayın

### HealthInsight

Burada doğru ve **tehlikeli** yapılandırılmış **ayarları** bulmak mümkündür.

### Authenticators

Burada bir kullanıcının kullanabileceği tüm kimlik doğrulama yöntemlerini bulabilirsiniz: Şifre, telefon, e-posta, kod, WebAuthn... Şifre kimlik doğrulayıcısına tıklayarak **şifre politikasını** görebilirsiniz. Güçlü olduğundan emin olun.

**Enrollment** sekmesinde gerekli veya isteğe bağlı olanları görebilirsiniz:

<figure><img src="../../.gitbook/assets/image (143).png" alt=""><figcaption></figcaption></figure>

Telefonu devre dışı bırakmak önerilir. En güçlü olanlar muhtemelen şifre, e-posta ve WebAuthn kombinasyonudur.

### Authentication policies

Her uygulamanın bir kimlik doğrulama politikası vardır. Kimlik doğrulama politikası, uygulamaya giriş yapmaya çalışan kullanıcıların belirli koşulları karşıladığını doğrular ve bu koşullara dayalı olarak faktör gereksinimlerini uygular.

Burada her uygulamaya erişim için **gereksinimleri** bulabilirsiniz. Her uygulama için en azından şifre ve başka bir yöntem istemeniz önerilir. Ancak bir saldırgan olarak daha zayıf bir şey bulursanız, ona saldırabilirsiniz.

### Global Session Policy

Burada farklı gruplara atanan oturum politikalarını bulabilirsiniz. Örneğin:

<figure><img src="../../.gitbook/assets/image (245).png" alt=""><figcaption></figcaption></figure>

MFA istemek, oturum süresini birkaç saatle sınırlamak, oturum çerezlerini tarayıcı uzantıları arasında kalıcı hale getirmemek ve konumu ve Kimlik Sağlayıcısını sınırlamak (mümkünse) önerilir. Örneğin, her kullanıcı belirli bir ülkeden giriş yapmalıysa, yalnızca bu konuma izin verebilirsiniz.

### Identity Providers

Kimlik Sağlayıcıları (IdP'ler), **kullanıcı hesaplarını yöneten** hizmetlerdir. Okta'ya IdP'ler eklemek, son kullanıcılarınızın sosyal bir hesap veya akıllı kart ile önce kimlik doğrulaması yaparak özel uygulamalarınıza **kendi kendine kayıt olmalarını** sağlar.

Kimlik Sağlayıcıları sayfasında, sosyal girişleri (IdP'ler) ekleyebilir ve Okta'yı gelen SAML ekleyerek bir hizmet sağlayıcı (SP) olarak yapılandırabilirsiniz. IdP'leri ekledikten sonra, kullanıcıyı bağlamına göre bir IdP'ye yönlendirmek için yönlendirme kuralları ayarlayabilirsiniz, örneğin kullanıcının konumu, cihazı veya e-posta alanı.

**Herhangi bir kimlik sağlayıcı yapılandırılmışsa**, bir saldırgan ve savunmacı bakış açısından bu yapılandırmayı kontrol edin ve **kaynağın gerçekten güvenilir olup olmadığını** kontrol edin, çünkü bir saldırgan onu ele geçirirse Okta ortamına da erişebilir.

### Delegated Authentication

Delegated authentication, kullanıcıların kuruluşlarının **Active Directory (AD) veya LDAP** sunucusuna ait kimlik bilgilerini girerek Okta'ya giriş yapmalarını sağlar.

Yine, bunu yeniden kontrol edin, çünkü bir saldırgan bir kuruluşun AD'sini ele geçirirse, bu ayar sayesinde Okta'ya geçiş yapabilir.

### Network

Bir ağ bölgesi, kuruluşunuzdaki bilgisayarlara ve cihazlara **erişim izni vermek veya erişimi kısıtlamak** için **erişim talep eden IP adresine** dayalı olarak kullanabileceğiniz yapılandırılabilir bir sınırdır. Bir ağ bölgesini, bir veya daha fazla bireysel IP adresi, IP adresi aralıkları veya coğrafi konumlar belirleyerek tanımlayabilirsiniz.

Bir veya daha fazla ağ bölgesi tanımladıktan sonra, bunları **Global Session Policies**, **authentication policies**, VPN bildirimleri ve **routing rules** içinde kullanabilirsiniz.

Bir saldırganın bakış açısından, hangi IP'lerin izin verildiğini bilmek ilginçtir (ve **bazı IP'lerin diğerlerinden daha ayrıcalıklı olup olmadığını** kontrol edin). Bir saldırganın bakış açısından, kullanıcıların belirli bir IP adresinden veya bölgeden erişmesi gerekiyorsa, bu özelliğin düzgün kullanıldığını kontrol edin.

### Device Integrations

* **Endpoint Management**: Endpoint management, yönetilen cihazların bir uygulamaya erişimini sağlamak için bir kimlik doğrulama politikasında uygulanabilecek bir koşuldur.
* Henüz kullanılmadığını gördüm. TODO
* **Notification services**: Henüz kullanılmadığını gördüm. TODO

### API

Bu sayfada Okta API token'ları oluşturabilir ve **oluşturulan** token'ları, bunların **ayrıcalıklarını**, **son kullanma** sürelerini ve **Origin URL'lerini** görebilirsiniz. Bir API token'ı, token'ı oluşturan kullanıcının izinleriyle oluşturulur ve yalnızca token'ı oluşturan **kullanıcı** **aktif** olduğu sürece geçerlidir.

**Güvenilir Kökenler**, Okta API aracılığıyla Okta org'unuza erişmek için kontrol ettiğiniz ve güvendiğiniz web sitelerine erişim sağlar.

Çok fazla API token'ı olmamalıdır, çünkü varsa bir saldırgan bunlara erişmeye ve kullanmaya çalışabilir.

## Workflow

### Automations

Automations, son kullanıcıların yaşam döngüsü sırasında meydana gelen bir dizi tetikleme koşuluna dayalı olarak çalışan otomatik eylemler oluşturmanıza olanak tanır.

Örneğin, bir koşul "Okta'da kullanıcı etkin olmaması" veya "Okta'da kullanıcı şifresi süresinin dolması" olabilir ve eylem "Kullanıcıya e-posta gönder" veya "Okta'da kullanıcı yaşam döngüsü durumunu değiştir" olabilir.

## Reports

### Reports

Günlükleri indirin. Bunlar, mevcut hesabın **e-posta adresine** **gönderilir**.

### System Log

Burada, kullanıcılar tarafından gerçekleştirilen **eylemlerin günlüklerini** Okta'da veya Okta aracılığıyla uygulamalarda oturum açma gibi birçok ayrıntıyla bulabilirsiniz.

### Import Monitoring

Bu, Okta ile erişilen diğer platformlardan **günlükleri içe aktarabilir**.

### Rate limits

Ulaşılan API hız sınırlarını kontrol edin.

## Settings

### Account

Burada Okta ortamı hakkında **genel bilgileri** bulabilirsiniz, örneğin şirket adı, adres, **e-posta faturalama iletişim bilgisi**, **e-posta teknik iletişim bilgisi** ve ayrıca Okta güncellemelerini kimin alması gerektiği ve hangi tür Okta güncellemeleri.

### Downloads

Burada Okta ajanlarını diğer teknolojilerle senkronize etmek için indirebilirsiniz.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
