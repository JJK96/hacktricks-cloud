# TravisCI Security

{% hint style="success" %}
Aprenda e pratique AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprenda e pratique GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo no Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo no telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

## O que √© TravisCI

**Travis CI** √© um servi√ßo de **integra√ß√£o cont√≠nua** **hospedado** ou **on premises** usado para construir e testar projetos de software hospedados em v√°rias **diferentes plataformas git**.

{% content-ref url="basic-travisci-information.md" %}
[basic-travisci-information.md](basic-travisci-information.md)
{% endcontent-ref %}

## Ataques

### Triggers

Para lan√ßar um ataque, voc√™ primeiro precisa saber como acionar uma build. Por padr√£o, TravisCI ir√° **acionar uma build em pushes e pull requests**:

![](<../../.gitbook/assets/image (145).png>)

#### Cron Jobs

Se voc√™ tiver acesso √† aplica√ß√£o web, pode **configurar crons para executar a build**, isso pode ser √∫til para persist√™ncia ou para acionar uma build:

![](<../../.gitbook/assets/image (243).png>)

{% hint style="info" %}
Parece que n√£o √© poss√≠vel configurar crons dentro do `.travis.yml` de acordo com [isto](https://github.com/travis-ci/travis-ci/issues/9162).
{% endhint %}

### Third Party PR

TravisCI, por padr√£o, desabilita o compartilhamento de vari√°veis de ambiente com PRs vindos de terceiros, mas algu√©m pode habilitar isso e ent√£o voc√™ poderia criar PRs para o reposit√≥rio e exfiltrar os segredos:

![](<../../.gitbook/assets/image (208).png>)

### Dumping Secrets

Como explicado na p√°gina de [**informa√ß√µes b√°sicas**](basic-travisci-information.md), existem 2 tipos de segredos. **Segredos de Vari√°veis de Ambiente** (que s√£o listados na p√°gina web) e **segredos criptografados personalizados**, que s√£o armazenados dentro do arquivo `.travis.yml` como base64 (note que ambos, como s√£o armazenados criptografados, acabar√£o como vari√°veis de ambiente nas m√°quinas finais).

* Para **enumerar segredos** configurados como **Vari√°veis de Ambiente**, v√° para as **configura√ß√µes** do **projeto** e verifique a lista. No entanto, note que todas as vari√°veis de ambiente do projeto configuradas aqui aparecer√£o ao acionar uma build.
* Para enumerar os **segredos criptografados personalizados**, o melhor que voc√™ pode fazer √© **verificar o arquivo `.travis.yml`**.
* Para **enumerar arquivos criptografados**, voc√™ pode procurar por **arquivos `.enc`** no reposit√≥rio, por linhas semelhantes a `openssl aes-256-cbc -K $encrypted_355e94ba1091_key -iv $encrypted_355e94ba1091_iv -in super_secret.txt.enc -out super_secret.txt -d` no arquivo de configura√ß√£o, ou por **iv e chaves criptografadas** nas **Vari√°veis de Ambiente**, como:

![](<../../.gitbook/assets/image (81).png>)

### TODO:

* Exemplo de build com shell reverso rodando em Windows/Mac/Linux
* Exemplo de build vazando a vari√°vel de ambiente codificada em base64 nos logs

### TravisCI Enterprise

Se um atacante acabar em um ambiente que usa **TravisCI enterprise** (mais informa√ß√µes sobre o que √© isso na [**informa√ß√£o b√°sica**](basic-travisci-information.md#travisci-enterprise)), ele poder√° **acionar builds no Worker.** Isso significa que um atacante poder√° se mover lateralmente para esse servidor, a partir do qual ele poder√°:

* escapar para o host?
* comprometer o kubernetes?
* comprometer outras m√°quinas rodando na mesma rede?
* comprometer novas credenciais de cloud?

## Refer√™ncias

* [https://docs.travis-ci.com/user/encrypting-files/](https://docs.travis-ci.com/user/encrypting-files/)
* [https://docs.travis-ci.com/user/best-practices-security](https://docs.travis-ci.com/user/best-practices-security)

{% hint style="success" %}
Aprenda e pratique AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprenda e pratique GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo no Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo no telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
