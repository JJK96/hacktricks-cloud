# TravisCI Security

{% hint style="success" %}
Μάθετε και εξασκηθείτε στο AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε και εξασκηθείτε στο GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Γίνετε μέλος της** 💬 [**ομάδας Discord**](https://discord.gg/hRep4RUj7f) ή της [**ομάδας telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε hacking tricks υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια στο github.

</details>
{% endhint %}

## Τι είναι το TravisCI

Το **Travis CI** είναι μια **φιλοξενούμενη** ή **εγκατεστημένη τοπικά** υπηρεσία **συνεχούς ενσωμάτωσης** που χρησιμοποιείται για την κατασκευή και δοκιμή έργων λογισμικού που φιλοξενούνται σε διάφορες **διαφορετικές πλατφόρμες git**.

{% content-ref url="basic-travisci-information.md" %}
[basic-travisci-information.md](basic-travisci-information.md)
{% endcontent-ref %}

## Επιθέσεις

### Triggers

Για να ξεκινήσετε μια επίθεση, πρέπει πρώτα να ξέρετε πώς να ενεργοποιήσετε μια κατασκευή. Από προεπιλογή, το TravisCI θα **ενεργοποιήσει μια κατασκευή σε pushes και pull requests**:

![](<../../.gitbook/assets/image (145).png>)

#### Cron Jobs

Αν έχετε πρόσβαση στην εφαρμογή web, μπορείτε να **ρυθμίσετε crons για να εκτελέσετε την κατασκευή**, αυτό μπορεί να είναι χρήσιμο για διατήρηση ή για να ενεργοποιήσετε μια κατασκευή:

![](<../../.gitbook/assets/image (243).png>)

{% hint style="info" %}
Φαίνεται ότι δεν είναι δυνατό να ρυθμίσετε crons μέσα στο `.travis.yml` σύμφωνα με [αυτό](https://github.com/travis-ci/travis-ci/issues/9162).
{% endhint %}

### Third Party PR

Το TravisCI από προεπιλογή απενεργοποιεί την κοινή χρήση env variables με PRs που προέρχονται από τρίτους, αλλά κάποιος μπορεί να το ενεργοποιήσει και τότε θα μπορούσατε να δημιουργήσετε PRs στο αποθετήριο και να εξάγετε τα μυστικά:

![](<../../.gitbook/assets/image (208).png>)

### Dumping Secrets

Όπως εξηγείται στη σελίδα [**βασικές πληροφορίες**](basic-travisci-information.md), υπάρχουν 2 τύποι μυστικών. **Μυστικά μεταβλητών περιβάλλοντος** (που αναφέρονται στη σελίδα web) και **προσαρμοσμένα κρυπτογραφημένα μυστικά**, τα οποία αποθηκεύονται μέσα στο αρχείο `.travis.yml` ως base64 (σημειώστε ότι και τα δύο αποθηκεύονται κρυπτογραφημένα και θα καταλήξουν ως env variables στις τελικές μηχανές).

* Για να **απαριθμήσετε τα μυστικά** που έχουν ρυθμιστεί ως **μεταβλητές περιβάλλοντος**, πηγαίνετε στις **ρυθμίσεις** του **έργου** και ελέγξτε τη λίστα. Ωστόσο, σημειώστε ότι όλες οι μεταβλητές περιβάλλοντος του έργου που έχουν ρυθμιστεί εδώ θα εμφανιστούν όταν ενεργοποιηθεί μια κατασκευή.
* Για να απαριθμήσετε τα **προσαρμοσμένα κρυπτογραφημένα μυστικά**, το καλύτερο που μπορείτε να κάνετε είναι να **ελέγξετε το αρχείο `.travis.yml`**.
* Για να απαριθμήσετε τα **κρυπτογραφημένα αρχεία**, μπορείτε να ελέγξετε για **αρχεία `.enc`** στο αποθετήριο, για γραμμές παρόμοιες με `openssl aes-256-cbc -K $encrypted_355e94ba1091_key -iv $encrypted_355e94ba1091_iv -in super_secret.txt.enc -out super_secret.txt -d` στο αρχείο ρυθμίσεων, ή για **κρυπτογραφημένα iv και κλειδιά** στις **μεταβλητές περιβάλλοντος** όπως:

![](<../../.gitbook/assets/image (81).png>)

### TODO:

* Παράδειγμα κατασκευής με reverse shell που τρέχει σε Windows/Mac/Linux
* Παράδειγμα κατασκευής που διαρρέει το env κωδικοποιημένο σε base64 στα logs

### TravisCI Enterprise

Αν ένας επιτιθέμενος καταλήξει σε ένα περιβάλλον που χρησιμοποιεί **TravisCI enterprise** (περισσότερες πληροφορίες για το τι είναι αυτό στις [**βασικές πληροφορίες**](basic-travisci-information.md#travisci-enterprise)), θα μπορεί να **ενεργοποιήσει κατασκευές στον Worker.** Αυτό σημαίνει ότι ένας επιτιθέμενος θα μπορεί να κινηθεί πλευρικά σε αυτόν τον διακομιστή από τον οποίο θα μπορούσε να:

* διαφύγει στον host;
* παραβιάσει το kubernetes;
* παραβιάσει άλλες μηχανές που τρέχουν στο ίδιο δίκτυο;
* παραβιάσει νέες cloud credentials;

## Αναφορές

* [https://docs.travis-ci.com/user/encrypting-files/](https://docs.travis-ci.com/user/encrypting-files/)
* [https://docs.travis-ci.com/user/best-practices-security](https://docs.travis-ci.com/user/best-practices-security)

{% hint style="success" %}
Μάθετε και εξασκηθείτε στο AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε και εξασκηθείτε στο GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Γίνετε μέλος της** 💬 [**ομάδας Discord**](https://discord.gg/hRep4RUj7f) ή της [**ομάδας telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε hacking tricks υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια στο github.

</details>
{% endhint %}
