# Informaci칩n B치sica de TravisCI

{% hint style="success" %}
Aprende y practica AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprende y practica GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

## Acceso

TravisCI se integra directamente con diferentes plataformas git como Github, Bitbucket, Assembla y Gitlab. Pedir치 al usuario que otorgue permisos a TravisCI para acceder a los repositorios que quiere integrar con TravisCI.

Por ejemplo, en Github pedir치 los siguientes permisos:

* `user:email` (solo lectura)
* `read:org` (solo lectura)
* `repo`: Otorga acceso de lectura y escritura al c칩digo, estados de los commits, colaboradores y estados de despliegue para repositorios y organizaciones p칰blicas y privadas.

## Secretos Encriptados

### Variables de Entorno

En TravisCI, como en otras plataformas CI, es posible **guardar secretos a nivel de repositorio** que se guardar치n encriptados y se **desencriptar치n y se pondr치n en la variable de entorno** de la m치quina que ejecuta la build.

![](<../../.gitbook/assets/image (203).png>)

Es posible indicar las **ramas a las que estar치n disponibles los secretos** (por defecto todas) y tambi칠n si TravisCI **deber칤a ocultar su valor** si aparece **en los logs** (por defecto lo har치).

### Secretos Encriptados Personalizados

Para **cada repositorio** TravisCI genera un **par de claves RSA**, **guarda** la **privada** y hace que la **clave p칰blica del repositorio est칠 disponible** para aquellos que tienen **acceso** al repositorio.

Puedes acceder a la clave p칰blica de un repositorio con:
```
travis pubkey -r <owner>/<repo_name>
travis pubkey -r carlospolop/t-ci-test
```
Luego, puedes usar esta configuraci칩n para **encriptar secretos y agregarlos a tu `.travis.yaml`**. Los secretos ser치n **desencriptados cuando se ejecute la build** y estar치n accesibles en las **variables de entorno**.

![](<../../.gitbook/assets/image (139).png>)

Ten en cuenta que los secretos encriptados de esta manera no aparecer치n listados en las variables de entorno de la configuraci칩n.

### Archivos Encriptados Personalizados

De la misma manera que antes, TravisCI tambi칠n permite **encriptar archivos y luego desencriptarlos durante la build**:
```
travis encrypt-file super_secret.txt -r carlospolop/t-ci-test

encrypting super_secret.txt for carlospolop/t-ci-test
storing result as super_secret.txt.enc
storing secure env variables for decryption

Please add the following to your build script (before_install stage in your .travis.yml, for instance):

openssl aes-256-cbc -K $encrypted_355e94ba1091_key -iv $encrypted_355e94ba1091_iv -in super_secret.txt.enc -out super_secret.txt -d

Pro Tip: You can add it automatically by running with --add.

Make sure to add super_secret.txt.enc to the git repository.
Make sure not to add super_secret.txt to the git repository.
Commit all changes to your .travis.yml.
```
Note que al cifrar un archivo se configurar치n 2 Variables de Entorno dentro del repositorio, tales como:

![](<../../.gitbook/assets/image (170).png>)

## TravisCI Enterprise

Travis CI Enterprise es una **versi칩n on-prem de Travis CI**, que puedes desplegar **en tu infraestructura**. Piensa en la versi칩n 'servidor' de Travis CI. Usar Travis CI te permite habilitar un sistema de Integraci칩n Continua/Despliegue Continuo (CI/CD) f치cil de usar en un entorno, que puedes configurar y asegurar como desees.

**Travis CI Enterprise consta de dos partes principales:**

1. Servicios **TCI** (o Servicios Core de TCI), responsables de la integraci칩n con sistemas de control de versiones, autorizaci칩n de builds, programaci칩n de trabajos de build, etc.
2. Im치genes de entorno de build y **Worker** de TCI (tambi칠n llamadas im치genes de SO).

**Los servicios Core de TCI requieren lo siguiente:**

1. Una base de datos **PostgreSQL11** (o posterior).
2. Una infraestructura para desplegar un cl칰ster de Kubernetes; puede desplegarse en un cl칰ster de servidores o en una sola m치quina si es necesario.
3. Dependiendo de tu configuraci칩n, es posible que desees desplegar y configurar algunos de los componentes por tu cuenta, por ejemplo, RabbitMQ - consulta [Setting up Travis CI Enterprise](https://docs.travis-ci.com/user/enterprise/tcie-3.x-setting-up-travis-ci-enterprise/) para m치s detalles.

**El Worker de TCI requiere lo siguiente:**

1. Una infraestructura donde se pueda desplegar una imagen de docker que contenga el **Worker y una imagen de build vinculada**.
2. Conectividad a ciertos componentes de los Servicios Core de Travis CI - consulta [Setting Up Worker](https://docs.travis-ci.com/user/enterprise/setting-up-worker/) para m치s detalles.

La cantidad de im치genes de entorno de build y Worker de TCI desplegadas determinar치 la capacidad concurrente total del despliegue de Travis CI Enterprise en tu infraestructura.

![](<../../.gitbook/assets/image (199).png>)

{% hint style="success" %}
Aprende y practica AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprende y practica GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya HackTricks</summary>

* Consulta los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
