# GCP - Cloud Run Enum

{% hint style="success" %}
AWS Hacking'ı öğrenin ve uygulayın: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'ini öğrenin ve uygulayın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katılın veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak PR'ler göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>
{% endhint %}

## Cloud Run <a href="#reviewing-cloud-run-configurations" id="reviewing-cloud-run-configurations"></a>

Cloud Run, Google'ın ölçeklenebilir altyapısında doğrudan **konteynerleri çalıştırmanıza** olanak tanıyan sunucusuz yönetilen bir hesaplama platformudur.

Konteynerinizi çalıştırabilir veya Go, Node.js, Python, Java, .NET Core veya Ruby kullanıyorsanız, sizin için **konteyneri oluşturan** [kaynak tabanlı dağıtım](https://cloud.google.com/run/docs/deploying-source-code) seçeneğini kullanabilirsiniz.

Google, Cloud Run'ı **Google Cloud'daki diğer hizmetlerle iyi çalışacak şekilde inşa etmiştir**, böylece tam özellikli uygulamalar oluşturabilirsiniz.

### Hizmetler ve işler <a href="#services-and-jobs" id="services-and-jobs"></a>

Cloud Run'da, kodunuz ya bir _**hizmet**_ olarak sürekli çalışabilir ya da bir _**iş**_ olarak çalışabilir. Hem hizmetler hem de işler aynı ortamda çalışır ve Google Cloud'daki diğer hizmetlerle aynı entegrasyonları kullanabilir.

* **Cloud Run hizmetleri.** Web isteklerine veya olaylara yanıt veren kodu çalıştırmak için kullanılır.
* **Cloud Run işleri.** Bir işi gerçekleştiren (bir iş) ve iş tamamlandığında sona eren kodu çalıştırmak için kullanılır.

## Cloud Run Hizmeti

Google [Cloud Run](https://cloud.google.com/run), env değişkenlerini arayabileceğiniz başka bir sunucusuz tekliftir. Cloud Run, varsayılan olarak konteyner içinde 8080 numaralı bağlantı noktasında çalışan küçük bir web sunucusu oluşturur ve bir HTTP GET isteği bekleyen bir işlemi başlatır. İstek alındığında bir işlem yürütülür ve işlem günlüğü bir HTTP yanıtı aracılığıyla çıktılanır.

### İlgili detaylar

* **Varsayılan olarak**, web sunucusuna **erişim** **genel** olmasına rağmen, aynı zamanda **dahili trafiğe sınırlanabilir** (VPC...)\
Ayrıca, web sunucusuna erişim için **kimlik doğrulama** ya **tümüne izin verilebilir** ya da **IAM aracılığıyla kimlik doğrulama gerektirebilir**.
* Varsayılan olarak, **şifreleme** Google tarafından yönetilen bir anahtar kullanır, ancak **KMS**'den bir **Müşteri Yönetimli Şifreleme Anahtarı (CMEK)** de **seçilebilir**.
* Varsayılan olarak, kullanılan **hizmet hesabı** proje üzerinde **Editör** erişimine sahip olan **Compute Engine varsayılanıdır** ve **`cloud-platform`** kapsamına sahiptir.
* Yürütme için **açık metin ortam değişkenleri** tanımlamak mümkündür ve hatta **bulut sırlarını bağlamak** veya **bulut sırlarını ortam değişkenlerine eklemek** mümkündür.
* Ayrıca **Cloud SQL ile bağlantılar eklemek** ve **bir dosya sistemi bağlamak** mümkündür.
* Dağıtılan hizmetlerin **URL'leri** şuna benzer: **`https://<svc-name>-<random>.a.run.app`**
* Bir Çalıştırma Hizmeti **birden fazla sürüm veya revizyon**a sahip olabilir ve **trafiği** çeşitli revizyonlar arasında **bölüştürebilir**.

### Numaralandırma
```bash
# List services
gcloud run services list
gcloud run services list --platform=managed
gcloud run services list --platform=gke

# Get info of a service
gcloud run services describe --region <region> <svc-name>

# Get info of all the services together
gcloud run services list --format=yaml
gcloud run services list --platform=managed --format=json
gcloud run services list --platform=gke --format=json

# Get policy
gcloud run services get-iam-policy --region <region> <svc-name>

# Get revisions
gcloud run revisions list --region <region>
gcloud run revisions describe --region <region> <revision>

# Get domains
gcloud run domain-mappings list
gcloud run domain-mappings describe <name>

# Attempt to trigger a job unauthenticated
curl <url>

# Attempt to trigger a job with your current gcloud authorization
curl -H "Authorization: Bearer $(gcloud auth print-identity-token)" <url>
```
## Bulut Çalıştırma İşleri

Bulut Çalıştırma işleri, **tamamlanana kadar çalışan ve istekleri karşılamayan konteynerler için daha uygun olabilir**. İşlerin istekleri karşılamak veya bir bağlantı noktasında dinlemek gibi bir yeteneği yoktur. Bu, Bulut Çalıştırma hizmetlerinin aksine, işlerin bir web sunucusu içermemesi gerektiği anlamına gelir. Bunun yerine, iş konteynerleri işlerini bitirdiklerinde çıkmalıdır.

### Numaralandırma
```bash
gcloud beta run jobs list
gcloud beta run jobs describe --region <region> <job-name>
gcloud beta run jobs get-iam-policy --region <region> <job-name>
```
## Yetki Yükseltme

Aşağıdaki sayfada, **yetkileri yükseltmek için bulut çalıştırma izinlerini kötüye kullanma** yöntemlerini kontrol edebilirsiniz:

{% content-ref url="../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md" %}
[gcp-run-privesc.md](../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md)
{% endcontent-ref %}

## Kimlik Doğrulamasız Erişim

{% content-ref url="../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md" %}
[gcp-cloud-run-unauthenticated-enum.md](../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md)
{% endcontent-ref %}

## Saldırı Sonrası İşlemler

{% content-ref url="../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md" %}
[gcp-cloud-run-post-exploitation.md](../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md)
{% endcontent-ref %}

## Kalıcılık

{% content-ref url="../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md" %}
[gcp-cloud-run-persistence.md](../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md)
{% endcontent-ref %}

## Referanslar

* [https://cloud.google.com/run/docs/overview/what-is-cloud-run](https://cloud.google.com/run/docs/overview/what-is-cloud-run)

{% hint style="success" %}
AWS Hacking öğrenin ve pratik yapın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitimi AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking öğrenin ve pratik yapın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitimi GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katılın veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak PR'ler göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>
{% endhint %}
