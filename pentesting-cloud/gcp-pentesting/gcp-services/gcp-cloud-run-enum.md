# GCP - Cloud Run Enum

{% hint style="success" %}
Leer & oefen AWS Hack:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hack: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Controleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}

## Cloud Run <a href="#reviewing-cloud-run-configurations" id="reviewing-cloud-run-configurations"></a>

Cloud Run is 'n bedienerlose bestuurde rekenplatform wat jou **houers direk bo-op Google se skaalbare infrastruktuur laat hardloop**.

Jy kan jou houer laat hardloop of as jy Go, Node.js, Python, Java, .NET Core, of Ruby gebruik, kan jy die [bron-gebaseerde implementering](https://cloud.google.com/run/docs/deploying-source-code) opsie gebruik wat **die houer vir jou bou**.

Google het Cloud Run gebou om **goed saam te werk met ander dienste op Google Cloud**, sodat jy volledige toepassings kan bou.

### Dienste en take <a href="#services-and-jobs" id="services-and-jobs"></a>

Op Cloud Run kan jou kode √≥f kontinu as 'n _**diens**_ hardloop of as 'n _**taak**_. Beide dienste en take hardloop in dieselfde omgewing en kan dieselfde integrasies met ander dienste op Google Cloud gebruik.

* **Cloud Run dienste.** Gebruik om kode te hardloop wat reageer op webversoeke, of gebeure.
* **Cloud Run take.** Gebruik om kode te hardloop wat werk verrig (‚Äòn taak) en ophou wanneer die werk klaar is.

## Cloud Run Diens

Google [Cloud Run](https://cloud.google.com/run) is nog 'n bedienerlose aanbod waar jy na omgewingsveranderlikes kan soek. Cloud Run skep 'n klein webbediener, wat standaard op poort 8080 binne die houer hardloop, wat wag vir 'n HTTP GET-versoek. Wanneer die versoek ontvang word, word 'n taak uitgevoer en die taaklog word uitgevoer via 'n HTTP-antwoord.

### Relevant besonderhede

* Standaard is die **toegang** tot die webbediener **openbaar**, maar dit kan ook **beperk word tot interne verkeer** (VPC...)\
Daarbenewens kan die **verifikasie** om die webbediener te kontak, **almal toelaat** of **verifikasie via IAM vereis**.
* Standaard gebruik die **enkripsie** 'n **Google-bestuurde sleutel**, maar 'n **CMEK** (Klantbestuurde Enkripsiesleutel) van **KMS** kan ook **gekies word**.
* Standaard word die **diensrekening** wat gebruik word, die **Rekenaarvermo√´ standaard een** wat **Redakteurstoegang** tot die projek het en dit het die **omvang `cloud-platform`.**
* Dit is moontlik om **duidelike teksomgewingsveranderlikes** vir die uitvoering te definieer, en selfs **wolkgeheime te koppel** of **wolkgeheime by omgewingsveranderlikes te voeg.**
* Dit is ook moontlik om **verbindings met Cloud SQL by te voeg** en **'n l√™ersisteem te koppel.**
* Die **URL's** van die ge√Ømplementeerde dienste is soortgelyk aan **`https://<svc-name>-<random>.a.run.app`**
* 'n Run Diens kan **meer as 1 weergawe of revisie h√™**, en **verkeer verdeel** tussen verskeie revisies.

### Enumerasie
```bash
# List services
gcloud run services list
gcloud run services list --platform=managed
gcloud run services list --platform=gke

# Get info of a service
gcloud run services describe --region <region> <svc-name>

# Get info of all the services together
gcloud run services list --format=yaml
gcloud run services list --platform=managed --format=json
gcloud run services list --platform=gke --format=json

# Get policy
gcloud run services get-iam-policy --region <region> <svc-name>

# Get revisions
gcloud run revisions list --region <region>
gcloud run revisions describe --region <region> <revision>

# Get domains
gcloud run domain-mappings list
gcloud run domain-mappings describe <name>

# Attempt to trigger a job unauthenticated
curl <url>

# Attempt to trigger a job with your current gcloud authorization
curl -H "Authorization: Bearer $(gcloud auth print-identity-token)" <url>
```
## Cloud Run Werk

Cloud Run-werk is 'n beter pas vir **houers wat voltooi en nie versoek dien nie**. Werk het nie die vermo√´ om versoek te dien of na 'n poort te luister nie. Dit beteken dat anders as Cloud Run-diens, werk nie 'n webbediener moet insluit nie. In plaas daarvan moet werkhouers afsluit wanneer hulle klaar is.

### Opsomming
```bash
gcloud beta run jobs list
gcloud beta run jobs describe --region <region> <job-name>
gcloud beta run jobs get-iam-policy --region <region> <job-name>
```
## Voorregskaping

Op die volgende bladsy kan jy sien hoe om **wolkmeganismes te misbruik om voorregte te kap**:

{% content-ref url="../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md" %}
[gcp-run-privesc.md](../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md)
{% endcontent-ref %}

## Ongeagte Toegang

{% content-ref url="../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md" %}
[gcp-cloud-run-unauthenticated-enum.md](../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md)
{% endcontent-ref %}

## Na-uitbuiting

{% content-ref url="../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md" %}
[gcp-cloud-run-post-exploitation.md](../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md)
{% endcontent-ref %}

## Volharding

{% content-ref url="../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md" %}
[gcp-cloud-run-persistence.md](../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md)
{% endcontent-ref %}

## Verwysings

* [https://cloud.google.com/run/docs/overview/what-is-cloud-run](https://cloud.google.com/run/docs/overview/what-is-cloud-run)

{% hint style="success" %}
Leer & oefen AWS-hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP-hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kontroleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}
