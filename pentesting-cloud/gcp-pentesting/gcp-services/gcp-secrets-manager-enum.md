# GCP - Secrets Manager Enum

{% hint style="success" %}
AWS 해킹 학습 및 실습:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP 해킹 학습 및 실습: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks 지원</summary>

* [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인하세요!
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **트위터** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**를 팔로우**하세요.
* **HackTricks** 및 **HackTricks Cloud** 깃허브 저장소에 PR을 제출하여 해킹 트릭을 **공유**하세요.

</details>
{% endhint %}

## Secret Manager

Google [**Secret Manager**](https://cloud.google.com/solutions/secrets-management/)은 비밀번호, API 키, 인증서, 파일(최대 64KB) 및 기타 민감한 데이터를 저장하기 위한 금고와 같은 솔루션입니다.

비밀은 **다른 데이터를 저장하는 다른 버전을 가질 수** 있습니다.

비밀은 **기본적으로 Google이 관리하는 키를 사용하여 암호화**되지만, 비밀을 암호화하는 데 사용할 KMS 키를 선택하는 것이 **가능**합니다.

**회전**에 대해선 **메시지를 구성하여 일정 일 수마다** pub-sub로 전송하도록 설정할 수 있으며, 해당 메시지를 수신하는 코드가 **비밀을 회전**할 수 있습니다.

**자동 삭제를 위한 날짜를 구성**할 수 있으며, 지정된 날짜에 도달하면 **비밀이 자동으로 삭제**됩니다.

### 열거
```bash
# First, list the entries
gcloud secrets list
gcloud secrets get-iam-policy <secret_name>

# Then, pull the clear-text of any version of any secret
gcloud secrets versions list <secret_name>
gcloud secrets versions access 1 --secret="<secret_name>"
```
### 권한 상승

다음 페이지에서 **시크릿 매니저 권한을 남용하여 권한을 상승하는 방법**을 확인할 수 있습니다.

{% content-ref url="../../gcp-security/gcp-privilege-escalation/gcp-secretmanager-privesc.md" %}
[gcp-secretmanager-privesc.md](../../gcp-security/gcp-privilege-escalation/gcp-secretmanager-privesc.md)
{% endcontent-ref %}

### 사후 공격

{% content-ref url="../../gcp-security/gcp-post-exploitation/gcp-secretmanager-post-exploitation.md" %}
[gcp-secretmanager-post-exploitation.md](../../gcp-security/gcp-post-exploitation/gcp-secretmanager-post-exploitation.md)
{% endcontent-ref %}

### 지속성

{% content-ref url="../../gcp-security/gcp-persistence/gcp-secret-manager-persistence.md" %}
[gcp-secret-manager-persistence.md](../../gcp-security/gcp-persistence/gcp-secret-manager-persistence.md)
{% endcontent-ref %}

### 회전 오용

공격자는 시크릿을 업데이트하여 **회전을 중지**시킬 수 있습니다(수정되지 않음), 또는 **회전을 훨씬 덜 자주**하게 만들 수 있습니다(시크릿이 수정되지 않음) 또는 **회전 메시지를 다른 pub/sub에 게시**하거나 실행되는 회전 코드를 수정할 수 있습니다(이는 다른 서비스에서 발생하며 아마도 클라우드 함수에서 발생하므로 공격자는 클라우드 함수나 다른 서비스에 대한 특권 액세스가 필요합니다)
