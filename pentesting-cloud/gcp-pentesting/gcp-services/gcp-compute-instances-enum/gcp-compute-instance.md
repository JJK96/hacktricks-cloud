# GCP - Vifaa vya Kuhesabu

{% hint style="success" %}
Jifunze na zoezi la Udukuzi wa AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Mafunzo ya HackTricks ya Mtaalam wa Timu Nyekundu ya AWS (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze na zoezi la Udukuzi wa GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Mafunzo ya HackTricks ya Mtaalam wa Timu Nyekundu ya GCP (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>unga mkono HackTricks</summary>

* Angalia [**mpango wa michango**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Taarifa Msingi

Vifaa vya Kuhesabu vya Google Cloud ni **mashine za virtual zilizobinafsishwa kwenye miundombinu ya wingu la Google**, zinazotoa nguvu ya kuhesabu inayoweza kupanuliwa na inayohitajika kwa maombi mbalimbali. Zinatoa huduma kama kupelekwa kwa kimataifa, uhifadhi endelevu, chaguzi za OS za kubadilika, na ushirikiano imara wa mitandao na usalama, hivyo kuwa chaguo la kipekee kwa kuhifadhi tovuti, kusindika data, na kuendesha maombi kwa ufanisi kwenye wingu.

### VM ya Siri

VM za Siri hutumia **vipengele vya usalama vilivyowekwa kwenye vifaa** vinavyotolewa na michakato ya AMD EPYC ya kizazi kipya, ambayo ni pamoja na kifungo cha kumbukumbu na uthibitishaji wa kivinjari kilichofungwa kwa usalama. Vipengele hivi huruhusu VM kulinda data inayosindika na kuhifadhiwa ndani yake hata kutoka kwa mfumo wa uendeshaji wa mwenyeji na hypervisor.

Ili kuendesha VM ya Siri inaweza kuhitaji **kubadilisha** mambo kama **aina** ya **mashine**, **interface ya mtandao**, **picha ya diski ya kuanzisha**.

### Diski & Ufichaji wa Diski

Inawezekana **kuchagua diski** itumike au **kuunda mpya**. Ukichagua mpya unaweza:

* Chagua **ukubwa** wa diski
* Chagua **OS**
* Eleza ikiwa unataka **kufuta diski wakati kifaa kinapofutwa**
* **Ufichaji**: Kwa **chaguo-msingi** itatumika **ufunguo uliosimamiwa na Google**, lakini unaweza pia **kuchagua ufunguo kutoka KMS** au eleza **ufunguo wa moja kwa moja utumike**.

### Weka Kontena

Inawezekana kuweka **kontena** ndani ya mashine ya virtual.\
Inawezekana kusanidi **picha** itumike, weka **amri** itakayotekelezwa ndani, **vigezo**, weka **kiasi**, na **mazingira ya env** (habari nyeti?) na kusanidi chaguo kadhaa kwa kontena kama kutekeleza kama **mwenye haki**, stdin na pseudo TTY.

### Akaunti ya Huduma

Kwa chaguo-msingi, **akaunti ya huduma ya msingi ya Compute Engine** itatumika. Barua pepe ya SA hii ni kama: `<proj-num>-compute@developer.gserviceaccount.com`\
Akaunti hii ya huduma ina **jukumu la Mhariri kwa mradi mzima (mamlaka ya juu).**

Na **mizizi ya ufikiaji ya chaguo-msingi** ni kama ifuatavyo:

* **https://www.googleapis.com/auth/devstorage.read\_only** -- Upatikanaji wa kusoma kwa vikapu :)
* https://www.googleapis.com/auth/logging.write
* https://www.googleapis.com/auth/monitoring.write
* https://www.googleapis.com/auth/servicecontrol
* https://www.googleapis.com/auth/service.management.readonly
* https://www.googleapis.com/auth/trace.append

Hata hivyo, inawezekana **kumpa `cloud-platform` kwa kubofya** au kufafanua **zile za desturi**.

<figure><img src="../../../../.gitbook/assets/image (138).png" alt=""><figcaption></figcaption></figure>

### Ukuta wa Moto

Inawezekana kuruhusu trafiki ya HTTP na HTTPS.

<figure><img src="../../../../.gitbook/assets/image (137).png" alt=""><figcaption></figcaption></figure>

### Uunganishaji wa Mtandao

* **Uendeshaji wa IP**: Inawezekana **kuruhusu uendeshaji wa IP** tangu uundaji wa kifaa.
* **Jina la Mwenyeji**: Inawezekana kumpa kifaa jina la mwenyeji wa kudumu.
* **Interface**: Inawezekana kuongeza kiolesura cha mtandao

### Usalama wa Ziada

Chaguo hizi zitaboresha usalama wa VM na zinapendekezwa:

* **Kuanzisha salama:** Kuanzisha salama husaidia kulinda mifano yako ya VM dhidi ya zisizo za kiwango cha boot na zisizo za kiwango cha kernel.
* **Wezesha vTPM:** Moduli ya Jukwaa Iliyothibitishwa Kivituali (vTPM) inathibitisha utimilifu wa mwenyeji wako wa VM kabla ya kuanza na baada ya kuanza, na inatoa uundaji na ulinzi wa funguo.
* **Usimamizi wa Utimilifu:** Ufuatiliaji wa utimilifu huruhusu kufuatilia na kuthibitisha utimilifu wa mifumo yako ya VM iliyolindwa kwa kutumia ripoti za Stackdriver. Inahitaji vTPM kuwezeshwa.

### Upatikanaji wa VM

Njia ya kawaida ya kuwezesha upatikanaji wa VM ni kwa **kuruhusu funguo za umma za SSH fulani** kupata VM.\
Hata hivyo, pia inawezekana **kuwezesha upatikanaji wa VM kupitia huduma ya `os-config` kwa kutumia IAM**. Zaidi ya hayo, inawezekana kuwezesha 2FA kupata VM kwa kutumia huduma hii.\
Wakati hii **huduma** inapokuwa **imezimwa**, upatikanaji kupitia **funguo za SSH unazimwa.**

<figure><img src="../../../../.gitbook/assets/image (139).png" alt=""><figcaption></figcaption></figure>

### Metadata

Inawezekana kufafanua **utomatiki** (data ya mtumiaji katika AWS) ambayo ni **amri za shell** ambazo zitatekelezwa kila wakati mashine inapoanza au kuanza upya.

Pia inawezekana **kuongeza thamani za ufunguo-ufunguo za metadata za ziada** ambazo zitapatikana kutoka kwa mwisho wa metadata. Taarifa hii mara nyingi hutumiwa kwa mazingira ya mazingira na hati za kuanza/kuzimwa. Hii inaweza kupatikana kwa kutumia **`mueleze` mbinu** kutoka kwa amri katika sehemu ya uhesabu, lakini pia inaweza kupatikana kutoka ndani ya kifaa kwa kufikia mwisho wa metadata.
```bash
# view project metadata
curl "http://metadata.google.internal/computeMetadata/v1/project/attributes/?recursive=true&alt=text" \
-H "Metadata-Flavor: Google"

# view instance metadata
curl "http://metadata.google.internal/computeMetadata/v1/instance/attributes/?recursive=true&alt=text" \
-H "Metadata-Flavor: Google"
```
Zaidi ya hayo, **tokeni ya uthibitishaji kwa akaunti ya huduma iliyowekwa** na **maelezo ya jumla** kuhusu kifaa, mtandao na mradi pia yatakuwa yanapatikana kutoka kwenye **kituo cha metadata**. Kwa maelezo zaidi angalia:

{% embed url="https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery/cloud-ssrf#6440" %}

### Kifaa cha Kuficha

Kifunguo cha kuficha kilichosimamiwa na Google hutumiwa kwa chaguo-msingi lakini kifunguo cha kuficha kilichosimamiwa na Mteja (CMEK) kinaweza kusanidiwa. Unaweza pia kusanidi ni nini cha kufanya wakati CMEF iliyotumiwa inafutwa: Kutoa taarifa au kuzima VM.

<figure><img src="../../../../.gitbook/assets/image (140).png" alt=""><figcaption></figcaption></figure>

{% hint style="success" %}
Jifunze & zoezi la Udukuzi wa AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Mafunzo ya HackTricks ya Mtaalam wa Timu Nyekundu ya AWS (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze & zoezi la Udukuzi wa GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Mafunzo ya HackTricks ya Mtaalam wa Timu Nyekundu ya GCP (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa michango**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
