# GCP - Berekeningsinstansies

{% hint style="success" %}
Leer & oefen AWS Hack: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Rooi Span Kenner (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hack: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Rooi Span Kenner (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kontroleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}

## Basiese Inligting

Google Cloud Berekeningsinstansies is **aanpasbare virtuele masjiene op Google se wolk-infrastruktuur**, wat skaalbare en aanvraag-gebaseerde rekenkrag bied vir 'n wye verskeidenheid toepassings. Hulle bied kenmerke soos globale implementering, volhoubare stoor, buigsame OS-keuses, en sterk netwerk- en sekuriteitsintegrasies, wat hulle 'n veelsydige keuse maak vir die gasheer van webwerwe, die verwerking van data, en die doeltreffende hardloop van toepassings in die wolk.

### Vertroulike VM

Vertroulike VM's maak gebruik van **hardeware-gebaseerde sekuriteitskenmerke** wat deur die jongste generasie AMD EPYC-verwerkers aangebied word, wat geheueversleuteling en veilige versleutelde virtualisering insluit. Hierdie kenmerke stel die VM in staat om die data wat daarin verwerk en gestoor word, selfs teen die gasbedryfstelsel en hipervisor te beskerm.

Om 'n Vertroulike VM te hardloop, mag dit nodig wees om dinge soos die **tipe** van die **masjien**, netwerk **koppelvlak**, **opstartskyfbeeld** te **verander**.

### Skyf & Skyfversleuteling

Dit is moontlik om die skyf te **kies** wat gebruik moet word of 'n nuwe een te **skep**. As jy 'n nuwe een kies, kan jy:

* Kies die **grootte** van die skyf
* Kies die **OS**
* Aandui of jy die skyf wil **verwyder wanneer die instansie verwyder word**
* **Versleuteling**: Standaard sal 'n **Google-bestuurde sleutel** gebruik word, maar jy kan ook 'n sleutel van KMS **kies** of aandui **ro-sleutel om te gebruik**.

### Implementeer Houverpakking

Dit is moontlik om 'n **houer** binne die virtuele masjien te implementeer.\
Dit is moontlik om die **beeld** te konfigureer wat gebruik moet word, die **bevel** om binne te hardloop, **argumente**, 'n **volume** te koppel, en **omgewingsveranderlikes** (gevoelige inligting?) in te stel en verskeie opsies vir hierdie houer te konfigureer soos uitvoer as **bevoorreg**, stdin en pseudo TTY.

### Diensrekening

Standaard sal die **Rekenaar-standaarddiensrekening** gebruik word. Die e-pos van hierdie SA is soos: `<proj-num>-compute@developer.gserviceaccount.com`\
Hierdie diensrekening het **Redakteursrol oor die hele projek (ho√´ voorregte).**

En die **standaardtoegangsbereike** is die volgende:

* **https://www.googleapis.com/auth/devstorage.read\_only** -- Leestoegang tot emmers :)
* https://www.googleapis.com/auth/logging.write
* https://www.googleapis.com/auth/monitoring.write
* https://www.googleapis.com/auth/servicecontrol
* https://www.googleapis.com/auth/service.management.readonly
* https://www.googleapis.com/auth/trace.append

Dit is egter moontlik om dit `cloud-platform` toe te ken met 'n klik of **aangepaste eenhede** te spesifiseer.

<figure><img src="../../../../.gitbook/assets/image (138).png" alt=""><figcaption></figcaption></figure>

### Vuurwal

Dit is moontlik om HTTP- en HTTPS-verkeer toe te laat.

<figure><img src="../../../../.gitbook/assets/image (137).png" alt=""><figcaption></figcaption></figure>

### Netwerke

* **IP-deurverwysing**: Dit is moontlik om **IP-deurverwysing** vanaf die skepping van die instansie te **aktiveer**.
* **Gasheernaam**: Dit is moontlik om die instansie 'n permanente gasheernaam te gee.
* **Koppelvlak**: Dit is moontlik om 'n netwerkkoppelvlak by te voeg

### Ekstra Sekuriteit

Hierdie opsies sal die sekuriteit van die VM **verhoog** en word aanbeveel:

* **Veilige opstart:** Veilige opstart help om jou VM-instansies teen opstart- en kernvlak-malware en rootkits te beskerm.
* **Aktiveer vTPM:** Virtuele Vertroude Platform Module (vTPM) valideer jou gas-VM se voor-opstart en opstartintegriteit, en bied sleutelgenerering en -beskerming.
* **Integriteitstoediening:** Integriteitstoediening laat jou toe om die hardloop-opstartintegriteit van jou geskilde VM-instansies te monitor en verifieer met behulp van Stackdriver-rapporte. Vereis dat vTPM geaktiveer word.

### VM-toegang

Die algemene manier om toegang tot die VM moontlik te maak, is deur **sekere SSH openbare sleutels toe te laat** om toegang tot die VM te verkry.\
Dit is egter ook moontlik om die toegang tot die VM moontlik te maak via die `os-config`-diens met behulp van IAM. Dit is ook moontlik om 2FA te aktiveer om toegang tot die VM met behulp van hierdie diens te verkry.\
Wanneer hierdie **diens** geaktiveer is, is die toegang via **SSH-sleutels gedeaktiveer**.

<figure><img src="../../../../.gitbook/assets/image (139).png" alt=""><figcaption></figcaption></figure>

### Metadata

Dit is moontlik om **outomatisering** (gebruikersdata in AWS) te definieer wat **skelopdragte** is wat elke keer uitgevoer sal word wanneer die masjien aangeskakel of herlaai word.

Dit is ook moontlik om **ekstra metadatasleutel-waarde waardes** te **byvoeg** wat toeganklik sal wees vanaf die metadatapunt. Hierdie inligting word gewoonlik gebruik vir omgewingsveranderlikes en aanvangs-/afsluitingskriptos. Dit kan verkry word deur die **`beskryf`-metode** van 'n bevel in die opnoemingsafdeling te gebruik, maar dit kan ook van binne die instansie verkry word deur die metadatapunt te benader.
```bash
# view project metadata
curl "http://metadata.google.internal/computeMetadata/v1/project/attributes/?recursive=true&alt=text" \
-H "Metadata-Flavor: Google"

# view instance metadata
curl "http://metadata.google.internal/computeMetadata/v1/instance/attributes/?recursive=true&alt=text" \
-H "Metadata-Flavor: Google"
```
Verder sal die **outentiekeerder-token vir die aangehegte diensrekening** en **algemene inligting** oor die instansie, netwerk en projek ook beskikbaar wees vanaf die **metadata-eindpunt**. Vir meer inligting, kyk:

{% embed url="https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery/cloud-ssrf#6440" %}

### Versleuteling

'n Deur Google bestuurde versleutelingssleutel word standaard gebruik, maar 'n Klantbestuurde versleutelingssleutel (CMEK) kan gekonfigureer word. Jy kan ook konfigureer wat om te doen wanneer die gebruikte CMEF herroep word: Niks of die VM afskakel.

<figure><img src="../../../../.gitbook/assets/image (140).png" alt=""><figcaption></figcaption></figure>

{% hint style="success" %}
Leer & oefen AWS-hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP-hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}
