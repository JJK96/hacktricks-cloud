# GCP - Απαρίθμηση Κινητήρα Εφαρμογών

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο Hacking του AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Εκπαίδευση HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο Hacking του GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Εκπαίδευση HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε** 💬 [**στην ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε κόλπα χάκερ υποβάλλοντας PRs** στα αποθετήρια [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

## Βασικές Πληροφορίες <a href="#reviewing-app-engine-configurations" id="reviewing-app-engine-configurations"></a>


Ο Κινητήρας Εφαρμογών της Google Cloud Platform (GCP) είναι μια **ανθεκτική, serverless πλατφόρμα σχεδιασμένη για την ανάπτυξη και φιλοξενία web εφαρμογών σε μεγάλη κλίμακα**. Ο σχεδιασμός αυτής της πλατφόρμας επικεντρώνεται στην απλοποίηση της διαδικασίας ανάπτυξης και τη βελτίωση της διαχειρισιμότητας των εφαρμογών. Τα κύρια χαρακτηριστικά και οι ευεργετικές πτυχές του Κινητήρα Εφαρμογών της GCP περιλαμβάνουν:

1. **Αρχιτεκτονική Serverless**: Ο Κινητήρας Εφαρμογών αναλαμβάνει αυτόματα την υποδομή, συμπεριλαμβανομένης της προμήθειας, της διαμόρφωσης και της κλιμάκωσης του διακομιστή. Αυτό επιτρέπει στους προγραμματιστές να επικεντρωθούν στην εγγραφή κώδικα χωρίς να ανησυχούν για το υποκείμενο υλικό.
2. **Αυτόματη Κλιμάκωση**: Ο Κινητήρας Εφαρμογών μπορεί να κλιμακώσει αυτόματα την εφαρμογή σας ανάλογα με την ποσότητα της κυκλοφορίας που λαμβάνει. Κλιμακώνεται για να αντιμετωπίσει την αυξημένη κυκλοφορία και μειώνεται όταν η κυκλοφορία μειώνεται, βοηθώντας στη βελτιστοποίηση του κόστους και της απόδοσης.
3. **Υποστήριξη Γλωσσών και Χρόνων Εκτέλεσης**: Υποστηρίζει δημοφιλείς γλώσσες προγραμματισμού όπως Java, Python, Node.js, Go, Ruby, PHP και .NET. Μπορείτε να εκτελέσετε τις εφαρμογές σας σε ένα πρότυπο ή ένα ευέλικτο περιβάλλον. Το πρότυπο περιβάλλον είναι πιο περιοριστικό αλλά υψηλά βελτιστοποιημένο για συγκεκριμένες γλώσσες, ενώ το ευέλικτο περιβάλλον επιτρέπει μεγαλύτερη προσαρμογή.
4. **Ενσωματωμένες Υπηρεσίες**: Ο Κινητήρας Εφαρμογών ενσωματώνεται με πολλές άλλες υπηρεσίες της GCP, όπως Cloud SQL, Cloud Storage, Cloud Datastore και άλλες. Αυτή η ενσωμάτωση απλοποιεί την αρχιτεκτονική των εφαρμογών βασισμένων στο cloud.
5. **Εκδόσεις και Διαίρεση Κυκλοφορίας**: Μπορείτε εύκολα να αναπτύξετε πολλαπλές εκδόσεις της εφαρμογής σας και στη συνέχεια να διαιρέσετε την κυκλοφορία μεταξύ τους για δοκιμές A/B ή σταδιακές κυκλοφορίες.
6. **Πληροφορίες Εφαρμογής**: Ο Κινητήρας Εφαρμογών παρέχει ενσωματωμένες υπηρεσίες όπως καταγραφή, πιστοποίηση χρηστών και σύνολο εργαλείων προγραμματιστή για την παρακολούθηση και διαχείριση των εφαρμογών.
7. **Ασφάλεια**: Προσφέρει ενσωματωμένες λειτουργίες ασφαλείας όπως εκδόσεις εφαρμογών, πιστοποιητικά SSL/TLS για ασφαλείς συνδέσεις και διαχείριση ταυτότητας και πρόσβασης.

### Τοίχος Πυρασφάλειας

Ένας απλός **τοίχος πυρασφάλειας** μπορεί να διαμορφωθεί για τις περιπτώσεις που εκτελούνται οι εφαρμογές με τις ακόλουθες επιλογές:

<figure><img src="../../../.gitbook/assets/image (3) (1) (2).png" alt=""><figcaption></figcaption></figure>

### SA

Ο προεπιλεγμένος λογαριασμός υπηρεσίας που χρησιμοποιούν αυτές οι Εφαρμογές είναι **`<όνομα-έργου>@appspot.gserviceaccount.com`** ο οποίος έχει ρόλο **Επεξεργαστή** στο έργο και οι ΛΥ μέσα στην Εφαρμογή Κινητήρα **τρέχουν με εύρος cloud-platform (μεταξύ άλλων).**

### Αποθήκευση

Ο πηγαίος κώδικας και τα μεταδεδομένα **αποθηκεύονται αυτόματα σε κάδους** με ονόματα όπως `<id-έργου>.appspot.com` και `staging.<id-έργου>.appspot.com` και `<χώρα>.<id-έργου>.appspot.com`&#x20;

**Κάθε αρχείο** της Εφαρμογής αποθηκεύεται με το **sha1 του περιεχομένου ως όνομα αρχείου**:

<figure><img src="../../../.gitbook/assets/image (4) (6).png" alt=""><figcaption></figcaption></figure>

Μέσα στον φάκελο **`ae`** από `staging.<id-έργου>.appspot.com`, **υπάρχει ένας φάκελος ανά έκδοση** με τα αρχεία κώδικα πηγής και το αρχείο **`manifest.json`** που **περιγράφει τα στοιχεία** της Εφαρμογής:
```json
{"requirements.txt":{"sourceUrl":"https://storage.googleapis.com/staging.onboarding-host-98efbf97812843.appspot.com/a270eedcbe2672c841251022b7105d340129d108","sha1Sum":"a270eedc_be2672c8_41251022_b7105d34_0129d108"},"main_test.py":{"sourceUrl":"https://storage.googleapis.com/staging.onboarding-host-98efbf97812843.appspot.com/0ca32fd70c953af94d02d8a36679153881943f32","sha1Sum":"0ca32fd7_0c953af9_4d02d8a ...
```
{% endcode %}

### Εμφιαλωτές

Η web εφαρμογή θα εκτελείται τελικά μέσα σε έναν **εμφιαλωτή (container)** και το **Code Build** χρησιμοποιείται για την κατασκευή του εμφιαλωτή.

### Διευθύνσεις URL & Περιοχές

Η **προεπιλεγμένη** ιστοσελίδα θα εκτίθεται στη διεύθυνση URL **`<project-uniq-name>.appspot.com`** αν και η διεύθυνση URL των παλαιότερων εκδόσεων θα είναι ελαφρώς διαφορετική, όπως **`https://20240117t001540-dot-<project-uniq-name>.uc.r.appspot.com`** (σημειώστε την αρχική χρονική σήμανση).

Μπορεί να φαίνεται ότι είναι δυνατή μόνο η ανάπτυξη μιας εφαρμογής μηχανής app engine ανά περιοχή, αλλά είναι δυνατό να υποδείξετε **`service: <servicename>`** στο **`app.yml`** και να δημιουργήσετε ένα νέο service (μια νέα web). Η μορφή της διεύθυνσης URL για αυτή τη νέα web θα είναι **`<servicename>-dot-<project-uniq-name>.appspot.com`**.

### Απαρίθμηση

{% hint style="danger" %}
Κάθε φορά που ανεβάζετε νέο κώδικα στην εφαρμογή, **δημιουργείται μια νέα έκδοση**. **Όλες οι εκδόσεις αποθηκεύονται** και έχουν ακόμα μια **διεύθυνση URL για πρόσβαση**. Έτσι, η τροποποίηση του κώδικα μιας παλαιότερης έκδοσης μπορεί να αποτελέσει μια **εξαιρετική τεχνική διατήρησης**.
{% endhint %}

Όπως και με τις Cloud Functions, **υπάρχει πιθανότητα η εφαρμογή να βασίζεται σε μυστικά που προσπελαύνονται κατά την εκτέλεση μέσω μεταβλητών περιβάλλοντος**. Αυτές οι μεταβλητές αποθηκεύονται σε ένα αρχείο **`app.yaml`** το οποίο μπορεί να προσπελαστεί ως εξής:
```bash
# List the apps
gcloud app services list
gcloud app services describe <app-name>
# Access via browser to the specified app
gcloud app services browse <app-name>

# Get App versions
gcloud app versions list
# Get all the info of the app and version, included specific verion URL and the env
gcloud app versions describe -s <app-name> <version-id>

# Logs
gcloud app logs tail -s <app-name>

# Instances
## This is only valid if a flexible environment is used and not a standard one
gcloud app instances list
gcloud app instances describe -s <app-name> --version <version-id> <ID>
## Connect to the instance via ssh
gcloud app instances ssh --service <app-name> --version <version-id> <ID>

# Firewalls
gcloud app firewall-rules list
gcloud app firewall-rules describe <num_fw>

# Get domains
gcloud app domain-mappings list
gcloud app domain-mappings describe <name>

# SSl certificates
gcloud app ssl-certificates list
gcloud app ssl-certificates describe <name>
```
### Εscalation προνομίων

{% content-ref url="../gcp-privilege-escalation/gcp-appengine-privesc.md" %}
[gcp-appengine-privesc.md](../gcp-privilege-escalation/gcp-appengine-privesc.md)
{% endcontent-ref %}

### Ανεξέλεγκτη απαρίθμηση

{% content-ref url="../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-app-engine-unauthenticated-enum.md" %}
[gcp-app-engine-unauthenticated-enum.md](../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-app-engine-unauthenticated-enum.md)
{% endcontent-ref %}

### Μετά από εκμετάλλευση

{% content-ref url="../../gcp-security/gcp-post-exploitation/gcp-app-engine-post-exploitation.md" %}
[gcp-app-engine-post-exploitation.md](../../gcp-security/gcp-post-exploitation/gcp-app-engine-post-exploitation.md)
{% endcontent-ref %}

### Διατήρηση

{% content-ref url="../../gcp-security/gcp-persistence/gcp-app-engine-persistence.md" %}
[gcp-app-engine-persistence.md](../../gcp-security/gcp-persistence/gcp-app-engine-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο Hacking του AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Εκπαίδευση HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο Hacking του GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Εκπαίδευση HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε** 💬 στην [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα τηλεγραφήματος**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε κόλπα χάκινγκ υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια στο GitHub.

</details>
{% endhint %}
