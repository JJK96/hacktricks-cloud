# GCP - AppEngine Privilege Escalation

{% hint style="success" %}
AWS Hacking'ı öğrenin ve uygulayın: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katılın veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak PR'ler göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>
{% endhint %}

## App Engine

App Engine hakkında daha fazla bilgi için şuraya bakın:

{% content-ref url="../gcp-services/gcp-app-engine-enum.md" %}
[gcp-app-engine-enum.md](../gcp-services/gcp-app-engine-enum.md)
{% endcontent-ref %}

### `appengine.applications.get`, `appengine.instances.get`, `appengine.instances.list`, `appengine.operations.get`, `appengine.operations.list`, `appengine.services.get`, `appengine.services.list`, `appengine.versions.create`, `appengine.versions.get`, `appengine.versions.list`, `cloudbuild.builds.get`,`iam.serviceAccounts.actAs`, `resourcemanager.projects.get`, `storage.objects.create`, `storage.objects.list`

Bunlar, **`gcloud` cli** kullanarak bir Uygulama dağıtmak için gerekli izinlerdir. Belki **`get`** ve **`list`** olanlar **önlenmiş** olabilir.

Python kod örneklerini [https://github.com/GoogleCloudPlatform/python-docs-samples/tree/main/appengine](https://github.com/GoogleCloudPlatform/python-docs-samples/tree/main/appengine) adresinde bulabilirsiniz.

Varsayılan olarak, Uygulama servisinin adı **`default`** olacaktır ve aynı ada sahip yalnızca 1 örnek olabilir.\
Bunu değiştirmek ve ikinci bir Uygulama oluşturmak için, **`app.yaml`** dosyasında kök anahtarının değerini **`service: my-second-app`** gibi bir şeye değiştirin.
```bash
cd python-docs-samples/appengine/flexible/hello_world
gcloud app deploy #Upload and start application inside the folder
```
En az 10-15 dakika bekleyin, işe yaramazsa **başka bir dağıtım** çağırın ve birkaç dakika bekleyin.

{% hint style="info" %}
**Kullanılacak Hizmet Hesabını belirtmek mümkündür** ancak varsayılan olarak, App Engine varsayılan Hizmet Hesabı kullanılır.
{% endhint %}

Uygulamanın URL'si `https://<proj-adı>.oa.r.appspot.com/` veya `https://<servis_adı>-dot-<proj-adı>.oa.r.appspot.com` gibi bir şeydir.

### `appengine.instances.enableDebug`, `appengine.instances.get`, `appengine.instances.list`, `appengine.operations.get`, `appengine.services.get`, `appengine.services.list`, `appengine.versions.get`, `appengine.versions.list`, `compute.projects.get`

Bu izinlerle, **esnek** türündeki App Engine örneklerine **ssh üzerinden giriş yapmak mümkündür**. Bazı **`list`** ve **`get`** izinlerinin **gerçekten gerekli olmayabileceği** unutulmamalıdır.
```bash
gcloud app instances ssh --service <app-name> --version <version-id> <ID>
```
### `appengine.applications.update`, `appengine.operations.get`

Bence bu sadece arka planda kullanılacak SA google'ı değiştirir, bu yüzden bu özelliği kötüye kullanarak hizmet hesabını çalamazsınız.

{% code overflow="wrap" %}
```bash
gcloud app update --service-account=<sa_email>
```
### `appengine.versions.getFileContents`, `appengine.versions.update`

Bu izinleri nasıl kullanacağınızdan emin değilim veya bunların faydalı olup olmadığını (kodu değiştirdiğinizde yeni bir sürüm oluşturulur, bu yüzden sadece kodu mu yoksa birinin IAM rolünü mü güncelleyebileceğinizi bilmiyorum, ancak muhtemelen bunu yapabilirsiniz, belki kovadaki kodu değiştirerek??).

### Kovalar üzerinde Yazma Erişimi

Kaynak kodunun bulunduğu kovalara yazma erişimi olsa bile **kaynak kodunu ve `manifest.json`'ı değiştirerek keyfi kodu yürütmek MÜMKÜN DEĞİLDİR**.\
Belki yeni bir sürüm oluşturulduğu anda ve kaynak kodu ile manifest yüklendiği anda bu anı tespit edip, onları değiştirerek yeni sürümün backdoored olanları kullanmasını sağlamak mümkün olabilir mi??

Ayrıca, konteyner katmanlarının kovada depolandığı görünüyor, belki onları değiştirmek mümkün olabilir?

{% hint style="success" %}
AWS Hacking'i öğrenin ve uygulayın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitimi AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitimi GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katılın veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak PR'ler göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>
{% endhint %}
