# GCP - рдЕрдкрдиреА рд╡рд┐рд╢реЗрд╖ SSH рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдЬреЛрдбрд╝реЗрдВ

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг AWS рд░реЗрдб рдЯреАрдо рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг GCP рд░реЗрдб рдЯреАрдо рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВред

</details>
{% endhint %}

## рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ <a href="#modifying-the-metadata" id="modifying-the-metadata"></a>

рдПрдХ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдкрд░ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рд╕рдВрд╢реЛрдзрди **рднрд╛рд░реА рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо** рдХреЗ рд▓рд┐рдП рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдкрд░ рд▓реЗ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЕрдЧрд░ рдХреЛрдИ рд╣рдорд▓рд╛рд╡рд░ рдЖрд╡рд╢реНрдпрдХ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд▓реЗрддрд╛ рд╣реИред

### **рдХрд╕реНрдЯрдо рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдореЗрдВ SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛**

GCP рдкрд░, **Linux рд╕рд┐рд╕реНрдЯрдо** рдЕрдХреНрд╕рд░ [Google Compute Engine рдХреЗ рд▓рд┐рдП Python Linux Guest Environment](https://github.com/GoogleCloudPlatform/compute-image-packages/tree/master/packages/python-google-compute-engine#accounts) рд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рддреЗ рд╣реИрдВред рдЗрд╕рдХрд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдШрдЯрдХ рд╣реИ [рдЕрдХрд╛рдЙрдВрдЯреНрд╕ рдбреЗрдорди](https://github.com/GoogleCloudPlatform/compute-image-packages/tree/master/packages/python-google-compute-engine#accounts), рдЬреЛ рдирд┐рд░рдВрддрд░ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреА рдЕрдкрдбреЗрдЯ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддрд╛рдХрд┐ рдЕрдзрд┐рдХреГрдд SSH рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдкрдбреЗрдЯ рд╣реЛ рд╕рдХреЗрдВред

рдЗрд╕рд▓рд┐рдП, рдЕрдЧрд░ рдХреЛрдИ рд╣рдорд▓рд╛рд╡рд░ рдХрд╕реНрдЯрдо рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдбреЗрдорди рдХреЛ рдПрдХ рдирдИ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдорд┐рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рд╕реНрдерд╛рдиреАрдп рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ **рдПрдХреАрдХреГрдд рдХреА рдЬрд╛рдПрдЧреА**ред рдХреБрдВрдЬреА рдХреЛ `~/.ssh/authorized_keys` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ **рдореМрдЬреВрджрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдореЗрдВ рдЬреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдпрд╛ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ `sudo` рдЕрдзрд┐рдХрд╛рд░реЛрдВ рд╡рд╛рд▓реЗ рдирдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**, рдХреБрдВрдЬреА рдХреЗ рдкреНрд░рд╛рд░реВрдк рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред рдФрд░ рд╣рдорд▓рд╛рд╡рд░ рд╣реЛрд╕реНрдЯ рдХреЛ рдХрдВрдкреНрд░рдорд╛рдЗрдЬрд╝ рдХрд░ рд╕рдХреЗрдЧрд╛ред

### **рдореМрдЬреВрджрд╛ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдореЗрдВ SSH рдХреБрдВрдЬреА рдЬреЛрдбрд╝реЗрдВ**

1. **рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдкрд░ рдореМрдЬреВрджрд╛ SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:**
- рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдФрд░ рдЙрд╕рдХреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХрд╛ рд╡рд┐рд╡рд░рдг рд╡рд┐рд╡рд░рдгреАрдп рд╢реИрд▓реА рдореЗрдВ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрджреЗрд╢ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ рддрд╛рдХрд┐ рдореМрдЬреВрджрд╛ SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рдвреВрдВрдв рд╕рдХреЗрдВред рдЙрддреНрдкрд╛рджрди рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рдЦрдВрдб `metadata` рдХреЗ рдЕрдВрддрд░реНрдЧрдд рд╣реЛрдЧрд╛, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ `ssh-keys` рдХреБрдВрдЬреА рдХреЗ рддрд╣рддред
```bash
gcloud compute instances describe [INSTANCE] --zone [ZONE]
```
- SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЗ рдкреНрд░рд╛рд░реВрдк рдкрд░ рдзреНрдпрд╛рди рджреЗрдВ: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреБрдВрдЬреА рдХреЗ рдЖрдЧреЗ рдХреЛрд▓рди рдЖрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдПрдХ рдЕрдВрддрд░рд╛рд▓ рджреНрд╡рд╛рд░рд╛ рдЕрд▓рдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

2. **SSH рдХреБрдВрдЬреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдкрд╛рда рдлрд╝рд╛рдЗрд▓ рддреИрдпрд╛рд░ рдХрд░реЗрдВ:**
- рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд╡рд┐рд╡рд░рдг рдФрд░ рдЙрдирдХреА рд╕рдВрдмрдВрдзрд┐рдд SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ `meta.txt` рдирд╛рдордХ рдПрдХ рдкрд╛рда рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВред рдпрд╣ рдирдП рдХреБрдВрдЬрд┐рдпреЛрдВ рдЬреЛрдбрд╝рддреЗ рд╕рдордп рдореМрдЬреВрджрд╛ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред

3. **рд▓рдХреНрд╖рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ (`alice` рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ) рдХреЗ рд▓рд┐рдП рдПрдХ рдирдИ SSH рдХреБрдВрдЬреА рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ:**
- рдирдП SSH рдХреБрдВрдЬреА рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `ssh-keygen` рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЯрд╛рд░рдЧреЗрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдЯрд┐рдкреНрдкрдгреА рдХреНрд╖реЗрддреНрд░ (`-C`) рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдирд╛рдо рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред
```bash
ssh-keygen -t rsa -C "alice" -f ./key -P "" && cat ./key.pub
```
- рдирдИ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХреЛ `meta.txt` рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ, рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдореЗрдВ рдкрд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░рд╛рд░реВрдк рдХреА рддрд░рд╣ред

4. **рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреА SSH рдХреБрдВрдЬреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ:**
- `gcloud compute instances add-metadata` рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдкрд░ рдЕрдкрдбреЗрдЯреЗрдб SSH рдХреБрдВрдЬреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рд▓рд╛рдЧреВ рдХрд░реЗрдВред
```bash
gcloud compute instances add-metadata [INSTANCE] --metadata-from-file ssh-keys=meta.txt
```

5. **рдирдИ SSH рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рддрдХ рдкрд╣реБрдВрдЪреЗрдВ:**
- рдирдИ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рд╕реЗ SSH рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВ, рд▓рдХреНрд╖рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдо
```bash
# define the new account username
NEWUSER="definitelynotahacker"

# create a key
ssh-keygen -t rsa -C "$NEWUSER" -f ./key -P ""

# create the input meta file
NEWKEY="$(cat ./key.pub)"
echo "$NEWUSER:$NEWKEY" > ./meta.txt

# update the instance metadata
gcloud compute instances add-metadata [INSTANCE_NAME] --metadata-from-file ssh-keys=meta.txt

# ssh to the new account
ssh -i ./key "$NEWUSER"@localhost
```
### рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕реНрддрд░ рдкрд░ SSH рдХреБрдВрдЬрд┐рдпрд╛рдБ <a href="#sshing-around" id="sshing-around"></a>

рдПрдХ рдХреНрд▓рд╛рдЙрдб рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ **рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕реНрддрд░ рдкрд░ SSH рдХреБрдВрдЬрд┐рдпрд╛рдБ рд▓рд╛рдЧреВ рдХрд░рдХреЗ** рдПрд╕рдПрд╕рдПрдЪ рдПрдХреНрд╕реЗрд╕ рдХреА рд░реЗрдВрдЬ рдХреЛ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд┐рд╕реА рднреА рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдореЗрдВ рдПрд╕рдПрд╕рдПрдЪ рдПрдХреНрд╕реЗрд╕ рдХреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдкрд░рд┐рдпреЛрдЬрдирд╛ рднрд░ рдореЗрдВ рдПрд╕рдПрд╕рдПрдЪ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ рдирд╣реАрдВ рдмреНрд▓реЙрдХ рдХрд┐рдпрд╛ рд╣реИред рдпрд╣рд╛рдВ рдПрдХ рд╕рдВрдХреНрд╖реЗрдкрд┐рдд рдорд╛рд░реНрдЧрджрд░реНрд╢рд┐рдХрд╛ рд╣реИ:

1. **рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕реНрддрд░ рдкрд░ SSH рдХреБрдВрдЬрд┐рдпрд╛рдБ рд▓рд╛рдЧреВ рдХрд░реЗрдВ:**
- `gcloud compute project-info add-metadata` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ `meta.txt` рд╕реЗ SSH рдХреБрдВрдЬрд┐рдпрд╛рдБ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдореЗрдВ рдЬреЛрдбрд╝ рд╕рдХреЗрдВред рдпрд╣ рдХрд╛рд░реНрд░рд╡рд╛рдИ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рдПрд╕рдПрд╕рдПрдЪ рдХреБрдВрдЬрд┐рдпрд╛рдБ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд╕рднреА рд╡реАрдПрдо рдореЗрдВ рдорд╛рдиреНрдп рд╣реИрдВ, рдЬрдм рддрдХ рдПрдХ рд╡реАрдПрдо рдореЗрдВ "рдмреНрд▓реЙрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕реНрддрд░ рдПрд╕рдПрд╕рдПрдЪ рдХреБрдВрдЬрд┐рдпрд╛рдБ" рд╡рд┐рдХрд▓реНрдк рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реИред
```bash
gcloud compute project-info add-metadata --metadata-from-file ssh-keys=meta.txt
```

2. **рдкрд░рд┐рдпреЛрдЬрдирд╛-рд╕реНрддрд░ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдореЗрдВ SSH:**
- рдкрд░рд┐рдпреЛрдЬрдирд╛-рд╕реНрддрд░ рдХреА SSH рдХреБрдВрдЬрд┐рдпрд╛рдБ рд▓рд╛рдЧреВ рд╣реЛрдиреЗ рдкрд░, рдЖрдк рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рднреАрддрд░ рдХрд┐рд╕реА рднреА рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдореЗрдВ SSH рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдкрд░рд┐рдпреЛрдЬрдирд╛-рд╕реНрддрд░ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рдмреНрд▓реЙрдХ рдирд╣реАрдВ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдПрд╕рдПрд╕рдПрдЪ рдХреБрдВрдЬреА рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВрдЧреЗ, рдЬрд┐рд╕рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдорд┐рд▓реЗрдЧрд╛ред
- рдПрдХ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдореЗрдВ SSH рдХрд░рдиреЗ рдХрд╛ рд╕реАрдзрд╛ рддрд░реАрдХрд╛ `gcloud compute ssh [INSTANCE]` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИред рдпрд╣ рдХрдорд╛рдВрдб рдЖрдкрдХреЗ рд╡рд░реНрддрдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕реНрддрд░ рдкрд░ рд╕реЗрдЯ рдХреА рдЧрдИ рдПрд╕рдПрд╕рдПрдЪ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдПрдХреНрд╕реЗрд╕ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред


# рд╕рдВрджрд░реНрдн
* [https://about.gitlab.com/blog/2020/02/12/plundering-gcp-escalating-privileges-in-google-cloud-platform/](https://about.gitlab.com/blog/2020/02/12/plundering-gcp-escalating-privileges-in-google-cloud-platform/)
