# GCP - Enumera√ß√£o de Reposit√≥rios de Origem

{% hint style="success" %}
Aprenda e pratique Hacking AWS: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Treinamento HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Treinamento HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoie o HackTricks</summary>

* Verifique os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

## Informa√ß√µes B√°sicas <a href="#reviewing-cloud-git-repositories" id="reviewing-cloud-git-repositories"></a>

Os Reposit√≥rios de Origem do Google Cloud s√£o um servi√ßo de **reposit√≥rio Git privado**, totalmente funcional e escal√°vel. Ele √© projetado para **hospedar seu c√≥digo-fonte em um ambiente totalmente gerenciado**, integrando-se perfeitamente com outras ferramentas e servi√ßos do GCP. Oferece um local colaborativo e seguro para equipes armazenarem, gerenciarem e rastrearem seu c√≥digo.

Principais recursos dos Reposit√≥rios de Origem do Cloud incluem:

1. **Hospedagem Git Totalmente Gerenciada**: Oferece a funcionalidade familiar do Git, o que significa que voc√™ pode usar comandos e fluxos de trabalho regulares do Git.
2. **Integra√ß√£o com Servi√ßos do GCP**: Integra-se com outros servi√ßos do GCP como Cloud Build, Pub/Sub e App Engine para rastreabilidade de ponta a ponta do c√≥digo √† implanta√ß√£o.
3. **Reposit√≥rios Privados**: Garante que seu c√≥digo seja armazenado de forma segura e privada. Voc√™ pode controlar o acesso usando fun√ß√µes de Gerenciamento de Identidade e Acesso (IAM) do Cloud.
4. **An√°lise de C√≥digo-Fonte**: Funciona com outras ferramentas do GCP para fornecer an√°lise automatizada do seu c√≥digo-fonte, identificando problemas potenciais como bugs, vulnerabilidades ou pr√°ticas de codifica√ß√£o ruins.
5. **Ferramentas de Colabora√ß√£o**: Suporta codifica√ß√£o colaborativa com ferramentas como solicita√ß√µes de mesclagem, coment√°rios e revis√µes.
6. **Suporte a Espelhamento**: Permite conectar os Reposit√≥rios de Origem do Cloud com reposit√≥rios hospedados no GitHub ou Bitbucket, possibilitando a sincroniza√ß√£o autom√°tica e fornecendo uma visualiza√ß√£o unificada de todos os seus reposit√≥rios.

### Informa√ß√µes OffSec <a href="#reviewing-cloud-git-repositories" id="reviewing-cloud-git-repositories"></a>

* A configura√ß√£o dos reposit√≥rios de origem dentro de um projeto ter√° uma **Conta de Servi√ßo** usada para publicar mensagens do Cloud Pub/Sub. A padr√£o usada √© a **Conta de Servi√ßo de Computa√ß√£o**. No entanto, **n√£o acredito que seja poss√≠vel roubar seu token** dos Reposit√≥rios de Origem, pois est√° sendo executado em segundo plano.
* Para ver o c√≥digo dentro do console web dos Reposit√≥rios de Origem do GCP ([https://source.cloud.google.com/](https://source.cloud.google.com/)), √© necess√°rio que o c√≥digo esteja **dentro do branch master por padr√£o**.
* Voc√™ tamb√©m pode **criar um Reposit√≥rio de Nuvem espelhado** apontando para um reposit√≥rio do **Github** ou **Bitbucket** (dando acesso a essas plataformas).
* √â poss√≠vel **codificar e depurar de dentro do GCP**.
* Por padr√£o, os Reposit√≥rios de Origem **impedem que chaves privadas sejam enviadas nos commits**, mas isso pode ser desativado.

### Abrir no Cloud Shell

√â poss√≠vel abrir o reposit√≥rio no Cloud Shell, um prompt como este aparecer√°:

<figure><img src="../../../.gitbook/assets/image (325).png" alt=""><figcaption></figcaption></figure>

Isso permitir√° que voc√™ codifique e depure no Cloud Shell (o que poderia comprometer o cloudshell).

### Enumera√ß√£o

{% code overflow="wrap" %}
```bash
# Repos enumeration
gcloud source repos list #Get names and URLs
gcloud source repos describe <repo_name>
gcloud source repos get-iam-policy <repo_name>

# gcloud repo clone
gcloud source repos clone <REPO NAME>
gcloud source repos get-iam-policy <REPO NAME>
... git add & git commit -m ...
git push --set-upstream origin master
git push -u origin master

# Access via git
## To add a SSH key go to https://source.cloud.google.com/user/ssh_keys (no gcloud command)
git clone ssh://username@domain.com@source.developers.google.com:2022/p/<proj-name>/r/<repo-name>
git add, commit, push...
```
{% endcode %}

### Escala√ß√£o de Privil√©gios e P√≥s-Explora√ß√£o

{% content-ref url="../gcp-privilege-escalation/gcp-sourcerepos-privesc.md" %}
[gcp-sourcerepos-privesc.md](../gcp-privilege-escalation/gcp-sourcerepos-privesc.md)
{% endcontent-ref %}

### Enumera√ß√£o N√£o Autenticada

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-source-repositories-unauthenticated-enum.md" %}
[gcp-source-repositories-unauthenticated-enum.md](../gcp-unaunthenticated-enum-and-access/gcp-source-repositories-unauthenticated-enum.md)
{% endcontent-ref %}

{% hint style="success" %}
Aprenda e pratique Hacking em AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprenda e pratique Hacking em GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Suporte ao HackTricks</summary>

* Verifique os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
