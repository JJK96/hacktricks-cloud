# GCP - Cloud Run Enum

{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter**'da **bizi takip edin** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}

## Cloud Run <a href="#reviewing-cloud-run-configurations" id="reviewing-cloud-run-configurations"></a>

Cloud Run, Google'ın ölçeklenebilir altyapısının üzerinde doğrudan **konteyner çalıştırmanıza** olanak tanıyan sunucusuz yönetilen bir hesaplama platformudur.

Konteynerinizi çalıştırabilir veya Go, Node.js, Python, Java, .NET Core veya Ruby kullanıyorsanız, **konteyneri sizin için oluşturan** [source-based deployment](https://cloud.google.com/run/docs/deploying-source-code) seçeneğini kullanabilirsiniz.

Google, Cloud Run'ı **Google Cloud'daki diğer hizmetlerle iyi çalışacak şekilde** inşa etmiştir, böylece tam özellikli uygulamalar oluşturabilirsiniz.

### Hizmetler ve işler <a href="#services-and-jobs" id="services-and-jobs"></a>

Cloud Run'da, kodunuz ya bir _**hizmet**_ olarak ya da bir _**iş**_ olarak sürekli çalışabilir. Hem hizmetler hem de işler aynı ortamda çalışır ve Google Cloud'daki diğer hizmetlerle aynı entegrasyonları kullanabilir.

* **Cloud Run hizmetleri.** Web isteklerine veya olaylara yanıt veren kodu çalıştırmak için kullanılır.
* **Cloud Run işleri.** İş yapan (bir iş) kodu çalıştırmak ve iş tamamlandığında çıkmak için kullanılır.

## Cloud Run Hizmeti

Google [Cloud Run](https://cloud.google.com/run), çevresel değişkenleri arayabileceğiniz başka bir sunucusuz tekliftir. Cloud Run, varsayılan olarak konteyner içinde 8080 numaralı portta çalışan küçük bir web sunucusu oluşturur ve bir HTTP GET isteği bekler. İstek alındığında, bir iş yürütülür ve iş günlüğü bir HTTP yanıtı aracılığıyla çıktılanır.

### İlgili detaylar

* **Varsayılan olarak**, web sunucusuna **erişim** **genel** olup, **iç trafikle** (VPC...) **sınırlı** hale getirilebilir.\
Ayrıca, web sunucusuna erişim için **tümünü kabul etme** veya **IAM aracılığıyla kimlik doğrulama gerektirme** seçenekleri vardır.
* Varsayılan olarak, **şifreleme** **Google yönetimli anahtar** kullanır, ancak **KMS**'den bir **CMEK** (Müşteri Yönetimli Şifreleme Anahtarı) de **seçilebilir**.
* **Varsayılan olarak**, kullanılan **hizmet hesabı** **Compute Engine varsayılanı**dır ve projeye **Editör** erişimi vardır ve **`cloud-platform`** kapsamına sahiptir.
* Çalışma için **düz metin çevresel değişkenleri** tanımlamak mümkündür ve hatta **bulut sırlarını monte etmek** veya **çevresel değişkenlere bulut sırları eklemek** mümkündür.
* **Cloud SQL ile bağlantılar eklemek** ve **bir dosya sistemi monte etmek** de mümkündür.
* Dağıtılan hizmetlerin **URL'leri** **`https://<svc-name>-<random>.a.run.app`** formatına benzer.
* Bir Run Hizmeti, **1'den fazla versiyon veya revizyon** alabilir ve **birden fazla revizyon arasında trafiği bölüştürebilir**.

### Enumeration
```bash
# List services
gcloud run services list
gcloud run services list --platform=managed
gcloud run services list --platform=gke

# Get info of a service
gcloud run services describe --region <region> <svc-name>

# Get info of all the services together
gcloud run services list --format=yaml
gcloud run services list --platform=managed --format=json
gcloud run services list --platform=gke --format=json

# Get policy
gcloud run services get-iam-policy --region <region> <svc-name>

# Get revisions
gcloud run revisions list --region <region>
gcloud run revisions describe --region <region> <revision>

# Get domains
gcloud run domain-mappings list
gcloud run domain-mappings describe <name>

# Attempt to trigger a job unauthenticated
curl <url>

# Attempt to trigger a job with your current gcloud authorization
curl -H "Authorization: Bearer $(gcloud auth print-identity-token)" <url>
```
## Cloud Run İşleri

Cloud Run işleri, **tamamlanmak için çalışan ve istekleri sunmayan konteynerler için daha uygun** bir seçenektir. İşlerin istekleri sunma veya bir portta dinleme yeteneği yoktur. Bu, Cloud Run hizmetlerinin aksine, işlerin bir web sunucusu içermemesi gerektiği anlamına gelir. Bunun yerine, iş konteynerleri işlerini bitirdiklerinde çıkmalıdır.

### Sayım
```bash
gcloud beta run jobs list
gcloud beta run jobs describe --region <region> <job-name>
gcloud beta run jobs get-iam-policy --region <region> <job-name>
```
## Yetki Yükseltme

Aşağıdaki sayfada, **bulut çalıştırma izinlerini kötüye kullanarak yetki yükseltmeyi** nasıl gerçekleştirebileceğinizi kontrol edebilirsiniz:

{% content-ref url="../gcp-privilege-escalation/gcp-run-privesc.md" %}
[gcp-run-privesc.md](../gcp-privilege-escalation/gcp-run-privesc.md)
{% endcontent-ref %}

## Kimlik Doğrulaması Olmadan Erişim

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md" %}
[gcp-cloud-run-unauthenticated-enum.md](../gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md)
{% endcontent-ref %}

## Sömürü Sonrası

{% content-ref url="../gcp-post-exploitation/gcp-cloud-run-post-exploitation.md" %}
[gcp-cloud-run-post-exploitation.md](../gcp-post-exploitation/gcp-cloud-run-post-exploitation.md)
{% endcontent-ref %}

## Süreklilik

{% content-ref url="../gcp-persistence/gcp-cloud-run-persistence.md" %}
[gcp-cloud-run-persistence.md](../gcp-persistence/gcp-cloud-run-persistence.md)
{% endcontent-ref %}

## Referanslar

* [https://cloud.google.com/run/docs/overview/what-is-cloud-run](https://cloud.google.com/run/docs/overview/what-is-cloud-run)

{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}
