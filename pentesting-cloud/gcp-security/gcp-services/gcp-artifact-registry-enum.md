# GCP - Artifact Registry Enum

{% hint style="success" %}
AWS Hacking öğrenin ve pratik yapın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking öğrenin ve pratik yapın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katılın veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* Hacking püf noktalarını paylaşarak PR'ler göndererek **HackTricks** ve **HackTricks Cloud** github depolarına katkıda bulunun.

</details>
{% endhint %}

## Temel Bilgiler

Google Cloud Artifact Registry, yazılım artefaktlarınızı **yönetmenize, depolamanıza ve güvenliğinizi sağlamanıza olanak tanıyan tamamen yönetilen bir hizmettir**. Temelde, **Docker** imajları, **Maven**, npm paketleri ve diğer türdeki artefaktlar gibi **derleme bağımlılıklarını depolamak** için bir depo görevi görür. Genellikle, yazılım geliştirme süreci sırasında üretilen artefaktları depolamak ve sürümlemek için **CI/CD borularında yaygın olarak kullanılır**.

Artifact Registry'nin temel özellikleri şunları içerir:

1. **Birleşik Depo**: **Çeşitli türdeki artefaktları** destekleyerek Docker imajları, dil paketleri (Java'nın Maven'i, Node.js'nin npm'si) ve diğer türdeki artefaktlar için tek bir depoya sahip olmanıza olanak tanır, böylece tüm artefaktlarınızda tutarlı erişim kontrolleri ve birleşik bir görünüm sağlar.
2. **Tamamen Yönetilen**: Yönetilen bir hizmet olarak, altta yatan altyapıyı, ölçeklendirmeyi ve güvenliği yönetir, kullanıcılar için bakım gereksinimlerini azaltır.
3. **İnce Tanımlı Erişim Kontrolü**: Google Cloud'un Kimlik ve Erişim Yönetimi (IAM) ile entegre olarak, depolarınızdaki artefaklara kimlerin erişebileceğini, yükleyebileceğini veya indirebileceğini tanımlamanıza olanak tanır.
4. **Coğrafi Çoğaltma**: Birden fazla bölgeye artefaktların çoğaltılmasını destekler, indirme hızını artırır ve kullanılabilirliği sağlar.
5. **Google Cloud Hizmetleriyle Entegrasyon**: **Cloud Build, Kubernetes Engine ve Compute Engine** gibi **diğer GCP hizmetleriyle sorunsuz çalışır**, Google Cloud ekosistemi içinde zaten çalışan ekipler için uygun bir seçenektir.
6. **Güvenlik**: Depolanan artefaktların güvenli ve bilinen güvenlik sorunlarından arındığından emin olmak için **zayıflık taraması ve konteyner analizi** gibi özellikler sunar.

### Formatlar ve Modlar

Yeni bir depo oluşturulurken, depo **format/türü** arasından Docker, Maven, npm, Python gibi birini seçmek mümkündür ve genellikle şu üçten biri olabilir:

* **Standart Depo**: **Kendi artefaktlarınızı** (Docker imajları, Maven paketleri gibi) doğrudan GCP'de depolamak için varsayılan mod. Güvenli, ölçeklenebilir ve Google Cloud ekosistemi içinde iyi entegre olur.
* **Uzak Depo** (müsaitse): Dış, genel depolardan artefaktları **ön belleğe alan bir proxy** olarak görev yapar. Bağımlılıkların yukarı akışta değişmesini engeller ve sık erişilen artefaktları önbelleğe alarak gecikmeyi azaltır.
* **Sanal Depo** (müsaitse): Birden fazla (standart veya uzak) depoya **tek bir uç noktadan erişim sağlayan birleşik bir arayüz** sağlar, farklı depolara yayılmış artefaktlar için istemci tarafı yapılandırmasını ve erişim yönetimini basitleştirir.
* Sanal bir depoda **depoları seçmeli ve onlara bir öncelik vermeli**siniz (en büyük önceliğe sahip depo kullanılacaktır).
* **Sanal** bir depoda **uzak ve standart** depoları **karıştırabilirsiniz**, **uzak** depodaki **öncelik**, **standart** depodan daha büyükse, **uzaktan (örneğin PyPi) paketler kullanılacaktır**. Bu, bir **Bağımlılık Karışıklığına** yol açabilir.

Docker'ın **Uzak sürümünde** Docker Hub'a erişmek için bir kullanıcı adı ve belirteç vermek mümkündür. **Belirteç daha sonra Secret Manager'da saklanır**.

### Şifreleme

Beklendiği gibi, varsayılan olarak bir Google tarafından yönetilen anahtar kullanılır, ancak Müşteri tarafından yönetilen bir anahtar (CMEK) belirtilebilir.

### Temizlik Politikaları

* **Artefaktları sil:** Artefaktlar, temizlik politikası kriterlerine göre **silinecektir**.
* **Kuru çalıştırma:** (Varsayılan olan) Artefaktlar **silinmeyecek**. Temizlik politikaları değerlendirilecek ve test silme olayları Cloud Audit Logging'e gönderilecektir.

### Zayıflık Taraması

**Konteyner imajları** içindeki zayıflıkları kontrol edecek olan **zayıflık tarayıcısını etkinleştirmek mümkündür**.

### Numaralandırma
```bash
# Get repositories
gcloud artifacts repositories list
gcloud artifacts repositories describe --location <location> <repo-name>
gcloud artifacts versions list --repository=<repo-name> -location <location> --package <package-name>

# Get settings of a repository (example using python but could be other)
gcloud artifacts print-settings python --repository <repo-name> --location <location>

# Get docker images
gcloud artifacts docker images list us-central1-docker.pkg.dev/<proj-name>/<repo-name>

# Get packages (like python and others...)
gcloud artifacts packages list --repository <repo-name> --location <location>

# Get SBOMB artifacts
gcloud artifacts sbom list

# Get vulnerabilities (docker images)
gcloud artifacts vulnerabilities list us-east1-docker.pkg.dev/project123/repository123/someimage@sha256:49765698074d6d7baa82f
gcloud artifacts docker images list-vulnerabilities projects/<proj-name>/locations/<location>/scans/<scan-uuid>
```
### Yetki Yükseltme

{% content-ref url="../gcp-privilege-escalation/gcp-artifact-registry-privesc.md" %}
[gcp-artifact-registry-privesc.md](../gcp-privilege-escalation/gcp-artifact-registry-privesc.md)
{% endcontent-ref %}

### Kimlik Doğrulamasız Erişim

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-artifact-registry-unauthenticated-enum.md" %}
[gcp-artifact-registry-unauthenticated-enum.md](../gcp-unaunthenticated-enum-and-access/gcp-artifact-registry-unauthenticated-enum.md)
{% endcontent-ref %}

### Saldırı Sonrası

{% content-ref url="../gcp-post-exploitation/gcp-artifact-registry-post-exploitation.md" %}
[gcp-artifact-registry-post-exploitation.md](../gcp-post-exploitation/gcp-artifact-registry-post-exploitation.md)
{% endcontent-ref %}

### Kalıcılık

{% content-ref url="../gcp-persistence/gcp-artifact-registry-persistence.md" %}
[gcp-artifact-registry-persistence.md](../gcp-persistence/gcp-artifact-registry-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
AWS Hacking öğrenin ve pratik yapın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitimi AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking öğrenin ve pratik yapın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitimi GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak PR göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>
{% endhint %}
