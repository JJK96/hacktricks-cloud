# GCP - Sanal Depo Sıralama

<details>

<summary><strong>Sıfırdan kahraman olmak için AWS hackleme öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARI**]'na (https://github.com/sponsors/carlospolop) göz atın!
* [**Resmi PEASS & HackTricks ürünleri**]'ni alın (https://peass.creator-spring.com)
* [**PEASS Ailesi**]'ni keşfedin (https://opensea.io/collection/the-peass-family), özel [**NFT'ler**]'imiz koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**'ı takip edin.**
* **Hacking püf noktalarınızı paylaşarak PR'lar göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)
* &#x20;github depoları.

</details>

## Temel Bilgiler

Google Cloud Artifact Registry, yazılım artefaktlarınızı **yönetmenize, depolamanıza ve güvenliğinizi sağlamanıza olanak tanıyan tamamen yönetilen bir hizmettir**. Temelde, **Docker** görüntüleri, **Maven**, npm paketleri ve diğer türdeki artefaktlar gibi **derleme bağımlılıklarını depolamak için bir depo** işlevi görür. Yazılım geliştirme süreci sırasında üretilen artefaktların depolanması ve sürüm kontrolü için **CI/CD borularında yaygın olarak kullanılır**.

Artifact Registry'nin temel özellikleri şunları içerir:

1. **Birleşik Depo**: **Çeşitli türdeki artefaktları destekler**, Docker görüntüleri, dil paketleri (Java'nın Maven'i, Node.js'nin npm'si gibi) ve diğer türdeki artefaktlar için tek bir depoya sahip olmanıza olanak tanır, böylece tüm artefaktlarınızda tutarlı erişim kontrolleri ve birleşik bir görünüm sağlar.
2. **Tamamen Yönetilen**: Yönetilen bir hizmet olarak, altta yatan altyapıyı, ölçeklendirmeyi ve güvenliği yönetir, kullanıcılar için bakım gereksinimlerini azaltır.
3. **İnce Tanımlı Erişim Kontrolü**: Google Cloud'un Kimlik ve Erişim Yönetimi (IAM) ile entegre olur, depolarınızdaki artefaklara kimlerin erişebileceğini, yükleyebileceğini veya indirebileceğini tanımlamanıza olanak tanır.
4. **Coğrafi Çoğaltma**: Birden fazla bölgeye artefaktların çoğaltılmasını destekler, indirme hızını artırır ve kullanılabilirliği sağlar.
5. **Google Cloud Hizmetleriyle Entegrasyon**: **Cloud Build, Kubernetes Engine ve Compute Engine gibi diğer GCP hizmetleriyle sorunsuz çalışır**, Google Cloud ekosistemi içinde zaten çalışan ekipler için uygun bir seçenek olmasını sağlar.
6. **Güvenlik**: **Depolanan artefaktların güvenli ve bilinen güvenlik sorunlarından arındığından emin olmak için zayıflık taraması ve konteyner analizi gibi özellikler sunar**.

### Biçimler ve Modlar

Yeni bir depo oluşturulurken, depo **biçim/türü** arasından Docker, Maven, npm, Python gibi çeşitli seçenekler arasından seçim yapılabilir ve genellikle şu üç moddan biri olabilir:

* **Standart Depo**: **Kendi artefaktlarınızı (Docker görüntüleri, Maven paketleri gibi)** doğrudan GCP'de depolamak için varsayılan moddur. Güvenlidir, ölçeklenebilir ve Google Cloud ekosistemi içinde iyi entegre olur.
* **Uzak Depo** (müsaitse): Dış, genel depolardan **arteaktları önbelleğe alan bir proxy** olarak hareket eder. Yukarı akıştaki bağımlılıkların değişmesini önler ve sık erişilen artefaktları önbelleğe alarak gecikmeyi azaltır.
* **Sanal Depo** (müsaitse): **Tek bir uç noktadan birden fazla (standart veya uzak) depoya erişim sağlayan bir birleşik arayüz** sunar, farklı depolara yayılmış artefaktlar için istemci tarafı yapılandırmasını ve erişim yönetimini basitleştirir.
* Sanal bir depo için **depoları seçmeniz ve onlara bir öncelik vermeniz gerekecektir** (en yüksek önceliğe sahip depo kullanılacaktır).
* **Sanal** bir depoda **uzak ve standart** depoları **karıştırabilirsiniz**, **uzak** depodaki **öncelik** standarttan **büyükse, uzaktan (örneğin PyPi) paketler kullanılacaktır**. Bu, bir **Bağımlılık Karışıklığına** yol açabilir.

Docker'ın **Uzak sürümünde** Docker Hub'a erişmek için bir kullanıcı adı ve belirteç vermek mümkündür. **Belirteç daha sonra Secret Manager'da saklanır**.

### Şifreleme

Beklendiği gibi, varsayılan olarak bir Google tarafından yönetilen anahtar kullanılır ancak Müşteri tarafından yönetilen bir anahtar belirtilebilir (CMEK).

### Temizleme Politikaları

* **Artefaktları silme:** Artefaktlar, temizlik politikasına göre **silinecektir**.
* **Kuru çalıştırma:** (Varsayılan olan) Artefaktlar **silinmeyecek**. Temizlik politikaları değerlendirilecek ve test silme olayları Cloud Audit Logging'e gönderilecektir.

### Zayıflık Taraması

**Konteyner görüntüleri içindeki zayıflıkları kontrol edecek olan zayıflık tarayıcısını etkinleştirmek mümkündür**.

### Sıralama
```bash
# Get repositories
gcloud artifacts repositories list
gcloud artifacts repositories describe --location <location> <repo-name>
gcloud artifacts versions list --repository=<repo-name> -location <location> --package <package-name>

# Get settings of a repository (example using python but could be other)
gcloud artifacts print-settings python --repository <repo-name> --location <location>

# Get docker images
gcloud artifacts docker images list us-central1-docker.pkg.dev/<proj-name>/<repo-name>

# Get packages (like python and others...)
gcloud artifacts packages list --repository <repo-name> --location <location>

# Get SBOMB artifacts
gcloud artifacts sbom list

# Get vulnerabilities (docker images)
gcloud artifacts vulnerabilities list us-east1-docker.pkg.dev/project123/repository123/someimage@sha256:49765698074d6d7baa82f
gcloud artifacts docker images list-vulnerabilities projects/<proj-name>/locations/<location>/scans/<scan-uuid>
```
### Yetki Yükseltme

{% content-ref url="../gcp-privilege-escalation/gcp-artifact-registry-privesc.md" %}
[gcp-artifact-registry-privesc.md](../gcp-privilege-escalation/gcp-artifact-registry-privesc.md)
{% endcontent-ref %}

### Kimlik Doğrulamasız Erişim

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-artifact-registry-unauthenticated-enum.md" %}
[gcp-artifact-registry-unauthenticated-enum.md](../gcp-unaunthenticated-enum-and-access/gcp-artifact-registry-unauthenticated-enum.md)
{% endcontent-ref %}

### Saldırı Sonrası

{% content-ref url="../gcp-post-exploitation/gcp-artifact-registry-post-exploitation.md" %}
[gcp-artifact-registry-post-exploitation.md](../gcp-post-exploitation/gcp-artifact-registry-post-exploitation.md)
{% endcontent-ref %}

### Kalıcılık

{% content-ref url="../gcp-persistence/gcp-artifact-registry-persistence.md" %}
[gcp-artifact-registry-persistence.md](../gcp-persistence/gcp-artifact-registry-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
AWS Hacking'i öğrenin ve uygulayın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitimi AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitimi GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katılın veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* Hacking püf noktalarını paylaşarak PR'ler göndererek **HackTricks** ve **HackTricks Cloud** github depolarına katkıda bulunun.

</details>
{% endhint %}
