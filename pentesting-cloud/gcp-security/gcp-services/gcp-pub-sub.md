# GCP - Pub/Sub Sıralama

{% hint style="success" %}
AWS Hacking'i öğrenin ve uygulayın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katılın veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak PR'ler göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>
{% endhint %}

## Pub/Sub <a href="#reviewing-cloud-pubsub" id="reviewing-cloud-pubsub"></a>

[Google **Cloud Pub/Sub**](https://cloud.google.com/pubsub/), bağımsız uygulamalar arasında mesaj alışverişini kolaylaştıran bir hizmet olarak tanımlanmaktadır. Temel bileşenler arasında **konular** bulunur, uygulamaların **abone olabileceği** bileşenler. Abone olan uygulamalar, **mesaj gönderebilme ve alabilme** yeteneğine sahiptir. Her mesaj, gerçek içeriği ve ilişkili meta verileri içerir.

**Konu, mesajların gönderileceği kuyruk** iken, **abonelikler**, kullanıcıların **konulardaki mesajlara erişmek için kullanacakları nesnelerdir**. Bir konuda birden fazla **abonelik olabilir** ve 4 tür abonelik bulunmaktadır:

* **Çekme**: Bu aboneliği kullanan kullanıcı(lar) mesajları çekmelidir.
* **İtme**: Bir URL uç noktası belirtilir ve mesajlar hemen oraya gönderilir.
* **Büyük sorgu tablosu**: İtme gibi ancak mesajları bir Büyük sorgu tablosu içine yerleştirme.
* **Cloud Depolama**: Mesajları doğrudan varolan bir kovaya iletmek.

**Varsayılan olarak** bir **abonelik 31 gün sonra sona erer**, ancak asla sona ermemesi için ayarlanabilir.

**Varsayılan olarak**, bir mesaj **7 gün boyunca saklanır**, ancak bu süre **31 güne kadar artırılabilir**. Ayrıca, 10 saniye içinde **ACK alınmazsa** mesaj kuyruğa geri döner. ACK alınmış mesajların depolanmaya devam etmesi de ayarlanabilir.

Bir konu varsayılan olarak bir **Google tarafından yönetilen şifreleme anahtarı** kullanılarak şifrelenir. Ancak bir **KMS'den Müşteri Yönetimli Şifreleme Anahtarı (CMEK)** de seçilebilir.

**Ölü mektup**: Abonelikler, bir **maksimum teslim deneme sayısı** yapılandırabilir. Bir mesaj teslim edilemezse, belirtilen ölü mektup konusuna **yeniden yayımlanır**.

### Anlık Görüntüler ve Şemalar

Bir anlık görüntü, belirli bir zamandaki bir aboneliğin durumunu **yakalar**. Temelde, bir anlık görüntü, abonelikteki **ACK alınmamış mesajların tutarlı bir yedeğidir**. Bir anlık görüntü oluşturarak, aboneliğin mesaj alım durumunu korursunuz ve orijinal mesajlar silinmiş olsa bile, anlık görüntünün alındığı noktadan mesaj tüketimine devam etmenizi sağlar.\
Çok şanslıysanız, bir anlık görüntü, anlık görüntünün alındığı zamandaki **eski hassas bilgileri** içerebilir.

Bir konu oluştururken, **konu mesajlarının bir şemaya uyması gerektiğini** belirtebilirsiniz.

### Sıralama
```bash
# Get a list of topics in the project
gcloud pubsub topics list
gcloud pubsub topics describe <topic>
gcloud pubsub topics list-subscriptions <topic>
gcloud pubsub topics get-iam-policy <topic>

# Get a list of subscriptions across all topics
gcloud pubsub subscriptions list
gcloud pubsub subscriptions describe <subscription>
gcloud pubsub subscriptions get-iam-policy <subscription>

# Get list of schemas
gcloud pubsub schemas list
gcloud pubsub schemas describe <schema>
gcloud pubsub schemas list-revisions <schema>

# Get list of snapshots
gcloud pubsub snapshots list
gcloud pubsub snapshots describe <snapshot>
```
Ancak, daha iyi sonuçlar elde edebilirsiniz [**daha büyük bir veri kümesi isteyerek**](https://cloud.google.com/pubsub/docs/replay-overview), dahil eski mesajlar. Bu bazı ön koşullara ve uygulamaları etkileyebileceğine dair etkilere sahiptir, bu yüzden gerçekten ne yaptığınızı iyi bildiğinizden emin olun.

### Ayrıcalık Yükseltme ve Saldırı Sonrası

{% content-ref url="../gcp-post-exploitation/gcp-pub-sub-post-exploitation.md" %}
[gcp-pub-sub-post-exploitation.md](../gcp-post-exploitation/gcp-pub-sub-post-exploitation.md)
{% endcontent-ref %}

## Pub/Sub Lite

[**Pub/Sub Lite**](https://cloud.google.com/pubsub/docs/choosing-pubsub-or-lite) zonal depolamaya sahip bir mesajlaşma servisidir. Pub/Sub Lite, Pub/Sub'un bir kesri maliyetindedir ve maliyetin birincil düşünce olduğu yüksek hacimli akış (saniyede 10 milyon mesaj) boru hatları ve olay odaklı sistemler için tasarlanmıştır.

PubSub Lite'ta **konular** ve **abonelikler** bulunur, **anlık görüntüler** ve **şemalar** bulunmaz ve şunlar vardır:

* **Rezervasyonlar**: Pub/Sub Lite Rezervasyonları, kullanıcıların mesaj akışları için belirli bir bölgede kapasite ayırmalarına olanak tanıyan bir özelliktir.
* **İşlemler**: Pub/Sub Lite'ı yönetme ve idare etmeyle ilgili işlemler ve görevleri ifade eder.

### Numaralandırma
```bash
# lite-topics
gcloud pubsub lite-topics list
gcloud pubsub lite-topics describe <topic>
gcloud pubsub lite-topics list-subscriptions <topic>

# lite-subscriptions
gcloud pubsub lite-subscriptions list
gcloud pubsub lite-subscriptions describe <subscription>

# lite-reservations
gcloud pubsub lite-reservations list
gcloud pubsub lite-reservations describe <topic>
gcloud pubsub lite-reservations list-topics <topic>

# lite-operations
gcloud pubsub lite-operations list
gcloud pubsub lite-operations describe <topic>
```
{% hint style="success" %}
AWS Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katılın veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak PR'ler göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>
{% endhint %}
