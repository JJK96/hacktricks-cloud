# Απαρίθμηση GCP - Pub/Sub

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο Hacking του AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Εκπαίδευση HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο Hacking του GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Εκπαίδευση HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε** 💬 [**στην ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Κοινοποιήστε κόλπα χάκερ υποβάλλοντας PRs** στα [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια στο GitHub.

</details>
{% endhint %}

## Pub/Sub <a href="#reviewing-cloud-pubsub" id="reviewing-cloud-pubsub"></a>

[Το Google **Cloud Pub/Sub**](https://cloud.google.com/pubsub/) περιγράφεται ως ένα υπηρεσία που διευκολύνει την ανταλλαγή μηνυμάτων μεταξύ ανεξάρτητων εφαρμογών. Οι βασικοί συστατικοί περιλαμβάνουν **θέματα**, στα οποία μπορούν να **εγγραφούν** εφαρμογές. Οι εγγεγραμμένες εφαρμογές έχουν τη δυνατότητα να **στέλνουν και να λαμβάνουν μηνύματα**. Κάθε μήνυμα περιλαμβάνει το πραγματικό περιεχόμενο μαζί με σχετικά μεταδεδομένα.

Το **θέμα είναι η ουρά** όπου τα μηνύματα θα σταλούν, ενώ οι **εγγραφές** είναι τα **αντικείμενα** που οι χρήστες θα χρησιμοποιήσουν για να **έχουν πρόσβαση στα μηνύματα στα θέματα**. Μπορεί να υπάρχει περισσότερες από **1 εγγραφή ανά θέμα** και υπάρχουν 4 τύποι εγγραφών:

* **Τράβηγμα (Pull)**: Οι χρήστες αυτής της εγγραφής πρέπει να τραβήξουν μηνύματα.
* **Πάτημα (Push)**: Υποδεικνύεται ένα τέλος URL και τα μηνύματα θα σταλούν αμέσως εκεί.
* **Πίνακας BigQuery**: Όπως το πάτημα, αλλά τα μηνύματα τοποθετούνται μέσα σε έναν πίνακα BigQuery.
* **Αποθήκευση Cloud (Cloud Storage)**: Παράδοση μηνυμάτων απευθείας σε ένα υπάρχον κάδο.

Από προεπιλογή μια **εγγραφή λήγει μετά από 31 ημέρες**, αν και μπορεί να οριστεί να μην λήξει ποτέ.

Από προεπιλογή, ένα μήνυμα παραμένει για 7 ημέρες, αλλά αυτός ο χρόνος μπορεί να **αυξηθεί έως 31 ημέρες**. Επίσης, αν δεν γίνει **ACKed σε 10 δευτερόλεπτα**, επιστρέφει στην ουρά. Μπορεί επίσης να οριστεί ότι τα ACKed μηνύματα θα πρέπει να συνεχίσουν να αποθηκεύονται.

Ένα θέμα κρυπτογραφείται από προεπιλογή χρησιμοποιώντας ένα **κλειδί κρυπτογράφησης που διαχειρίζεται η Google**. Αλλά μπορεί επίσης να επιλεγεί ένα **CMEK** (Κλειδί Κρυπτογράφησης που Διαχειρίζεται ο Πελάτης) από το KMS.

**Νεκρό γράμμα (Dead letter)**: Οι εγγραφές μπορούν να διαμορφώσουν ένα **μέγιστο αριθμό προσπαθειών παράδοσης**. Όταν ένα μήνυμα δεν μπορεί να παραδοθεί, επαναδημοσιεύεται στο καθορισμένο θέμα νεκρού γράμματος.

### Στιγμιότυπα & Σχήματα

Ένα στιγμιότυπο είναι μια λειτουργία που **καταγράφει την κατάσταση μιας εγγραφής σε ένα συγκεκριμένο χρονικό σημείο**. Βασικά, είναι μια συνεπής **δημιουργία αντιγράφου ασφαλείας των μη αναγνωρισμένων μηνυμάτων σε μια εγγραφή**. Δημιουργώντας ένα στιγμιότυπο, διατηρείτε την κατάσταση αναγνώρισης μηνυμάτων της εγγραφής, επιτρέποντάς σας να συνεχίσετε την κατανάλωση μηνυμάτων από το σημείο που πήρατε το στιγμιότυπο, ακόμη και αφού τα αρχικά μηνύματα θα είχαν διαγραφεί αλλιώς.\
Αν είστε πολύ τυχεροί, ένα στιγμιότυπο μπορεί να περιέχει **παλιές ευαίσθητες πληροφορίες** από τη στιγμή που πραγματοποιήθηκε το στιγμιότυπο.

Κατά τη δημιουργία ενός θέματος, μπορείτε να υποδείξετε ότι τα **μηνύματα του θέματος πρέπει να ακολουθούν ένα σχήμα**.

### Απαρίθμηση
```bash
# Get a list of topics in the project
gcloud pubsub topics list
gcloud pubsub topics describe <topic>
gcloud pubsub topics list-subscriptions <topic>
gcloud pubsub topics get-iam-policy <topic>

# Get a list of subscriptions across all topics
gcloud pubsub subscriptions list
gcloud pubsub subscriptions describe <subscription>
gcloud pubsub subscriptions get-iam-policy <subscription>

# Get list of schemas
gcloud pubsub schemas list
gcloud pubsub schemas describe <schema>
gcloud pubsub schemas list-revisions <schema>

# Get list of snapshots
gcloud pubsub snapshots list
gcloud pubsub snapshots describe <snapshot>
```
Ωστόσο, μπορείτε να έχετε καλύτερα αποτελέσματα [**ζητώντας ένα μεγαλύτερο σύνολο δεδομένων**](https://cloud.google.com/pubsub/docs/replay-overview), συμπεριλαμβανομένων παλαιότερων μηνυμάτων. Αυτό έχει μερικές προϋποθέσεις και μπορεί να επηρεάσει τις εφαρμογές, οπότε βεβαιωθείτε ότι πραγματικά ξέρετε τι κάνετε.

### Ανόδος Προνομίων & Μετά Εκμετάλλευση

{% content-ref url="../gcp-post-exploitation/gcp-pub-sub-post-exploitation.md" %}
[gcp-pub-sub-post-exploitation.md](../gcp-post-exploitation/gcp-pub-sub-post-exploitation.md)
{% endcontent-ref %}

## Pub/Sub Lite

[**Pub/Sub Lite**](https://cloud.google.com/pubsub/docs/choosing-pubsub-or-lite) είναι ένα υπηρεσία μηνυμάτων με **ζωνική αποθήκευση**. Το Pub/Sub Lite **κοστίζει ένα μικρό κομμάτι** του Pub/Sub και προορίζεται για **υψηλό όγκο ροής** (έως 10 εκατομμύρια μηνύματα ανά δευτερόλεπτο) αγωγούς και συστήματα που λειτουργούν με βάση τα γεγονότα όπου το χαμηλό κόστος είναι η κύρια σκέψη.

Στο PubSub Lite υπάρχουν **θέματα** και **συνδρομές**, δεν υπάρχουν **στιγμιότυπα** και **σχήματα** και υπάρχουν:

* **Κρατήσεις**: Οι Κρατήσεις Pub/Sub Lite είναι μια λειτουργία που επιτρέπει στους χρήστες να κρατούν χωρητικότητα σε μια συγκεκριμένη περιοχή για τα ροές μηνυμάτων τους.
* **Λειτουργίες**: Αναφέρεται στις ενέργειες και τις εργασίες που συνδέονται με τη διαχείριση και τη διαχείριση του Pub/Sub Lite.

### Απαρίθμηση
```bash
# lite-topics
gcloud pubsub lite-topics list
gcloud pubsub lite-topics describe <topic>
gcloud pubsub lite-topics list-subscriptions <topic>

# lite-subscriptions
gcloud pubsub lite-subscriptions list
gcloud pubsub lite-subscriptions describe <subscription>

# lite-reservations
gcloud pubsub lite-reservations list
gcloud pubsub lite-reservations describe <topic>
gcloud pubsub lite-reservations list-topics <topic>

# lite-operations
gcloud pubsub lite-operations list
gcloud pubsub lite-operations describe <topic>
```
{% hint style="success" %}
Μάθε & εξάσκησε το Hacking στο AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Εκπαίδευση HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθε & εξάσκησε το Hacking στο GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Εκπαίδευση HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστήριξε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Συμμετέχετε** 💬 [**στην ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Κοινοποιήστε τεχνικές χάκινγκ υποβάλλοντας PRs** στα αποθετήρια [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
