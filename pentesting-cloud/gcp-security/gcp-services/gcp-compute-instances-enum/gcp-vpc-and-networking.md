# GCP - VPC рдФрд░ рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди **HackTricks** рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рд╕реЗ рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## **GCP рдХрдореНрдкреНрдпреВрдЯ рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ**

**VPCs** рдореЗрдВ **Firewall** рдирд┐рдпрдо рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рд╡реАрдкреАрд╕реА рдореЗрдВ рдЖрдиреЗ рд╡рд╛рд▓реА рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрддреЗ рд╣реИрдВред VPCs рдореЗрдВ **рд╕рдмрдиреЗрдЯрд╡рд░реНрдХ** рднреА рд╣реЛрддреЗ рд╣реИрдВ рдЬрд╣рд╛рдВ **рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди** рдХрдиреЗрдХреНрдЯ рдХреА рдЬрд╛рдПрдЧреАред\
AWS рдХреА рддреБрд▓рдирд╛ рдореЗрдВ, **Firewall** AWS **рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдЧреНрд░реБрдкреНрд╕ рдФрд░ NACLs** рдХреЗ **рдирд┐рдХрдЯрддрдо** рдЪреАрдЬ рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдпреЗ **рд╡реАрдкреАрд╕реА рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд** рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рд╣рд░ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдореЗрдВ рдирд╣реАрдВред

## **GCP рдореЗрдВ VPC, рд╕рдмрдиреЗрдЯрд╡рд░реНрдХ рдФрд░ рдлрд╝рд╛рдпрд░рд╡реЙрд▓**

рдХрдВрдкреНрдпреВрдЯ рдЗрдВрд╕реНрдЯреЗрдВрд╕реЗрдЬ **рд╕рдмрдиреЗрдЯрд╡рд░реНрдХ** рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрддреА рд╣реИрдВ рдЬреЛ **VPCs** ([рд╡рд░реНрдЪреБрдЕрд▓ рдкреНрд░рд╛рдЗрд╡реЗрдЯ рдХреНрд▓рд╛рдЙрдб](https://cloud.google.com/vpc/docs/vpc)) рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИрдВред GCP рдореЗрдВ рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдЧреНрд░реБрдкреНрд╕ рдирд╣реАрдВ рд╣реИрдВ, рдпрд╣рд╛рдВ [**VPC рдлрд╝рд╛рдпрд░рд╡реЙрд▓**](https://cloud.google.com/vpc/docs/firewalls) рд╣реЛрддреЗ рд╣реИрдВ рдЬрд┐рдирдХреЗ рдирд┐рдпрдо рдЗрд╕ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрддрд░ рдкрд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рд╣рд░ VM рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрддреЗ рд╣реИрдВред

### рд╕рдмрдиреЗрдЯрд╡рд░реНрдХ

**рдПрдХ VPC** рдореЗрдВ **рдХрдИ рд╕рдмрдиреЗрдЯрд╡рд░реНрдХ** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдкреНрд░рддреНрдпреЗрдХ **рд╕рдмрдиреЗрдЯрд╡рд░реНрдХ 1 рдХреНрд╖реЗрддреНрд░ рдореЗрдВ** рд╣реЛрддрд╛ рд╣реИред

### рдлрд╝рд╛рдпрд░рд╡реЙрд▓

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рд╣рд░ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рджреЛ [**рд╕рдВрдХреЗрддрд┐рдд рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдирд┐рдпрдо**](https://cloud.google.com/vpc/docs/firewalls#default\_firewall\_rules) рд╣реЛрддреЗ рд╣реИрдВ: **рдЖрдЙрдЯрдмрд╛рдЙрдВрдб рдХреА рдЕрдиреБрдорддрд┐** рдФрд░ **рдЗрдирдмрд╛рдЙрдВрдб рдХреА рдирд┐рд╖реЗрдз**ред

рдЬрдм рдПрдХ GCP рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдПрдХ VPC рднреА рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо **`рдбрд┐рдлрд╝реЙрд▓реНрдЯ`** рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдирд┐рдпрдо рд╣реЛрддреЗ рд╣реИрдВ:

* **рдбрд┐рдлрд╝реЙрд▓реНрдЯ-рдЕрд▓рд╛рдЙ-рдЗрдВрдЯрд░рдирд▓:** `рдбрд┐рдлрд╝реЙрд▓реНрдЯ` рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдЕрдиреНрдп рдЗрдВрд╕реНрдЯреЗрдВрд╕реЗрдЬ рд╕реЗ рд╕рднреА рдЯреНрд░реИрдлрд┐рдХ рдХреА рдЕрдиреБрдорддрд┐
* **рдбрд┐рдлрд╝реЙрд▓реНрдЯ-рдЕрд▓рд╛рдЙ-рдПрд╕рдПрд╕рдПрдЪ:** рд╣рд░ рдЬрдЧрд╣ рд╕реЗ 22 рдХреА рдЕрдиреБрдорддрд┐
* **рдбрд┐рдлрд╝реЙрд▓реНрдЯ-рдЕрд▓рд╛рдЙ-рдЖрд░рдбреАрдкреА:** рд╣рд░ рдЬрдЧрд╣ рд╕реЗ 3389 рдХреА рдЕрдиреБрдорддрд┐
* **рдбрд┐рдлрд╝реЙрд▓реНрдЯ-рдЕрд▓рд╛рдЙ-рдЖрдЗрд╕реАрдПрдордкреА:** рд╣рд░ рдЬрдЧрд╣ рд╕реЗ рдкрд┐рдВрдЧ рдХреА рдЕрдиреБрдорддрд┐

{% hint style="warning" %}
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, **рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдирд┐рдпрдо** **рдЕрдВрджрд░реВрдиреА рдЖрдИрдкреА рдкрддреЛрдВ** рдХреЗ рд▓рд┐рдП **рдЕрдзрд┐рдХ рдЕрдиреБрдорддрд┐рдкреВрд░реНрдг** рд╣реЛрддреЗ рд╣реИрдВред рдбрд┐рдлрд╝реЙрд▓реНрдЯ VPC рдХрд┐рд╕реА рднреА рдХрдВрдкреНрдпреВрдЯ рдЗрдВрд╕реНрдЯреЗрдВрд╕реЗрдЬ рдХреЗ рдмреАрдЪ рд╕рднреА рдЯреНрд░реИрдлрд┐рдХ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
{% endhint %}

рдбрд┐рдлрд╝реЙрд▓реНрдЯ VPC рдпрд╛ рдирдП VPCs рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ **рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдирд┐рдпрдо** рдмрдирд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред [**рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдирд┐рдпрдо**](https://cloud.google.com/vpc/docs/firewalls) рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд **рддрд░реАрдХреЛрдВ** рд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

* [**рдиреЗрдЯрд╡рд░реНрдХ рдЯреИрдЧ**](https://cloud.google.com/vpc/docs/add-remove-network-tags)
* [**рд╕реЗрд╡рд╛ рдЕрдХрд╛рдЙрдВрдЯреНрд╕**](https://cloud.google.com/vpc/docs/firewalls#serviceaccounts)
* **рдПрдХ VPC рдХреЗ рд╕рднреА рдЗрдВрд╕реНрдЯреЗрдВрд╕реЗрдЬ**

рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдЦреБрд▓реЗ рдкреЛрд░реНрдЯреНрд╕ рд╡рд╛рд▓реА рд╕рднреА рдХрдВрдкреНрдпреВрдЯ рдЗрдВрд╕реНрдЯреЗрдВрд╕реЗрдЬ рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд░рд▓ `gcloud` рдХрдорд╛рдВрдб рдирд╣реАрдВ рд╣реИред рдЖрдкрдХреЛ рдлрд╛рдпрд░рд╡реЙрд▓ рдирд┐рдпрдо, рдиреЗрдЯрд╡рд░реНрдХ рдЯреИрдЧ, рд╕реЗрд╡рд╛ рдЕрдХрд╛рдЙрдВрдЯреНрд╕, рдФрд░ рдЗрдВрд╕реНрдЯреЗрдВрд╕реЗрдЬ рдХреЗ рдмреАрдЪ рдбреЙрдЯреНрд╕ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рд╣реЛрдВрдЧреЗред

рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ [рдЗрд╕ рдкрд╛рдпрдерди рд╕реНрдХреНрд░рд┐рдкреНрдЯ](https://gitlab.com/gitlab-com/gl-security/gl-redteam/gcp\_firewall\_enum) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдЧрдпрд╛ рдерд╛ рдЬреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛ рдирд┐рд░реНрдпрд╛рдд рдХрд░реЗрдЧрд╛:

* рдЗрдВрд╕реНрдЯреЗрдВрд╕, рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЖрдИрдкреА, рдЕрдиреБрдордд TCP, рдЕрдиреБрдордд UDP рджрд┐рдЦрд╛рдиреЗ рд╡рд╛рд▓реА CSV рдлрд╝рд╛рдЗрд▓
* рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗ рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдкреЛрд░реНрдЯреНрд╕ рдкрд░ рд╕рднреА рдЗрдВрд╕реНрдЯреЗрдВрд╕реЗрдЬ рдХрд╛ рд▓рдХреНрд╖реНрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП nmap рд╕реНрдХреИрди (0.0.0.0/0)
* рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗ рд╕рднреА TCP рдкреЛрд░реНрдЯреНрд╕ рдХреА рдкреВрд░реА рд╢реНрд░реЗрдгреА рдХрд╛ рд▓рдХреНрд╖реНрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП masscan

### рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдиреАрддрд┐рдпрд╛рдБ <a href="#hierarchical-firewall-policies" id="hierarchical-firewall-policies"></a>

_рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдиреАрддрд┐рдпрд╛рдБ_ рдЖрдкрдХреЛ рдЕрдкрдиреЗ рд╕рдВрдЧрдарди рдореЗрдВ рдПрдХ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдиреАрддрд┐ рдмрдирд╛рдиреЗ рдФрд░ **рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВ**ред рдЖрдк **рд╕рдВрдЧрдарди рдХреЛ рдкреВрд░реЗ** рдпрд╛ **рд╡реНрдпрдХреНрддрд┐рдЧрдд рдлреЛрд▓реНрдбрд░реНрд╕** рдХреЛ рднреА **рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдиреАрддрд┐рдпрд╛рдБ** рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрди рдиреАрддрд┐рдпреЛрдВ рдореЗрдВ рдирд┐рдпрдо рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдХрдиреЗрдХреНрд╢рди рдХреЛ рдирд┐рд╖реЗрдз рдпрд╛ рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред

рдЖрдк рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдиреАрддрд┐рдпреЛрдВ рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдХрджрдореЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк [**рд╕рдВрд╕рд╛рдзрди рд╡рд░реНрдЧреАрдХрд░рдг**](https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy) рдХреЗ **рд╕рдВрдЧрдарди рдпрд╛ рдлреЛрд▓реНрдбрд░ рдиреЛрдбреНрд╕** рдкрд░ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдиреАрддрд┐рдпрд╛рдБ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рдПрдХ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдиреАрддрд┐ рдирд┐рдпрдо **рдХрдиреЗрдХреНрд╢рди рдХреЛ рдирд┐рд╖реЗрдз рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдХрдиреЗрдХреНрд╢рди рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИ, рдпрд╛ рдирд┐рдЪрд▓реЗ рд╕реНрддрд░ рдХреЗ рдлреЛрд▓реНрдбрд░реНрд╕ рдпрд╛ VPC рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдирд┐рдпрдореЛрдВ рдХреЛ рд╡рд┐рдЪрд╛рд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИ**ред

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рд╕рднреА рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдиреАрддрд┐рдпрд╛рдБ рд╕рдВрдЧрдарди рдпрд╛ рдлреЛрд▓реНрдбрд░ рдХреЗ рддрд╣рдд рдЙрди рдкреНрд░реЛрдЬреЗрдХреНрдЯреНрд╕ рдореЗрдВ рд╕рднреА рд╡реАрдПрдореНрд╕ рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрддреА рд╣реИрдВ рдЬрд┐рдирдХреЗ рддрд╣рдд рдиреАрддрд┐ рдЬреБрдбрд╝реА рд╣реЛрддреА рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк [рд▓рдХреНрд╖реНрдп рдиреЗрдЯрд╡рд░реНрдХ рдпрд╛ рд▓рдХреНрд╖реНрдп рд╕реЗрд╡рд╛ рдЕрдХрд╛рдЙрдВрдЯреНрд╕](https://cloud.google.com/vpc/docs/firewall-policies#targets) рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдХреЗ рдХрд┐рд╕ рд╡реАрдПрдореНрд╕ рдХреЛ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдирд┐рдпрдо рдорд┐рд▓рддрд╛ рд╣реИ рдпрд╣ рд╡рд┐рд░реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк рдпрд╣рд╛рдВ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ [**рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдиреАрддрд┐ рдХреИрд╕реЗ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ**](https://cloud.google.com/vpc/docs/using-firewall-policies#gcloud)ред

### рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдирд┐рдпрдореЛрдВ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди

<figure><img src="../../../../.gitbook/assets/image (2) (1).png" alt=""><figcaption></figcaption></figure>

1
