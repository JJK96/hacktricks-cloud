# GCP - Security Enum

{% hint style="success" %}
Aprenda e pratique AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprenda e pratique GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Supporte HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo no Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo no telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

## Informa√ß√µes B√°sicas

Google Cloud Platform (GCP) Security abrange um **conjunto abrangente de ferramentas** e pr√°ticas projetadas para garantir a **seguran√ßa** dos recursos e dados dentro do ambiente Google Cloud, dividido em quatro se√ß√µes principais: **Security Command Center, Detections and Controls, Data Protection e Zero Trust.**

## **Security Command Center**

O Google Cloud Platform (GCP) Security Command Center (SCC) √© uma **ferramenta de seguran√ßa e gerenciamento de riscos para recursos GCP** que permite √†s organiza√ß√µes obter visibilidade e controle sobre seus ativos na nuvem. Ele ajuda a **detectar e responder a amea√ßas** oferecendo an√°lises de seguran√ßa abrangentes, **identificando configura√ß√µes incorretas**, garantindo **conformidade** com padr√µes de seguran√ßa e **integrando-se** com outras ferramentas de seguran√ßa para detec√ß√£o e resposta automatizadas a amea√ßas.

* **Vis√£o Geral**: Painel para **visualizar uma vis√£o geral** de todos os resultados do Security Command Center.
* Amea√ßas: \[Premium Requerido] Painel para visualizar todas as **amea√ßas detectadas. Confira mais sobre Amea√ßas abaixo**
* **Vulnerabilidades**: Painel para **visualizar configura√ß√µes incorretas encontradas na conta GCP**.
* **Conformidade**: \[Premium requerido] Esta se√ß√£o permite **testar seu ambiente GCP contra v√°rias verifica√ß√µes de conformidade** (como PCI-DSS, NIST 800-53, benchmarks CIS...) em toda a organiza√ß√£o.
* **Ativos**: Esta se√ß√£o **mostra todos os ativos sendo usados**, muito √∫til para sysadmins (e talvez atacantes) verem o que est√° rodando em uma √∫nica p√°gina.
* **Achados**: Isso **agrega** em uma **tabela achados** de diferentes se√ß√µes de seguran√ßa do GCP (n√£o apenas do Command Center) para poder visualizar facilmente achados que importam.
* **Fontes**: Mostra um **resumo dos achados** de todas as diferentes se√ß√µes de seguran√ßa do GCP **por se√ß√£o**.
* **Postura**: \[Premium Requerido] Security Posture permite **definir, avaliar e monitorar a seguran√ßa do ambiente GCP**. Funciona criando pol√≠ticas que definem restri√ß√µes ou limita√ß√µes que controlam/monitoram os recursos no GCP. Existem v√°rios modelos de postura predefinidos que podem ser encontrados em [https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy](https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy)

### **Amea√ßas**

Do ponto de vista de um atacante, esta √© provavelmente a **caracter√≠stica mais interessante, pois poderia detectar o atacante**. No entanto, observe que esse recurso requer **Premium** (o que significa que a empresa precisar√° pagar mais), ent√£o **pode nem estar habilitado**.&#x20;

Existem 3 tipos de mecanismos de detec√ß√£o de amea√ßas:

* **Amea√ßas de Evento**: Achados produzidos ao corresponder eventos do **Cloud Logging** com base em **regras criadas** internamente pelo Google. Tamb√©m pode escanear **logs do Google Workspace**.
* √â poss√≠vel encontrar a descri√ß√£o de todas as [**regras de detec√ß√£o na documenta√ß√£o**](https://cloud.google.com/security-command-center/docs/concepts-event-threat-detection-overview?authuser=2#how\_works)
* **Amea√ßas de Container**: Achados produzidos ap√≥s analisar o comportamento de baixo n√≠vel do kernel dos containers.
* **Amea√ßas Personalizadas**: Regras criadas pela empresa.

√â poss√≠vel encontrar respostas recomendadas para amea√ßas detectadas de ambos os tipos em [https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response](https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response)

### Enumera√ß√£o

{% code overflow="wrap" %}
```bash
# Get a source
gcloud scc sources describe <org-number> --source=5678
## If the response is that the service is disabled or that the source is not found, then, it isn't enabled

# Get notifications
gcloud scc notifications list <org-number>

# Get findings (if not premium these are just vulnerabilities)
gcloud scc findings list <org-number>
```
{% endcode %}

### P√≥s-Explota√ß√£o

{% content-ref url="../gcp-post-exploitation/gcp-security-post-exploitation.md" %}
[gcp-security-post-exploitation.md](../gcp-post-exploitation/gcp-security-post-exploitation.md)
{% endcontent-ref %}

## Detec√ß√µes e Controles

* **Chronicle SecOps**: Um conjunto avan√ßado de opera√ß√µes de seguran√ßa projetado para ajudar as equipes a aumentar sua velocidade e impacto nas opera√ß√µes de seguran√ßa, incluindo detec√ß√£o de amea√ßas, investiga√ß√£o e resposta.
* **reCAPTCHA Enterprise**: Um servi√ßo que protege sites contra atividades fraudulentas como scraping, stuffing de credenciais e ataques automatizados, distinguindo entre usu√°rios humanos e bots.
* **Web Security Scanner**: Ferramenta de varredura de seguran√ßa automatizada que detecta vulnerabilidades e problemas comuns de seguran√ßa em aplicativos web hospedados no Google Cloud ou em outro servi√ßo web.
* **Risk Manager**: Uma ferramenta de governan√ßa, risco e conformidade (GRC) que ajuda as organiza√ß√µes a avaliar, documentar e entender sua postura de risco no Google Cloud.
* **Binary Authorization**: Um controle de seguran√ßa para cont√™ineres que garante que apenas imagens de cont√™ineres confi√°veis sejam implantadas em clusters do Kubernetes Engine de acordo com pol√≠ticas definidas pela empresa.
* **Advisory Notifications**: Um servi√ßo que fornece alertas e avisos sobre poss√≠veis problemas de seguran√ßa, vulnerabilidades e a√ß√µes recomendadas para manter os recursos seguros.
* **Access Approval**: Um recurso que permite que as organiza√ß√µes exijam aprova√ß√£o expl√≠cita antes que funcion√°rios do Google possam acessar seus dados ou configura√ß√µes, proporcionando uma camada adicional de controle e auditabilidade.
* **Managed Microsoft AD**: Um servi√ßo que oferece Microsoft Active Directory (AD) gerenciado, permitindo que os usu√°rios utilizem seus aplicativos e cargas de trabalho dependentes do Microsoft AD no Google Cloud.

## Prote√ß√£o de Dados

* **Sensitive Data Protection**: Ferramentas e pr√°ticas destinadas a proteger dados sens√≠veis, como informa√ß√µes pessoais ou propriedade intelectual, contra acesso ou exposi√ß√£o n√£o autorizada.
* **Data Loss Prevention (DLP)**: Um conjunto de ferramentas e processos usados para identificar, monitorar e proteger dados em uso, em movimento e em repouso atrav√©s de inspe√ß√£o profunda de conte√∫do e aplica√ß√£o de um conjunto abrangente de regras de prote√ß√£o de dados.
* **Certificate Authority Service**: Um servi√ßo escal√°vel e seguro que simplifica e automatiza a gest√£o, implanta√ß√£o e renova√ß√£o de certificados SSL/TLS para servi√ßos internos e externos.
* **Key Management**: Um servi√ßo baseado em nuvem que permite gerenciar chaves criptogr√°ficas para suas aplica√ß√µes, incluindo a cria√ß√£o, importa√ß√£o, rota√ß√£o, uso e destrui√ß√£o de chaves de criptografia. Mais informa√ß√µes em:

{% content-ref url="gcp-kms-enum.md" %}
[gcp-kms-enum.md](gcp-kms-enum.md)
{% endcontent-ref %}

* **Certificate Manager**: Um servi√ßo que gerencia e implanta certificados SSL/TLS, garantindo conex√µes seguras e criptografadas para seus servi√ßos e aplicativos web.
* **Secret Manager**: Um sistema de armazenamento seguro e conveniente para chaves de API, senhas, certificados e outros dados sens√≠veis, que permite o acesso e gerenciamento f√°cil e seguro desses segredos em aplicativos. Mais informa√ß√µes em:

{% content-ref url="gcp-secrets-manager-enum.md" %}
[gcp-secrets-manager-enum.md](gcp-secrets-manager-enum.md)
{% endcontent-ref %}

## Zero Trust

* **BeyondCorp Enterprise**: Uma plataforma de seguran√ßa zero-trust que permite acesso seguro a aplicativos internos sem a necessidade de uma VPN tradicional, confiando na verifica√ß√£o da confian√ßa do usu√°rio e do dispositivo antes de conceder acesso.
* **Policy Troubleshooter**: Uma ferramenta projetada para ajudar administradores a entender e resolver problemas de acesso em sua organiza√ß√£o, identificando por que um usu√°rio tem acesso a certos recursos ou por que o acesso foi negado, auxiliando na aplica√ß√£o de pol√≠ticas de zero-trust.
* **Identity-Aware Proxy (IAP)**: Um servi√ßo que controla o acesso a aplicativos em nuvem e VMs executadas no Google Cloud, on-premises ou em outras nuvens, com base na identidade e no contexto da solicita√ß√£o, em vez da rede de origem da solicita√ß√£o.
* **VPC Service Controls**: Per√≠metros de seguran√ßa que fornecem camadas adicionais de prote√ß√£o para recursos e servi√ßos hospedados na Virtual Private Cloud (VPC) do Google Cloud, prevenindo a exfiltra√ß√£o de dados e fornecendo controle de acesso granular.
* **Access Context Manager**: Parte do BeyondCorp Enterprise do Google Cloud, esta ferramenta ajuda a definir e aplicar pol√≠ticas de controle de acesso detalhadas com base na identidade do usu√°rio e no contexto de sua solicita√ß√£o, como status de seguran√ßa do dispositivo, endere√ßo IP e mais.

{% hint style="success" %}
Aprenda e pratique AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprenda e pratique GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo no Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo no Telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
