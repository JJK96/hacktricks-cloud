# GCP - Security Enum

{% hint style="success" %}
Aprende y practica AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprende y practica GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

## Informaci칩n B치sica

Google Cloud Platform (GCP) Security abarca una **suite completa de herramientas** y pr치cticas dise침adas para asegurar la **seguridad** de los recursos y datos dentro del entorno de Google Cloud, dividida en cuatro secciones principales: **Security Command Center, Detections and Controls, Data Protection y Zero Trust.**

## **Security Command Center**

El Google Cloud Platform (GCP) Security Command Center (SCC) es una **herramienta de gesti칩n de seguridad y riesgos para recursos de GCP** que permite a las organizaciones obtener visibilidad y control sobre sus activos en la nube. Ayuda a **detectar y responder a amenazas** ofreciendo an치lisis de seguridad completos, **identificando configuraciones incorrectas**, asegurando el **cumplimiento** con est치ndares de seguridad, e **integr치ndose** con otras herramientas de seguridad para la detecci칩n y respuesta automatizada de amenazas.

* **Overview**: Panel para **visualizar una visi칩n general** de todos los resultados del Security Command Center.
* Threats: \[Premium Required] Panel para visualizar todas las **amenazas detectadas. Revisa m치s sobre Amenazas abajo**
* **Vulnerabilities**: Panel para **visualizar configuraciones incorrectas encontradas en la cuenta de GCP**.
* **Compliance**: \[Premium required] Esta secci칩n permite **probar tu entorno de GCP contra varias verificaciones de cumplimiento** (como PCI-DSS, NIST 800-53, CIS benchmarks...) en toda la organizaci칩n.
* **Assets**: Esta secci칩n **muestra todos los activos en uso**, muy 칰til para los administradores de sistemas (y tal vez atacantes) para ver qu칠 est치 funcionando en una sola p치gina.
* **Findings**: Esto **agrega** en una **tabla hallazgos** de diferentes secciones de GCP Security (no solo Command Center) para poder visualizar f치cilmente los hallazgos que importan.
* **Sources**: Muestra un **resumen de hallazgos** de todas las diferentes secciones de seguridad de GCP **por secci칩n**.
* **Posture**: \[Premium Required] Security Posture permite **definir, evaluar y monitorear la seguridad del entorno de GCP**. Funciona creando pol칤ticas que definen restricciones o limitaciones que controlan/monitorean los recursos en GCP. Hay varios plantillas de postura predefinidas que se pueden encontrar en [https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy](https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy)

### **Threats**

Desde la perspectiva de un atacante, esta es probablemente la **caracter칤stica m치s interesante ya que podr칤a detectar al atacante**. Sin embargo, ten en cuenta que esta caracter칤stica requiere **Premium** (lo que significa que la empresa tendr치 que pagar m치s), por lo que **podr칤a no estar habilitada**.&#x20;

Hay 3 tipos de mecanismos de detecci칩n de amenazas:

* **Event Threats**: Hallazgos producidos al coincidir eventos de **Cloud Logging** basados en **reglas creadas** internamente por Google. Tambi칠n puede escanear **Google Workspace logs**.
* Es posible encontrar la descripci칩n de todas las [**reglas de detecci칩n en la documentaci칩n**](https://cloud.google.com/security-command-center/docs/concepts-event-threat-detection-overview?authuser=2#how\_works)
* **Container Threats**: Hallazgos producidos despu칠s de analizar el comportamiento de bajo nivel del kernel de los contenedores.
* **Custom Threats**: Reglas creadas por la empresa.

Es posible encontrar respuestas recomendadas a las amenazas detectadas de ambos tipos en [https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response](https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response)

### Enumeraci칩n

{% code overflow="wrap" %}
```bash
# Get a source
gcloud scc sources describe <org-number> --source=5678
## If the response is that the service is disabled or that the source is not found, then, it isn't enabled

# Get notifications
gcloud scc notifications list <org-number>

# Get findings (if not premium these are just vulnerabilities)
gcloud scc findings list <org-number>
```
{% endcode %}

### Post Exploitation

{% content-ref url="../gcp-post-exploitation/gcp-security-post-exploitation.md" %}
[gcp-security-post-exploitation.md](../gcp-post-exploitation/gcp-security-post-exploitation.md)
{% endcontent-ref %}

## Detections and Controls

* **Chronicle SecOps**: Un conjunto avanzado de operaciones de seguridad dise침ado para ayudar a los equipos a aumentar su velocidad e impacto en las operaciones de seguridad, incluyendo la detecci칩n de amenazas, investigaci칩n y respuesta.
* **reCAPTCHA Enterprise**: Un servicio que protege sitios web de actividades fraudulentas como scraping, stuffing de credenciales y ataques automatizados, distinguiendo entre usuarios humanos y bots.
* **Web Security Scanner**: Herramienta de escaneo de seguridad automatizada que detecta vulnerabilidades y problemas de seguridad comunes en aplicaciones web alojadas en Google Cloud u otro servicio web.
* **Risk Manager**: Una herramienta de gobernanza, riesgo y cumplimiento (GRC) que ayuda a las organizaciones a evaluar, documentar y comprender su postura de riesgo en Google Cloud.
* **Binary Authorization**: Un control de seguridad para contenedores que asegura que solo im치genes de contenedores confiables se desplieguen en cl칰steres de Kubernetes Engine seg칰n las pol칤ticas establecidas por la empresa.
* **Advisory Notifications**: Un servicio que proporciona alertas y avisos sobre posibles problemas de seguridad, vulnerabilidades y acciones recomendadas para mantener los recursos seguros.
* **Access Approval**: Una caracter칤stica que permite a las organizaciones requerir aprobaci칩n expl칤cita antes de que los empleados de Google puedan acceder a sus datos o configuraciones, proporcionando una capa adicional de control y auditabilidad.
* **Managed Microsoft AD**: Un servicio que ofrece Microsoft Active Directory (AD) gestionado, permitiendo a los usuarios utilizar sus aplicaciones y cargas de trabajo dependientes de Microsoft AD en Google Cloud.

## Data Protection

* **Sensitive Data Protection**: Herramientas y pr치cticas destinadas a proteger datos sensibles, como informaci칩n personal o propiedad intelectual, contra el acceso no autorizado o la exposici칩n.
* **Data Loss Prevention (DLP)**: Un conjunto de herramientas y procesos utilizados para identificar, monitorear y proteger datos en uso, en movimiento y en reposo mediante una inspecci칩n profunda del contenido y aplicando un conjunto integral de reglas de protecci칩n de datos.
* **Certificate Authority Service**: Un servicio escalable y seguro que simplifica y automatiza la gesti칩n, despliegue y renovaci칩n de certificados SSL/TLS para servicios internos y externos.
* **Key Management**: Un servicio basado en la nube que permite gestionar claves criptogr치ficas para tus aplicaciones, incluyendo la creaci칩n, importaci칩n, rotaci칩n, uso y destrucci칩n de claves de cifrado. M치s informaci칩n en:

{% content-ref url="gcp-kms-enum.md" %}
[gcp-kms-enum.md](gcp-kms-enum.md)
{% endcontent-ref %}

* **Certificate Manager**: Un servicio que gestiona y despliega certificados SSL/TLS, asegurando conexiones seguras y cifradas a tus servicios web y aplicaciones.
* **Secret Manager**: Un sistema de almacenamiento seguro y conveniente para claves API, contrase침as, certificados y otros datos sensibles, que permite el acceso y la gesti칩n f치cil y segura de estos secretos en aplicaciones. M치s informaci칩n en:

{% content-ref url="gcp-secrets-manager-enum.md" %}
[gcp-secrets-manager-enum.md](gcp-secrets-manager-enum.md)
{% endcontent-ref %}

## Zero Trust

* **BeyondCorp Enterprise**: Una plataforma de seguridad de confianza cero que permite el acceso seguro a aplicaciones internas sin la necesidad de una VPN tradicional, bas치ndose en la verificaci칩n de la confianza del usuario y del dispositivo antes de otorgar acceso.
* **Policy Troubleshooter**: Una herramienta dise침ada para ayudar a los administradores a entender y resolver problemas de acceso en su organizaci칩n, identificando por qu칠 un usuario tiene acceso a ciertos recursos o por qu칠 se le neg칩 el acceso, ayudando as칤 en la aplicaci칩n de pol칤ticas de confianza cero.
* **Identity-Aware Proxy (IAP)**: Un servicio que controla el acceso a aplicaciones en la nube y VMs que se ejecutan en Google Cloud, en instalaciones locales u otras nubes, basado en la identidad y el contexto de la solicitud en lugar de la red desde la cual se origina la solicitud.
* **VPC Service Controls**: Per칤metros de seguridad que proporcionan capas adicionales de protecci칩n a los recursos y servicios alojados en la Virtual Private Cloud (VPC) de Google Cloud, previniendo la exfiltraci칩n de datos y proporcionando control de acceso granular.
* **Access Context Manager**: Parte de BeyondCorp Enterprise de Google Cloud, esta herramienta ayuda a definir y aplicar pol칤ticas de control de acceso detalladas basadas en la identidad del usuario y el contexto de su solicitud, como el estado de seguridad del dispositivo, la direcci칩n IP y m치s.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
