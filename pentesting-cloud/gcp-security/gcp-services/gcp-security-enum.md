# GCP - Security Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* [**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェック！
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)をフォローしてください。
* **ハッキングトリックを共有するには、** [**HackTricks**](https://github.com/carlospolop/hacktricks)および[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出してください。

</details>
{% endhint %}

## 基本情報

Google Cloud Platform (GCP) セキュリティは、Google Cloud環境内のリソースとデータの**セキュリティ**を確保するための**包括的なツール**と実践を含み、4つの主要なセクションに分かれています：**Security Command Center, Detections and Controls, Data Protection and Zero Trust.**

## **Security Command Center**

Google Cloud Platform (GCP) Security Command Center (SCC) は、GCPリソースのための**セキュリティおよびリスク管理ツール**であり、組織がクラウド資産の可視性と制御を得ることを可能にします。これにより、包括的なセキュリティ分析を提供し、**脅威を検出して対応**し、**誤設定を特定**し、セキュリティ標準への**準拠**を確保し、他のセキュリティツールと統合して自動化された脅威検出と対応を行います。

* **概要**: Security Command Centerのすべての結果の**概要を視覚化するパネル**。
* 脅威: \[プレミアム必要] すべての**検出された脅威を視覚化するパネル**。詳細は以下の脅威セクションを参照。
* **脆弱性**: GCPアカウントで見つかった**誤設定を視覚化するパネル**。
* **コンプライアンス**: \[プレミアム必要] このセクションでは、組織全体でPCI-DSS、NIST 800-53、CISベンチマークなどの**複数のコンプライアンスチェックに対してGCP環境をテスト**できます。
* **資産**: このセクションは**使用中のすべての資産を表示**し、シスアドミン（おそらく攻撃者）にとって、何が実行されているかを一目で確認するのに非常に便利です。
* **発見**: これは、GCPセキュリティの異なるセクション（Command Centerだけでなく）の**発見をテーブルに集約**し、重要な発見を簡単に視覚化できるようにします。
* **ソース**: GCPセキュリティの異なるセクションごとの**発見の概要を表示**します。
* **ポスチャー**: \[プレミアム必要] Security Postureは、GCP環境の**セキュリティを定義、評価、監視**することを可能にします。これは、GCPのリソースを制御/監視する制約や制限を定義するポリシーを作成することで機能します。いくつかの事前定義されたポスチャーテンプレートは[https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy](https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy)で見つけることができます。

### **脅威**

攻撃者の視点から見ると、これはおそらく**攻撃者を検出する可能性があるため最も興味深い機能**です。ただし、この機能は**プレミアム**（つまり、会社が追加料金を支払う必要がある）を必要とするため、**有効になっていない可能性もあります**。

脅威検出メカニズムには3つのタイプがあります：

* **イベント脅威**: **Cloud Logging**からのイベントをGoogleが内部で作成した**ルールに基づいて一致させることによって生成される発見**。**Google Workspaceログ**もスキャンできます。
* すべての[**検出ルールの説明はドキュメントで見つけることができます**](https://cloud.google.com/security-command-center/docs/concepts-event-threat-detection-overview?authuser=2#how\_works)
* **コンテナ脅威**: コンテナのカーネルの低レベルの動作を分析した後に生成される発見。
* **カスタム脅威**: 会社が作成したルール。

両方のタイプの検出された脅威に対する推奨される対応は[https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response](https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response)で見つけることができます。

### 列挙

{% code overflow="wrap" %}
```bash
# Get a source
gcloud scc sources describe <org-number> --source=5678
## If the response is that the service is disabled or that the source is not found, then, it isn't enabled

# Get notifications
gcloud scc notifications list <org-number>

# Get findings (if not premium these are just vulnerabilities)
gcloud scc findings list <org-number>
```
{% endcode %}

### Post Exploitation

{% content-ref url="../gcp-post-exploitation/gcp-security-post-exploitation.md" %}
[gcp-security-post-exploitation.md](../gcp-post-exploitation/gcp-security-post-exploitation.md)
{% endcontent-ref %}

## Detections and Controls

* **Chronicle SecOps**: 脅威検出、調査、対応を含むセキュリティオペレーションの速度と影響を高めるために設計された高度なセキュリティオペレーションスイート。
* **reCAPTCHA Enterprise**: スクレイピング、クレデンシャルスタッフィング、自動攻撃などの不正行為からウェブサイトを保護し、人間のユーザーとボットを区別するサービス。
* **Web Security Scanner**: Google Cloudまたは他のウェブサービスでホストされているウェブアプリケーションの脆弱性や一般的なセキュリティ問題を検出する自動セキュリティスキャンツール。
* **Risk Manager**: 組織がGoogle Cloudのリスク姿勢を評価、文書化、理解するのを支援するガバナンス、リスク、およびコンプライアンス（GRC）ツール。
* **Binary Authorization**: 企業が設定したポリシーに従って、信頼されたコンテナイメージのみがKubernetes Engineクラスターにデプロイされることを保証するコンテナのセキュリティコントロール。
* **Advisory Notifications**: 潜在的なセキュリティ問題、脆弱性、およびリソースを安全に保つための推奨アクションに関するアラートとアドバイザリを提供するサービス。
* **Access Approval**: Googleの従業員がデータや設定にアクセスする前に明示的な承認を要求する機能で、追加のコントロールと監査可能性を提供。
* **Managed Microsoft AD**: Google Cloud上で既存のMicrosoft AD依存アプリケーションやワークロードを使用できるようにするマネージドMicrosoft Active Directory（AD）サービス。

## Data Protection

* **Sensitive Data Protection**: 個人情報や知的財産などの機密データを不正アクセスや露出から保護するためのツールと実践。
* **Data Loss Prevention (DLP)**: データの使用中、移動中、および保存中のデータを深いコンテンツ検査と包括的なデータ保護ルールの適用によって識別、監視、保護するためのツールとプロセスのセット。
* **Certificate Authority Service**: 内部および外部サービスのSSL/TLS証明書の管理、デプロイ、および更新を簡素化し、自動化するスケーラブルで安全なサービス。
* **Key Management**: 暗号鍵の作成、インポート、回転、使用、および破棄を含むアプリケーションの暗号鍵を管理するクラウドベースのサービス。詳細は以下に：

{% content-ref url="gcp-kms-enum.md" %}
[gcp-kms-enum.md](gcp-kms-enum.md)
{% endcontent-ref %}

* **Certificate Manager**: SSL/TLS証明書を管理およびデプロイし、ウェブサービスおよびアプリケーションへの安全で暗号化された接続を確保するサービス。
* **Secret Manager**: APIキー、パスワード、証明書、およびその他の機密データの安全で便利なストレージシステムで、アプリケーションでこれらのシークレットに簡単かつ安全にアクセスおよび管理できるようにする。詳細は以下に：

{% content-ref url="gcp-secrets-manager-enum.md" %}
[gcp-secrets-manager-enum.md](gcp-secrets-manager-enum.md)
{% endcontent-ref %}

## Zero Trust

* **BeyondCorp Enterprise**: ユーザーとデバイスの信頼性を検証してからアクセスを許可することで、従来のVPNを必要とせずに内部アプリケーションへの安全なアクセスを可能にするゼロトラストセキュリティプラットフォーム。
* **Policy Troubleshooter**: ユーザーが特定のリソースにアクセスできる理由やアクセスが拒否された理由を特定することで、組織内のアクセス問題を理解し解決するのに役立つツールで、ゼロトラストポリシーの施行を支援。
* **Identity-Aware Proxy (IAP)**: リクエストが発信されたネットワークではなく、リクエストのアイデンティティとコンテキストに基づいてGoogle Cloud、オンプレミス、または他のクラウドで実行されているクラウドアプリケーションおよびVMへのアクセスを制御するサービス。
* **VPC Service Controls**: Google CloudのVirtual Private Cloud（VPC）にホストされているリソースおよびサービスに追加の保護層を提供し、データの流出を防ぎ、細かいアクセス制御を提供するセキュリティ境界。
* **Access Context Manager**: Google CloudのBeyondCorp Enterpriseの一部であり、ユーザーのアイデンティティとリクエストのコンテキスト（デバイスのセキュリティステータス、IPアドレスなど）に基づいて細かいアクセス制御ポリシーを定義および施行するのに役立つツール。

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
