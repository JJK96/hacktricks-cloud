# GCP - Security Enum

{% hint style="success" %}
学习和练习 AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
学习和练习 GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>支持 HackTricks</summary>

* 查看 [**订阅计划**](https://github.com/sponsors/carlospolop)!
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram 群组**](https://t.me/peass) 或 **关注** 我们的 **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **通过提交 PRs 分享黑客技巧到** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库。

</details>
{% endhint %}

## 基本信息

Google Cloud Platform (GCP) 安全性涵盖了一套**全面的工具**和实践，旨在确保 Google Cloud 环境中资源和数据的**安全性**，分为四个主要部分：**Security Command Center, Detections and Controls, Data Protection 和 Zero Trust。**

## **Security Command Center**

Google Cloud Platform (GCP) Security Command Center (SCC) 是一个**GCP 资源的安全和风险管理工具**，使组织能够获得对其云资产的可见性和控制。它通过提供全面的安全分析，**识别错误配置**，确保**符合安全标准**，并与其他安全工具**集成**以实现自动威胁检测和响应，帮助**检测和响应威胁**。

* **概述**：面板**可视化 Security Command Center 的所有结果概览**。
* 威胁：\[需要高级版] 面板可视化所有**检测到的威胁。更多关于威胁的信息请见下文**
* **漏洞**：面板**可视化 GCP 账户中发现的错误配置**。
* **合规性**：\[需要高级版] 此部分允许**根据多个合规性检查（如 PCI-DSS, NIST 800-53, CIS 基准等）测试 GCP 环境**。
* **资产**：此部分**显示所有正在使用的资产**，对系统管理员（可能还有攻击者）非常有用，可以在一个页面上看到正在运行的内容。
* **发现**：此部分**汇总** GCP 安全的不同部分的**发现结果**，以便轻松可视化重要的发现。
* **来源**：显示 GCP 安全不同部分的**发现摘要**。
* **姿态**：\[需要高级版] 安全姿态允许**定义、评估和监控 GCP 环境的安全性**。它通过创建定义约束或限制的策略来控制/监控 GCP 中的资源。可以在 [https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy](https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy) 找到几个预定义的姿态模板。

### **威胁**

从攻击者的角度来看，这可能是**最有趣的功能，因为它可以检测到攻击者**。但是，请注意此功能需要**高级版**（这意味着公司需要支付更多费用），因此它**可能甚至没有启用**。

有三种类型的威胁检测机制：

* **事件威胁**：通过匹配来自 **Cloud Logging** 的事件，根据 Google 内部创建的**规则**生成的发现结果。它还可以扫描 **Google Workspace 日志**。
* 可以在 [**文档中找到所有检测规则的描述**](https://cloud.google.com/security-command-center/docs/concepts-event-threat-detection-overview?authuser=2#how\_works)
* **容器威胁**：在分析容器内核的低级行为后生成的发现结果。
* **自定义威胁**：由公司创建的规则。

可以在 [https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response](https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response) 找到对检测到的威胁的推荐响应。

### 枚举

{% code overflow="wrap" %}
```bash
# Get a source
gcloud scc sources describe <org-number> --source=5678
## If the response is that the service is disabled or that the source is not found, then, it isn't enabled

# Get notifications
gcloud scc notifications list <org-number>

# Get findings (if not premium these are just vulnerabilities)
gcloud scc findings list <org-number>
```
{% endcode %}

### Post Exploitation

{% content-ref url="../gcp-post-exploitation/gcp-security-post-exploitation.md" %}
[gcp-security-post-exploitation.md](../gcp-post-exploitation/gcp-security-post-exploitation.md)
{% endcontent-ref %}

## Detections and Controls

* **Chronicle SecOps**: 一个高级安全操作套件，旨在帮助团队提高安全操作的速度和影响力，包括威胁检测、调查和响应。
* **reCAPTCHA Enterprise**: 一项服务，通过区分人类用户和机器人来保护网站免受抓取、凭证填充和自动化攻击等欺诈活动的侵害。
* **Web Security Scanner**: 自动化安全扫描工具，检测托管在Google Cloud或其他网络服务上的Web应用程序中的漏洞和常见安全问题。
* **Risk Manager**: 一个治理、风险和合规（GRC）工具，帮助组织评估、记录和理解其Google Cloud风险状况。
* **Binary Authorization**: 一个容器的安全控制，确保只有受信任的容器镜像根据企业设定的策略部署在Kubernetes Engine集群上。
* **Advisory Notifications**: 一项服务，提供关于潜在安全问题、漏洞和推荐操作的警报和建议，以保持资源的安全。
* **Access Approval**: 一个功能，允许组织在Google员工访问其数据或配置之前需要明确批准，提供额外的控制和审计层。
* **Managed Microsoft AD**: 一项提供托管Microsoft Active Directory（AD）的服务，允许用户在Google Cloud上使用其现有的依赖于Microsoft AD的应用程序和工作负载。

## Data Protection

* **Sensitive Data Protection**: 旨在保护敏感数据（如个人信息或知识产权）免受未经授权访问或暴露的工具和实践。
* **Data Loss Prevention (DLP)**: 一套工具和流程，通过深度内容检查和应用全面的数据保护规则，用于识别、监控和保护使用中、传输中和静止中的数据。
* **Certificate Authority Service**: 一个可扩展且安全的服务，简化和自动化SSL/TLS证书的管理、部署和更新，用于内部和外部服务。
* **Key Management**: 一个基于云的服务，允许您管理应用程序的加密密钥，包括创建、导入、轮换、使用和销毁加密密钥。更多信息在：

{% content-ref url="gcp-kms-enum.md" %}
[gcp-kms-enum.md](gcp-kms-enum.md)
{% endcontent-ref %}

* **Certificate Manager**: 一个管理和部署SSL/TLS证书的服务，确保与您的Web服务和应用程序的连接安全且加密。
* **Secret Manager**: 一个安全且方便的存储系统，用于API密钥、密码、证书和其他敏感数据，允许在应用程序中轻松且安全地访问和管理这些秘密。更多信息在：

{% content-ref url="gcp-secrets-manager-enum.md" %}
[gcp-secrets-manager-enum.md](gcp-secrets-manager-enum.md)
{% endcontent-ref %}

## Zero Trust

* **BeyondCorp Enterprise**: 一个零信任安全平台，通过在授予访问权限之前验证用户和设备的信任度，来实现对内部应用程序的安全访问，而无需传统的VPN。
* **Policy Troubleshooter**: 一个工具，旨在帮助管理员理解和解决组织中的访问问题，通过识别用户为何有权访问某些资源或为何被拒绝访问，从而帮助执行零信任策略。
* **Identity-Aware Proxy (IAP)**: 一项服务，基于请求的身份和上下文而不是请求来源的网络，控制对Google Cloud、内部部署或其他云上运行的云应用程序和虚拟机的访问。
* **VPC Service Controls**: 安全边界，为托管在Google Cloud虚拟私有云（VPC）中的资源和服务提供额外的保护层，防止数据泄露并提供细粒度的访问控制。
* **Access Context Manager**: Google Cloud BeyondCorp Enterprise的一部分，这个工具帮助定义和执行基于用户身份和请求上下文（如设备安全状态、IP地址等）的细粒度访问控制策略。

{% hint style="success" %}
学习和实践AWS Hacking：<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
学习和实践GCP Hacking：<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>支持HackTricks</summary>

* 查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram群组**](https://t.me/peass) 或 **关注** 我们的 **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **通过提交PRs到** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github仓库来分享黑客技巧**。

</details>
{% endhint %}
