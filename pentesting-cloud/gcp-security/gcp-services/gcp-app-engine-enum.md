# GCP - App Engine Enum

{% hint style="success" %}
Μάθετε και εξασκηθείτε στο AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε και εξασκηθείτε στο GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε hacking tricks υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια στο github.

</details>
{% endhint %}

## Βασικές Πληροφορίες <a href="#reviewing-app-engine-configurations" id="reviewing-app-engine-configurations"></a>

Το App Engine της Google Cloud Platform (GCP) είναι μια **ισχυρή, serverless πλατφόρμα προσαρμοσμένη για την ανάπτυξη και φιλοξενία web εφαρμογών σε μεγάλη κλίμακα**. Ο σχεδιασμός αυτής της πλατφόρμας επικεντρώνεται στην απλοποίηση της διαδικασίας ανάπτυξης και στην ενίσχυση της διαχειρισιμότητας των εφαρμογών. Τα κύρια χαρακτηριστικά και τα οφέλη του App Engine της GCP περιλαμβάνουν:

1. **Serverless Αρχιτεκτονική**: Το App Engine διαχειρίζεται αυτόματα την υποδομή, συμπεριλαμβανομένης της παροχής, της διαμόρφωσης και της κλιμάκωσης των διακομιστών. Αυτό επιτρέπει στους προγραμματιστές να επικεντρωθούν στη συγγραφή κώδικα χωρίς να ανησυχούν για το υποκείμενο υλικό.
2. **Αυτόματη Κλιμάκωση**: Το App Engine μπορεί να κλιμακώσει αυτόματα την εφαρμογή σας σε απάντηση στην ποσότητα της κίνησης που λαμβάνει. Κλιμακώνεται για να χειριστεί αυξημένη κίνηση και μειώνεται όταν η κίνηση μειώνεται, βοηθώντας στη βελτιστοποίηση του κόστους και της απόδοσης.
3. **Υποστήριξη Γλωσσών και Εκτελεστικών Περιβαλλόντων**: Υποστηρίζει δημοφιλείς γλώσσες προγραμματισμού όπως Java, Python, Node.js, Go, Ruby, PHP, και .NET. Μπορείτε να εκτελέσετε τις εφαρμογές σας σε ένα standard ή ένα flexible περιβάλλον. Το standard περιβάλλον είναι πιο περιοριστικό αλλά εξαιρετικά βελτιστοποιημένο για συγκεκριμένες γλώσσες, ενώ το flexible περιβάλλον επιτρέπει περισσότερη προσαρμογή.
4. **Ενσωματωμένες Υπηρεσίες**: Το App Engine ενσωματώνεται με πολλές άλλες υπηρεσίες της GCP, όπως Cloud SQL, Cloud Storage, Cloud Datastore, και άλλες. Αυτή η ενσωμάτωση απλοποιεί την αρχιτεκτονική των εφαρμογών που βασίζονται στο cloud.
5. **Έκδοση και Διαχωρισμός Κίνησης**: Μπορείτε εύκολα να αναπτύξετε πολλαπλές εκδόσεις της εφαρμογής σας και στη συνέχεια να διαχωρίσετε την κίνηση μεταξύ τους για A/B testing ή σταδιακές κυκλοφορίες.
6. **Εφαρμοστικές Ενδείξεις**: Το App Engine παρέχει ενσωματωμένες υπηρεσίες όπως logging, user authentication, και μια σειρά εργαλείων για προγραμματιστές για την παρακολούθηση και διαχείριση εφαρμογών.
7. **Ασφάλεια**: Προσφέρει ενσωματωμένα χαρακτηριστικά ασφαλείας όπως έκδοση εφαρμογών, πιστοποιητικά SSL/TLS για ασφαλείς συνδέσεις, και διαχείριση ταυτότητας και πρόσβασης.

### Firewall

Ένα απλό **firewall** μπορεί να διαμορφωθεί για τις περιπτώσεις που εκτελούν τις εφαρμογές με τις ακόλουθες επιλογές:

<figure><img src="../../../.gitbook/assets/image (246).png" alt=""><figcaption></figcaption></figure>

### SA

Ο προεπιλεγμένος λογαριασμός υπηρεσίας που χρησιμοποιείται από αυτές τις εφαρμογές είναι **`<proj-name>@appspot.gserviceaccount.com`** που έχει **Editor** ρόλο στο έργο και οι SAs μέσα στην APP Engine περίπτωση **τρέχουν με cloud-platform scope (μεταξύ άλλων).**

### Storage

Ο πηγαίος κώδικας και τα μεταδεδομένα **αποθηκεύονται αυτόματα σε buckets** με ονόματα όπως `<proj-id>.appspot.com` και `staging.<proj-id>.appspot.com` και `<country>.<proj-id>.appspot.com`

**Κάθε αρχείο** της εφαρμογής αποθηκεύεται με το **sha1 του περιεχομένου ως όνομα αρχείου**:

<figure><img src="../../../.gitbook/assets/image (82).png" alt=""><figcaption></figcaption></figure>

Μέσα στον **`ae`** φάκελο από `staging.<proj-id>.appspot.com`, **υπάρχει ένας φάκελος ανά έκδοση** με τα **αρχεία πηγαίου κώδικα** και το **`manifest.json`** αρχείο που **περιγράφει τα συστατικά** της εφαρμογής:

{% code overflow="wrap" %}
```json
{"requirements.txt":{"sourceUrl":"https://storage.googleapis.com/staging.onboarding-host-98efbf97812843.appspot.com/a270eedcbe2672c841251022b7105d340129d108","sha1Sum":"a270eedc_be2672c8_41251022_b7105d34_0129d108"},"main_test.py":{"sourceUrl":"https://storage.googleapis.com/staging.onboarding-host-98efbf97812843.appspot.com/0ca32fd70c953af94d02d8a36679153881943f32","sha1Sum":"0ca32fd7_0c953af9_4d02d8a ...
```
{% endcode %}

### Containers

Η web εφαρμογή θα εκτελεστεί τελικά μέσα σε ένα **container** και το **Code Build** χρησιμοποιείται για να χτίσει το container.

### URLs & Regions

Η **προεπιλεγμένη** ιστοσελίδα θα εκτεθεί στη διεύθυνση URL **`<project-uniq-name>.appspot.com`** αν και η διεύθυνση URL των παλαιότερων εκδόσεων θα είναι ελαφρώς διαφορετική, όπως **`https://20240117t001540-dot-<project-uniq-name>.uc.r.appspot.com`** (σημειώστε την αρχική χρονική σήμανση).

Μπορεί να φαίνεται ότι είναι δυνατό να αναπτυχθεί μόνο μία εφαρμογή web app engine ανά περιοχή, αλλά είναι δυνατό να υποδείξετε **`service: <servicename>`** στο **`app.yml`** και να δημιουργήσετε μια νέα υπηρεσία (ένα νέο web). Η μορφή της διεύθυνσης URL για αυτό το νέο web θα είναι **`<servicename>-dot-<project-uniq-name>.appspot.com`**.

### Enumeration

{% hint style="danger" %}
Κάθε φορά που ανεβάζετε νέο κώδικα στην εφαρμογή, **δημιουργείται μια νέα έκδοση**. **Όλες οι εκδόσεις αποθηκεύονται** και έχουν ακόμη και μια **διεύθυνση URL για πρόσβαση σε αυτές**. Έτσι, η τροποποίηση του κώδικα μιας παλιάς έκδοσης θα μπορούσε να είναι μια **εξαιρετική τεχνική διατήρησης**.
{% endhint %}

Όπως και με τις Cloud Functions, **υπάρχει πιθανότητα η εφαρμογή να βασίζεται σε μυστικά που προσπελάζονται κατά την εκτέλεση μέσω μεταβλητών περιβάλλοντος**. Αυτές οι μεταβλητές αποθηκεύονται σε ένα αρχείο **`app.yaml`** το οποίο μπορεί να προσπελαστεί ως εξής:
```bash
# List the apps
gcloud app services list
gcloud app services describe <app-name>
# Access via browser to the specified app
gcloud app services browse <app-name>

# Get App versions
gcloud app versions list
# Get all the info of the app and version, included specific verion URL and the env
gcloud app versions describe -s <app-name> <version-id>

# Logs
gcloud app logs tail -s <app-name>

# Instances
## This is only valid if a flexible environment is used and not a standard one
gcloud app instances list
gcloud app instances describe -s <app-name> --version <version-id> <ID>
## Connect to the instance via ssh
gcloud app instances ssh --service <app-name> --version <version-id> <ID>

# Firewalls
gcloud app firewall-rules list
gcloud app firewall-rules describe <num_fw>

# Get domains
gcloud app domain-mappings list
gcloud app domain-mappings describe <name>

# SSl certificates
gcloud app ssl-certificates list
gcloud app ssl-certificates describe <name>
```
### Κλιμάκωση Προνομίων

{% content-ref url="../gcp-privilege-escalation/gcp-appengine-privesc.md" %}
[gcp-appengine-privesc.md](../gcp-privilege-escalation/gcp-appengine-privesc.md)
{% endcontent-ref %}

### Μη Αυθεντικοποιημένη Απαρίθμηση

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-app-engine-unauthenticated-enum.md" %}
[gcp-app-engine-unauthenticated-enum.md](../gcp-unaunthenticated-enum-and-access/gcp-app-engine-unauthenticated-enum.md)
{% endcontent-ref %}

### Μετα-Εκμετάλλευση

{% content-ref url="../gcp-post-exploitation/gcp-app-engine-post-exploitation.md" %}
[gcp-app-engine-post-exploitation.md](../gcp-post-exploitation/gcp-app-engine-post-exploitation.md)
{% endcontent-ref %}

### Εμμονή

{% content-ref url="../gcp-persistence/gcp-app-engine-persistence.md" %}
[gcp-app-engine-persistence.md](../gcp-persistence/gcp-app-engine-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Δείτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε hacking tricks υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια στο github.

</details>
{% endhint %}
