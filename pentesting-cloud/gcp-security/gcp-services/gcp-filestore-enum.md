# GCP - Dosya Deposu Sıralama

{% hint style="success" %}
AWS Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katılın veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak PR'ler göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>
{% endhint %}

## Temel Bilgiler

Google Cloud Dosya Deposu, hem bir **dosya sistemi arabirimi hem de veri için paylaşılan bir dosya sistemine ihtiyaç duyan uygulamalar için özel olarak tasarlanmış bir **yönetilen dosya depolama hizmetidir**. Bu hizmet, yüksek performanslı dosya paylaşımları sunarak, çeşitli GCP hizmetleriyle entegre edilebilir. Klasik dosya sistemi arabirimleri ve anlamlarının önemli olduğu medya işleme, içerik yönetimi ve veritabanı yedekleme gibi senaryolarda kullanışlıdır.

Bunu, diğer **NFS** **paylaşılan belge havuzu gibi düşünebilirsiniz -** hassas bilgilerin potansiyel bir kaynağı.

### Bağlantılar

Bir Dosya Deposu örneği oluşturulurken, **erişilebilir olacağı ağı seçmek mümkündür**.

Ayrıca, **varsayılan olarak seçilen VPC ağı ve bölgesindeki tüm istemcilerin erişebileceği**, ancak **erişimi IP adresine veya aralığına göre de kısıtlayabileceğiniz ve istemcinin alacağı erişim ayrıcalığını (Yönetici, Yönetici Görüntüleyici, Editör, Görüntüleyici) belirtebileceğiniz** mümkündür.

Ayrıca, bir **Özel Hizmet Erişim Bağlantısı** aracılığıyla erişilebilir:

* VPC ağı başına olup Memorystore, Tensorflow ve SQL gibi tüm yönetilen hizmetlerde kullanılabilir.
* Google'a ait bir ağ ile VPC ağınız arasındadır ve VPC eşleme kullanılarak, örnekleriniz ve hizmetlerinizin yalnızca **dahili IP adreslerini kullanarak iletişim kurmasını sağlar**.
* Hizmet üretici tarafında size izole bir proje oluşturur, yani başka müşterilerle paylaşılmaz. Yalnızca sağladığınız kaynaklar için faturalandırılacaksınız.
* VPC eşlemesi, VPC'nize yeni rotaları içe aktaracaktır.

### Yedeklemeler

Dosya paylaşımlarının **yedeklerini oluşturmak mümkündür**. Bu yedekler daha sonra **orijinalde** yeni Dosya Paylaşımı örneğinde veya **yeni olanlarda** geri yüklenebilir.

### Şifreleme

Varsayılan olarak, verileri şifrelemek için bir **Google tarafından yönetilen şifreleme anahtarı** kullanılacaktır, ancak bir **Müşteri tarafından yönetilen şifreleme anahtarı (CMEK)** seçmek mümkündür.

### Sıralama

Bir proje içinde mevcut bir dosya deposu bulursanız, bu dosya deposunu, etkilenen Hesaplama Örneği içinden **bağlayabilirsiniz**. Var olup olmadığını görmek için aşağıdaki komutu kullanın.

{% code overflow="wrap" %}
```bash
# Instances
gcloud filestore instances list # Check the IP address
gcloud filestore instances describe --zone <zone> <name> # Check IP and access restrictions

# Backups
gcloud filestore backups list
gcloud filestore backups describe --region <region> <backup>

# Search for NFS shares in a VPC subnet
sudo nmap -n -T5 -Pn -p 2049 --min-parallelism 100 --min-rate 1000 --open 10.99.160.2/20
```
{% endcode %}

{% hint style="danger" %}
Bir dosya depolama servisinin **tamamen yeni bir alt ağda olabileceğini unutmayın** (bir **VPC eş** olan Özel Hizmet Erişim Bağlantısı içinde olabilir).\
Bu nedenle, ayrıca bu ağ aralıklarında nmap çalıştırmak için **VPC eşlerini listeleyebilmeniz gerekebilir**.

{% code overflow="wrap" %}
```bash
# Get peerings
gcloud compute networks peerings list
# Get routes imported from a peering
gcloud compute networks peerings list-routes <peering-name> --network=<network-name> --region=<region> --direction=INCOMING
```
### Yetkilendirme Yükseltme ve Saldırı Sonrası İstismar

GCP'de doğrudan bu hizmeti istismar ederek yetkileri yükseltmenin bir yolu yok, ancak bazı **Saldırı Sonrası İstismar hileleri kullanarak verilere erişim sağlamak mümkün olabilir** ve belki bazı kimlik bilgilerini bulup yetkileri yükseltebilirsiniz:

{% content-ref url="../gcp-post-exploitation/gcp-filestore-post-exploitation.md" %}
[gcp-filestore-post-exploitation.md](../gcp-post-exploitation/gcp-filestore-post-exploitation.md)
{% endcontent-ref %}

### Kalıcılık

{% content-ref url="../gcp-persistence/gcp-filestore-persistence.md" %}
[gcp-filestore-persistence.md](../gcp-persistence/gcp-filestore-persistence.md)
{% endcontent-ref %}
