# GCP - Artifact Registry Kalıcılığı

{% hint style="success" %}
AWS Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak PR'ler göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>
{% endhint %}

## Artifact Registry

Artifact Registry hakkında daha fazla bilgi için şu adrese bakın:

{% content-ref url="../gcp-services/gcp-artifact-registry-enum.md" %}
[gcp-artifact-registry-enum.md](../gcp-services/gcp-artifact-registry-enum.md)
{% endcontent-ref %}

### Bağımlılık Karışıklığı

* Bir **sanal** depoda **uzak ve standart** depolar **karıştırılırsa** ve bir paket her ikisinde de mevcutsa ne olur?
* Sanal depoda **en yüksek öncelik ayarına sahip olan** kullanılır
* Eğer **öncelik aynı ise**:
* Eğer **sürüm** aynı ise, sanal depoda alfabetik olarak ilk sıradaki **politika adı** kullanılır
* Değilse, **en yüksek sürüm** kullanılır

{% hint style="danger" %}
Bu nedenle, bir **en yüksek sürümü (bağımlılık karışıklığı)** kötüye kullanmak mümkündür, eğer uzak depo daha yüksek veya aynı önceliğe sahipse
{% endhint %}

Bu teknik, **kalıcılık** ve **kimlik doğrulamasız erişim** için kullanışlı olabilir; çünkü bunu kötüye kullanmak için sadece Artifact Registry'de depolanan bir kütüphane adını **bilmek** ve aynı kütüphaneyi **yükseltilmiş bir sürümle (örneğin python için PyPi'da)** genel depoda oluşturmak yeterlidir.

Kalıcılık için izlenmesi gereken adımlar şunlardır:

* **Gereksinimler**: Bir **sanal depo** olmalı ve kullanılmalı, **genel depoda mevcut olmayan bir adı** olan bir **iç paket** kullanılmalıdır.
* Uzak bir depo oluşturun eğer yoksa
* Uzak depoyu sanal depoya ekleyin
* Sanal depo kayıtlarının politikalarını düzenleyerek uzak depoya daha yüksek bir öncelik (veya aynı) verin.\
Şuna benzer bir komut çalıştırın:
* [gcloud artifacts repositories update --upstream-policy-file ...](https://cloud.google.com/sdk/gcloud/reference/artifacts/repositories/update#--upstream-policy-file)
* Meşru paketi indirin, kötü amaçlı kodunuzu ekleyin ve aynı sürümle genel depoya kaydedin. Her bir geliştirici yüklediğinde sizinki de yüklenecektir!

Bağımlılık karışıklığı hakkında daha fazla bilgi için şu adrese bakın:

{% embed url="https://book.hacktricks.xyz/pentesting-web/dependency-confusion" %}

{% hint style="success" %}
AWS Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak PR'ler göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>
{% endhint %}
