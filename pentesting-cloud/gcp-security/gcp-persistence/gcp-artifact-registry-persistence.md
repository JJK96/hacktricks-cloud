# GCP - Artefak-Registrasie Volharding

{% hint style="success" %}
Leer & oefen AWS Hack:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Rooi Span Kenner (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hack: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Rooi Span Kenner (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kontroleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** 💬 [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hack-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}

## Artefak-Registrasie

Vir meer inligting oor Artefak-Registrasie, kyk:

{% content-ref url="../gcp-services/gcp-artifact-registry-enum.md" %}
[gcp-artifact-registry-enum.md](../gcp-services/gcp-artifact-registry-enum.md)
{% endcontent-ref %}

### Afhanklikheidsverwarring

* Wat gebeur as 'n **afgeleë en 'n standaard** repositories **gemeng word in 'n virtuele** een en 'n pakkie in beide bestaan?
* Die een met die **hoogste prioriteit wat in die virtuele repository** ingestel is, word gebruik
* As die **prioriteit dieselfde is**:
* As die **weergawe dieselfde is**, word die **beleid naam alfabeties eerste in die virtuele repository** gebruik
* Indien nie, word die **hoogste weergawe** gebruik

{% hint style="danger" %}
Daarom is dit moontlik om 'n **hoogste weergawe (afhanklikheidsverwarring)** in 'n openbare pakkette-argief te **misbruik as die afgeleë argief 'n hoër of dieselfde prioriteit het**
{% endhint %}

Hierdie tegniek kan nuttig wees vir **volharding** en **onbevestigde toegang** aangesien dit net vereis om 'n biblioteeknaam te **ken** wat in die Artefak-Registrasie gestoor is en daardie selfde biblioteek in die openbare argief (PyPi vir Python byvoorbeeld) te **skep** met 'n hoër weergawe.

Vir volharding moet jy hierdie stappe volg:

* **Vereistes**: 'n **virtuele argief** moet **bestaan** en gebruik word, 'n **interne pakkie** met 'n **naam** wat nie in die **openbare argief** bestaan nie, moet gebruik word.
* Skep 'n afgeleë argief as dit nie bestaan nie
* Voeg die afgeleë argief by die virtuele argief
* Wysig die beleide van die virtuele argief om 'n hoër prioriteit (of dieselfde) aan die afgeleë argief te gee.\
Voer iets soos uit:
* [gcloud artifacts repositories update --upstream-policy-file ...](https://cloud.google.com/sdk/gcloud/reference/artifacts/repositories/update#--upstream-policy-file)
* Laai die regte pakkie af, voeg jou skadelike kode by en registreer dit in die openbare argief met dieselfde weergawe. Elke keer as 'n ontwikkelaar dit installeer, sal hy joune installeer!

Vir meer inligting oor afhanklikheidsverwarring, kyk:

{% embed url="https://book.hacktricks.xyz/pentesting-web/dependency-confusion" %}

{% hint style="success" %}
Leer & oefen AWS Hack:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Rooi Span Kenner (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hack: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Rooi Span Kenner (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kontroleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** 💬 [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hack-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}
