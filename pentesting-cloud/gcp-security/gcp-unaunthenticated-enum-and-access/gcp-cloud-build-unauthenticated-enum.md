# GCP - Απαριθμήσει Μη Εξουσιοδοτημένων Πόρων Cloud Build

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο Hacking του AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Εκπαίδευση HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο Hacking του GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Εκπαίδευση HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε** 💬 [**στην ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Κοινοποιήστε τεχνικές χάκινγκ υποβάλλοντας PRs** στα αποθετήρια [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

## Cloud Build

Για περισσότερες πληροφορίες σχετικά με το Cloud Build, ελέγξτε:

{% content-ref url="../gcp-services/gcp-cloud-build-enum.md" %}
[gcp-cloud-build-enum.md](../gcp-services/gcp-cloud-build-enum.md)
{% endcontent-ref %}

### cloudbuild.yml

Εάν καταφέρετε να έχετε πρόσβαση εγγραφής σε ένα αποθετήριο που περιέχει ένα αρχείο με το όνομα **`cloudbuild.yml`**, θα μπορούσατε να **εισάγετε πίσω πόρτα** σε αυτό το αρχείο, το οποίο καθορίζει τις **εντολές που θα εκτελεστούν** μέσα σε ένα Cloud Build και να εξαγάγετε τα μυστικά, να καταστρέψετε το τι γίνεται και επίσης να καταστρέψετε το **λογαριασμό υπηρεσίας Cloud Build.**

{% hint style="info" %}
Σημειώστε ότι το GCP έχει τη δυνατότητα να επιτρέπει στους διαχειριστές να ελέγχουν την εκτέλεση συστημάτων δημιουργίας από εξωτερικές PR μέσω του "Έλεγχου Σχολίων". Ο Έλεγχος Σχολίων είναι μια λειτουργία όπου οι συνεργάτες/ιδιοκτήτες έργων **πρέπει να σχολιάσουν "/gcbrun" για να ενεργοποιήσουν τη δημιουργία** έναντι της PR και χρησιμοποιώντας αυτήν τη λειτουργία αποτρέπει κατ' ουσίαν οποιονδήποτε στο διαδίκτυο από το να ενεργοποιήσει τα συστήματα δημιουργίας σας.
{% endhint %}

Για κάποιες σχετικές πληροφορίες μπορείτε να ελέγξετε τη σελίδα σχετικά με το πώς να επιτεθείτε στις ενέργειες του Github (παρόμοιο με αυτό):

{% content-ref url="../../../pentesting-ci-cd/github-security/abusing-github-actions/" %}
[abusing-github-actions](../../../pentesting-ci-cd/github-security/abusing-github-actions/)
{% endcontent-ref %}

### Έγκριση PR

Όταν το trigger είναι PR επειδή **οποιοσδήποτε μπορεί να κάνει PR σε δημόσια αποθετήρια** θα ήταν πολύ επικίνδυνο να **επιτρέψετε απλά την εκτέλεση του trigger με οποιονδήποτε PR**. Συνεπώς, από προεπιλογή, η εκτέλεση θα είναι μόνο **αυτόματη για ιδιοκτήτες και συνεργάτες**, και προκειμένου να εκτελεστεί το trigger με PR άλλων χρηστών, ένας ιδιοκτήτης ή συνεργάτης πρέπει να σχολιάσει `/gcbrun`.

<figure><img src="../../../.gitbook/assets/image (339).png" alt="" width="563"><figcaption></figcaption></figure>

{% hint style="danger" %}
Συνεπώς, αν αυτό είναι ορισμένο σε **`Μη απαιτείται`**, ένας επιτιθέμενος θα μπορούσε να κάνει ένα **PR στο κλαδί** που θα ενεργοποιήσει την εκτέλεση προσθέτοντας την κακόβουλη εκτέλεση κώδικα στο αρχείο **`cloudbuild.yml`** και να καταστρέψει την εκτέλεση του cloudbuild (σημειώστε ότι το cloudbuild θα κατεβάσει τον κώδικα ΑΠΟ το PR, οπότε θα εκτελέσει το κακόβουλο **`cloudbuild.yml`**).
{% endhint %}

Επιπλέον, είναι εύκολο να δείτε αν χρειάζεται να εκτελεστεί μια εκτέλεση cloudbuild όταν στέλνετε ένα PR επειδή εμφανίζεται στο Github:

<figure><img src="../../../.gitbook/assets/image (340).png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
Έτσι, ακόμη κι αν το cloudbuild δεν εκτελείται, ο επιτιθέμενος θα μπορεί να δει το **όνομα έργου ενός έργου GCP** που ανήκει στην εταιρεία.
{% endhint %}

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο Hacking του AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Εκπαίδευση HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο Hacking του GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Εκπαίδευση HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε** 💬 [**στην ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Κοινοποιήστε τεχνικές χάκινγκ υποβάλλοντας PRs** στα αποθετήρια [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
