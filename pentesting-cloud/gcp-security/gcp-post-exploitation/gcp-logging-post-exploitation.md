# GCP - Logging Post Exploitation

{% hint style="success" %}
AWS Hacking öğrenin ve pratik yapın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking öğrenin ve pratik yapın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 Discord grubuna** [**katılın**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'ı takip edin.**
* **HackTricks'e PR göndererek hacking ipuçlarını paylaşın** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına.

</details>
{% endhint %}

## Temel Bilgiler

Daha fazla bilgi için kontrol edin:

{% content-ref url="../gcp-services/gcp-logging-enum.md" %}
[gcp-logging-enum.md](../gcp-services/gcp-logging-enum.md)
{% endcontent-ref %}

Diğer izleme bozma yöntemleri için kontrol edin:

{% content-ref url="gcp-monitoring-post-exploitation.md" %}
[gcp-monitoring-post-exploitation.md](gcp-monitoring-post-exploitation.md)
{% endcontent-ref %}

### Varsayılan Logging

**Varsayılan olarak sadece okuma işlemleri gerçekleştirdiğiniz için yakalanmazsınız. Daha fazla bilgi için Logging Enum bölümüne bakın.**

### Hariç Tutulan Principal Ekle

[https://console.cloud.google.com/iam-admin/audit/allservices](https://console.cloud.google.com/iam-admin/audit/allservices) ve [https://console.cloud.google.com/iam-admin/audit](https://console.cloud.google.com/iam-admin/audit) adreslerinde log oluşturulmaması için principal eklemek mümkündür. Bir saldırgan, yakalanmamak için bunu kötüye kullanabilir.

### Logları Oku - `logging.logEntries.list`

{% code overflow="wrap" %}
```bash
# Read logs
gcloud logging read "logName=projects/your-project-id/logs/log-id" --limit=10 --format=json

# Everything from a timestamp
gcloud logging read "timestamp >= \"2023-01-01T00:00:00Z\"" --limit=10 --format=json

# Use these options to indicate a different bucket or view to use: --bucket=_Required  --view=_Default
```
{% endcode %}

### `logging.logs.delete`

{% code overflow="wrap" %}
```bash
# Delete all entries from a log in the _Default log bucket - logging.logs.delete
gcloud logging logs delete <log-name>
```
{% endcode %}

### Log yazma - `logging.logEntries.create`

{% code overflow="wrap" %}
```bash
# Write a log entry to try to disrupt some system
gcloud logging write LOG_NAME "A deceptive log entry" --severity=ERROR
```
{% endcode %}

### `logging.buckets.update`

{% code overflow="wrap" %}
```bash
# Set retention period to 1 day (_Required has a fixed one of 400days)

gcloud logging buckets update bucketlog --location=<location> --description="New description" --retention-days=1
```
{% endcode %}

### `logging.buckets.delete`

### `logging.buckets.delete`

Bu izin, bir Logging bucket'ını silmenize olanak tanır. Bu, saldırganın izlerini örtmek için kullanabileceği bir yöntemdir. 

### `logging.buckets.update`

Bu izin, bir Logging bucket'ını güncellemenize olanak tanır. Saldırganlar, log verilerini değiştirmek veya loglamayı devre dışı bırakmak için bu izni kullanabilirler.

### `logging.logEntries.create`

Bu izin, yeni log girdileri oluşturmanıza olanak tanır. Saldırganlar, sahte loglar ekleyerek izlerini gizleyebilirler.

### `logging.logEntries.delete`

Bu izin, mevcut log girdilerini silmenize olanak tanır. Saldırganlar, kendi aktivitelerini gizlemek için bu izni kullanabilirler.

### `logging.logMetrics.create`

Bu izin, yeni log metrikleri oluşturmanıza olanak tanır. Saldırganlar, log verilerini manipüle etmek için bu izni kullanabilirler.

### `logging.logMetrics.delete`

Bu izin, mevcut log metriklerini silmenize olanak tanır. Saldırganlar, log verilerini manipüle etmek için bu izni kullanabilirler.

### `logging.logMetrics.update`

Bu izin, mevcut log metriklerini güncellemenize olanak tanır. Saldırganlar, log verilerini manipüle etmek için bu izni kullanabilirler.

### `logging.sinks.create`

Bu izin, yeni log sink'leri oluşturmanıza olanak tanır. Saldırganlar, log verilerini başka bir yere yönlendirmek için bu izni kullanabilirler.

### `logging.sinks.delete`

Bu izin, mevcut log sink'lerini silmenize olanak tanır. Saldırganlar, log verilerini başka bir yere yönlendirmek için bu izni kullanabilirler.

### `logging.sinks.update`

Bu izin, mevcut log sink'lerini güncellemenize olanak tanır. Saldırganlar, log verilerini başka bir yere yönlendirmek için bu izni kullanabilirler.

### `logging.views.create`

Bu izin, yeni log görünümleri oluşturmanıza olanak tanır. Saldırganlar, log verilerini manipüle etmek için bu izni kullanabilirler.

### `logging.views.delete`

Bu izin, mevcut log görünümlerini silmenize olanak tanır. Saldırganlar, log verilerini manipüle etmek için bu izni kullanabilirler.

### `logging.views.update`

Bu izin, mevcut log görünümlerini güncellemenize olanak tanır. Saldırganlar, log verilerini manipüle etmek için bu izni kullanabilirler.
```bash
# Delete log bucket
gcloud logging buckets delete BUCKET_NAME --location=<location>
```
### `logging.links.delete`

{% code overflow="wrap" %}
```bash
# Delete link
gcloud logging links delete <link-id> --bucket <bucket> --location <location>
```
{% endcode %}

### `logging.views.delete`

### `logging.views.delete` izni

Bu izin, bir kullanıcının belirli bir proje veya organizasyon içindeki Logging View'leri silmesine olanak tanır. Bu izni kötüye kullanmak, bir saldırganın belirli log verilerini gizlemesine veya log yönetimini bozmasına olanak tanıyabilir.

### `logging.sinks.delete` izni

Bu izin, bir kullanıcının belirli bir proje veya organizasyon içindeki Logging Sink'leri silmesine olanak tanır. Bu izni kötüye kullanmak, bir saldırganın log verilerinin belirli bir hedefe yönlendirilmesini durdurmasına olanak tanıyabilir.

### `logging.exclusions.delete` izni

Bu izin, bir kullanıcının belirli bir proje veya organizasyon içindeki Logging Exclusion'ları silmesine olanak tanır. Bu izni kötüye kullanmak, bir saldırganın belirli log verilerinin Logging'den hariç tutulmasını durdurmasına olanak tanıyabilir.

### `logging.logs.delete` izni

Bu izin, bir kullanıcının belirli bir proje veya organizasyon içindeki logları silmesine olanak tanır. Bu izni kötüye kullanmak, bir saldırganın belirli log verilerini tamamen ortadan kaldırmasına olanak tanıyabilir.

### `logging.privateLogEntries.list` izni

Bu izin, bir kullanıcının belirli bir proje veya organizasyon içindeki özel log girişlerini listelemesine olanak tanır. Bu izni kötüye kullanmak, bir saldırganın hassas veya gizli log verilerini görüntülemesine olanak tanıyabilir.

### `logging.privateLogEntries.delete` izni

Bu izin, bir kullanıcının belirli bir proje veya organizasyon içindeki özel log girişlerini silmesine olanak tanır. Bu izni kötüye kullanmak, bir saldırganın hassas veya gizli log verilerini ortadan kaldırmasına olanak tanıyabilir.
```bash
# Delete a logging view to remove access to anyone using it
gcloud logging views delete <view-id> --bucket=<bucket> --location=global
```
### `logging.views.update`

{% code overflow="wrap" %}
```bash
# Update a logging view to hide data
gcloud logging views update <view-id> --log-filter="resource.type=gce_instance" --bucket=<bucket> --location=global --description="New description for the log view"
```
{% endcode %}

### `logging.logMetrics.update`

{% code overflow="wrap" %}
```bash
# Update log based metrics - logging.logMetrics.update
gcloud logging metrics update <metric-name> --description="Changed metric description" --log-filter="severity>CRITICAL" --project=PROJECT_ID
```
{% endcode %}

### `logging.logMetrics.delete`

### `logging.logMetrics.delete`

Bu izin, bir saldırganın bir log metric'i silmesine olanak tanır. Bu, saldırganın kötü niyetli etkinliklerini gizlemek için logları manipüle etmesine yardımcı olabilir.

### `logging.logMetrics.list`

Bu izin, bir saldırganın mevcut log metric'lerini listelemesine olanak tanır. Bu, saldırganın hangi log metric'lerinin mevcut olduğunu ve hangilerinin silinmesi gerektiğini belirlemesine yardımcı olabilir.

### `logging.logMetrics.update`

Bu izin, bir saldırganın mevcut log metric'lerini güncellemesine olanak tanır. Bu, saldırganın log metric'lerini manipüle ederek kötü niyetli etkinliklerini gizlemesine yardımcı olabilir.

### `logging.logMetrics.create`

Bu izin, bir saldırganın yeni log metric'leri oluşturmasına olanak tanır. Bu, saldırganın kendi log metric'lerini ekleyerek kötü niyetli etkinliklerini gizlemesine yardımcı olabilir.

### `logging.sinks.delete`

Bu izin, bir saldırganın bir log sink'i silmesine olanak tanır. Bu, saldırganın log verilerini başka bir yere yönlendirmesini ve ardından bu yönlendirmeyi gizlemek için log sink'ini silmesini sağlar.

### `logging.sinks.list`

Bu izin, bir saldırganın mevcut log sink'lerini listelemesine olanak tanır. Bu, saldırganın hangi log sink'lerinin mevcut olduğunu ve hangilerinin silinmesi gerektiğini belirlemesine yardımcı olabilir.

### `logging.sinks.update`

Bu izin, bir saldırganın mevcut log sink'lerini güncellemesine olanak tanır. Bu, saldırganın log verilerini başka bir yere yönlendirmesini ve ardından bu yönlendirmeyi gizlemek için log sink'ini güncellemesini sağlar.

### `logging.sinks.create`

Bu izin, bir saldırganın yeni log sink'leri oluşturmasına olanak tanır. Bu, saldırganın log verilerini başka bir yere yönlendirmesini ve ardından bu yönlendirmeyi gizlemek için yeni log sink'leri oluşturmasını sağlar.

### `logging.views.delete`

Bu izin, bir saldırganın bir log view'i silmesine olanak tanır. Bu, saldırganın belirli log verilerini gizlemek için log view'lerini manipüle etmesine yardımcı olabilir.

### `logging.views.list`

Bu izin, bir saldırganın mevcut log view'lerini listelemesine olanak tanır. Bu, saldırganın hangi log view'lerinin mevcut olduğunu ve hangilerinin silinmesi gerektiğini belirlemesine yardımcı olabilir.

### `logging.views.update`

Bu izin, bir saldırganın mevcut log view'lerini güncellemesine olanak tanır. Bu, saldırganın log view'lerini manipüle ederek belirli log verilerini gizlemesine yardımcı olabilir.

### `logging.views.create`

Bu izin, bir saldırganın yeni log view'leri oluşturmasına olanak tanır. Bu, saldırganın kendi log view'lerini ekleyerek belirli log verilerini gizlemesine yardımcı olabilir.
```bash
# Delete log based metrics - logging.logMetrics.delete
gcloud logging metrics delete <metric-name>
```
### `logging.sinks.delete`

`logging.sinks.delete` izni, bir saldırganın log sink'leri silmesine olanak tanır. Bu, logların belirli bir hedefe yönlendirilmesini durdurabilir ve potansiyel olarak olay yanıt ekiplerinin saldırıyı tespit etmesini zorlaştırabilir.

```bash
gcloud logging sinks delete [SINK_NAME]
```

### `logging.logs.delete`

`logging.logs.delete` izni, bir saldırganın belirli logları silmesine olanak tanır. Bu, saldırganın izlerini örtmek için kullanabileceği bir tekniktir.

```bash
gcloud logging logs delete [LOG_NAME]
```

### `logging.exclusions.create`

`logging.exclusions.create` izni, bir saldırganın belirli logları hariç tutmasına olanak tanır. Bu, belirli olayların loglanmasını engelleyebilir ve saldırının tespit edilmesini zorlaştırabilir.

```bash
gcloud logging exclusions create [EXCLUSION_NAME] --log-filter="[FILTER]"
```

### `logging.exclusions.delete`

`logging.exclusions.delete` izni, bir saldırganın mevcut log hariç tutmalarını silmesine olanak tanır. Bu, daha önce hariç tutulan logların tekrar loglanmasını sağlayabilir.

```bash
gcloud logging exclusions delete [EXCLUSION_NAME]
```

### `logging.sinks.update`

`logging.sinks.update` izni, bir saldırganın mevcut log sink'lerini güncellemesine olanak tanır. Bu, logların farklı bir hedefe yönlendirilmesini sağlayabilir.

```bash
gcloud logging sinks update [SINK_NAME] --destination=[NEW_DESTINATION]
```

### `logging.sinks.create`

`logging.sinks.create` izni, bir saldırganın yeni log sink'leri oluşturmasına olanak tanır. Bu, logların belirli bir hedefe yönlendirilmesini sağlayabilir.

```bash
gcloud logging sinks create [SINK_NAME] --destination=[DESTINATION]
```

### `logging.metrics.create`

`logging.metrics.create` izni, bir saldırganın log tabanlı metrikler oluşturmasına olanak tanır. Bu, belirli olayların izlenmesini sağlayabilir.

```bash
gcloud logging metrics create [METRIC_NAME] --log-filter="[FILTER]"
```

### `logging.metrics.delete`

`logging.metrics.delete` izni, bir saldırganın mevcut log tabanlı metrikleri silmesine olanak tanır. Bu, belirli olayların izlenmesini durdurabilir.

```bash
gcloud logging metrics delete [METRIC_NAME]
```
```bash
# Delete sink - logging.sinks.delete
gcloud logging sinks delete <sink-name>
```
### `logging.sinks.update`

{% code overflow="wrap" %}
```bash
# Disable sink - logging.sinks.update
gcloud logging sinks update <sink-name> --disabled

# Createa filter to exclude attackers logs - logging.sinks.update
gcloud logging sinks update SINK_NAME --add-exclusion="name=exclude-info-logs,filter=severity<INFO"

# Change where the sink is storing the data - logging.sinks.update
gcloud logging sinks update <sink-name> new-destination

# Change the service account to one withuot permissions to write in the destination - logging.sinks.update
gcloud logging sinks update SINK_NAME --custom-writer-identity=attacker-service-account-email --project=PROJECT_ID

# Remove explusions to try to overload with logs - logging.sinks.update
gcloud logging sinks update SINK_NAME --clear-exclusions

# If the sink exports to BigQuery, an attacker might enable or disable the use of partitioned tables, potentially leading to inefficient querying and higher costs. - logging.sinks.update
gcloud logging sinks update SINK_NAME --use-partitioned-tables
gcloud logging sinks update SINK_NAME --no-use-partitioned-tables
```
{% endcode %}

{% hint style="success" %}
AWS Hacking öğrenin ve pratik yapın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking öğrenin ve pratik yapın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'ı takip edin.**
* **HackTricks** ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına PR göndererek hacking ipuçlarını paylaşın.

</details>
{% endhint %}
