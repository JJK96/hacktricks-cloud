# рдХреБрдмрд░рдиреЗрдЯреАрд╕ рдореЗрдВ рд╕реЗрд╡рд╛рдПрдВ рдЙрдЬрд╛рдЧрд░ рдХрд░рдирд╛

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг AWS рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг GCP рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВред

</details>
{% endhint %}

рдХреБрдмрд░рдиреЗрдЯреАрд╕ рдореЗрдВ рд╕реЗрд╡рд╛рдПрдВ рдЙрдЬрд╛рдЧрд░ рдХрд░рдиреЗ рдХреЗ **рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЗ** рд╣реИрдВ рддрд╛рдХрд┐ **рдЖрдВрддрд░рд┐рдХ** рдФрд░ **рдмрд╛рд╣реНрдп** рдЕрдВрддрдГрд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЛ рдЙрди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛ рд╕рдХреЗред рдпрд╣ рдХреБрдмрд░рдиреЗрдЯреАрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рд╢рд╛рд╕рдХ **рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рд╕реЗрд╡рд╛рдУрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИ** рдЬрд┐рдирдХреЛ рд╡реЗ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрдиреА рдЪрд╛рд╣рд┐рдПред

### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЧрдгрдирд╛

рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреЛ рд╕реЗрд╡рд╛рдПрдВ рдЙрдЬрд╛рдЧрд░ рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЛрдВ рдХреЛ рдЬрд╛рдБрдЪрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдпрд╣ рдЬрд╛рди рд▓реЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдк рдиреЗрдорд╕реНрдкреЗрд╕, рд╕реЗрд╡рд╛рдПрдВ рдФрд░ рдЗрдВрдЧреНрд░реЗрд╕ рдХреА рд╕реВрдЪреА рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдореЗрдВ рдЙрдЬрд╛рдЧрд░ рд╣рд░ рдЪреАрдЬрд╝ рдХреЛ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
kubectl get namespace -o custom-columns='NAME:.metadata.name' | grep -v NAME | while IFS='' read -r ns; do
echo "Namespace: $ns"
kubectl get service -n "$ns"
kubectl get ingress -n "$ns"
echo "=============================================="
echo ""
echo ""
done | grep -v "ClusterIP"
# Remove the last '| grep -v "ClusterIP"' to see also type ClusterIP
```
### ClusterIP

рдПрдХ **ClusterIP** рд╕реЗрд╡рд╛ **рдХреНрд▓рд╕реНрдЯрд░** рдХреА **рдореБрдЦреНрдп** Kubernetes **рд╕реЗрд╡рд╛** рд╣реИред рдпрд╣ рдЖрдкрдХреЛ рдЕрдкрдиреЗ рдХреНрд▓рд╕реНрдЯрд░ рдХреЗ рднреАрддрд░ рдПрдХ **рд╕реЗрд╡рд╛** рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдЖрдкрдХреЗ рдХреНрд▓рд╕реНрдЯрд░ рдХреЗ рдЕрдиреНрдп рдРрдкреНрд╕ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВред рдХрд┐рд╕реА **рдмрд╛рд╣рд░реА рдкрд╣реБрдВрдЪ** рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕реЗ Kubernetes Proxy рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```bash
kubectl proxy --port=8080
```
рдЕрдм, рдЖрдк Kubernetes API рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реЗрд╡рд╛рдУрдВ рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдЗрд╕ рдпреЛрдЬрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ:

`http://localhost:8080/api/v1/proxy/namespaces/<NAMESPACE>/services/<SERVICE-NAME>:<PORT-NAME>/`

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд URL рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

`http://localhost:8080/api/v1/proxy/namespaces/default/services/my-internal-service:http/`

рдЗрд╕ рд╕реЗрд╡рд╛ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП:
```yaml
apiVersion: v1
kind: Service
metadata:
name: my-internal-service
spec:
selector:
app: my-app
type: ClusterIP
ports:
- name: http
port: 80
targetPort: 80
protocol: TCP
```
_рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ `kubectl` рдХреЛ **рдкреНрд░рдорд╛рдгрд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд▓рд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред_

рд╕рднреА ClusterIPs рдХреА рд╕реВрдЪреА рдмрдирд╛рдПрдВ:

{% code overflow="wrap" %}
```bash
kubectl get services --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,TYPE:.spec.type,CLUSTER-IP:.spec.clusterIP,PORT(S):.spec.ports[*].port,TARGETPORT(S):.spec.ports[*].targetPort,SELECTOR:.spec.selector' | grep ClusterIP
```
{% endcode %}

### рдиреЛрдбрдкреЛрд░реНрдЯ

рдЬрдм **рдиреЛрдбрдкреЛрд░реНрдЯ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕рднреА рдиреЛрдбреНрд╕ рдкрд░ (рдЬреЛ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрдиреЛрдВ рдХреЛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВ) рдПрдХ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдкреЛрд░реНрдЯ рдЙрдкрд▓рдмреНрдз рд╣реЛрддрд╛ рд╣реИред рдЗрд╕ рд╡рд┐рд╢реЗрд╖ рдкреЛрд░реНрдЯ рдкрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдд **рдЯреНрд░реИрдлрд┐рдХ** рдлрд┐рд░ рд╕реЗ рд╕реЗрд╡рд╛ рдХреА рдУрд░ рд╕рд┐рд╕реНрдЯрдореЗрдЯрд┐рдХ рд░реВрдк рд╕реЗ **рд░реВрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рд╕рд╛рдорд╛рдиреНрдпрдд: рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ рдЗрд╕рдХреЗ рдиреБрдХрд╕рд╛рдиреЛрдВ рдХреЗ рдХрд╛рд░рдг рд╕рд┐рдлрд╛рд░рд┐рд╢ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рд╕рднреА рдиреЛрдбрдкреЛрд░реНрдЯреНрд╕ рдХреА рд╕реВрдЪреА:

{% code overflow="wrap" %}
```bash
kubectl get services --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,TYPE:.spec.type,CLUSTER-IP:.spec.clusterIP,PORT(S):.spec.ports[*].port,NODEPORT(S):.spec.ports[*].nodePort,TARGETPORT(S):.spec.ports[*].targetPort,SELECTOR:.spec.selector' | grep NodePort
```
{% endcode %}

NodePort рд╡рд┐рдирд┐рд░реНрджреЗрд╢рди рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг:
```yaml
apiVersion: v1
kind: Service
metadata:
name: my-nodeport-service
spec:
selector:
app: my-app
type: NodePort
ports:
- name: http
port: 80
targetPort: 80
nodePort: 30036
protocol: TCP
```
рдпрджрд┐ рдЖрдк **yaml рдореЗрдВ nodePort** рдХреЛ **рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╣реАрдВ** рдХрд░рддреЗ рд╣реИрдВ (рдпрд╣ рд╡рд╣ рдкреЛрд░реНрдЯ рд╣реИ рдЬреЛ рдЦреЛрд▓рд╛ рдЬрд╛рдПрдЧрд╛) рддреЛ **30000тАУ32767 рд░реЗрдВрдЬ** рдореЗрдВ рдПрдХ рдкреЛрд░реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

### LoadBalancer <a href="#id-0d96" id="id-0d96"></a>

**рдПрдХ рдХреНрд▓рд╛рдЙрдб рдкреНрд░рджрд╛рддрд╛ рдХреЗ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ** рд╕реЗрд╡рд╛ рдХреЛ рдмрд╛рд╣рд░реА рд░реВрдк рд╕реЗ рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИред GKE рдкрд░, рдпрд╣ рдПрдХ [рдиреЗрдЯрд╡рд░реНрдХ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░](https://cloud.google.com/compute/docs/load-balancing/network/) рдХреЛ рдЙрдард╛рдПрдЧрд╛ рдЬреЛ рдЖрдкрдХреЛ рдПрдХ рдПрдХрд▓ рдЖрдИрдкреА рдкрддрд╛ рджреЗрдЧрд╛ рдЬреЛ рд╕рднреА рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдЖрдкрдХреА рд╕реЗрд╡рд╛ рдХреЛ рдлреЙрд░рд╡рд░реНрдб рдХрд░реЗрдЧрд╛ред AWS рдореЗрдВ рдпрд╣ рдПрдХ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рд▓реЙрдиреНрдЪ рдХрд░реЗрдЧрд╛ред

рдЖрдкрдХреЛ рдкреНрд░рддрд┐ рдЙрдЬрд╛рдЧрд░рд┐рдд рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рдХреЗ рд▓рд┐рдП рднреБрдЧрддрд╛рди рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЬреЛ рдорд╣рдВрдЧрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

рд╕рднреА рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░реЛрдВ рдХреА рд╕реВрдЪреА рджреЗрдЦреЗрдВ:

{% code overflow="wrap" %}
```bash
kubectl get services --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,TYPE:.spec.type,CLUSTER-IP:.spec.clusterIP,EXTERNAL-IP:.status.loadBalancer.ingress[*],PORT(S):.spec.ports[*].port,NODEPORT(S):.spec.ports[*].nodePort,TARGETPORT(S):.spec.ports[*].targetPort,SELECTOR:.spec.selector' | grep LoadBalancer
```
{% endcode %}

### рдмрд╛рд╣рд░реА рдЖрдИрдкреА <a href="#external-ips" id="external-ips"></a>

{% hint style="success" %}
рдмрд╛рд╣рд░реА рдЖрдИрдкреА рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреА рд╕реЗрд╡рд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдЙрдЬрд╛рдЧрд░ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рдпреЗ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рддрдм рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЬрдм рдПрдХ рдмрд╛рд╣рд░реА рдХреНрд▓рд╛рдЙрдб рдкреНрд░рджрд╛рддрд╛ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реЛред

рдЙрдиреНрд╣реЗрдВ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, `EXTERNAL-IP` рдлреАрд▓реНрдб рдореЗрдВ рдорд╛рди рд╡рд╛рд▓реЗ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред
{% endhint %}

рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдЯреНрд░реИрдлрд┐рдХ **рдмрд╛рд╣рд░реА рдЖрдИрдкреА** (рдЬреИрд╕реЗ **рдЧрдВрддрд╡реНрдп рдЖрдИрдкреА**), рд╕реЗрд╡рд╛ рдкреЛрд░реНрдЯ рдкрд░, **рд╕реЗрд╡рд╛ рдЗрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдореЗрдВ рд╕реЗ рдПрдХ рдХреА рдУрд░ рдорд╛рд░реНрдЧрд┐рдХ рд╣реЛрдЧрд╛**ред `externalIPs` рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдмрдВрдзрд┐рдд рдирд╣реАрдВ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕рдХреА рдЬрд┐рдореНрдореЗрджрд╛рд░реА рдХреНрд▓рд╕реНрдЯрд░ рдкреНрд░рд╢рд╛рд╕рдХ рдХреА рд╣реЛрддреА рд╣реИред

рд╕реЗрд╡рд╛ рд╡рд┐рд╢рд┐рд╖реНрдЯрддрд╛ рдореЗрдВ, `externalIPs` рдХреЛ рдХрд┐рд╕реА рднреА `ServiceTypes` рдХреЗ рд╕рд╛рде рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, "`рдореЗрд░реА рд╕реЗрд╡рд╛`" рдХреЛ "`80.11.12.10:80`" (`externalIP:port`) рдкрд░ рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рджреНрд╡рд╛рд░рд╛ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```yaml
apiVersion: v1
kind: Service
metadata:
name: my-service
spec:
selector:
app: MyApp
ports:
- name: http
protocol: TCP
port: 80
targetPort: 9376
externalIPs:
- 80.11.12.10
```
### ExternalName

[**рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕реЗ:**](https://kubernetes.io/docs/concepts/services-networking/service/#externalname) ExternalName рдкреНрд░рдХрд╛рд░ рдХреА рд╕реЗрд╡рд╛рдПрдВ **рдПрдХ рд╕реЗрд╡рд╛ рдХреЛ рдПрдХ DNS рдирд╛рдо рд╕реЗ рдореИрдк рдХрд░рддреА рд╣реИрдВ**, `my-service` рдпрд╛ `cassandra` рдЬреИрд╕реЗ рдкрд╛рд░рдВрдкрд░рд┐рдХ рд╕реЗрд▓реЗрдХреНрдЯрд░ рдХреЛ рдирд╣реАрдВред рдЖрдк рдЗрди рд╕реЗрд╡рд╛рдУрдВ рдХреЛ `spec.externalName` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреЗ рд╣реИрдВред

рдЗрд╕ рд╕реЗрд╡рд╛ рдкрд░рд┐рднрд╛рд╖рд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `prod` рдиреЗрдорд╕реНрдкреЗрд╕ рдореЗрдВ `my-service` рд╕реЗрд╡рд╛ рдХреЛ `my.database.example.com` рд╕реЗ рдореИрдк рдХрд░рддреА рд╣реИ:
```yaml
apiVersion: v1
kind: Service
metadata:
name: my-service
namespace: prod
spec:
type: ExternalName
externalName: my.database.example.com
```
рдЬрдм `my-service.prod.svc.cluster.local` рд╣реЛрд╕реНрдЯ рдХреЛ рдЦреЛрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдХреНрд▓рд╕реНрдЯрд░ DNS рд╕реЗрд╡рд╛ `CNAME` рд░рд┐рдХреЙрд░реНрдб рд╡реИрд▓реНрдпреВ `my.database.example.com` рдХреЗ рд╕рд╛рде рд╡рд╛рдкрд╕ рдХрд░рддреА рд╣реИред `my-service` рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдЕрдиреНрдп рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдПрдХ рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЕрдВрддрд░ рд╣реИ рдХрд┐ **рд░рд┐рдбрд╛рдпрд░реЗрдХреНрд╢рди DNS рд╕реНрддрд░ рдкрд░ рд╣реЛрддрд╛ рд╣реИ** рдФрд░ рдкреНрд░реЙрдХреНрд╕реА рдпрд╛ рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдирд╣реАрдВред

рд╕рднреА ExternalNames рдХреА рд╕реВрдЪреА:

{% code overflow="wrap" %}
```bash
kubectl get services --all-namespaces | grep ExternalName
```
{% endcode %}

### рдЗрдиреНрдЧреНрд░реЗрд╕

рдЙрдкрд░реЛрдХреНрдд рд╕рднреА рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреА рддрд░рд╣, **рдЗрдиреНрдЧреНрд░реЗрд╕ рдПрдХ рд╕реЗрд╡рд╛ рдХреЗ рдкреНрд░рдХрд╛рд░ рдирд╣реАрдВ рд╣реИ**ред рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рдпрд╣ **рдХрдИ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рдордиреЗ рдмреИрдарддрд╛ рд╣реИ рдФрд░ рдПрдХ "рд╕реНрдорд╛рд░реНрдЯ рд░рд╛рдЙрдЯрд░" рдпрд╛ рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ**ред

рдЖрдк рдЗрдиреНрдЧреНрд░реЗрд╕ рдХреЗ рд╕рд╛рде рдХрдИ рд╡рд┐рднрд┐рдиреНрди рдЪреАрдЬреЗрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ **рдХрдИ рдкреНрд░рдХрд╛рд░ рдХреЗ рдЗрдиреНрдЧреНрд░реЗрд╕ рдирд┐рдпрдВрддреНрд░рдХ рд╣реИрдВ рдЬрд┐рдирдХреЗ рд╡рд┐рднрд┐рдиреНрди рдХреНрд╖рдорддрд╛рдПрдБ рд╣реИрдВ**ред

рдбрд┐рдлрд╝реЙрд▓реНрдЯ GKE рдЗрдиреНрдЧреНрд░реЗрд╕ рдирд┐рдпрдВрддреНрд░рдХ рдЖрдкрдХреЗ рд▓рд┐рдП рдПрдХ [HTTP(S) рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░](https://cloud.google.com/compute/docs/load-balancing/http/) рдЙрдард╛рдПрдЧрд╛ред рдЗрд╕рд╕реЗ рдЖрдк рдкреГрд╖реНрда рдЖрдзрд╛рд░рд┐рдд рдФрд░ рдЙрдкрдбреЛрдореЗрди рдЖрдзрд╛рд░рд┐рдд рд░реВрдЯрд┐рдВрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдк foo.yourdomain.com рдкрд░ рд╕рднреА рдХреБрдЫ foo рд╕реЗрд╡рд╛ рдХреЛ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ yourdomain.com/bar/ рдкрде рдХреЗ рдиреАрдЪреЗ рд╕рднреА рдХреБрдЫ bar рд╕реЗрд╡рд╛ рдХреЛред

GKE рдкрд░ рдПрдХ рдЗрдиреНрдЧреНрд░реЗрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд▓рд┐рдП YAML рдПрдХ [L7 HTTP рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░](https://cloud.google.com/compute/docs/load-balancing/http/) рдХреЗ рд╕рд╛рде рдЗрд╕ рддрд░рд╣ рджрд┐рдЦ рд╕рдХрддрд╛ рд╣реИ:
```yaml
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
name: my-ingress
spec:
backend:
serviceName: other
servicePort: 8080
rules:
- host: foo.mydomain.com
http:
paths:
- backend:
serviceName: foo
servicePort: 8080
- host: mydomain.com
http:
paths:
- path: /bar/*
backend:
serviceName: bar
servicePort: 8080
```
рд╕рднреА рдЗрдирдЧреНрд░реЗрд╕ рдХреА рд╕реВрдЪреА рдмрдирд╛рдПрдВ:

{% code overflow="wrap" %}
```bash
kubectl get ingresses --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,RULES:spec.rules[*],STATUS:status'
```
{% endcode %}

рдпрджреНрдпрдкрд┐ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рд╣рд░ рдПрдХ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реИ рддрд╛рдХрд┐ рдЗрд╕реЗ рдмреЗрд╣рддрд░ рд╕реЗ рдкрдврд╝рд╛ рдЬрд╛ рд╕рдХреЗ:
```bash
kubectl get ingresses --all-namespaces -o=yaml
```
### рд╕рдВрджрд░реНрдн

* [https://medium.com/google-cloud/kubernetes-nodeport-vs-loadbalancer-vs-ingress-when-should-i-use-what-922f010849e0](https://medium.com/google-cloud/kubernetes-nodeport-vs-loadbalancer-vs-ingress-when-should-i-use-what-922f010849e0)
* [https://kubernetes.io/docs/concepts/services-networking/service/](https://kubernetes.io/docs/concepts/services-networking/service/)

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг AWS рд░реЗрдб рдЯреАрдо рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг GCP рд░реЗрдб рдЯреАрдо рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
{% endhint %}
