# Kubernetes рд╣рд╛рд░реНрдбрдирд┐рдВрдЧ

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг AWS рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг GCP рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
{% endhint %}

## рдХреНрд▓рд╕реНрдЯрд░ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг

### [**Kubescape**](https://github.com/armosec/kubescape)

[**Kubescape**](https://github.com/armosec/kubescape) рдПрдХ K8s рдУрдкрди-рд╕реЛрд░реНрд╕ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ рд░рд┐рд╕реНрдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг, рд╕реБрд░рдХреНрд╖рд╛ рдЕрдиреБрдкрд╛рд▓рди, RBAC рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝рд░ рдФрд░ рдЗрдореЗрдЬ рд╕реБрд░рдХреНрд╖рд╛ рдЬрд╛рдВрдЪ рдЬреИрд╕реА рд╡рд┐рднрд┐рдиреНрди рдлреНрд░реЗрдорд╡рд░реНрдХ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдорд┐рд╕рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИ, рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╡рдВрд▓рд░реЗрдмрд┐рд▓рд┐рдЯреА рдФрд░ RBAC (рд░реЛрд▓-рдЖрдзрд╛рд░рд┐рдд-рдкрд╣реБрдВрдЪ-рдирд┐рдпрдВрддреНрд░рдг) рдЙрд▓реНрд▓рдВрдШрди рдХреЛ рд╕реНрдерд╛рдиреАрдп рд╕реНрддрд░реЛрдВ рдкрд░ рдкрд╣рд▓реЗ рд╣реА рдЪрд░рдгреЛрдВ рдореЗрдВ рдЦреЛрдЬрддрд╛ рд╣реИ, рд╕реАрдЖрдИ/рд╕реАрдбреА рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЗ рд╢реБрд░реБрдЖрддреА рдЪрд░рдгреЛрдВ рдореЗрдВ рдЬреЛрдЦрд┐рдо рд╕реНрдХреЛрд░ рдХреА рдЧрдгрдирд╛ рддреБрд░рдВрдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕рдордп рдХреЗ рд╕рд╛рде рдЬреЛрдЦрд┐рдо рд░реБрдЭрд╛рди рджрд┐рдЦрд╛рддрд╛ рд╣реИред
```bash
kubescape scan --verbose
```
### [**рдХреНрдпреВрдм-рдмреЗрдВрдЪ**](https://github.com/aquasecurity/kube-bench)

рдпрд╣ рдЯреВрд▓ [**рдХреНрдпреВрдм-рдмреЗрдВрдЪ**](https://github.com/aquasecurity/kube-bench) рдПрдХ рдЯреВрд▓ рд╣реИ рдЬреЛ рдпрд╣ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпреВрдмрд░рдиреЗрдЯреАрдЬрд╝ рд╕реБрд░рдХреНрд╖рд┐рдд рдврдВрдЧ рд╕реЗ рдбрд┐рдкреНрд▓реЙрдп рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП [**CIS рдХреНрдпреВрдмрд░рдиреЗрдЯреАрдЬрд╝ рдмреЗрдВрдЪрдорд╛рд░реНрдХ**](https://www.cisecurity.org/benchmark/kubernetes/) рдореЗрдВ рджрд░реНрдЬ рдХреА рдЧрдИ рдЬрд╛рдВрдЪреЗрдВ рдЪрд▓рд╛рддрд╛ рд╣реИред\
рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЗрдВ рд╕реЗ рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ:

* рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ рд╕реЗ kube-bench рдЪрд▓рд╛рдПрдВ (рд╣реЛрд╕реНрдЯ рдХреЗ рд╕рд╛рде PID рдиреЗрдорд╕реНрдкреЗрд╕ рд╕рд╛рдЭрд╛ рдХрд░рддреЗ рд╣реБрдП)
* рд╣реЛрд╕реНрдЯ рдкрд░ kube-bench рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рдХрдВрдЯреЗрдирд░ рдЪрд▓рд╛рдПрдВ, рдФрд░ рдлрд┐рд░ рд╣реЛрд╕реНрдЯ рдкрд░ kube-bench рд╕реАрдзреЗ рдЪрд▓рд╛рдПрдВ
* [рд░рд┐рд▓реАрдЬрд╝ рдкреЗрдЬ](https://github.com/aquasecurity/kube-bench/releases) рд╕реЗ рдирд╡реАрдирддрдо рдмрд╛рдЗрдирд░реА рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ,
* рд╕реНрд░реЛрдд рд╕реЗ рдЗрд╕реЗ рдХрдВрдкрд╛рдЗрд▓ рдХрд░реЗрдВред

### [**рдХреНрдпреВрдмрдСрдбрд┐рдЯ**](https://github.com/Shopify/kubeaudit)

рдпрд╣ рдЯреВрд▓ [**рдХреНрдпреВрдмрдСрдбрд┐рдЯ**](https://github.com/Shopify/kubeaudit) рдПрдХ рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдЯреВрд▓ рдФрд░ рдПрдХ рдЧреЛ рдкреИрдХреЗрдЬ рд╣реИ рдЬреЛ **рдХреНрдпреВрдмрд░рдиреЗрдЯреАрдЬрд╝ рдХреНрд▓рд╕реНрдЯрд░** рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрдмрдВрдзрд┐рдд рдЪрд┐рдВрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдСрдбрд┐рдЯ рдХрд░рддрд╛ рд╣реИред

рдХреНрдпреВрдмрдСрдбрд┐рдЯ рдпрд╣ рдбрд┐рдЯреЗрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рдПрдХ рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ рдЪрд▓ рд░рд╣рд╛ рд╣реИред рдЕрдЧрд░ рд╣рд╛рдВ, рддреЛ рдпрд╣ рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛ рдХрд┐ рдЙрд╕ рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рд╕рднреА рдХреНрдпреВрдмрд░рдиреЗрдЯреАрдЬрд╝ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдСрдбрд┐рдЯ рдХрд░реЗрдВ:
```
kubeaudit all
```
рдЗрд╕ рдЯреВрд▓ рдореЗрдВ рдПрд░реНрдЧреНрдпреВрдореЗрдВрдЯ `autofix` рднреА рд╣реИ рдЬреЛ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдкрддрд╛ рд▓рдЧреА рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рдареАрдХ рдХрд░рддрд╛ рд╣реИред**

### [**Kube-hunter**](https://github.com/aquasecurity/kube-hunter)

рдпрд╣ рдЯреВрд▓ [**kube-hunter**](https://github.com/aquasecurity/kube-hunter) рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝ рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рдХрдорд┐рдпреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЯреВрд▓ рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЬрд╛рдЧрд░реВрдХрддрд╛ рдФрд░ рджреГрд╢реНрдпрддрд╛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред
```bash
kube-hunter --remote some.node.com
```
### [**Kubei**](https://github.com/Erezf-p/kubei)

[**Kubei**](https://github.com/Erezf-p/kubei) рдПрдХ vulnerabilities рд╕реНрдХреИрдирд┐рдВрдЧ рдФрд░ CIS Docker benchmark рдЯреВрд▓ рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЙрдирдХреЗ рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝ рдХреНрд▓рд╕реНрдЯрд░ рдХрд╛ рд╕рдЯреАрдХ рдФрд░ рддрддреНрдХрд╛рд▓ рдЬреЛрдЦрд┐рдо рдореВрд▓реНрдпрд╛рдВрдХрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред Kubei рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝ рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд░рд╣реА рд╕рднреА рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рд╕реНрдХреИрди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреЙрдбреНрд╕ рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдкреЙрдбреНрд╕ рдХреА рдЫрд╡рд┐рдпрд╛рдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

### [**KubiScan**](https://github.com/cyberark/KubiScan)

[**KubiScan**](https://github.com/cyberark/KubiScan) рдПрдХ рдЯреВрд▓ рд╣реИ рдЬреЛ Kubernetes рдХреНрд▓рд╕реНрдЯрд░ рдХреЛ рд╕реНрдХреИрди рдХрд░рддрд╛ рд╣реИ рдФрд░ Kubernetes рдХреЗ Role-based access control (RBAC) рдЕрдзрд┐рдХрд╛рд░ рдореЙрдбрд▓ рдореЗрдВ рдЬреЛрдЦрд┐рдордкреВрд░реНрдг рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЦрддрд░рдирд╛рдХ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИред

### [Managed Kubernetes Auditing Toolkit](https://github.com/DataDog/managed-kubernetes-auditing-toolkit)

[**Mkat**](https://github.com/DataDog/managed-kubernetes-auditing-toolkit) рдПрдХ рдЯреВрд▓ рд╣реИ рдЬреЛ рдЕрдиреНрдп рдкреНрд░рдХрд╛рд░ рдХреА рдЙрдЪреНрдЪ рдЬреЛрдЦрд┐рдо рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬреЛ рдЕрдиреНрдп рдЯреВрд▓реЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВред рдЗрд╕рдореЗрдВ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ 3 рд╡рд┐рднрд┐рдиреНрди рдореЛрдб рд╣реИрдВ:

* **`find-role-relationships`**: рдЬреЛ рдЦреЛрдЬреЗрдЧрд╛ рдХрд┐ рдХреМрди рд╕реЗ AWS roles рдХреМрди рд╕реЗ рдкреЙрдбреНрд╕ рдореЗрдВ рдЪрд▓ рд░рд╣реЗ рд╣реИрдВ
* **`find-secrets`**: рдЬреЛ K8s рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдореЗрдВ рд░рд╣рд╕реНрдпреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛ рдЬреИрд╕реЗ Pods, ConfigMaps, рдФрд░ Secretsред
* **`test-imds-access`**: рдЬреЛ рдкреЙрдбреНрд╕ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛ рдФрд░ рдореЗрдЯрд╛рдбреЗрдЯрд╛ v1 рдФрд░ v2 рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛ред рдЪреЗрддрд╛рд╡рдиреА: рдпрд╣ рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рдПрдХ рдкреЙрдб рдЪрд▓рд╛рдПрдЧрд╛, рдмрд╣реБрдд рд╕рд╛рд╡рдзрд╛рди рд░рд╣реЗрдВ рдХреНрдпреЛрдВрдХрд┐ рд╢рд╛рдпрдж рдЖрдк рдРрд╕рд╛ рдХрд░рдирд╛ рдирд╣реАрдВ рдЪрд╛рд╣реЗрдВрдЧреЗ!

## **IaC рдХреЛрдб рдХреА рдорд╛рдиреНрдпрддрд╛ рдХреА рдЬрд╛рдБрдЪ**

### [**Popeye**](https://github.com/derailed/popeye)

[**Popeye**](https://github.com/derailed/popeye) рдПрдХ рдЙрдкрдпреЛрдЧреАрддрд╛ рд╣реИ рдЬреЛ рд▓рд╛рдЗрд╡ Kubernetes рдХреНрд▓рд╕реНрдЯрд░ рдХреЛ рд╕реНрдХреИрди рдХрд░рддреА рд╣реИ рдФрд░ **рдбрд┐рдкреНрд▓реЙрдп рдХрд┐рдП рдЧрдП рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдФрд░ рд╡рд┐рдиреНрдпрд╛рд╕реЛрдВ рдореЗрдВ рд╕рдВрднрд╛рд╡рд┐рдд рдореБрджреНрджреЛрдВ рдХреА рд░рд┐рдкреЛрд░реНрдЯ** рдХрд░рддреА рд╣реИред рдпрд╣ рдЖрдкрдХреЗ рдХреНрд▓рд╕реНрдЯрд░ рдХреЛ рдЙрд╕ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдХрд░рдХреЗ рд╕рд╛рдл рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдбрд┐рдкреНрд▓реЙрдп рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рди рдХрд┐ рдЬреЛ рдбрд┐рд╕реНрдХ рдкрд░ рдмреИрдард╛ рд╣реИред рдЕрдкрдиреЗ рдХреНрд▓рд╕реНрдЯрд░ рдХреЛ рд╕реНрдХреИрди рдХрд░рдХреЗ, рдпрд╣ рдЧрд▓рдд рд╡рд┐рдиреНрдпрд╛рд╕реЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИ рдФрд░ рдЖрдкрдХреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╕рд░реНрд╡реЛрддреНрддрдо рдЕрднреНрдпрд╛рд╕ рд╕реНрдерд╛рди рдкрд░ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рднрд╡рд┐рд╖реНрдп рдХреА рдкрд░реЗрд╢рд╛рдирд┐рдпреЛрдВ рд╕реЗ рдмрдЪрд╛ рдЬрд╛ рд╕рдХреЗред рдпрд╣ рд╡рдиреНрджрд░рдгреАрдп рдЕрдзрд┐рдХрд╛рд░рд┐рдХ рдУрд╡рд░рд▓реЛрдб рдХреЛ рдХрдо рдХрд░рдиреЗ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд░рдЦрддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдкрдбрд╝рддрд╛ рд╣реИ рдЬрдм рдХреЛрдИ рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝ рдХреНрд▓рд╕реНрдЯрд░ рдХреЛ рдЬрдВрдЧрд▓ рдореЗрдВ рдЪрд▓рд╛рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реЛрддреА рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдпрджрд┐ рдЖрдкрдХрд╛ рдХреНрд▓рд╕реНрдЯрд░ рдПрдХ рдореИрдЯреНрд░рд┐рдХ-рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рд╕рдВрднрд╛рд╡рд┐рдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рдЕрдзрд┐рдХ/рдХрдо рдЖрд╡рдВрдЯрди рдФрд░ рдпрджрд┐ рдЖрдкрдХреЗ рдХреНрд▓рд╕реНрдЯрд░ рдХреНрд╖рдорддрд╛ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рдП, рддреЛ рдЖрдкрдХреЛ рдЪреЗрддрд╛рди рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИред

### [**KICS**](https://github.com/Checkmarx/kics)

[**KICS**](https://github.com/Checkmarx/kics) **рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо**, рдЕрдиреБрдкрд╛рд▓рди рдореБрджреНрджреЗ, рдФрд░ рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдорд┐рд╕рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдЦреЛрдЬрддрд╛ рд╣реИ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд **рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдЬреИрд╕реЗ рдХреЛрдб рд╕рдорд╛рдзрд╛рдиреЛрдВ** рдореЗрдВ: Terraform, Kubernetes, Docker, AWS CloudFormation, Ansible, Helm, Microsoft ARM, рдФрд░ OpenAPI 3.0 рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛

### [**Checkov**](https://github.com/bridgecrewio/checkov)

[**Checkov**](https://github.com/bridgecrewio/checkov) рдПрдХ рд╕реНрдереИрддрд┐рдХ рдХреЛрдб рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдЯреВрд▓ рд╣реИ рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░-рдЬреИрд╕реЗ-рдХреЛрдб рдХреЗ рд▓рд┐рдПред

рдпрд╣ [Terraform](https://terraform.io), Terraform рдкреНрд▓рд╛рди, [Cloudformation](https://aws.amazon.com/cloudformation/), [AWS SAM](https://aws.amazon.com/serverless/sam/), [Kubernetes](https://kubernetes.io), [Dockerfile](https://www.docker.com), [Serverless](https://www.serverless.com) рдпрд╛ [ARM Templates](https://docs.microsoft.com/en-us/azure/azure-resource-manager/templates/overview) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рдХреНрд▓рд╛рдЙрдб рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдХреЛ рд╕реНрдХреИрди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЧреНрд░рд╛рдл-рдЖрдзрд╛рд░рд┐рдд рд╕реНрдХреИрдирд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдЕрдиреБрдкрд╛рд▓рди рдорд┐рд╕рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИред

### [**Kube-score**](https://github.com/zegl/kube-score)

[**kube-score**](https://github.com/zegl/kube-score) рдПрдХ рдЯреВрд▓ рд╣реИ рдЬреЛ рдЖрдкрдХреЗ Kubernetes рдСрдмреНрдЬреЗрдХреНрдЯ рдкрд░рд┐рднрд╛рд╖рд╛рдУрдВ рдХрд╛ рд╕реНрдереИрддрд┐рдХ рдХреЛрдб рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддрд╛ рд╣реИред

рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

| рд╡рд┐рддрд░рдг                                             | рдХрдорд╛рдВрдб / рд▓рд┐рдВрдХ                                                                          |
| --------------------------------------------------- | --------------------------------------------------------------------------------------- |
| macOS, Linux, рдФрд░ Windows рдХреЗ рд▓рд┐рдП рдкреВрд░реНрд╡-рдирд┐рд░реНрдорд┐рдд рдмрд╛рдЗрдирд░реА | [GitHub releases](https://github.com/zegl/kube-score/releases)                          |
| Docker                                              | `docker pull zegl/kube-score` ([Docker Hub)](https://hub.docker.com/r/zegl/kube-score/) |
| Homebrew (macOS рдФрд░ Linux)                          | `brew install kube-score`                                                               |
| [Krew](https://krew.sigs.k8s.io/) (macOS рдФрд░ Linux) | `kubectl krew install score`                                                            |

## рд╕реБрдЭрд╛рд╡

### Kubernetes PodSecurityContext рдФрд░ SecurityContext

рдЖрдк **рдкреЙрдбреНрд╕ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрджрд░реНрдн** рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (_PodSecurityContext_) рдФрд░ **рдХрдВрдЯреЗрдирд░реНрд╕** рдХреА рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрджрд░реНрдн рдХреЛ рдЬреЛ рдЪрд▓рд╛рдП рдЬрд╛рдПрдБрдЧреЗ (_SecurityContext_)ред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдкрдврд╝реЗрдВ:

{% content-ref url="kubernetes-securitycontext-s.md" %}
[kubernetes-securitycontext-s.md](kubernetes-securitycontext-s.md)
{% endcontent-ref %}

### Kubernetes API Hardening

рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝ рдПрдкреАрдЖрдИ рд╕рд░реНрд╡рд░ рдХрд╛ **рдкрд╣реБрдБрдЪ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдирд╛** рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдкрд░реНрдпрд╛рдкреНрдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рд╡рд╛рд▓рд╛ рдПрдХ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдХрд▓рд╛рдХрд╛рд░ рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдХрдИ рддрд░рд╣ рдХреЗ рдиреБрдХрд╕рд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реИред\
рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ **рдкрд╣реБрдБрдЪ** рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП (**рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ** рдореВрд▓реЛрдВ рдХреЛ рдПрдкреАрдЖрдИ рд╕рд░реНрд╡рд░ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ рдФрд░ рдХрд┐рд╕реА рдЕрдиреНрдп рдХрдиреЗрдХреНрд╢рди рдХреЛ рдирдХрд╛рд░рдирд╛) рдФрд░ [**рдкреНрд░рдорд╛рдгреАрдХрд░рдг**](https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/) (рдХрдо рд╕реЗ рдХрдо рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреЗ рд╕рд┐рджреНрдзрд╛рдВрдд рдХрд╛ рдкрд╛рд▓рди рдХрд░рдирд╛)ред рдФрд░ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ **рдХрднреА рднреА** **рдЕрдирд╛рдордд** **рдЕрдиреБрд░реЛрдзреЛрдВ** рдХреА **рдЕрдиреБрдорддрд┐** **рдирд╣реАрдВ** **рджреЗрдиреА**ред

**рд╕рд╛рдорд╛рдиреНрдп рдЕрдиреБрд░реЛрдз рдкреНрд░рдХреНрд░рд┐рдпрд╛:**\
рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдпрд╛ K8s рд╕реЗрд╡рд╛ рдЦрд╛рддрд╛ тАУ> рдкреНрд░рдорд╛рдгреАрдХрд░рдг тАУ> рдЕрдзрд┐рдХрд╛рд░реАрдХрд░рдг тАУ> рдкреНрд░рд╡реЗрд╢ рдирд┐рдпрдВрддреНрд░рдгред

**рд╕реБрдЭрд╛рд╡**:

* рдкреЛрд░реНрдЯ рдмрдВрдж рдХрд░реЗрдВред
* рдЕрдирд╛рдордд рдкрд╣реБрдБрдЪ рд╕реЗ рдмрдЪреЗрдВред
* NodeRestriction; рдПрдкреАрдЖрдИ рд╕реЗ рд╡рд┐рд╢реЗрд╖ рдиреЛрдбреЛрдВ рдХреА рдХреЛрдИ рдкрд╣реБрдБрдЪ рди рд╣реЛред
* [https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#noderestriction](https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#noderestriction)
* рдореВрд▓ рд░реВрдк рд╕реЗ kubelets рдХреЛ рдиреЛрдб-рдкреНрд░рддрд┐рдмрдВрдз.kubernetes.io/ рдЙрдкрд╕рд░реНрдЧ рдХреЗ рд╕рд╛рде рд▓реЗрдмрд▓ рдЬреЛрдбрд╝рдиреЗ/рд╣рдЯрд╛рдиреЗ/рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрддрд╛ рд╣реИред рдпрд╣ рд▓реЗрдмрд▓ рдЙрдкрд╕рд░реНрдЧ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рдиреЛрдб рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рд▓реЗрдмрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд╛рд░реНрдпрдХрд▓рд╛рдкреЛрдВ рдХреЗ рд▓рд┐рдП рдЖрд░рдХреНрд╖рд┐рдд рд╣реИ, рдФрд░ kubelets рдХреЛ рдЗрд╕ рдЙрдкрд╕рд░реНрдЧ рдХреЗ рд╕рд╛рде рд▓реЗрдмрд▓реЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреА рдЬрд╛рдПрдЧреАред
* рдФрд░ рднреА, рд▓реЗрдмрд▓ рдХреЗ рд╕рд╛рде рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд╛рд░реНрдпрдХрд▓рд╛рдк рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВред
* рдПрдкреАрдЖрдИ рдкрд╣реБрдБрдЪ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рдкреЙрдб рд╕реЗ рдмрдЪреЗрдВред
* рдЗрдВрдЯрд░рдиреЗрдЯ рдХреЛ рдПрдкреАрдЖрдИ рд╕рд░реНрд╡рд░ рдХрд╛ рд╕рд╛рдордирд╛ рди рдХрд░реЗрдВред
* рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдБрдЪ RBAC рд╕реЗ рдмрдЪреЗрдВред
* рдлрд╛рдпрд░рд╡реЙрд▓ рдФрд░ рдЖрдИрдкреА рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯрд┐рдВрдЧ рдХреЗ рд╕рд╛рде ApiServer рдкреЛрд░реНрдЯ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░реЗрдВред

### SecurityContext Hardening

рдбрд┐рдлрд╝реЙрд▓
```yaml
apiVersion: v1
kind: Pod
metadata:
name: security-context-demo
spec:
securityContext:
runAsUser: 1000
runAsGroup: 3000
fsGroup: 2000
volumes:
- name: sec-ctx-vol
emptyDir: {}
containers:
- name: sec-ctx-demo
image: busybox
command: [ "sh", "-c", "sleep 1h" ]
securityContext:
runAsNonRoot: true
volumeMounts:
- name: sec-ctx-vol
mountPath: /data/demo
securityContext:
allowPrivilegeEscalation: true
```
* [https://kubernetes.io/docs/tasks/configure-pod-container/security-context/](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)
* [https://kubernetes.io/docs/concepts/policy/pod-security-policy/](https://kubernetes.io/docs/concepts/policy/pod-security-policy/)

### рд╕рд╛рдорд╛рдиреНрдп рд╣рд╛рд░реНрдбрдирд┐рдВрдЧ

рдЖрдкрдХреЛ рдЕрдкрдиреЗ Kubernetes environment рдХреЛ рдЬрд┐рддрдиреА рдЬрд░реБрд░рдд рд╣реЛ рдЙрддрдиреА рдмрд╛рд░ рдЕрдкрдбреЗрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП:

* Dependencies рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВред
* Bug рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдкреИрдЪреЗрд╕ред

[**рд░рд┐рд▓реАрдЬрд╝ рд╕рд╛рдЗрдХрд┐рд▓**](https://kubernetes.io/docs/setup/release/version-skew-policy/): рд╣рд░ 3 рдорд╣реАрдиреЗ рдореЗрдВ рдПрдХ рдирдпрд╛ рдорд╛рдЗрдирд░ рд░рд┐рд▓реАрдЬрд╝ рд╣реЛрддрд╛ рд╣реИ -- 1.20.3 = 1(Major).20(Minor).3(patch)

**Kubernetes Cluster рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╣реИ (рдпрд╣рд╛рдБ рд╕реЗ** [**рдпрд╣рд╛рдБ**](https://kubernetes.io/docs/tasks/administer-cluster/cluster-upgrade/)**):**

* рдЗрд╕ рдХреНрд░рдо рдореЗрдВ рдорд╛рд╕реНрдЯрд░ рдиреЛрдб components рдХреЛ рдЕрдкрдЧреНрд░реЗрдб рдХрд░реЗрдВ:
* etcd (рд╕рднреА instances).
* kube-apiserver (рд╕рднреА control plane hosts).
* kube-controller-manager.
* kube-scheduler.
* cloud controller manager, рдЕрдЧрд░ рдЖрдк рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░рддреЗ рд╣реИрдВред
* kube-proxy, kubelet рдЬреИрд╕реЗ Worker Node components рдХреЛ рдЕрдкрдЧреНрд░реЗрдб рдХрд░реЗрдВред

{% hint style="success" %}
AWS Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдкреНрд░реИрдХреНрдЯрд┐рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдкреНрд░реИрдХреНрдЯрд┐рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
{% endhint %}
