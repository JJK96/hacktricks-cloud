# –ó–∞—Ö–∏—Å—Ç Kubernetes

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –≤–∑–ª–æ–º AWS: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –≤–∑–ª–æ–º GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ—à–∏—Ä—é–π—Ç–µ —Ö–∞–∫–µ—Ä—Å—å–∫—ñ —Ç—Ä—é–∫–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>
{% endhint %}

## –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –∫–ª–∞—Å—Ç–µ—Ä–∞

### [**Kubescape**](https://github.com/armosec/kubescape)

[**Kubescape**](https://github.com/armosec/kubescape) - —Ü–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç K8s, —è–∫–∏–π –Ω–∞–¥–∞—î –±–∞–≥–∞—Ç–æ—Ö–º–∞—Ä–∫–æ–≤–∏–π –æ–¥–∏–Ω –ø–æ–≥–ª—è–¥ –Ω–∞ K8s, –≤–∫–ª—é—á–∞—é—á–∏ –∞–Ω–∞–ª—ñ–∑ —Ä–∏–∑–∏–∫—ñ–≤, –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å –±–µ–∑–ø–µ—Ü—ñ, –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ç–æ—Ä RBAC —Ç–∞ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π –∑–æ–±—Ä–∞–∂–µ–Ω—å. Kubescape —Å–∫–∞–Ω—É—î –∫–ª–∞—Å—Ç–µ—Ä–∏ K8s, —Ñ–∞–π–ª–∏ YAML —Ç–∞ HELM-—á–∞—Ä—Ç–∏, –≤–∏—è–≤–ª—è—é—á–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –∑–≥—ñ–¥–Ω–æ –∑ –∫—ñ–ª—å–∫–æ–º–∞ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞–º–∏ (—Ç–∞–∫–∏–º–∏ —è–∫ [NSA-CISA](https://www.armosec.io/blog/kubernetes-hardening-guidance-summary-by-armo), [MITRE ATT\&CK¬Æ](https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/)), –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —Ç–∞ –ø–æ—Ä—É—à–µ–Ω–Ω—è RBAC (–∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–æ–ª–µ–π) –Ω–∞ —Ä–∞–Ω–Ω—ñ—Ö –µ—Ç–∞–ø–∞—Ö –∫–æ–Ω–≤–µ—î—Ä–∞ CI/CD, –æ–±—á–∏—Å–ª—é—î —Ä–∏–∑–∏–∫–æ–≤–∏–π –±–∞–ª –º–∏—Ç—Ç—î–≤–æ —Ç–∞ –ø–æ–∫–∞–∑—É—î —Ç–µ–Ω–¥–µ–Ω—Ü—ñ—ó —Ä–∏–∑–∏–∫—É –∑ —á–∞—Å–æ–º.
```bash
kubescape scan --verbose
```
### [**Kube-bench**](https://github.com/aquasecurity/kube-bench)

–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [**kube-bench**](https://github.com/aquasecurity/kube-bench) - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫–∏–π –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–æ Kubernetes –±–µ–∑–ø–µ—á–Ω–æ, –∑–∞–ø—É—Å–∫–∞—é—á–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ –≤ [**CIS Kubernetes Benchmark**](https://www.cisecurity.org/benchmark/kubernetes/).\
–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–±—Ä–∞—Ç–∏:

* –∑–∞–ø—É—Å—Ç–∏—Ç–∏ kube-bench –∑—Å–µ—Ä–µ–¥–∏–Ω–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (—Å–ø—ñ–ª—å–Ω–∏–π –ø—Ä–æ—Å—Ç—ñ—Ä PID –∑ —Ö–æ—Å—Ç–æ–º)
* –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, —è–∫–∏–π –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î kube-bench –Ω–∞ —Ö–æ—Å—Ç—ñ, –∞ –ø–æ—Ç—ñ–º –∑–∞–ø—É—Å—Ç–∏—Ç–∏ kube-bench –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –Ω–∞ —Ö–æ—Å—Ç—ñ
* –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ –±—ñ–Ω–∞—Ä–Ω—ñ —Ñ–∞–π–ª–∏ –∑—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ [Releases page](https://github.com/aquasecurity/kube-bench/releases),
* —Å–∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ –π–æ–≥–æ –∑ –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É.

### [**Kubeaudit**](https://github.com/Shopify/kubeaudit)

–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [**kubeaudit**](https://github.com/Shopify/kubeaudit) - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞ —Ç–∞ –ø–∞–∫–µ—Ç Go –¥–ª—è **–ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∫–ª–∞—Å—Ç–µ—Ä—ñ–≤ Kubernetes** –Ω–∞ —Ä—ñ–∑–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏ –∑ –±–µ–∑–ø–µ–∫–æ—é.

Kubeaudit –º–æ–∂–µ –≤–∏—è–≤–∏—Ç–∏, —á–∏ –≤—ñ–Ω –ø—Ä–∞—Ü—é—î –≤ –º–µ–∂–∞—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ –∫–ª–∞—Å—Ç–µ—Ä—ñ. –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤—ñ–Ω —Å–ø—Ä–æ–±—É—î –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—Å—ñ —Ä–µ—Å—É—Ä—Å–∏ Kubernetes –≤ —Ü—å–æ–º—É –∫–ª–∞—Å—Ç–µ—Ä—ñ:
```
kubeaudit all
```
–¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Ç–∞–∫–æ–∂ –º–∞—î –∞—Ä–≥—É–º–µ–Ω—Ç `autofix` –¥–ª—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –≤–∏—è–≤–ª–µ–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º.**

### [**Kube-hunter**](https://github.com/aquasecurity/kube-hunter)

–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [**kube-hunter**](https://github.com/aquasecurity/kube-hunter) —à—É–∫–∞—î –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –±–µ–∑–ø–µ–∫–∏ –≤ –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö Kubernetes. –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –±—É–≤ —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π –¥–ª—è –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è —É—Å–≤—ñ–¥–æ–º–ª–µ–Ω–æ—Å—Ç—ñ —Ç–∞ –≤–∏–¥–∏–º–æ—Å—Ç—ñ –ø—Ä–æ–±–ª–µ–º –±–µ–∑–ø–µ–∫–∏ –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö Kubernetes.
```bash
kube-hunter --remote some.node.com
```
### [**Kubei**](https://github.com/Erezf-p/kubei)

[**Kubei**](https://github.com/Erezf-p/kubei) - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –±–µ–∑–ø–µ–∫–∏ CIS Docker, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ç–æ—á–Ω—É —Ç–∞ –º–∏—Ç—Ç—î–≤—É –æ—Ü—ñ–Ω–∫—É —Ä–∏–∑–∏–∫—É —ó—Ö –∫–ª–∞—Å—Ç–µ—Ä—ñ–≤ Kubernetes. Kubei —Å–∫–∞–Ω—É—î –≤—Å—ñ –æ–±—Ä–∞–∑–∏, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ –∫–ª–∞—Å—Ç–µ—Ä—ñ Kubernetes, –≤–∫–ª—é—á–∞—é—á–∏ –æ–±—Ä–∞–∑–∏ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö —Ç–∞ —Å–∏—Å—Ç–µ–º–Ω–∏—Ö –ø—ñ–¥—Å–∏—Å—Ç–µ–º.

### [**KubiScan**](https://github.com/cyberark/KubiScan)

[**KubiScan**](https://github.com/cyberark/KubiScan) - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –∫–ª–∞—Å—Ç–µ—Ä–∞ Kubernetes –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Ä–∏–∑–∏–∫–æ–≤–∞–Ω–∏—Ö –¥–æ–∑–≤–æ–ª—ñ–≤ —É –º–æ–¥–µ–ª—ñ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–æ–ª–µ–π (RBAC) Kubernetes.

### [Managed Kubernetes Auditing Toolkit](https://github.com/DataDog/managed-kubernetes-auditing-toolkit)

[**Mkat**](https://github.com/DataDog/managed-kubernetes-auditing-toolkit) - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —ñ–Ω—à–∏—Ö —Ç–∏–ø—ñ–≤ –≤–∏—Å–æ–∫–æ—Ä–∏–∑–∏–∫–æ–≤–∏—Ö –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ —ñ–Ω—à–∏–º–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏. –í—ñ–Ω –º–∞—î –≥–æ–ª–æ–≤–Ω—ñ 3 —Ä—ñ–∑–Ω—ñ —Ä–µ–∂–∏–º–∏:

* **`find-role-relationships`**: –¶–µ–π —Ä–µ–∂–∏–º –∑–Ω–∞—Ö–æ–¥–∏—Ç—å, —è–∫—ñ —Ä–æ–ª—ñ AWS –ø—Ä–∞—Ü—é—é—Ç—å —É —è–∫–∏—Ö –ø—ñ–¥—Å–∏—Å—Ç–µ–º–∞—Ö
* **`find-secrets`**: –°–ø—Ä–æ–±—É—î —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç–∏ –≤ —Ä–µ—Å—É—Ä—Å–∞—Ö K8s, —Ç–∞–∫–∏—Ö —è–∫ –ü—ñ–¥—Å–∏—Å—Ç–µ–º–∏, –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω—ñ –∫–∞—Ä—Ç–∏ —Ç–∞ –°–µ–∫—Ä–µ—Ç–∏.
* **`test-imds-access`**: –°–ø—Ä–æ–±—É—î –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –ø—ñ–¥—Å–∏—Å—Ç–µ–º–∏ —Ç–∞ —Å–ø—Ä–æ–±—É—î –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –º–µ—Ç–∞–¥–∞–Ω–∏—Ö v1 —Ç–∞ v2. –ü–û–ü–ï–†–ï–î–ñ–ï–ù–ù–Ø: –¶–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—ñ–¥—Å–∏—Å—Ç–µ–º—É –≤ –∫–ª–∞—Å—Ç–µ—Ä—ñ, –±—É–¥—å—Ç–µ –¥—É–∂–µ –æ–±–µ—Ä–µ–∂–Ω—ñ, –æ—Å–∫—ñ–ª—å–∫–∏ –º–æ–∂–ª–∏–≤–æ, –≤–∞–º —Ü—å–æ–≥–æ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–æ–±–∏—Ç–∏!

## **–ê—É–¥–∏—Ç –∫–æ–¥—É IaC**

### [**Popeye**](https://github.com/derailed/popeye)

[**Popeye**](https://github.com/derailed/popeye) - —Ü–µ —É—Ç–∏–ª—ñ—Ç–∞, —è–∫–∞ —Å–∫–∞–Ω—É—î –∂–∏–≤–∏–π –∫–ª–∞—Å—Ç–µ—Ä Kubernetes —Ç–∞ **–ø–æ–≤—ñ–¥–æ–º–ª—è—î –ø—Ä–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏ –∑ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ —Ç–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è–º–∏**. –í–æ–Ω–∞ –æ—á–∏—â—É—î –≤–∞—à –∫–ª–∞—Å—Ç–µ—Ä –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç–æ–≥–æ, —â–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–æ, –∞ –Ω–µ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç–æ–≥–æ, —â–æ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ –¥–∏—Å–∫—É. –°–∫–∞–Ω—É—é—á–∏ –≤–∞—à –∫–ª–∞—Å—Ç–µ—Ä, –≤–æ–Ω–∞ –≤–∏—è–≤–ª—è—î –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Ç–∞ –¥–æ–ø–æ–º–∞–≥–∞—î –≤–∞–º –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ –≤ –Ω—å–æ–º—É –¥–æ—Ç—Ä–∏–º—É—é—Ç—å—Å—è –Ω–∞–π–∫—Ä–∞—â—ñ –ø—Ä–∞–∫—Ç–∏–∫–∏, —Ç–∏–º —Å–∞–º–∏–º –∑–∞–ø–æ–±—ñ–≥–∞—é—á–∏ –º–∞–π–±—É—Ç–Ω—ñ–º –ø—Ä–æ–±–ª–µ–º–∞–º. –í–æ–Ω–∞ —Å–ø—Ä—è–º–æ–≤–∞–Ω–∞ –Ω–∞ –∑–º–µ–Ω—à–µ–Ω–Ω—è –∫–æ–≥–Ω—ñ—Ç–∏–≤–Ω–æ–≥–æ _–ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è_, –∑ —è–∫–∏–º —Å—Ç–∏–∫–∞—î—Ç—å—Å—è –ª—é–¥–∏–Ω–∞ –ø—Ä–∏ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—ñ –∫–ª–∞—Å—Ç–µ—Ä–æ–º Kubernetes —É –¥–∏–∫—ñ–π –ø—Ä–∏—Ä–æ–¥—ñ. –ö—Ä—ñ–º —Ç–æ–≥–æ, —è–∫—â–æ –≤–∞—à –∫–ª–∞—Å—Ç–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º–µ—Ç—Ä–∏—á–Ω–∏–π —Å–µ—Ä–≤–µ—Ä, –≤–æ–Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª—è—î –ø—Ä–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –ø–µ—Ä–µ–≤–∏—â–µ–Ω–Ω—è –∞–±–æ –Ω–µ–¥–æ—Å—Ç–∞—á—ñ —Ä–µ—Å—É—Ä—Å—ñ–≤ —Ç–∞ –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –ø–æ–ø–µ—Ä–µ–¥–∏—Ç–∏ –≤–∞—Å, —è–∫—â–æ –≤–∞—à –∫–ª–∞—Å—Ç–µ—Ä –≤–∏—á–µ—Ä–ø–∞—î –º—ñ—Å—Ç–∫—ñ—Å—Ç—å.

### [**KICS**](https://github.com/Checkmarx/kics)

[**KICS**](https://github.com/Checkmarx/kics) –∑–Ω–∞—Ö–æ–¥–∏—Ç—å **–≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –±–µ–∑–ø–µ–∫–∏**, –ø—Ä–æ–±–ª–µ–º–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ —Ç–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—ñ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –≤ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö **—Ä—ñ—à–µ–Ω–Ω—è—Ö –Ü–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏ —è–∫ –∫–æ–¥—É**: Terraform, Kubernetes, Docker, AWS CloudFormation, Ansible, Helm, Microsoft ARM —Ç–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è OpenAPI 3.0

### [**Checkov**](https://github.com/bridgecrewio/checkov)

[**Checkov**](https://github.com/bridgecrewio/checkov) - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –∫–æ–¥—É –¥–ª—è —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏ —è–∫ –∫–æ–¥—É.

–í—ñ–Ω —Å–∫–∞–Ω—É—î —Ö–º–∞—Ä–Ω—É —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É, —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é [Terraform](https://terraform.io), –ø–ª–∞–Ω—É Terraform, [Cloudformation](https://aws.amazon.com/cloudformation/), [AWS SAM](https://aws.amazon.com/serverless/sam/), [Kubernetes](https://kubernetes.io), [Dockerfile](https://www.docker.com), [Serverless](https://www.serverless.com) –∞–±–æ [–®–∞–±–ª–æ–Ω–∏ ARM](https://docs.microsoft.com/en-us/azure/azure-resource-manager/templates/overview) —Ç–∞ –≤–∏—è–≤–ª—è—î –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—ñ –∑ —Ç–æ—á–∫–∏ –∑–æ—Ä—É –±–µ–∑–ø–µ–∫–∏ —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≥—Ä–∞—Ñ—ñ–≤.

### [**Kube-score**](https://github.com/zegl/kube-score)

[**kube-score**](https://github.com/zegl/kube-score) - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫–∏–π –≤–∏–∫–æ–Ω—É—î —Å—Ç–∞—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –∫–æ–¥—É –≤–∏–∑–Ω–∞—á–µ–Ω—å –æ–±'—î–∫—Ç—ñ–≤ Kubernetes.

–î–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è:

| –†–æ–∑–ø–æ–¥—ñ–ª                                      | –ö–æ–º–∞–Ω–¥–∞ / –ü–æ—Å–∏–ª–∞–Ω–Ω—è                                                                      |
| -------------------------------------------- | ----------------------------------------------------------------------------------------- |
| –ì–æ—Ç–æ–≤—ñ –±—ñ–Ω–∞—Ä–Ω—ñ —Ñ–∞–π–ª–∏ –¥–ª—è macOS, Linux —Ç–∞ Windows | [–í–∏–ø—É—Å–∫–∏ GitHub](https://github.com/zegl/kube-score/releases)                          |
| Docker                                       | `docker pull zegl/kube-score` ([Docker Hub)](https://hub.docker.com/r/zegl/kube-score/) |
| Homebrew (macOS —Ç–∞ Linux)                    | `brew install kube-score`                                                               |
| [Krew](https://krew.sigs.k8s.io/) (macOS —Ç–∞ Linux) | `kubectl krew install score`                                                            |

## –ü–æ—Ä–∞–¥–∏

### –ö–æ–Ω—Ç–µ–∫—Å—Ç –±–µ–∑–ø–µ–∫–∏ Kubernetes PodSecurityContext —Ç–∞ SecurityContext

–í–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ **–∫–æ–Ω—Ç–µ–∫—Å—Ç –±–µ–∑–ø–µ–∫–∏ –ø—ñ–¥—Å–∏—Å—Ç–µ–º** (–∑ _PodSecurityContext_) —Ç–∞ **–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤**, —è–∫—ñ –±—É–¥—É—Ç—å –∑–∞–ø—É—â–µ–Ω—ñ (–∑ _SecurityContext_). –î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —á–∏—Ç–∞–π—Ç–µ:

{% content-ref url="kubernetes-securitycontext-s.md" %}
[kubernetes-securitycontext-s.md](kubernetes-securitycontext-s.md)
{% endcontent-ref %}

### –ó–∞—Ö–∏—Å—Ç API Kubernetes

–î—É–∂–µ –≤–∞–∂–ª–∏–≤–æ **–∑–∞—Ö–∏—â–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ API Kubernetes**, –æ—Å–∫—ñ–ª—å–∫–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑ –¥–æ—Å—Ç–∞—Ç–Ω—ñ–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏ –º–æ–∂–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –Ω–∏–º —Ç–∞ –∑–∞–≤–¥–∞—Ç–∏ —à–∫–æ–¥—É –Ω–∞–≤–∫–æ–ª–∏—à–Ω—å–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—É.\
–í–∞–∂–ª–∏–≤–æ –∑–∞—Ö–∏—â–∞—Ç–∏ —è–∫ **–¥–æ—Å—Ç—É–ø** (**–±—ñ–ª—ñ—Å—Ç** –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ API —Ç–∞ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è –±—É–¥—å-—è–∫–æ–≥–æ —ñ–Ω—à–æ–≥–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è) —Ç–∞–∫ —ñ [**–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é**](https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/) (–¥–æ—Ç—Ä–∏–º—É—é—á–∏—Å—å –ø—Ä–∏–Ω—Ü–∏–ø—É **–º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏—Ö** **–ø—Ä–∏–≤—ñ–ª–µ—ó–≤**). –Ü –æ–±–æ–≤'—è–∑–∫–æ–≤–æ **–Ω—ñ–∫–æ–ª–∏** **–Ω–µ** **–¥–æ–∑–≤–æ–ª—è–π—Ç–µ** **–∞–Ω–æ–Ω—ñ–º–Ω—ñ** **–∑–∞–ø–∏—Ç–∏**.

**–ó–∞–≥–∞–ª—å–Ω–∏–π –ø—Ä–æ—Ü–µ—Å –∑–∞–ø–∏—Ç—É:**\
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–±–æ –°–µ—Ä–≤—ñ—Å–Ω–∏–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å K8s ‚Äì> –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è ‚Äì> –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è ‚Äì> –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ–ø—É—Å–∫—É.

**–ü–æ—Ä–∞–¥–∏**:

* –ó–∞–∫—Ä–∏–π—Ç–µ –ø–æ—Ä—Ç–∏.
* –£–Ω–∏–∫–∞–π—Ç–µ –∞–Ω–æ–Ω—ñ–º–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É.
* –û–±–º–µ–∂–µ–Ω–Ω—è –≤—É–∑–ª—ñ–≤; –ù–µ–º–∞—î –¥–æ—Å—Ç—É–ø—É –∑ –ø–µ–≤–Ω–∏—Ö –≤—É–∑–ª—ñ–≤ –¥–æ API.
* [https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#noderestriction](https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#noderestriction)
* –§–∞–∫—Ç–∏—á–Ω–æ –∑–∞–ø–æ–±—ñ–≥–∞—î kubelets –¥–æ–¥–∞–≤–∞—Ç–∏/–≤–∏–¥–∞–ª—è—Ç–∏/–æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –º—ñ—Ç–∫–∏ –∑ –ø—Ä–µ—Ñ—ñ–∫—Å–æ–º node-restriction.kubernetes.io/. –¶–µ–π –ø—Ä–µ—Ñ—ñ–∫—Å –º—ñ—Ç–æ–∫ –∑–∞—Ä–µ–∑–µ—Ä–≤–æ–≤–∞–Ω–∏–π –¥–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤ –¥–ª—è –º—ñ—Ç–æ–∫ —ó—Ö –æ–±'—î–∫—Ç—ñ–≤ –≤—É–∑–ª—ñ–≤ –¥–ª—è —Ü—ñ–ª–µ–π —ñ–∑–æ–ª—è—Ü—ñ—ó —Ä–æ–±–æ—á–∏—Ö –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å, —ñ kubelets –Ω–µ –º–∞—Ç–∏–º—É—Ç—å –¥–æ–∑–≤–æ–ª—É –Ω–∞ –∑–º—ñ–Ω—É –º—ñ—Ç–æ–∫ –∑ —Ü–∏–º –ø—Ä–µ—Ñ—ñ–∫—Å–æ–º.
* –¢–∞–∫–æ–∂ –¥–æ–∑–≤–æ–ª—è—î kubelets –¥–æ–¥–∞–≤–∞—Ç–∏/–≤–∏–¥–∞–ª—è—Ç–∏/–æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —Ü—ñ –º—ñ—Ç–∫–∏ —Ç–∞ –ø—Ä–µ—Ñ—ñ–∫—Å–∏ –º—ñ—Ç–æ–∫.
* –ó–∞–±–µ–∑–ø–µ—á—Ç–µ –∑ –º—ñ—Ç–∫–∞–º–∏ –±–µ–∑–ø–µ—á–Ω—É —ñ–∑–æ–ª—è—Ü—ñ—é —Ä–æ–±–æ—á–∏—Ö –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å.
* –£–Ω–∏–∫–∞–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –ø—ñ–¥—Å–∏—Å—Ç–µ–º –¥–æ—Å—Ç—É–ø—É –¥–æ API.
* –£–Ω–∏–∫–∞–π—Ç–µ –≤–∏–∫–ª–∞–¥–∞–Ω–Ω—è ApiServer –≤ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç.
* –£–Ω–∏–∫–∞–π—Ç–µ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É RBAC.
* –ü–æ—Ä—Ç ApiServer –∑ –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä–æ–º —Ç–∞ –±—ñ–ª—ñ—Å—Ç–∏–Ω–≥–æ–º IP.
```yaml
apiVersion: v1
kind: Pod
metadata:
name: security-context-demo
spec:
securityContext:
runAsUser: 1000
runAsGroup: 3000
fsGroup: 2000
volumes:
- name: sec-ctx-vol
emptyDir: {}
containers:
- name: sec-ctx-demo
image: busybox
command: [ "sh", "-c", "sleep 1h" ]
securityContext:
runAsNonRoot: true
volumeMounts:
- name: sec-ctx-vol
mountPath: /data/demo
securityContext:
allowPrivilegeEscalation: true
```
* [https://kubernetes.io/docs/tasks/configure-pod-container/security-context/](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)
* [https://kubernetes.io/docs/concepts/policy/pod-security-policy/](https://kubernetes.io/docs/concepts/policy/pod-security-policy/)

### –ó–∞–≥–∞–ª—å–Ω–µ –∑–º—ñ—Ü–Ω–µ–Ω–Ω—è

–í–∞–º —Å–ª—ñ–¥ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —Å–≤–æ—î —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ Kubernetes —Ç–∞–∫ —á–∞—Å—Ç–æ, —è–∫ —Ü–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ, —â–æ–± –º–∞—Ç–∏:

* –û–Ω–æ–≤–ª–µ–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ.
* –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫ —Ç–∞ –±–µ–∑–ø–µ–∫–∏.

[**–¶–∏–∫–ª–∏ –≤–∏–ø—É—Å–∫—É**](https://kubernetes.io/docs/setup/release/version-skew-policy/): –ö–æ–∂–Ω—ñ 3 –º—ñ—Å—è—Ü—ñ –≤–∏—Ö–æ–¥–∏—Ç—å –Ω–æ–≤–∏–π –¥—Ä—ñ–±–Ω–∏–π –≤–∏–ø—É—Å–∫ -- 1.20.3 = 1(–û—Å–Ω–æ–≤–Ω–∏–π).20(–î—Ä—ñ–±–Ω–∏–π).3(–ø–∞—Ç—á)

**–ù–∞–π–∫—Ä–∞—â–∏–π —Å–ø–æ—Å—ñ–± –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–ª–∞—Å—Ç–µ—Ä–∞ Kubernetes (–∑** [**—Ç—É—Ç**](https://kubernetes.io/docs/tasks/administer-cluster/cluster-upgrade/)**):**

* –û–Ω–æ–≤—ñ—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –≤—É–∑–ª–∞ –º–∞–π—Å—Ç—Ä–∞ –≤ —Ç–∞–∫—ñ–π –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ:
* etcd (–≤—Å—ñ –µ–∫–∑–µ–º–ø–ª—è—Ä–∏).
* kube-apiserver (–≤—Å—ñ —Ö–æ—Å—Ç–∏ –ø–ª–∞–Ω—É —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è).
* kube-controller-manager.
* kube-scheduler.
* –∫–µ—Ä—É—é—á–∏–π –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä —Ö–º–∞—Ä–∏, —è–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –π–æ–≥–æ.
* –û–Ω–æ–≤—ñ—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –≤—É–∑–ª–∞ —Ä–æ–±–æ—á–æ–≥–æ –º—ñ—Å—Ü—è, —Ç–∞–∫—ñ —è–∫ kube-proxy, kubelet.

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –≤–∑–ª–æ–º AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –≤–∑–ª–æ–º GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ—à–∏—Ä—é–π—Ç–µ —Ö–∞–∫–µ—Ä—Å—å–∫—ñ —Ç—Ä—é–∫–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}
