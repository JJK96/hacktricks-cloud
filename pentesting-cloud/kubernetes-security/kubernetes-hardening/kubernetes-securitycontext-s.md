# Kubernetes SecurityContext(s)

{% hint style="success" %}
Leer & oefen AWS Hack:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hack: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Controleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}

## PodSecurityContext <a href="#podsecuritycontext-v1-core" id="podsecuritycontext-v1-core"></a>

[**Van die dokumente:**](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core)

Wanneer jy die sekuriteitskonteks van 'n Pod spesifiseer, kan jy verskeie eienskappe gebruik. Vanuit 'n verdedigende sekuriteits-oogpunt moet jy oorweeg:

* Om **runASNonRoot** as **Waar** te h√™
* Om **runAsUser** te konfigureer
* Indien moontlik, oorweeg om **beperkings** op **regte** aan te dui deur **seLinuxOptions** en **seccompProfile**
* Moet **NIET** voorregte **groep** toegang gee via **runAsGroup** en **supplementaryGroups**

| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>fsGroup</strong></a><br><em>heeltal</em></p>                                                                                                                                                                                                                                                 | <p>'n Spesiale aanvullende groep wat van toepassing is op <strong>alle houers in 'n pod</strong>. Sommige volume-tipes laat die Kubelet toe om die eiendomsreg van daardie volume te <strong>verander</strong> sodat dit deur die pod besit word:<br>1. Die besit-GID sal die FSGroup wees<br>2. Die setgid-bit is ingestel (nuwe l√™ers wat in die volume geskep word, sal deur FSGroup besit word)<br>3. Die toestemmingsbits word OF met rw-rw----. Indien ongespesifiseer, sal die Kubelet nie die eiendomsreg en toestemmings van enige volume wysig nie</p> |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>fsGroupChangePolicy</strong></a><br><em>string</em></p>                                                                                                                                                                                                                                      | Dit definieer die gedrag van **verandering van eiendomsreg en toestemming van die volume** voordat dit binne die Pod blootgestel word.                                                                                                                                                                                                                                                                                                                                                                         |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>runAsGroup</strong></a><br><em>heeltal</em></p>                                                                                                                                                                                                                                              | Die **GID om die ingangspunt van die houerproses uit te voer**. Gebruik die standaard tydens uitvoer as ongespesifiseer. Kan ook in SecurityContext ingestel word.                                                                                                                                                                                                                                                                                                                                                        |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>runAsNonRoot</strong></a><br><em>booleaans</em></p>                                                                                                                                                                                                                                            | Dui aan dat die houer as 'n nie-wortelgebruiker moet loop. Indien waar, sal die Kubelet die beeld tydens uitvoer valideer om te verseker dat dit nie as UID 0 (wortel) loop nie en sal die houer nie begin as dit wel so is nie.                                                                                                                                                                                                                                                                          |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>runAsUser</strong></a><br><em>heeltal</em></p>                                                                                                                                                                                                                                               | Die **UID om die ingangspunt van die houerproses uit te voer**. Standaard na die gebruiker gespesifiseer in die beeldmetadata indien ongespesifiseer.                                                                                                                                                                                                                                                                                                                                                              |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>seLinuxOptions</strong></a><br><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#selinuxoptions-v1-core"><em>SELinuxOptions</em></a><br><em>Meer inligting oor</em> <em><strong>seLinux</strong></em></p>                                                           | Die **SELinux-konteks wat op alle houers toegepas moet word**. Indien ongespesifiseer, sal die houer-uitvoertyd 'n ewekansige SELinux-konteks vir elke houer toewys.                                                                                                                                                                                                                                                                                                                             |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>seccompProfile</strong></a><br><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#seccompprofile-v1-core"><em>SeccompProfile</em></a><br><em>Meer inligting oor</em> <em><strong>Seccomp</strong></em></p>                                                           | Die **seccomp-opsies wat deur die houers** in hierdie pod gebruik moet word.                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>supplementalGroups</strong></a><br><em>heeltal-reeks</em></p>                                                                                                                                                                                                                                | 'n Lys van **groepe wat op die eerste proses wat in elke houer uitgevoer word, toegepas word**, bo en behalwe die houer se prim√™re GID.                                                                                                                                                                                                                                                                                                                                                                  |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>sysctls</strong></a><br><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#sysctl-v1-core"><em>Sysctl</em></a> <em>reeks</em><br><em>Meer inligting oor</em> <a href="https://www.garron.me/en/go2linux/sysctl-linux.html"><em><strong>sysctls</strong></em></a></p> | Sysctls hou 'n lys van **genaamspasie-sysctls wat vir die pod gebruik word**. Houers met nie-ondersteunde sysctls (deur die houer-uitvoertyd) mag dalk nie kan begin nie.                                                                                                                                                                                                                                                                                                                                        |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>windowsOptions</strong></a><br><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#windowssecuritycontextoptions-v1-core"><em>WindowsSecurityContextOptions</em></a></p>                                                                                           | Die Windows-spesifieke instellings wat op alle houers toegepas moet word. Indien ongespesifiseer, sal die opsies binne 'n houer se SecurityContext gebruik word.                                                                                                                                                                                                                                                                                                                                               |
## SecurityContext

[**Van die dokumente:**](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core)

Hierdie konteks word ingestel binne die **houdersdefinisies**. Vanuit 'n verdedigende sekuriteits-oogpunt moet jy oorweeg:

* **allowPrivilegeEscalation** na **Valse**
* Moet nie sensitiewe **vermo√´ns** byvoeg nie (en verwyder diegene wat jy nie nodig het nie)
* **privileged** na **Valse**
* Indien moontlik, stel **readOnlyFilesystem** as **Waar** in
* Stel **runAsNonRoot** as **Waar** in en stel 'n **runAsUser**
* Indien moontlik, oorweeg om **beperking** van **toestemmings** aan te dui deur **seLinuxOptions** en **seccompProfile**
* **MOET NIE** **privilege** **groep** toegang gee via **runAsGroup.**

Let daarop dat die eienskappe wat in **beide SecurityContext en PodSecurityContext** ingestel is, die waarde wat in **SecurityContext** gespesifiseer is, neem **voorkeur**.

| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>allowPrivilegeEscalation</strong></a><br><em>boolean</em></p>                                                                                                                                                                      | **AllowPrivilegeEscalation** beheer of 'n proses meer bevoegdhede kan kry as sy ouerproses. Hierdie booleaan beheer direk of die no\_new\_privs-vlag op die houerproses ingestel sal word. AllowPrivilegeEscalation is altyd waar wanneer die houer as **Privileged** uitgevoer word of **CAP\_SYS\_ADMIN** het |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>capabilities</strong></a><br><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#capabilities-v1-core"><em>Capabilities</em></a><br><em>Meer inligting oor</em> <em><strong>Capabilities</strong></em></p>  | Die **vermo√´ns om by te voeg/af te skakel wanneer houers uitgevoer word**. Standaard na die verstekstel van vermo√´ns.                                                                                                                                                                                                                    |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>privileged</strong></a><br><em>boolean</em></p>                                                                                                                                                                                    | Voer houer uit in bevoorregte modus. Prosesse in bevoorregte houers is essensieel **gelykstaande aan root op die gasheer**. Standaard na vals.                                                                                                                                                                               |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>procMount</strong></a><br><em>string</em></p>                                                                                                                                                                                      | procMount dui die **tipe proc-mount aan wat gebruik moet word vir die houers**. Die verstek is DefaultProcMount wat die houerbedryfstelsel se verstekte instellings vir leesalleen-paaie en gemaskerde paaie gebruik.                                                                                                                                    |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>readOnlyRootFilesystem</strong></a><br><em>boolean</em></p>                                                                                                                                                                        | Of hierdie **houer 'n leesalleen-wortel-l√™erstelsel het**. Verstek is vals.                                                                                                                                                                                                                                             |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>runAsGroup</strong></a><br><em>integer</em></p>                                                                                                                                                                                    | Die **GID om die ingangspunt** van die houerproses uit te voer. Gebruik die bedryfstelselverstek as dit nie ingestel is nie.                                                                                                                                                                                                |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>runAsNonRoot</strong></a><br><em>boolean</em></p>                                                                                                                                                                                  | Dui aan dat die houer **as 'n nie-root-gebruiker moet uitgevoer word**. Indien waar, sal die Kubelet die beeld by uitvoer tydens hardlooptyd valideer om te verseker dat dit nie as UID 0 (root) uitgevoer word nie en sal die houer nie begin as dit wel so is nie.                                                                                                          |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>runAsUser</strong></a><br><em>integer</em></p>                                                                                                                                                                                     | Die **UID om die ingangspunt** van die houerproses uit te voer. Verstek na die gebruiker wat in die beeldmetadata gespesifiseer is indien nie gespesifiseer nie.                                                                                                                                                                                                  |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>seLinuxOptions</strong></a><br><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#selinuxoptions-v1-core"><em>SELinuxOptions</em></a><br><em>Meer inligting oor</em> <em><strong>seLinux</strong></em></p> | Die **SELinux-konteks wat op die houer toegepas moet word**. Indien nie gespesifiseer nie, sal die houerbedryfstelsel 'n ewekansige SELinux-konteks vir elke houer toewys.                                                                                                                                                                  |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>seccompProfile</strong></a><br><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#seccompprofile-v1-core"><em>SeccompProfile</em></a></p>                                                               | Die **seccomp-opsies** om deur hierdie houer gebruik te word.                                                                                                                                                                                                                                                                         |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>windowsOptions</strong></a><br><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#windowssecuritycontextoptions-v1-core"><em>WindowsSecurityContextOptions</em></a></p>                                 | Die **Windows-spesifieke instellings** wat op alle houers toegepas word.                                                                                                                                                                                                                                                              |

## Verwysings

* [https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core)
* [https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core)

{% hint style="success" %}
Leer & oefen AWS Hack: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hack: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kontroleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}
