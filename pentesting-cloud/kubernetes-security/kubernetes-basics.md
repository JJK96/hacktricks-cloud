# Kubernetes Basics

## Kubernetes Basics

{% hint style="success" %}
**AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:**<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг AWS рд░реЗрдб рдЯреАрдо рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
**GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:** <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг GCP рд░реЗрдб рдЯреАрдо рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕**](https://github.com/carlospolop/hacktricks) **рдФрд░ [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреНрд▓рд╛рдЙрдб**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
{% endhint %}

**рдЗрд╕ рдкреГрд╖реНрда рдХреЗ рдореВрд▓ рд▓реЗрдЦрдХ рд╣реИрдВ** [**Jorge**](https://www.linkedin.com/in/jorge-belmonte-a924b616b/) **(рдЙрдирдХреЗ рдореВрд▓ рдкреЛрд╕реНрдЯ рдХреЛ рдкрдврд╝реЗрдВ** [**рдпрд╣рд╛рдБ**](https://sickrov.github.io)**)**

## рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдФрд░ рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

### Kubernetes рдХреНрдпрд╛ рдХрд░рддрд╛ рд╣реИ?

* рдПрдХ рдХрдВрдЯреЗрдирд░ рдЗрдВрдЬрди рдореЗрдВ рдХрдВрдЯреЗрдирд░/рдХрдВрдЯреЗрдирд░реНрд╕ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
* рдЕрдиреБрд╕реВрдЪреА рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЛ рдорд┐рд╢рди рдХреЛ рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рдмрдирд╛рддрд╛ рд╣реИред
* рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЛ рдЬреАрд╡рд┐рдд рд░рдЦрддрд╛ рд╣реИред
* рдХрдВрдЯреЗрдирд░ рд╕рдВрдЪрд╛рд░ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
* рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рддрдХрдиреАрдХреЛрдВ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
* рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╡реЙрд▓реНрдпреВрдо рдХрд╛ рд╕рдВрднрд╛рд▓рди рдХрд░рддрд╛ рд╣реИред

### рд╡рд╛рд╕реНрддреБрдХрд▓рд╛

![](https://sickrov.github.io/media/Screenshot-68.jpg)

* **рдиреЛрдб**: рдкреЙрдб рдпрд╛ рдкреЙрдб рдХреЗ рд╕рд╛рде рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдоред
* **рдкреЙрдб**: рдПрдХ рдХрдВрдЯреЗрдирд░ рдпрд╛ рдПрдХрд╛рдзрд┐рдХ рдХрдВрдЯреЗрдирд░ рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рд▓рдкреЗрдЯрдиреЗ рд╡рд╛рд▓рд╛ред рдПрдХ рдкреЙрдб рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП (рдЗрд╕рд▓рд┐рдП рд╕рд╛рдорд╛рдиреНрдпрдд: рдПрдХ рдкреЙрдб рдореЗрдВ рдХреЗрд╡рд▓ 1 рдХрдВрдЯреЗрдирд░ рдЪрд▓рддрд╛ рд╣реИ)ред рдкреЙрдб рдХрдВрдЯреЗрдирд░ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдЪрд▓рд╛рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рд╣реИред
* **рд╕реЗрд╡рд╛**: рдкреНрд░рддреНрдпреЗрдХ рдкреЙрдб рдХреЗ рдкрд╛рд╕ рдиреЛрдб рдХреЗ рдЖрдВрддрд░рд┐рдХ **рдЖрдИрдкреА рдкрддрд╛** рд╣реЛрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕реЗ рдПрдХ рд╕реЗрд╡рд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреА рдЙрдЬрд╛рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╕реЗрд╡рд╛ рдХреЗ рдкрд╛рд╕ рднреА рдПрдХ рдЖрдИрдкреА рдкрддрд╛ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдкреЙрдбреНрд╕ рдХреЗ рдмреАрдЪ рд╕рдВрдЪрд╛рд░ рдХреЛ рдмрдирд╛рдП рд░рдЦрдирд╛ рд╣реИ, рддрд╛рдХрд┐ рдпрджрд┐ рдХреЛрдИ рдорд░ рдЬрд╛рддрд╛ рд╣реИ рддреЛ **рдирдпрд╛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди** (рдПрдХ рд╡рд┐рднрд┐рдиреНрди рдЖрдВрддрд░рд┐рдХ рдЖрдИрдкреА рдХреЗ рд╕рд╛рде) **рд╕реЗрд╡рд╛ рдХреЗ рд╕рдорд╛рди рдЖрдИрдкреА рдореЗрдВ рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп рд╣реЛрдЧрд╛**ред рдЗрд╕реЗ рдЖрдВрддрд░рд┐рдХ рдпрд╛ рдмрд╛рд╣реНрдп рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╕реЗрд╡рд╛ рдЬрдм **рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ** рддреЛ рдЖрдк рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд╡рд╛ рдХреЗ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП `kubectl get endpoints` рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВред
* **рдХреНрдпреВрдмрд▓реЗрдЯ**: рдкреНрд░рд╛рдердорд┐рдХ рдиреЛрдб рдПрдЬреЗрдВрдЯред рдЙрд╕ рдШрдЯрдХ рдХрд╛ рдЬреЛ рдиреЛрдб рдФрд░ рдХреБрдмреЗрдХреНрдЯрд▓ рдХреЗ рдмреАрдЪ рд╕рдВрдЪрд╛рд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдХреЗрд╡рд▓ рдкреЙрдбреНрд╕ рдХреЛ рдЪрд▓рд╛ рд╕рдХрддрд╛ рд╣реИ (API рд╕рд░реНрд╡рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ)ред рдХреНрдпреВрдмрд▓реЗрдЯ рдЙрди рдХрдВрдЯреЗрдирд░реЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдирд╣реАрдВ рдХрд░рддрд╛ рдЬреЛ рдХреБрдмрд░рдиреЗрдЯреНрд╕ рджреНрд╡рд╛рд░рд╛ рдирд╣реАрдВ рдмрдирд╛рдП рдЧрдП рд╣реЛрдВред
* **рдХреНрдпреВрдм-рдкреНрд░реЙрдХреНрд╕реА**: рдпрд╣ рд╕реЗрд╡рд╛ рдПрдкреАрд╕рд░реНрд╡рд░ рдФрд░ рдиреЛрдб рдХреЗ рдмреАрдЪ рд╕рдВрдЪрд╛рд░ (рд╕реЗрд╡рд╛рдПрдВ) рдХрд╛ рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред рдЖрдИрдкреАрдЯреЗрдмрд▓реНрд╕ рдХреЗ рд▓рд┐рдП рдиреЛрдб рд╣реИред рдЕрдзрд┐рдХ рдЕрдиреБрднрд╡реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдиреНрдп рд╡рд┐рдХреНрд░реЗрддрд╛рдУрдВ рд╕реЗ рдЕрдиреНрдп рдХреНрдпреВрдм-рдкреНрд░реЙрдХреНрд╕реА рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* **рд╕рд╛рдЗрдбрдХрд╛рд░ рдХрдВрдЯреЗрдирд░**: рд╕рд╛рдЗрдбрдХрд╛рд░ рдХрдВрдЯреЗрдирд░ рдореБрдЦреНрдп рдХрдВрдЯреЗрдирд░ рдХреЗ рд╕рд╛рде рдкреЙрдб рдореЗрдВ рдЪрд▓рдиреЗ рд╡рд╛рд▓реЗ рдХрдВрдЯреЗрдирд░ рд╣реИрдВред рдпрд╣ рд╕рд╛рдЗрдбрдХрд╛рд░ рдкреИрдЯрд░реНрди рдореМрдЬреВрджрд╛ рдХрдВрдЯреЗрдирд░реЛрдВ рдХреА рдХреНрд╖рдорддрд╛ рдХреЛ рдмрдврд╝рд╛рддрд╛ рд╣реИ рдмрд┐рдирд╛ рдЙрдиреНрд╣реЗрдВ рдмрджрд▓реЗред рдЖрдЬрдХрд▓, рд╣рдореЗрдВ рдкрддрд╛ рд╣реИ рдХрд┐ рд╣рдо рдХрдВрдЯреЗрдирд░ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╣рд╛рдВ рднреА рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ рдмрд╛рдВрдзрдиреЗ рдХреЗ рд▓рд┐рдП рдХрдВрдЯреЗрдирд░ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдПрдХ рдХрдВрдЯреЗрдирд░ рдХреЗрд╡рд▓ рдПрдХ рдЪреАрдЬ рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╡рд╣ рдЪреАрдЬ рдмрд╣реБрдд рдЕрдЪреНрдЫреЗ рд╕реЗ рдХрд░рддрд╛ рд╣реИред
* **рдорд╛рд╕реНрдЯрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛:**
* **рдПрдкреА рд╕рд░реНрд╡рд░:** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдФрд░ рдкреЙрдбреНрд╕ рдХрд╛ рдорд╛рд╕реНрдЯрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рд╣реИред рдХреЗрд╡рд▓ рдкреНрд░рдорд╛рдгрд┐рдд рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрдиреА рдЪрд╛рд╣рд┐рдПред
* **рд╕реНрдХреЗрдЬреНрдпреВрд▓рд░**: рд╕реНрдХреЗрдЬреНрдпреВрд▓рд┐рдВрдЧ рдХрд╛ рддрд╛рддреНрдкрд░реНрдп рд╣реИ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдХрд┐ рдкреЙрдбреНрд╕ рдХреЛ рдиреЛрдбреНрд╕ рд╕реЗ рдорд┐рд▓рд╛рдпрд╛ рдЬрд╛рдП рддрд╛рдХрд┐ рдХреНрдпреВрдмрд▓реЗрдЯ рдЙрдиреНрд╣реЗрдВ рдЪрд▓рд╛ рд╕рдХреЗред рдЗрд╕рдореЗрдВ рдкрд░реНрдпрд╛рдкреНрдд рдмреБрджреНрдзрд┐рдорддреНрддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕рд╛ рдиреЛрдб рдЕрдзрд┐рдХ рдЙрдкрд▓рдмреНрдз рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд╕рд╛рде рд╣реИ рдФрд░ рдирдП рдкреЙрдб рдХреЛ рдЙрд╕реЗ рд╕реМрдВрдкрд╛ рдЬрд╛рдПред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕реНрдХреЗрдЬреНрдпреВрд▓рд░ рдирдП рдкреЙрдбреНрд╕ рд╢реБрд░реВ рдирд╣реАрдВ рдХрд░рддрд╛, рдпрд╣ рдХреЗрд╡рд▓ рдиреЛрдб рдХреЗ рдЕрдВрджрд░ рдЪрд▓ рд░рд╣реЗ рдХреНрдпреВрдмрд▓реЗрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдирдП рдкреЙрдб рдХреЛ рд▓реЙрдиреНрдЪ рдХрд░реЗрдЧрд╛ред
* **рдХреНрдпреВрдм рдирд┐рдпрдВрддреНрд░рдХ рдкреНрд░рдмрдВрдзрдХ**: рдпрд╣ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдЬреИрд╕реЗ рдХрд┐ рд░реЗрдкреНрд▓рд┐рдХрд╛ рд╕реЗрдЯреНрд╕ рдпрд╛ рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯреНрд╕ рдХреА рдЬрд╛рдБрдЪ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпрджрд┐, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╕рд╣реА рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдкреЙрдбреНрд╕ рдпрд╛ рдиреЛрдбреНрд╕ рдЪрд▓ рд░рд╣реЗ рд╣реИрдВ рдпрд╛ рдирд╣реАрдВред рдпрджрд┐ рдХреЛрдИ рдкреЙрдб рдЧрд╛рдпрдм рд╣реИ, рддреЛ рдпрд╣ рдирдпрд╛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдХреЗрдЬреНрдпреВрд▓рд░ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░реЗрдЧрд╛ред рдпрд╣ рдкреНрд░рддрд┐рд▓рд┐рдкрд┐, рдЯреЛрдХрди рдФрд░ рдПрдкреАрдЖрдИ рдХреА рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИред
* **etcd**: рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣рдг, рд╕реНрдерд╛рдпреА, рд╕рдВрдЧрдд рдФрд░ рд╡рд┐рддрд░рд┐рддред рдХреБрдмрд░рдиреЗрдЯреНрд╕ рдХрд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рд╣реИ рдФрд░ рдпрд╣рд╛рдБ рдкреВрд░реЗ рдХреНрд▓рд╕реНрдЯрд░ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рд░рдЦрддрд╛ рд╣реИ (рд╣рд░ рдкрд░рд┐рд╡рд░реНрддрди рдпрд╣рд╛рдБ рд▓реЙрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ)ред рд╕реНрдХреЗрдЬреНрдпреВрд▓рд░ рдпрд╛ рдирд┐рдпрдВрддреНрд░рдХ рдкреНрд░рдмрдВрдзрдХ рдЬреИрд╕реЗ рдШрдЯрдХ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рддрд┐рдерд┐ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди рд╕реЗ рдкрд░рд┐рд╡рд░реНрддрди рд╣реБрдП рд╣реИрдВ (рдиреЛрдбреНрд╕ рдХреЗ рдЙрдкрд▓рдмреНрдз рд╕рдВрд╕рд╛рдзрди, рдЪрд▓ рд░рд╣реЗ рдкреЙрдбреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛...)
* **рдХреНрд▓рд╛рдЙрдб рдирд┐рдпрдВрддреНрд░рдХ рдкреНрд░рдмрдВрдзрдХ**: рдпрд╣ рд╡рд┐рд╢реЗрд╖ рдирд┐рдпрдВрддреНрд░рдХ рд╣реИ рдЬреЛ рдлреНрд▓реЛ рдирд┐рдпрдВрддреНрд░рдг рдФрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЗ рд▓рд┐рдП рд╣реИ, рдЙрджрд╛: рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ AWS рдпрд╛ рдУрдкрдирд╕реНрдЯреИрдХ рдореЗрдВ рдХреНрд▓рд╕реНрдЯрд░ рд╣реИрдВред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХреНрдпреЛрдВрдХрд┐ рдХрдИ рдиреЛрдбреНрд╕ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ (рдХрдИ рдкреЙрдбреНрд╕ рдЪрд▓рд╛ рд░рд╣реЗ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ), рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдХрдИ рдорд╛рд╕реНрдЯрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рднреА рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдПрдкреА рд╕рд░реНрд╡рд░ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЙрдирдХрд╛ etcd рд╕рдордХрд╛рд▓рд┐рдХ рд╣реЛрддрд╛ рд╣реИред

**рд╡реЙрд▓реНрдпреВрдо:**

рдЬрдм рдПрдХ рдкреЙрдб рдбреЗрдЯрд╛ рдмрдирд╛рддрд╛ рд╣реИ рдЬреЛ рдкреЙрдб рдЧрд╛рдпрдм рд╣реЛрдиреЗ рдкрд░ рдирд╖реНрдЯ рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рддреЛ рдЙрд╕реЗ рдПрдХ рднреМрддрд┐рдХ рд╡реЙрд▓реНрдпреВрдо рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред **рдХреБрдмрд░рдиреЗрдЯреНрд╕ рдПрдХ рд╡реЙрд▓реНрдпреВрдо рдХ
### PKI рдмреБрдирд┐рдпрд╛рджреА рд╕рдВрд░рдЪрдирд╛ - рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рд╛рдзрд┐рдХрд░рдг CA:

![](https://sickrov.github.io/media/Screenshot-66.jpg)

* CA рдХреНрд▓рд╕реНрдЯрд░ рдХреЗ рднреАрддрд░ рд╕рднреА рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд░реВрдЯ рд╣реИред
* рдШрдЯрдХреЛрдВ рдХреЛ рдПрдХ-рджреВрд╕рд░реЗ рдХреЛ рдорд╛рдиреНрдп рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
* рд╕рднреА рдХреНрд▓рд╕реНрдЯрд░ рдкреНрд░рдорд╛рдгрдкрддреНрд░ CA рджреНрд╡рд╛рд░рд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рд╣реИрдВред
* ETCd рдХрд╛ рдЕрдкрдирд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╣реИред
* рдкреНрд░рдХрд╛рд░:
  * рдПрдкреАрдЖрдИ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯред
  * рдХреБрдмрд▓реЗрдЯ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯред
  * рд╕реНрдХреЗрдЬреНрдпреВрд▓рд░ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯред

## рдореВрд▓ рдХреНрд░рд┐рдпрд╛рдПрдБ

### Minikube

**Minikube** рдХреЛ рдкреВрд░реЗ рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝ рдкрд░рд┐рд╡реЗрд╢ рдХреЛ рдбрд┐рдкреНрд▓реЙрдп рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рди рд╣реЛрдиреЗ рдкрд░ рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝ рдкрд░ рдХреБрдЫ **рддреНрд╡рд░рд┐рдд рдкрд░реАрдХреНрд╖рдг** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ **рдорд╛рд╕реНрдЯрд░ рдФрд░ рдиреЛрдб рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рдПрдХ рдорд╢реАрди рдореЗрдВ рдЪрд▓рд╛рдПрдЧрд╛**ред Minikube рдиреЛрдб рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд░реНрдЪреБрдЕрд▓рдмреЙрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ред [**рдпрд╣рд╛рдБ рджреЗрдЦреЗрдВ рдХреИрд╕реЗ рдЗрд╕реЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ**](https://minikube.sigs.k8s.io/docs/start/).
```
$ minikube start
ЁЯШД  minikube v1.19.0 on Ubuntu 20.04
тЬи  Automatically selected the virtualbox driver. Other choices: none, ssh
ЁЯТ┐  Downloading VM boot image ...
> minikube-v1.19.0.iso.sha256: 65 B / 65 B [-------------] 100.00% ? p/s 0s
> minikube-v1.19.0.iso: 244.49 MiB / 244.49 MiB  100.00% 1.78 MiB p/s 2m17.
ЁЯСН  Starting control plane node minikube in cluster minikube
ЁЯТ╛  Downloading Kubernetes v1.20.2 preload ...
> preloaded-images-k8s-v10-v1...: 491.71 MiB / 491.71 MiB  100.00% 2.59 MiB
ЁЯФе  Creating virtualbox VM (CPUs=2, Memory=3900MB, Disk=20000MB) ...
ЁЯР│  Preparing Kubernetes v1.20.2 on Docker 20.10.4 ...
тЦк Generating certificates and keys ...
тЦк Booting up control plane ...
тЦк Configuring RBAC rules ...
ЁЯФО  Verifying Kubernetes components...
тЦк Using image gcr.io/k8s-minikube/storage-provisioner:v5
ЁЯМЯ  Enabled addons: storage-provisioner, default-storageclass
ЁЯПД  Done! kubectl is now configured to use "minikube" cluster and "default" namespace by defaul

$ minikube status
host: Running
kubelet: Running
apiserver: Running
kubeconfig: Configured

---- ONCE YOU HAVE A K8 SERVICE RUNNING WITH AN EXTERNAL SERVICE -----
$ minikube service mongo-express-service
(This will open your browser to access the service exposed port)

$ minikube delete
ЁЯФе  Deleting "minikube" in virtualbox ...
ЁЯТА  Removed all traces of the "minikube" cluster
```
### Kubectl Basics

**`Kubectl`** рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝ рдХреНрд▓рд╕реНрдЯрд░ рдХреЗ рд▓рд┐рдП рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдЯреВрд▓ рд╣реИред рдпрд╣ рдорд╛рд╕реНрдЯрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдПрдкреАрдЖрдИ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝ рдореЗрдВ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░ рд╕рдХреЗ рдпрд╛ рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдкреВрдЫ рд╕рдХреЗред
```bash
kubectl version #Get client and server version
kubectl get pod
kubectl get services
kubectl get deployment
kubectl get replicaset
kubectl get secret
kubectl get all
kubectl get ingress
kubectl get endpoints

#kubectl create deployment <deployment-name> --image=<docker image>
kubectl create deployment nginx-deployment --image=nginx
#Access the configuration of the deployment and modify it
#kubectl edit deployment <deployment-name>
kubectl edit deployment nginx-deployment
#Get the logs of the pod for debbugging (the output of the docker container running)
#kubectl logs <replicaset-id/pod-id>
kubectl logs nginx-deployment-84cd76b964
#kubectl describe pod <pod-id>
kubectl describe pod mongo-depl-5fd6b7d4b4-kkt9q
#kubectl exec -it <pod-id> -- bash
kubectl exec -it mongo-depl-5fd6b7d4b4-kkt9q -- bash
#kubectl describe service <service-name>
kubectl describe service mongodb-service
#kubectl delete deployment <deployment-name>
kubectl delete deployment mongo-depl
#Deploy from config file
kubectl apply -f deployment.yml
```
### рдорд┐рдиреАрдХреНрдпреВрдм рдбреИрд╢рдмреЛрд░реНрдб

рдбреИрд╢рдмреЛрд░реНрдб рдЖрдкрдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдорд┐рдиреАрдХреНрдпреВрдм рдХреНрдпрд╛ рдЪрд▓рд╛ рд░рд╣рд╛ рд╣реИ, рдЖрдк рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП URL рдпрд╣рд╛рдБ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```
minikube dashboard --url


ЁЯФМ  Enabling dashboard ...
тЦк Using image kubernetesui/dashboard:v2.3.1
тЦк Using image kubernetesui/metrics-scraper:v1.0.7
ЁЯдФ  Verifying dashboard health ...
ЁЯЪА  Launching proxy ...
ЁЯдФ  Verifying proxy health ...
http://127.0.0.1:50034/api/v1/namespaces/kubernetes-dashboard/services/http:kubernetes-dashboard:/proxy/
```
### YAML рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдЙрджрд╛рд╣рд░рдг

рдкреНрд░рддреНрдпреЗрдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдореЗрдВ 3 рднрд╛рдЧ рд╣реЛрддреЗ рд╣реИрдВ: **рдореЗрдЯрд╛рдбреЗрдЯрд╛**, **рд╡рд┐рд╡рд░рдг** (рдХреНрдпрд╛ рд▓реЙрдиреНрдЪ рдХрд░рдирд╛ рд╣реИ), **рд╕реНрдерд┐рддрд┐** (рд╡рд╛рдВрдЫрд┐рдд рд╕реНрдерд┐рддрд┐)ред\
рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╡рд┐рд╡рд░рдг рдореЗрдВ, рдЖрдк рдЯреЗрдореНрдкреНрд▓реЗрдЯ рдкрд╛рдПрдВрдЧреЗ рдЬрд┐рд╕рдореЗрдВ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЫрд╡рд┐ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реА рдПрдХ рдирдИ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕рдВрд░рдЪрдирд╛ рд╣реЛрддреА рд╣реИ:

**рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ + рд╕реЗрд╡рд╛ рдХрд╛ рдЙрджрд╛рд╣рд░рдг рдПрдХ рд╣реА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ (рдпрд╣рд╛рдБ рд╕реЗ** [**рдпрд╣рд╛рдБ**](https://gitlab.com/nanuchi/youtube-tutorial-series/-/blob/master/demo-kubernetes-components/mongo.yaml)**)**

рдЬреИрд╕рд╛ рдХрд┐ рдПрдХ рд╕реЗрд╡рд╛ рдЖрдо рддреМрд░ рдкрд░ рдПрдХ рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрддреА рд╣реИ, рдЗрд╕реЗ рдПрдХ рд╣реА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ (рдЗрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рдШреЛрд╖рд┐рдд рд╕реЗрд╡рд╛ рдХреЗрд╡рд▓ рдЖрдВрддрд░рд┐рдХ рд░реВрдк рд╕реЗ рдкрд╣реБрдВрдЪреА рдЬрд╛ рд╕рдХрддреА рд╣реИ):
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
name: mongodb-deployment
labels:
app: mongodb
spec:
replicas: 1
selector:
matchLabels:
app: mongodb
template:
metadata:
labels:
app: mongodb
spec:
containers:
- name: mongodb
image: mongo
ports:
- containerPort: 27017
env:
- name: MONGO_INITDB_ROOT_USERNAME
valueFrom:
secretKeyRef:
name: mongodb-secret
key: mongo-root-username
- name: MONGO_INITDB_ROOT_PASSWORD
valueFrom:
secretKeyRef:
name: mongodb-secret
key: mongo-root-password
---
apiVersion: v1
kind: Service
metadata:
name: mongodb-service
spec:
selector:
app: mongodb
ports:
- protocol: TCP
port: 27017
targetPort: 27017
```
**рдмрд╛рд╣реНрдп рд╕реЗрд╡рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдЙрджрд╛рд╣рд░рдг**

рдпрд╣ рд╕реЗрд╡рд╛ рдмрд╛рд╣реНрдп рд░реВрдк рд╕реЗ рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп рд╣реЛрдЧрд╛ ( `nodePort` рдФрд░ `type: LoadBlancer` рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рдЬрд╛рдВрдЪреЗрдВ):
```yaml
---
apiVersion: v1
kind: Service
metadata:
name: mongo-express-service
spec:
selector:
app: mongo-express
type: LoadBalancer
ports:
- protocol: TCP
port: 8081
targetPort: 8081
nodePort: 30000
```
{% hint style="info" %}
рдпрд╣ рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИ рд▓реЗрдХрд┐рди рдкреНрд░реЛрдбрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреЗрд╡рд▓ рдЖрдВрддрд░рд┐рдХ рд╕реЗрд╡рд╛рдПрдВ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП рдФрд░ рдПрдХ рдЗрдВрдЧреНрд░реЗрд╕ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдПред
{% endhint %}

**рдЗрдВрдЧреНрд░реЗрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрджрд╛рд╣рд░рдг**

рдпрд╣ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ `http://dashboard.com` рдореЗрдВ рдЙрднрд╛рд░реЗрдЧрд╛ред
```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
name: dashboard-ingress
namespace: kubernetes-dashboard
spec:
rules:
- host: dashboard.com
http:
paths:
- backend:
serviceName: kubernetes-dashboard
servicePort: 80
```
**рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрджрд╛рд╣рд░рдг**

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдкрд╛рд╕рд╡рд░реНрдб B64 рдореЗрдВ рдПрдиреНрдХреЛрдб рдХрд┐рдП рдЧрдП рд╣реИрдВ (рдЬреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реИ!)
```yaml
apiVersion: v1
kind: Secret
metadata:
name: mongodb-secret
type: Opaque
data:
mongo-root-username: dXNlcm5hbWU=
mongo-root-password: cGFzc3dvcmQ=
```
**ConfigMap рдХрд╛ рдЙрджрд╛рд╣рд░рдг**

**ConfigMap** рд╡рд╣ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╣реИ рдЬреЛ рдкреЙрдбреНрд╕ рдХреЛ рджреА рдЬрд╛рддреА рд╣реИ рддрд╛рдХрд┐ рд╡реЗ рдпрд╣ рдЬрд╛рдиреЗрдВ рдХрд┐ рд╡реЗ рдЕрдиреНрдп рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рдХреИрд╕реЗ рдвреВрдВрдвреЗрдВ рдФрд░ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдкреНрд░рддреНрдпреЗрдХ рдкреЙрдб рдпрд╣ рдЬрд╛рдиреЗрдЧрд╛ рдХрд┐ рдирд╛рдо `mongodb-service` рдПрдХ рдкреЙрдб рдХрд╛ рдкрддрд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рд╡рд╣ рд╕рдВрд╡рд╛рдж рдХрд░ рд╕рдХрддрд╛ рд╣реИ (рдпрд╣ рдкреЙрдб рдПрдХ mongodb рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░ рд░рд╣рд╛ рд╣реЛрдЧрд╛):
```yaml
apiVersion: v1
kind: ConfigMap
metadata:
name: mongodb-configmap
data:
database_url: mongodb-service
```
рдлрд┐рд░, **рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди** рдХреЗ рдЕрдВрджрд░ рдЗрд╕ рдкрддреЗ рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпрд╣ рдкреЙрдб рдХреЗ env рдореЗрдВ рд▓реЛрдб рд╣реЛред
```yaml
[...]
spec:
[...]
template:
[...]
spec:
containers:
- name: mongo-express
image: mongo-express
ports:
- containerPort: 8081
env:
- name: ME_CONFIG_MONGODB_SERVER
valueFrom:
configMapKeyRef:
name: mongodb-configmap
key: database_url
[...]
```
**рд╡реЙрд▓реНрдпреВрдо рдХреЙрдиреНрдлрд╝рд┐рдЧ рдХрд╛ рдЙрджрд╛рд╣рд░рдг**

рдЖрдк [https://gitlab.com/nanuchi/youtube-tutorial-series/-/tree/master/kubernetes-volumes](https://gitlab.com/nanuchi/youtube-tutorial-series/-/tree/master/kubernetes-volumes) рдореЗрдВ рд╕реНрдЯреЛрд░реЗрдЬ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди yaml рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдЙрджрд╛рд╣рд░рдг рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред\
**рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╡реЙрд▓реНрдпреВрдо рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЗ рдЕрдВрджрд░ рдирд╣реАрдВ рд╣реИрдВ**

### рдиреЗрдорд╕реНрдкреЗрд╕

рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝ **рдПрдХ рд╕рдорд╛рди рднреМрддрд┐рдХ рдХреНрд▓рд╕реНрдЯрд░ рджреНрд╡рд╛рд░рд╛ рд╕рдорд░реНрдерд┐рдд рдХрдИ рд╡рд░реНрдЪреБрдЕрд▓ рдХреНрд▓рд╕реНрдЯрд░** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред рдпреЗ рд╡рд░реНрдЪреБрдЕрд▓ рдХреНрд▓рд╕реНрдЯрд░ **рдиреЗрдорд╕реНрдкреЗрд╕** рдХрд╣рд▓рд╛рддреЗ рд╣реИрдВред рдпреЗ рдЙрди рд╡рд╛рддрд╛рд╡рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдП рдЧрдП рд╣реИрдВ рдЬрд┐рдирдореЗрдВ рдХрдИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╡рд┐рднрд┐рдиреНрди рдЯреАрдореЛрдВ рдпрд╛ рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдореЗрдВ рдлреИрд▓реЗ рд╣реБрдП рд╣реИрдВред рдХреБрдЫ рд╕реЗ рд▓реЗрдХрд░ рдХреБрдЫ рджрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рд╡рд╛рд▓реЗ рдХреНрд▓рд╕реНрдЯрд░реНрд╕ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдиреЗрдорд╕реНрдкреЗрд╕ рдмрдирд╛рдиреЗ рдпрд╛ рд╕реЛрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдиреЗрдорд╕реНрдкреЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝ рдореЗрдВ рдбрд┐рдкреНрд▓реЙрдп рдХрд┐рдП рдЧрдП рдкреНрд░рддреНрдпреЗрдХ рд╣рд┐рд╕реНрд╕реЗ рдХреЛ рдмреЗрд╣рддрд░ рдирд┐рдпрдВрддреНрд░рдг рдФрд░ рд╕рдВрдЧрдарди рдкреНрд░рд╛рдкреНрдд рд╣реЛред

рдиреЗрдорд╕реНрдкреЗрд╕ рдирд╛рдореЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдХреНрд╖реЗрддреНрд░ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдирд╛рдо рдПрдХ рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЗ рднреАрддрд░ рдЕрджреНрд╡рд┐рддреАрдп рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП, рд▓реЗрдХрд┐рди рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдирд╣реАрдВред рдиреЗрдорд╕реНрдкреЗрд╕ рдПрдХ-рджреВрд╕рд░реЗ рдХреЗ рдЕрдВрджрд░ рд╕рдорд╛рд╣рд┐рдд рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреЗ рдФрд░ **рдкреНрд░рддреНрдпреЗрдХ** рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝ **рд╕рдВрд╕рд╛рдзрди** рдХреЗрд╡рд▓ **рдПрдХ** **рдиреЗрдорд╕реНрдкреЗрд╕** рдореЗрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

рдЕрдЧрд░ рдЖрдк рдорд┐рдиреАрдХреНрдпреВрдм рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ рддреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ 4 рдиреЗрдорд╕реНрдкреЗрд╕ рд╣реЛрддреЗ рд╣реИрдВ:
```
kubectl get namespace
NAME              STATUS   AGE
default           Active   1d
kube-node-lease   Active   1d
kube-public       Active   1d
kube-system       Active   1d
```
* **kube-system**: рдпрд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ рд╣реИ рдФрд░ рдЖрдкрдХреЛ рдЗрд╕реЗ рдЫреВрдиреЗ рдХреА рдЬрд░реВрд░рдд рдирд╣реАрдВ рд╣реИред рдпрд╣ рдорд╛рд╕реНрдЯрд░ рдФрд░ kubectl рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╣реИред
* **kube-public**: рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп рдбреЗрдЯрд╛ред рдПрдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрдореИрдк рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдХреНрд▓рд╕реНрдЯрд░ рд╕реВрдЪрдирд╛ рд╣реЛрддреА рд╣реИред
* **kube-node-lease**: рдиреЛрдб рдХреА рдЙрдкрд▓рдмреНрдзрддрд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИред
* **default**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рд╕рдВрд╕рд╛рдзрди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдиреЗрдорд╕реНрдкреЗрд╕ред
```bash
#Create namespace
kubectl create namespace my-namespace
```
{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЕрдзрд┐рдХрд╛рдВрд╢ Kubernetes рд╕рдВрд╕рд╛рдзрди (рдЬреИрд╕реЗ pods, services, replication controllers, рдФрд░ рдЕрдиреНрдп) рдХрд┐рд╕реА рдиреЗрдорд╕реНрдкреЗрд╕ рдореЗрдВ рд╣реЛрддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЕрдиреНрдп рд╕рдВрд╕рд╛рдзрди рдЬреИрд╕реЗ рдиреЗрдорд╕реНрдкреЗрд╕ рд╕рдВрд╕рд╛рдзрди рдФрд░ рдиреЛрдбреНрд╕ рдФрд░ persistenVolumes рдЬреИрд╕реЗ рдирд┐рдЪрд▓реЗ рд╕реНрддрд░ рдХреЗ рд╕рдВрд╕рд╛рдзрди рдиреЗрдорд╕реНрдкреЗрд╕ рдореЗрдВ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВред рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХреМрди рд╕реЗ Kubernetes рд╕рдВрд╕рд╛рдзрди рдиреЗрдорд╕реНрдкреЗрд╕ рдореЗрдВ рд╣реИрдВ рдФрд░ рдХреМрди рдирд╣реАрдВ:
```bash
kubectl api-resources --namespaced=true #In a namespace
kubectl api-resources --namespaced=false #Not in a namespace
```
{% endhint %}

рдЖрдк рдЙрд╕ рд╕рдВрджрд░реНрдн рдореЗрдВ рд╕рднреА рдЖрдЧрд╛рдореА kubectl рдХрдорд╛рдВрдбреНрд╕ рдХреЗ рд▓рд┐рдП рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЛ рд╕реЗрд╡ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
kubectl config set-context --current --namespace=<insert-namespace-name-here>
```
### рд╣реЗрд▓реНрдо

рд╣реЗрд▓реНрдо рдХреБрдмрд░рдиреЗрдЯреАрдЬ рдХреЗ рд▓рд┐рдП **рдкреИрдХреЗрдЬ рдкреНрд░рдмрдВрдзрдХ** рд╣реИред рдпрд╣ рдпрд╛рдорд▓ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкреИрдХреЗрдЬ рдХрд░рдиреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдФрд░ рдирд┐рдЬреА рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рд╡рд┐рддрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЗрди рдкреИрдХреЗрдЬреЛрдВ рдХреЛ **рд╣реЗрд▓реНрдо рдЪрд╛рд░реНрдЯреНрд╕** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред
```
helm search <keyword>
```
## рдХреБрдмрд░рдиреЗрдЯреНрд╕ рд╕реАрдХреНрд░реЗрдЯреНрд╕

**рд╕реАрдХреНрд░реЗрдЯ** рдПрдХ рдСрдмреНрдЬреЗрдХреНрдЯ рд╣реИ рдЬреЛ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛** рдЬреИрд╕реЗ рдкрд╛рд╕рд╡рд░реНрдб, рдЯреЛрдХрди рдпрд╛ рдХреБрдВрдЬреА рдЬреИрд╕реА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИред рдРрд╕реА рдЬрд╛рдирдХрд╛рд░реА рдЕрдиреНрдпрдерд╛ рдПрдХ рдкреЙрдб рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рдпрд╛ рдПрдХ рдЫрд╡рд┐ рдореЗрдВ рдбрд╛рд▓реА рдЬрд╛ рд╕рдХрддреА рд╣реИред рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реАрдХреНрд░реЗрдЯ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕рд┐рд╕реНрдЯрдо рднреА рд╕реАрдХреНрд░реЗрдЯ рдмрдирд╛рддрд╛ рд╣реИред рд╕реАрдХреНрд░реЗрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдирд╛рдо рдПрдХ рдорд╛рдиреНрдп **DNS рд╕рдмрдбреЛрдореЗрди рдирд╛рдо** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред [рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг](https://kubernetes.io/docs/concepts/configuration/secret/) рдпрд╣рд╛рдБ рдкрдврд╝реЗрдВред

рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪреАрдЬреЗрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ:

* рдПрдкреАрдЖрдИ, рдПрд╕рдПрд╕рдПрдЪ рдХреБрдВрдЬреАред
* рдУрдЖрде рдЯреЛрдХрдиреНрд╕ред
* рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕, рдкрд╛рд╕рд╡рд░реНрдб (рд╕рд╛рджрд╛ рдкрд╛рда рдпрд╛ b64 + рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди)ред
* рдЬрд╛рдирдХрд╛рд░реА рдпрд╛ рдЯрд┐рдкреНрдкрдгрд┐рдпрд╛рдБред
* рдбреЗрдЯрд╛рдмреЗрд╕ рдХрдиреЗрдХреНрд╢рди рдХреЛрдб, рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕тАжред

рдХреБрдмрд░рдиреЗрдЯреНрд╕ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕реАрдХреНрд░реЗрдЯреНрд╕ рд╣реЛрддреЗ рд╣реИрдВ

| рдмрд┐рд▓реНрдЯрдЗрди рдкреНрд░рдХрд╛рд░                        | рдЙрдкрдпреЛрдЧ                                     |
| ----------------------------------- | ----------------------------------------- |
| **Opaque**                          | **рдЕрдирд┐рдпрдорд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдбреЗрдЯрд╛ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ)** |
| kubernetes.io/service-account-token | рд╕реЗрд╡рд╛ рдЦрд╛рддрд╛ рдЯреЛрдХрди                     |
| kubernetes.io/dockercfg             | рд╕рд┐рд░рд┐рдпрд▓рд╛рдЗрдЬреНрдб \~/.dockercfg рдлрд╝рд╛рдЗрд▓             |
| kubernetes.io/dockerconfigjson      | рд╕рд┐рд░рд┐рдпрд▓рд╛рдЗрдЬреНрдб \~/.docker/config.json рдлрд╝рд╛рдЗрд▓    |
| kubernetes.io/basic-auth            | рдмреБрдирд┐рдпрд╛рджреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕      |
| kubernetes.io/ssh-auth              | рдПрд╕рдПрд╕рдПрдЪ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕        |
| kubernetes.io/tls                   | рдПрдХ рдЯреАрдПрд▓рдПрд╕ рдХреНрд▓рд╛рдЗрдВрдЯ рдпрд╛ рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛           |
| bootstrap.kubernetes.io/token       | рдмреВрдЯрд╕реНрдЯреНрд░реИрдк рдЯреЛрдХрди рдбреЗрдЯрд╛                      |

{% hint style="info" %}
**рдУрдкреЗрдХ рдкреНрд░рдХрд╛рд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╣реИ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╕рд╛рдзрд╛рд░рдг рдХреА-рдорд╛рдирдХ рдЬреЛрдбрд╝-рдорд╛рдирдХ рд╣реЛрддрд╛ рд╣реИред**
{% endhint %}

**рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ:**

![](https://sickrov.github.io/media/Screenshot-164.jpg)

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдПрдХ **рд╕реАрдХреНрд░реЗрдЯ** рдХреЛ `mysecret` рдирд╛рдо рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ 2 рдХреА-рдорд╛рдирдХ рдЬреЛрдбрд╝реЗ рд╣реИрдВ `username: YWRtaW4=` рдФрд░ `password: MWYyZDFlMmU2N2Rm`ред рдпрд╣ рднреА рдПрдХ **рдкреЙрдб** рдХреЛ `secretpod` рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ `username` рдФрд░ `password` рдХреЛ `mysecret` рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд `SECRET_USERNAME` рдФрд░ `SECRET_PASSWOR` рд╡рд╛рддрд╛рд╡рд░рдг рдЪрд░реЛрдВ рдореЗрдВ рдЙрдЬрд╛рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдпрд╣ рднреА `username` рд╕реАрдХреНрд░реЗрдЯ рдХреЛ `mysecret` рдореЗрдВ рдорд╛рдЙрдВрдЯ рдХрд░реЗрдЧрд╛ рдкрде `/etc/foo/my-group/my-username` рдореЗрдВ `0640` рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рдеред

{% code title="secretpod.yaml" %}
```yaml
apiVersion: v1
kind: Secret
metadata:
name: mysecret
type: Opaque
data:
username: YWRtaW4=
password: MWYyZDFlMmU2N2Rm
---
apiVersion: v1
kind: Pod
metadata:
name: secretpod
spec:
containers:
- name: secretpod
image: nginx
env:
- name: SECRET_USERNAME
valueFrom:
secretKeyRef:
name: mysecret
key: username
- name: SECRET_PASSWORD
valueFrom:
secretKeyRef:
name: mysecret
key: password
volumeMounts:
- name: foo
mountPath: "/etc/foo"
restartPolicy: Never
volumes:
- name: foo
secret:
secretName: mysecret
items:
- key: username
path: my-group/my-username
mode: 0640
```
{% endcode %}
```bash
kubectl apply -f <secretpod.yaml>
kubectl get pods #Wait until the pod secretpod is running
kubectl exec -it  secretpod -- bash
env | grep SECRET && cat /etc/foo/my-group/my-username && echo
```
### etcd рдореЗрдВ рд░рд╣рд╕реНрдп <a href="#discover-secrets-in-etcd" id="discover-secrets-in-etcd"></a>

**etcd** рдПрдХ рд╕рдВрдЧрдд рдФрд░ рдЙрдЪреНрдЪ рдЙрдкрд▓рдмреНрдз **рдХреБрдВрдЬреА-рдореВрд▓реНрдп рд╕рдВрдЧреНрд░рд╣** рд╣реИ рдЬреЛ рд╕рднреА рдХреНрд▓рд╕реНрдЯрд░ рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдХреБрдмрд░рдиреЗрдЯреНрд╕ рдмреИрдХрд┐рдВрдЧ рд╕реНрдЯреЛрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╣рдо etcd рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд░рд╣рд╕реНрдпреЛрдВ рддрдХ рдкрд╣реБрдВрдЪреЗрдВрдЧреЗ:
```bash
cat /etc/kubernetes/manifests/kube-apiserver.yaml | grep etcd
```
рддреБрдореНрд╣реЗрдВ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯреНрд╕, рдХреАрдЬ рдФрд░ рдпреВрдЖрд░рдПрд▓ рдХреЛ рдПрдлрдПрд╕ рдореЗрдВ рдХрд╣рд╛рдБ рд╕реНрдерд┐рдд рд╣реИрдВ, рд╡рд╣рд╛рдБ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ред рдПрдХ рдмрд╛рд░ рдЬрдм рддреБрдо рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд▓реЛ, рддреЛ рддреБрдо etcd рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХреЛрдЧреЗред
```bash
#ETCDCTL_API=3 etcdctl --cert <path to client.crt> --key <path to client.ket> --cacert <path to CA.cert> endpoint=[<ip:port>] health

ETCDCTL_API=3 etcdctl --cert /etc/kubernetes/pki/apiserver-etcd-client.crt --key /etc/kubernetes/pki/apiserver-etcd-client.key --cacert /etc/kubernetes/pki/etcd/etcd/ca.cert endpoint=[127.0.0.1:1234] health
```
рдЬрдм рдЖрдк рд╕рдВрдЪрд╛рд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд▓реЗрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рд░рд╣рд╕реНрдп рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
#ETCDCTL_API=3 etcdctl --cert <path to client.crt> --key <path to client.ket> --cacert <path to CA.cert> endpoint=[<ip:port>] get <path/to/secret>

ETCDCTL_API=3 etcdctl --cert /etc/kubernetes/pki/apiserver-etcd-client.crt --key /etc/kubernetes/pki/apiserver-etcd-client.key --cacert /etc/kubernetes/pki/etcd/etcd/ca.cert endpoint=[127.0.0.1:1234] get /registry/secrets/default/secret_02
```
**ETCD рдореЗрдВ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдЬреЛрдбрд╝рдирд╛**

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕рднреА рд░рд╣рд╕реНрдп etcd рдореЗрдВ рд╕рд╛рджрд╛ рдкрд╛рда рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЬрдм рддрдХ рдЖрдк рдПрдХ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдкрд░рдд рд▓рд╛рдЧреВ рди рдХрд░реЗрдВред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг [https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/](https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/) рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИрдВ

{% code title="encryption.yaml" %}
```yaml
apiVersion: apiserver.config.k8s.io/v1
kind: EncryptionConfiguration
resources:
- resources:
- secrets
providers:
- aescbc:
keys:
- name: key1
secret: cjjPMcWpTPKhAdieVtd+KhG4NN+N6e3NmBPMXJvbfrY= #Any random key
- identity: {}
```
{% endcode %}

рдЙрд╕рдХреЗ рдмрд╛рдж, рдЖрдкрдХреЛ `kube-apiserver` рдкрд░ `--encryption-provider-config` рдлреНрд▓реИрдЧ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдмрдирд╛рдП рдЧрдП рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕реНрдерд╛рди рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░реЗрдВред рдЖрдк `/etc/kubernetes/manifest/kube-apiserver.yaml` рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд▓рд╛рдЗрди рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ:
```yaml
containers:
- command:
- kube-apiserver
- --encriyption-provider-config=/etc/kubernetes/etcd/<configFile.yaml>
```
рд╕рдВрджрд░реНрдн рдорд╛рдЙрдВрдЯ рдореЗрдВ рдиреАрдЪреЗ рд╕реНрдХреНрд░реЙрд▓ рдХрд░реЗрдВ:
```yaml
- mountPath: /etc/kubernetes/etcd
name: etcd
readOnly: true
```
рд╕рдВрджреВрд╖рдгреЛрдВ рдореЗрдВ рдиреАрдЪреЗ рдЬрд╛рдПрдВ hostPath:
```yaml
- hostPath:
path: /etc/kubernetes/etcd
type: DirectoryOrCreate
name: etcd
```
**рдбреЗрдЯрд╛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╣реЛрдиреЗ рдХреА рд╕рддреНрдпрд╛рдкрди**

рдбреЗрдЯрд╛ etcd рдореЗрдВ рд▓рд┐рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рдпрд╣ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╣реЛрддрд╛ рд╣реИред рдЕрдкрдиреЗ `kube-apiserver` рдХреЛ рдкреБрдирдГ рдЖрд░рдВрдн рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдХрд┐рд╕реА рднреА рдирдП рдмрдирд╛рдП рдЧрдП рдпрд╛ рдЕрдкрдбреЗрдЯ рдХрд┐рдП рдЧрдП рд╕реАрдХреНрд░реЗрдЯ рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рддреЗ рд╕рдордп рдЗрд╕реЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк `etcdctl` рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╕реАрдХреНрд░реЗрдЯ рдХреА рд╕рд╛рдордЧреНрд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

1.  `default` рдиреЗрдорд╕реНрдкреЗрд╕ рдореЗрдВ `secret1` рдирд╛рдордХ рдирдпрд╛ рд╕реАрдХреНрд░реЗрдЯ рдмрдирд╛рдПрдВ:

```
kubectl create secret generic secret1 -n default --from-literal=mykey=mydata
```
2.  Etcdctl рдХрдорд╛рдВрдбрд▓рд╛рдЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, etcd рд╕реЗ рдЙрд╕ рд╕реАрдХреНрд░реЗрдЯ рдХреЛ рдкрдврд╝реЗрдВ:

`ETCDCTL_API=3 etcdctl get /registry/secrets/default/secret1 [...] | hexdump -C`

рдЬрд╣рд╛рдВ `[...]` рдПрдЯреАрд╕реАрдбреА рд╕рд░реНрд╡рд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрддрд┐рд░рд┐рдХреНрдд рддрд░реНрдХ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдПред
3. рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░реЗрдВ рдХрд┐ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╕реАрдХреНрд░реЗрдЯ `k8s:enc:aescbc:v1:` рдХреЗ рд╕рд╛рде рдкреНрд░реАрдлрд┐рдХреНрд╕ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬреЛ рдЗрд╕рдХрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ `aescbc` рдкреНрд░рджрд╛рддрд╛ рдиреЗ рдкрд░рд┐рдгрд╛рдореА рдбреЗрдЯрд╛ рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рд╣реИред
4.  рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░реЗрдВ рдХрд┐ рд╕реАрдХреНрд░реЗрдЯ API рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдкрд░ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рд╣реЛрддрд╛ рд╣реИ:

```
kubectl describe secret secret1 -n default
```

`mykey: bXlkYXRh` рдХреЗ рд╕рдорд╛рди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, mydata рдХреЛ рдПрдиреНрдХреЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╕реАрдХреНрд░реЗрдЯ рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдбрд┐рдХреЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [рдПрдХ рд╕реАрдХреНрд░реЗрдЯ рдХреЛ рдбрд┐рдХреЛрдб рдХрд░рдирд╛](https://kubernetes.io/docs/concepts/configuration/secret#decoding-a-secret) рджреЗрдЦреЗрдВред

**рдХреНрдпреЛрдВрдХрд┐ рд╕реАрдХреНрд░реЗрдЯ рд▓реЗрдЦрди рдкрд░ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╣реЛрддреЗ рд╣реИрдВ, рд╕реАрдХреНрд░реЗрдЯ рдкрд░ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рд╕реЗ рдЙрд╕ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛:**
```
kubectl get secrets --all-namespaces -o json | kubectl replace -f -
```
**рдЕрдВрддрд┐рдо рд╕реБрдЭрд╛рд╡:**

* рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдХрд┐ рдЖрдк рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдХреЛ рдПрдлрдПрд╕ рдореЗрдВ рди рд░рдЦреЗрдВ, рдЙрдиреНрд╣реЗрдВ рдЕрдиреНрдп рд╕реНрдерд╛рдиреЛрдВ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
* рдЕрдкрдиреЗ рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдХреЛ рдЕрдзрд┐рдХ рд╕реБрд░рдХреНрд╖рд╛ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП [https://www.vaultproject.io/](https://www.vaultproject.io) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВред
* [https://kubernetes.io/docs/concepts/configuration/secret/#risks](https://kubernetes.io/docs/concepts/configuration/secret/#risks)
* [https://docs.cyberark.com/Product-Doc/OnlineHelp/AAM-DAP/11.2/en/Content/Integrations/Kubernetes\_deployApplicationsConjur-k8s-Secrets.htm](https://docs.cyberark.com/Product-Doc/OnlineHelp/AAM-DAP/11.2/en/Content/Integrations/Kubernetes\_deployApplicationsConjur-k8s-Secrets.htm)

## рд╕рдВрджрд░реНрдн

{% embed url="https://sickrov.github.io/" %}

{% embed url="https://www.youtube.com/watch?v=X48VuDVv0do" %}

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рд╣рдореЗрдВ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
{% endhint %}
