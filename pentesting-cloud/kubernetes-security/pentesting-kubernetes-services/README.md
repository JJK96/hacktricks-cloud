# рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХреБрдмрд░рдиреЗрдЯреАрд╕ рд╕реЗрд╡рд╛рдПрдВ

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ **рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

рдХреБрдмрд░рдиреЗрдЯреАрд╕ рдХрдИ **рд╡рд┐рд╢реЗрд╖ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛рдПрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреЛ **рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдЙрдЬрд╛рдЧрд░** рдпрд╛ **рдПрдХ рдкреЙрдб рдХреЛ рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдЖрдВрддрд░рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

## OSINT рдХреЗ рд╕рд╛рде рдЙрдЬрд╛рдЧрд░ рдкреЙрдбреНрд╕ рдЦреЛрдЬрдирд╛

рдПрдХ рддрд░реАрдХрд╛ `Identity LIKE "k8s.%.com"` рдХреА рдЦреЛрдЬ рдХрд░рдирд╛ [crt.sh](https://crt.sh) рдореЗрдВ рдХреБрдмрд░рдиреЗрдЯреАрд╕ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╕рдмрдбреЛрдореЗрди рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдПред рдПрдХ рдФрд░ рддрд░реАрдХрд╛ `"k8s.%.com"` рдХреА рдЦреЛрдЬ рдХрд░рдирд╛ github рдореЗрдВ рдФрд░ **YAML рдлрд╝рд╛рдЗрд▓реНрд╕** рдЦреЛрдЬрдирд╛ рдЬрд┐рд╕рдореЗрдВ рдпрд╣ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╣реЛред

## рдХреБрдмрд░рдиреЗрдЯреАрд╕ рд╕реЗрд╡рд╛рдПрдВ рдХреИрд╕реЗ рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИ

рдпрд╣ рдЖрдкрдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЖрдк рд╕рдордЭреЗрдВ рдХрд┐ рдХреБрдмрд░рдиреЗрдЯреАрд╕ рдХреИрд╕реЗ **рд╕реЗрд╡рд╛рдПрдВ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдЙрдЬрд╛рдЧрд░** рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рдЦреЛрдЬ рд╕рдХреЗрдВ:

{% content-ref url="../exposing-services-in-kubernetes.md" %}
[exposing-services-in-kubernetes.md](../exposing-services-in-kubernetes.md)
{% endcontent-ref %}

## рдкреЛрд░реНрдЯ рд╕реНрдХреИрдирд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдЬрд╛рдЧрд░ рдкреЙрдбреНрд╕ рдЦреЛрдЬрдирд╛

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЛрд░реНрдЯреНрд╕ рдПрдХ рдХреБрдмрд░рдиреЗрдЯреАрд╕ рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рдЦреБрд▓реЗ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ:

| рдкреЛрд░реНрдЯ            | рдкреНрд░рдХреНрд░рд┐рдпрд╛        | рд╡рд┐рд╡рд░рдг                                                            |
| --------------- | -------------- | ---------------------------------------------------------------------- |
| 443/TCP         | kube-apiserver | рдХреБрдмрд░рдиреЗрдЯреАрд╕ API рдкреЛрд░реНрдЯ                                                    |
| 2379/TCP        | etcd           |                                                                        |
| 6666/TCP        | etcd           | etcd                                                                   |
| 4194/TCP        | cAdvisor       | рдХрдВрдЯреЗрдирд░ рдореАрдЯреНрд░рд┐рдХреНрд╕                                                      |
| 6443/TCP        | kube-apiserver | рдХреБрдмрд░рдиреЗрдЯреАрд╕ API рдкреЛрд░реНрдЯ                                                    |
| 8443/TCP        | kube-apiserver | Minikube API рдкреЛрд░реНрдЯ                                                      |
| 8080/TCP        | kube-apiserver | рдЕрд╕реБрд░рдХреНрд╖рд┐рдд API рдкреЛрд░реНрдЯ                                                      |
| 10250/TCP       | kubelet        | HTTPS API рдЬреЛ рдкреВрд░реНрдг рдореЛрдб рдПрдХреНрд╕реЗрд╕ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ                                |
| 10255/TCP       | kubelet        | рдЕрдкреНрд░рдорд╛рдгрд┐рдд рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рд╡рд╛рд▓рд╛ HTTP рдкреЛрд░реНрдЯ: рдкреЙрдб, рдЪрд▓ рд░рд╣реЗ рдкреЙрдбреНрд╕ рдФрд░ рдиреЛрдб рд╕реНрдерд┐рддрд┐ |
| 10256/TCP       | kube-proxy     | рдХреНрдпреВрдм рдкреНрд░реЙрдХреНрд╕реА рд╣реЗрд▓реНрде рдЪреЗрдХ рд╕рд░реНрд╡рд░                                         |
| 9099/TCP        | calico-felix   | Calico рдХреЗ рд▓рд┐рдП рд╣реЗрд▓реНрде рдЪреЗрдХ рд╕рд░реНрд╡рд░                                         |
| 6782-4/TCP      | weave          | рдореАрдЯреНрд░рд┐рдХреНрд╕ рдФрд░ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕                                                  |
| 30000-32767/TCP | NodePort       | рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░реЙрдХреНрд╕реА                                                  |
| 44134/TCP       | Tiller         | рд╣реЗрд▓реНрдо рд╕реЗрд╡рд╛ рд╕реБрди рд░рд╣реА рд╣реИ                                                 |

### Nmap

{% code overflow="wrap" %}
```bash
nmap -n -T4 -p 443,2379,6666,4194,6443,8443,8080,10250,10255,10256,9099,6782-6784,30000-32767,44134 <pod_ipaddress>/16
```
{% endcode %}

### Kube-apiserver

рдпрд╣ **API Kubernetes рд╕реЗрд╡рд╛** рд╣реИ рдЬрд┐рд╕рд╕реЗ рдкреНрд░рд╢рд╛рд╕рдХ рд╕рд╛рдорд╛рдиреНрдпрдд: рдЙрдкрдХрд░рдг **`kubectl`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд╛рддрдЪреАрдд рдХрд░рддреЗ рд╣реИрдВред

**рд╕рд╛рдорд╛рдиреНрдп рдкреЛрд░реНрдЯ: 6443 рдФрд░ 443**, рд▓реЗрдХрд┐рди minikube рдореЗрдВ 8443 рдФрд░ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рдореЗрдВ 8080 рднреА рд╣реИред
```
curl -k https://<IP Address>:(8|6)443/swaggerapi
curl -k https://<IP Address>:(8|6)443/healthz
curl -k https://<IP Address>:(8|6)443/api/v1
```
**рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрдк рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдФрд░ рдЗрд╕ рд╕реЗрд╡рд╛ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдХреНрд░рд┐рдпрд╛рдПрдБ рдХреИрд╕реЗ рдХрд░реЗрдВ, рдЗрд╕рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХреЗрдВ:**

{% content-ref url="../kubernetes-enumeration.md" %}
[kubernetes-enumeration.md](../kubernetes-enumeration.md)
{% endcontent-ref %}

### Kubelet API

рдпрд╣ рд╕реЗрд╡рд╛ **рдХреНрд▓рд╕реНрдЯрд░ рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдиреЛрдб рдореЗрдВ рдЪрд▓рддреА рд╣реИ**ред рдпрд╣ рд╕реЗрд╡рд╛ рд╣реИ рдЬреЛ **рдиреЛрдб** рдХреЗ рдЕрдВрджрд░ рдХреЗ рдкреЙрдбреНрд╕ рдХреЛ **рдирд┐рдпрдВрддреНрд░рд┐рдд** рдХрд░реЗрдЧреАред рдпрд╣ **kube-apiserver** рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рддреА рд╣реИред

рдпрджрд┐ рдЖрдк рдЗрд╕ рд╕реЗрд╡рд╛ рдХреЛ рдЕрдирд╛рд╡реГрддреНрдд RCE рдорд┐рд▓рд╛ рд╣реИ рддреЛ рдЖрдкрдиреЗ рдПрдХ **рдЕрдкреНрд░рдорд╛рдгрд┐рдд RCE** рдкрд╛рдпрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

#### Kubelet API
```
curl -k https://<IP address>:10250/metrics
curl -k https://<IP address>:10250/pods
```
рдпрджрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ `рдЕрдирдзрд┐рдХреГрдд` рд╣реИ рддреЛ рдЗрд╕реЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

рдпрджрд┐ рдЖрдк рдиреЛрдбреНрд╕ рдХреА рд╕реВрдЪреА рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рд╕рд╛рде kubelets рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреА рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
kubectl get nodes -o custom-columns='IP:.status.addresses[0].address,KUBELET_PORT:.status.daemonEndpoints.kubeletEndpoint.Port' | grep -v KUBELET_PORT | while IFS='' read -r node; do
ip=$(echo $node | awk '{print $1}')
port=$(echo $node | awk '{print $2}')
echo "curl -k --max-time 30 https://$ip:$port/pods"
echo "curl -k --max-time 30 https://$ip:2379/version" #Check  also for etcd
done
```
#### kubelet (рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп)
```
curl -k https://<IP Address>:10255
http://<external-IP>:10255/pods
```
### etcd рдПрдкреАрдЖрдИ
```
curl -k https://<IP address>:2379
curl -k https://<IP address>:2379/version
etcdctl --endpoints=http://<MASTER-IP>:2379 get / --prefix --keys-only
```
### рдЯрд┐рд▓рд░
```
helm --host tiller-deploy.kube-system:44134 version
```
рдЖрдк рдЗрд╕ рд╕реЗрд╡рд╛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ Kubernetes рдХреЗ рдЕрдВрджрд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ:

### cAdvisor

рдореИрдЯреНрд░рд┐рдХреНрд╕ рдЬреБрдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╕реЗрд╡рд╛ред
```
curl -k https://<IP Address>:4194
```
### рдиреЛрдбрдкреЛрд░реНрдЯ

рдЬрдм рдПрдХ рдкреЛрд░реНрдЯ рдХреЛ рд╕рднреА рдиреЛрдбреНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рдиреЛрдбрдкреЛрд░реНрдЯ** рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдЬрд╛рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдШреЛрд╖рд┐рдд **рд╕реЗрд╡рд╛** рдореЗрдВ рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдкреНрд░реЛрдХреНрд╕реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рднреА рдиреЛрдбреНрд╕ рдореЗрдВ рдПрдХ рд╣реА рдкреЛрд░реНрдЯ рдЦреЛрд▓рд╛ рдЬрд╛рддрд╛ рд╣реИред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдпрд╣ рдкреЛрд░реНрдЯ **30000-32767** рдХреЗ рд░реЗрдВрдЬ рдореЗрдВ рд╣реЛрдЧрд╛ред рдЗрд╕рд▓рд┐рдП рдирдП рдЕрдирдХреАрдХреГрдд рд╕реЗрд╡рд╛рдПрдВ рдЙрди рдкреЛрд░реНрдЯреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╣реБрдВрдЪреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред
```
sudo nmap -sS -p 30000-32767 <IP>
```
## рд╡рдВрд░реНрдирд░рдмрд▓ рдорд┐рд╕рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рдиреНрд╕

### рдХреНрдпреВрдм-рдПрдкреАрдЖрдИрд╕рд░реНрд╡рд░ рдЕрдирд╛рдо рдПрдХреНрд╕реЗрд╕

**рдХреНрдпреВрдм-рдПрдкреАрдЖрдИрд╕рд░реНрд╡рд░ рдПрдкреАрдЖрдИ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХрд╛ рдЕрдирд╛рдо рдПрдХреНрд╕реЗрд╕ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ**ред рд▓реЗрдХрд┐рди рдЖрдк рдХреБрдЫ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

![](https://www.cyberark.com/wp-content/uploads/2019/09/Kube-Pen-2-fig-5.png)

### **рдИрдЯреАрд╕реАрдбреА рдЕрдирд╛рдо рдПрдХреНрд╕реЗрд╕ рдХреА рдЬрд╛рдВрдЪ**

рдИрдЯреАрд╕реАрдбреА рдХреНрд▓рд╕реНрдЯрд░ рд╕реАрдХреНрд░реЗрдЯреНрд╕, рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЗрдВ рдФрд░ рдЕрдзрд┐рдХ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛** рд╕реНрдЯреЛрд░ рдХрд░рддрд╛ рд╣реИред **рдбрд┐рдлрд╝реЙрд▓реНрдЯ** рд░реВрдк рд╕реЗ, рдИрдЯреАрд╕реАрдбреА **рдЕрдирд╛рдо рд░реВрдк рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рдЬрд╛рдВрдЪрдирд╛ рд╣рдореЗрд╢рд╛ рдЕрдЪреНрдЫрд╛ рд╣реЛрддрд╛ рд╣реИред

рдЕрдЧрд░ рдИрдЯреАрд╕реАрдбреА рдЕрдирд╛рдо рд░реВрдк рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЛ **[etcdctl](https://github.com/etcd-io/etcd/blob/master/etcdctl/READMEv2.md)** **рдЯреВрд▓** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рд╕рднреА рд╕реНрдЯреЛрд░ рдХрд┐рдП рдЧрдП рдХреА рд╕рднреА рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛:
```
etcdctl --endpoints=http://<MASTER-IP>:2379 get / --prefix --keys-only
```
### **Kubelet RCE**

[**Kubelet рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг**](https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/) рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕реЗрд╡рд╛ рдХреЛ рдЕрдирд╛рдо рдПрдХреНрд╕реЗрд╕** рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ:

> Kubelet рд╕рд░реНрд╡рд░ рдХреЛ рдЕрдирд╛рдо рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рддрд╛ рд╣реИред рдЕрдиреНрдп рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╡рд┐рдзрд┐ рджреНрд╡рд╛рд░рд╛ рдЕрд╕реНрд╡реАрдХреГрдд рди рдХрд┐рдП рдЧрдП рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдЕрдирд╛рдо рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╡рд╣рд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЕрдирд╛рдо рдЕрдиреБрд░реЛрдзреЛрдВ рдореЗрдВ рдПрдХ рдЙрдкрдпреЛрдХреНрддрд╛ рдХрд╛ рдирд╛рдо `system:anonymous` рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдПрдХ рд╕рдореВрд╣ рдХрд╛ рдирд╛рдо `system:unauthenticated` рд╣реЛрддрд╛ рд╣реИред

**Kubelet API рдХреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдФрд░ рдЕрдзрд┐рдХреГрддрддрд╛ рдХреЛ рд╕рдордЭрдиреЗ** рдХреЗ рд▓рд┐рдП рдЗрд╕ рдкреГрд╖реНрда рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ:

{% content-ref url="kubelet-authentication-and-authorization.md" %}
[kubelet-authentication-and-authorization.md](kubelet-authentication-and-authorization.md)
{% endcontent-ref %}

**Kubelet** рд╕реЗрд╡рд╛ **API рдХрд╛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг рдирд╣реАрдВ рд╣реИ**, рд▓реЗрдХрд┐рди рд╕реНрд░реЛрдд рдХреЛрдб рдпрд╣рд╛рдБ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрдЬрд╛рдЧрд░ рдХрд┐рдП рдЧрдП рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдЗрддрдирд╛ рдЖрд╕рд╛рди рд╣реИ рдЬрд┐рддрдирд╛ рдХрд┐ **рдпрд╣ рдЪрд▓рд╛рдирд╛**:
```bash
curl -s https://raw.githubusercontent.com/kubernetes/kubernetes/master/pkg/kubelet/server/server.go | grep 'Path("/'

Path("/pods").
Path("/run")
Path("/exec")
Path("/attach")
Path("/portForward")
Path("/containerLogs")
Path("/runningpods/").
```
#### /рдкреЙрдбреНрд╕

рдЗрд╕ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдкрд░ рдкреЙрдбреНрд╕ рдФрд░ рдЙрдирдХреЗ рдХрдВрдЯреЗрдирд░реЛрдВ рдХреА рд╕реВрдЪреА рд╣реЛрддреА рд╣реИ:
```bash
kubeletctl pods
```
#### /exec

рдпрд╣ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХрд┐рд╕реА рднреА рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ рдХреЛрдб рдХреЛ рдмрд╣реБрдд рдЖрд╕рд╛рдиреА рд╕реЗ execute рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ:
```bash
kubeletctl exec [command]
```
{% hint style="info" %}
рдЗрд╕ рд╣рдорд▓реЗ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП _**kubelet**_ рд╕реЗрд╡рд╛ рдХреЛ `--anonymous-auth false` рдХреЗ рд╕рд╛рде рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рд╕реЗрд╡рд╛ рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрддрд░ рдкрд░ рдЕрд▓рдЧ рдХрд░ рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдПред
{% endhint %}

### **рдХреБрдмрд▓реЗрдЯ (рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рд╡рд╛рд▓рд╛ рдкреЛрд░реНрдЯ) рд╕реВрдЪрдирд╛ рдЙрдЬрд╛рдЧрд░реАрдХрд░рдг рдХреА рдЬрд╛рдБрдЪ**

рдЬрдм рдПрдХ **рдХреБрдмрд▓реЗрдЯ рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рд╡рд╛рд▓рд╛ рдкреЛрд░реНрдЯ** рдЙрдЬрд╛рдЧрд░ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЕрдирдзрд┐рдХреГрдд рдкрдХреНрд╖реЛрдВ рджреНрд╡рд╛рд░рд╛ API рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рдкреЛрд░реНрдЯ рдХреА рдЙрдЬрд╛рдЧрд░реАрдХрд░рдг рд╕реЗ рд╡рд┐рднрд┐рдиреНрди **рдХреНрд▓рд╕реНрдЯрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рддрддреНрд╡реЛрдВ** рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЬрд╛рдирдХрд╛рд░реА, рдЬрд┐рд╕рдореЗрдВ **рдкреЙрдб рдирд╛рдо, рдЖрдВрддрд░рд┐рдХ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕реНрдерд┐рддрд┐рдпрд╛рдБ, рдФрд░ рдЕрдиреНрдп рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди** рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдорд╣рддреНрд╡рдкреВрд░реНрдг рди рд╣реЛ, рд▓реЗрдХрд┐рди рдЗрд╕рдХрд╛ рдЙрдЬрд╛рдЧрд░ рд╣реЛрдирд╛ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо рдмрдирд╛рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдмрдЪрд╛рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

рдЗрд╕ рдХрдордЬреЛрд░реА рдХреЛ рдХреИрд╕реЗ рд╢рд╛рд░реАрд░рд┐рдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдПрдХ рджреВрд░рд╕реНрде рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ URL рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИред `http://<external-IP>:10255/pods` рдкрд░ рдЬрд╛рдХрд░, рд╣рдорд▓рд╛рд╡рд░ рдХреБрдмрд▓реЗрдЯ рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ:

![https://www.cyberark.com/wp-content/uploads/2019/09/KUbe-Pen-2-fig-6.png](https://www.cyberark.com/wp-content/uploads/2019/09/KUbe-Pen-2-fig-6.png)

## рд╕рдВрджрд░реНрдн

{% embed url="https://www.cyberark.com/resources/threat-research-blog/kubernetes-pentest-methodology-part-2" %}

{% embed url="https://labs.f-secure.com/blog/attacking-kubernetes-through-kubelet" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
