# GWS - Upornost

{% hint style="success" %}
Naučite i vežbajte hakovanje AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Obuka AWS Crveni Tim Ekspert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Naučite i vežbajte hakovanje GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Obuka GCP Crveni Tim Ekspert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podržite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakovanje trikova slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

{% hint style="danger" %}
Sve radnje navedene u ovoj sekciji koje menjaju postavke će generisati **bezbednosno upozorenje na email i čak push obaveštenje na bilo koji sinhronizovani mobilni uređaj** sa nalogom.
{% endhint %}

## **Upornost u Gmail-u**

* Možete kreirati **filtere da sakrijete** bezbednosna obaveštenja od Google-a
* `from: (no-reply@accounts.google.com) "Security Alert"`
* Ovo će sprečiti da bezbednosna email obaveštenja stignu na email (ali neće sprečiti push obaveštenja na mobilni)

<details>

<summary>Koraci za kreiranje Gmail filtera</summary>

(Instrukcije sa [**ovde**](https://support.google.com/mail/answer/6579))

1. Otvorite [Gmail](https://mail.google.com/).
2. U polju za pretragu na vrhu, kliknite na Prikaz opcija pretrage ![photos tune](https://lh3.googleusercontent.com/cD6YR\_YvqXqNKxrWn2NAWkV6tjJtg8vfvqijKT1\_9zVCrl2sAx9jROKhLqiHo2ZDYTE=w36) .
3. Unesite svoje kriterijume pretrage. Ako želite da proverite da li je pretraga uspela, vidite koje email poruke se pojavljuju klikom na **Pretraga**.&#x20;
4. Na dnu prozora pretrage, kliknite na **Kreiraj filter**.
5. Izaberite šta želite da filter uradi.
6. Kliknite na **Kreiraj filter**.

Proverite svoje trenutne filtere (za brisanje njih) na [https://mail.google.com/mail/u/0/#settings/filters](https://mail.google.com/mail/u/0/#settings/filters)

</details>

<figure><img src="../../.gitbook/assets/image (331).png" alt=""><figcaption></figcaption></figure>

* Kreirajte **adresu prosleđivanja za prosleđivanje osetljivih informacija** (ili svega) - Potreban je ručni pristup.
* Kreirajte adresu prosleđivanja na [https://mail.google.com/mail/u/2/#settings/fwdandpop](https://mail.google.com/mail/u/2/#settings/fwdandpop)
* Adresa primaoca će morati da potvrdi ovo
* Zatim, postavite da prosleđuje sve email poruke čuvajući kopiju (ne zaboravite da kliknete na sačuvaj promene):

<figure><img src="../../.gitbook/assets/image (332).png" alt=""><figcaption></figcaption></figure>

Takođe je moguće kreirati filtere i proslediti samo određene email poruke na drugu email adresu.

## Lozinke aplikacija

Ako ste uspeli da **kompromitujete sesiju korisnika Google-a** i korisnik je imao **2FA**, možete **generisati** [**lozinku aplikacije**](https://support.google.com/accounts/answer/185833?hl=en) (pratite link da vidite korake). Imajte na umu da **Google više ne preporučuje lozinke aplikacija i one su opozvane** kada korisnik **promeni svoju Google nalog lozinku.**

**Čak i ako imate otvorenu sesiju, moraćete znati lozinku korisnika da biste kreirali lozinku aplikacije.**

{% hint style="info" %}
Lozinke aplikacija mogu se **koristiti samo sa nalozima koji imaju uključenu dvostepenu verifikaciju**.
{% endhint %}

## Promena 2-FA i slično

Takođe je moguće **isključiti 2-FA ili upisati novi uređaj** (ili broj telefona) na ovoj stranici [**https://myaccount.google.com/security**](https://myaccount.google.com/security)**.**\
**Takođe je moguće generisati šifre (dodati svoj uređaj), promeniti lozinku, dodati mobilne brojeve za verifikaciju telefona i oporavak, promeniti email za oporavak i promeniti sigurnosna pitanja).**

{% hint style="danger" %}
Da biste **sprečili bezbednosna push obaveštenja** da stignu na telefon korisnika, možete **odjaviti njegov pametni telefon** (iako bi to bilo čudno) jer ga ne možete ponovo prijaviti sa ove stranice.

Takođe je moguće **locirati uređaj.**
{% endhint %}

**Čak i ako imate otvorenu sesiju, moraćete znati lozinku korisnika da biste promenili ove postavke.**

## Upornost putem OAuth aplikacija

Ako ste **kompromitovali nalog korisnika,** možete jednostavno **prihvatiti** da dodelite sve moguće dozvole **OAuth aplikaciji**. Jedini problem je što Workspace može biti konfigurisan da **ne dozvoljava neodobrene spoljne i/ili interne OAuth aplikacije.**\
Prilično je uobičajeno da organizacije Workspace-a podrazumevano ne veruju spoljnim OAuth aplikacijama, ali veruju internim, pa ako imate **dovoljno dozvola da generišete novu OAuth aplikaciju** unutar organizacije i spoljne aplikacije su zabranjene, generišite je i **koristite tu novu internu OAuth aplikaciju za održavanje upornosti**.

Proverite sledeću stranicu za više informacija o OAuth aplikacijama:

{% content-ref url="gws-google-platforms-phishing/" %}
[gws-google-platforms-phishing](gws-google-platforms-phishing/)
{% endcontent-ref %}

## Upornost putem delegacije

Možete jednostavno **delegirati nalog** drugom nalogu koji kontroliše napadač (ako vam je dozvoljeno da to uradite). U Workspace **Organizacijama** ova opcija mora biti **omogućena**. Može biti onemogućena za sve, omogućena za neke korisnike/grupe ili za sve (obično je omogućena samo za neke korisnike/grupe ili potpuno onemogućena).

<details>

<summary>Ako ste administrator Workspace-a, proverite ovo da omogućite funkciju</summary>

(Informacije [kopirane sa dokumenata](https://support.google.com/a/answer/7223765))

Kao administrator za vašu organizaciju (na primer, vaš posao ili škola), kontrolišete da li korisnici mogu delegirati pristup svom Gmail nalogu. Možete dozvoliti svima da imaju opciju da delegiraju svoj nalog. Ili, dozvoliti samo ljudima u određenim odeljenjima da postave delegaciju. Na primer, možete:

* Dodati administrativnog asistenta kao delegata na vaš Gmail nalog tako da mogu čitati i slati emailove u vaše ime.&#x20;
* Dodati grupu, kao što je vaše odeljenje prodaje, u Grupe kao delegata da svima omogućite pristup jednom Gmail nalogu.

Korisnici mogu delegirati pristup drugom korisniku u istoj organizaciji, bez obzira na njihov domen ili organizacionu jedinicu.

### Ograničenja i restrikcije delegacije&#x20;

* **Dozvoli korisnicima da dodele pristup svojoj poštanskoj sandučiću Google grupi** opcija: Da biste koristili ovu opciju, mora biti omogućena za OU delegiranog naloga i za svaku OU člana grupe. Članovi grupe koji pripadaju OU bez ove opcije omogućene ne mogu pristupiti delegiranom nalogu.
* Sa tipičnom upotrebom, 40 delegiranih korisnika može pristupiti Gmail nalogu istovremeno. Upotreba iznad proseka od strane jednog ili više delegata može smanjiti ovaj broj.&#x20;
* Automatizovani procesi koji često pristupaju Gmailu takođe mogu smanjiti broj delegata koji mogu pristupiti nalogu istovremeno. Ovi procesi uključuju API-je ili proširenja pregledača koji često pristupaju Gmailu.
* Jedan Gmail nalog podržava do 1.000 jedinstvenih delegata. Grupa u Grupama se računa kao jedan delegat prema limitu.
* Delegacija ne povećava limite za Gmail nalog. Gmail nalozi sa delegiranim korisnicima imaju standardne Gmail nalog limite i politike. Za detalje, posetite [Gmail limite i politike](https://support.google.com/a/topic/28609).
### Korak 1: Uključivanje Gmail delegacije za vaše korisnike&#x20;

**Pre nego što počnete:** Da biste primenili podešavanje za određene korisnike, stavite njihove naloge u [organizacionu jedinicu](https://support.google.com/a/topic/1227584).

1. [Prijavite se](https://admin.google.com/) na svoj [Google Admin konzolu](https://support.google.com/a/answer/182076).

Prijavite se koristeći _administrator nalog_, a ne vaš trenutni nalog CarlosPolop@gmail.com
2. U Admin konzoli, idite na Meni ![](https://storage.googleapis.com/support-kms-prod/JxKYG9DqcsormHflJJ8Z8bHuyVI5YheC0lAp)![a zatim](https://storage.googleapis.com/support-kms-prod/Th2Tx0uwPMOhsMPn7nRXMUo3vs6J0pto2DTn)![](https://storage.googleapis.com/support-kms-prod/ocGtUSENh4QebLpvZcmLcNRZyaTBcolMRSyl) **Aplikacije**![a zatim](https://storage.googleapis.com/support-kms-prod/Th2Tx0uwPMOhsMPn7nRXMUo3vs6J0pto2DTn)**Google Workspace**![a zatim](https://storage.googleapis.com/support-kms-prod/Th2Tx0uwPMOhsMPn7nRXMUo3vs6J0pto2DTn)**Gmail**![a zatim](https://storage.googleapis.com/support-kms-prod/Th2Tx0uwPMOhsMPn7nRXMUo3vs6J0pto2DTn)**Podešavanja korisnika**.
3. Da biste primenili podešavanje za sve, ostavite izabranu gornju organizacionu jedinicu. Inače, izaberite podređenu [organizacionu jedinicu](https://support.google.com/a/topic/1227584).
4. Kliknite na **Delegacija pošte**.
5. Označite polje **Dozvoli korisnicima da delegiraju pristup svojoj poštanskoj sandučići drugim korisnicima u domenu**.
6. (Opciono) Da biste omogućili korisnicima da specificiraju koje informacije o pošiljaocu su uključene u delegirane poruke poslate sa njihovog naloga, označite polje **Dozvoli korisnicima da prilagode ovo podešavanje**.
7. Izaberite opciju za podrazumevane informacije o pošiljaocu koje su uključene u porukama poslatim od strane delegata:&#x20;
* **Prikaži vlasnika naloga i delegata koji je poslao email**—Poruke uključuju email adrese vlasnika Gmail naloga i delegata.
* **Prikaži samo vlasnika naloga**—Poruke uključuju email adresu samo vlasnika Gmail naloga. Email adresa delegata nije uključena.
8. (Opciono) Da biste omogućili korisnicima da dodaju grupu u Grupama kao delegata, označite polje **Dozvoli korisnicima da dodele pristup svojoj poštanskoj sandučići Google grupi**.
9. Kliknite na **Sačuvaj**. Ako ste konfigurisali podređenu organizacionu jedinicu, možda ćete moći da **Nasledite** ili **Prepišete** podešavanja roditeljske organizacione jedinice.
10. (Opciono) Da biste uključili Gmail delegaciju za druge organizacione jedinice, ponovite korake 3–9.

Promene mogu potrajati do 24 sata, ali obično se dešavaju brže. [Saznajte više](https://support.google.com/a/answer/7514107)

### Korak 2: Neka korisnici podeše delegacije za svoje naloge

Nakon što uključite delegaciju, vaši korisnici idu u svoja Gmail podešavanja da dodele delegatima. Delegati mogu čitati, slati i primati poruke u ime korisnika. &#x20;

Za detalje, uputite korisnike na [Delegiranje i saradnju putem emaila](https://support.google.com/a/users/answer/138350).

</details>

<details>

<summary>Od običnog korisnika, proverite ovde uputstva kako da pokušate da delegirate pristup</summary>

(Informacije kopirane [**iz dokumenata**](https://support.google.com/mail/answer/138350))

Možete dodati do 10 delegata.

Ako koristite Gmail putem svog posla, škole ili druge organizacije:

* Možete dodati do 1000 delegata unutar vaše organizacije.
* Sa tipičnom upotrebom, 40 delegata može pristupiti Gmail nalogu istovremeno.&#x20;
* Ako koristite automatizovane procese, kao što su API-ji ili ekstenzije pregledača, nekoliko delegata može pristupiti Gmail nalogu istovremeno.

1. Na svom računaru, otvorite [Gmail](https://mail.google.com/). Ne možete dodati delegate iz Gmail aplikacije.
2. U gornjem desnom uglu, kliknite na Podešavanja ![Podešavanja](https://lh3.googleusercontent.com/p3J-ZSPOLtuBBR\_ofWTFDfdgAYQgi8mR5c76ie8XQ2wjegk7-yyU5zdRVHKybQgUlQ=w36-h36) ![a zatim](https://lh3.googleusercontent.com/3\_l97rr0GvhSP2XV5OoCkV2ZDTIisAOczrSdzNCBxhIKWrjXjHucxNwocghoUa39gw=w36-h36) **Prikaži sva podešavanja**.
3. Kliknite na karticu **Nalozi i uvoz** ili **Nalozi**.
4. U odeljku "Dodeli pristup svom nalogu", kliknite na **Dodaj drugi nalog**. Ako koristite Gmail putem svog posla ili škole, vaša organizacija može ograničiti delegiranje emaila. Ako ne vidite ovo podešavanje, kontaktirajte svog administratora.
* Ako ne vidite Dodeli pristup svom nalogu, onda je ograničeno.
5. Unesite email adresu osobe koju želite dodati. Ako koristite Gmail putem svog posla, škole ili druge organizacije, i ako vaš administrator to dozvoljava, možete uneti email adresu grupe. Ova grupa mora imati istu domenu kao vaša organizacija. Spoljni članovi grupe su uskraćeni pristup delegaciji. \
\
**Važno:** Ako je nalog koji delegirate novi nalog ili je lozinka resetovana, Administrator mora isključiti zahtev za promenu lozinke kada se prvi put prijavite.

* [Saznajte kako Administrator može kreirati korisnika](https://support.google.com/a/answer/33310).
* [Saznajte kako Administrator može resetovati lozinke](https://support.google.com/a/answer/33319).

6\. Kliknite na **Sledeći korak** ![a zatim](https://lh3.googleusercontent.com/QbWcYKta5vh\_4-OgUeFmK-JOB0YgLLoGh69P478nE6mKdfpWQniiBabjF7FVoCVXI0g=h36) **Pošalji email za dodelu pristupa**.

Osoba koju ste dodali će dobiti email sa zahtevom za potvrdu. Poziv ističe nakon nedelju dana.

Ako ste dodali grupu, svi članovi grupe postaće delegati bez potrebe za potvrdom.&#x20;

Napomena: Može potrajati do 24 sata da delegacija počne da ima efekta.

</details>

## Upornost putem Android aplikacije

Ako imate **sesiju unutar žrtvinog Google naloga** možete pretražiti **Play prodavnicu** i možda moći **instalirati malver** koji ste već otpremili direktno **na telefon** kako biste održali upornost i pristupili žrtvinom telefonu.

## **Upornost putem** Skripti aplikacije

Možete kreirati **triggere zasnovane na vremenu** u Skriptama aplikacije, tako da ako korisnik prihvati Skriptu aplikaciju, ona će biti **pokrenuta** čak i **bez pristupa korisnika**. Za više informacija o tome kako to uraditi proverite:

{% content-ref url="gws-google-platforms-phishing/gws-app-scripts.md" %}
[gws-app-scripts.md](gws-google-platforms-phishing/gws-app-scripts.md)
{% endcontent-ref %}

## Reference

* [https://www.youtube-nocookie.com/embed/6AsVUS79gLw](https://www.youtube-nocookie.com/embed/6AsVUS79gLw) - Matthew Bryant - Hakovanje G Suite: Moć Dark Apps Script Magije
* [https://www.youtube.com/watch?v=KTVHLolz6cE](https://www.youtube.com/watch?v=KTVHLolz6cE) - Mike Felch i Beau Bullock - OK Google, Kako da Red Timujete GSuite?

{% hint style="success" %}
Naučite & vežbajte hakovanje AWS-a:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Obuka AWS Red Tim Ekspert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Naučite & vežbajte hakovanje GCP-a: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Obuka GCP Red Tim Ekspert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podržite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakovanje trikova slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) **i** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github repozitorijume.**

</details>
{% endhint %}
