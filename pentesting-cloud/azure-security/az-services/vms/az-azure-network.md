# Az - Azure Network

{% hint style="success" %}
Naučite i vežbajte AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Naučite i vežbajte GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podržite HackTricks</summary>

* Pogledajte [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Delite hacking trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

## Osnovne Informacije

Mreže unutar Azure funkcionišu kao integralni deo njegove cloud computing platforme, omogućavajući **povezivanje i komunikaciju između različitih Azure servisa i resursa**. Mrežna arhitektura u Azure je dizajnirana da bude visoko skalabilna, sigurna i prilagodljiva.

U svojoj osnovi, Azure pruža **virtualnu mrežu (VNet)** koja omogućava korisnicima da kreiraju **izolovane** **mreže** unutar Azure clouda. Unutar ovih VNet-ova, resursi kao što su virtuelne mašine, aplikacije i baze podataka mogu biti sigurno hostovani i upravljani. Mrežna podrška u Azure omogućava komunikaciju unutar clouda (između Azure servisa) i povezivanje sa spoljnim mrežama i internetom.

**Sigurnost** je ključni aspekt Azure mrežnog sistema, sa različitim alatima i servisima dostupnim za zaštitu podataka, upravljanje pristupom i osiguranje usklađenosti. Ove mere sigurnosti uključuju **firewalle**, **grupe mrežne sigurnosti** i **mogućnosti enkripcije**, omogućavajući visok nivo kontrole nad saobraćajem i pristupom.

Sve u svemu, Azure-ove mrežne mogućnosti su dizajnirane da ponude fleksibilnost, omogućavajući korisnicima da kreiraju mrežno okruženje koje odgovara njihovim specifičnim potrebama aplikacija i radnih opterećenja, uz snažan naglasak na sigurnost i pouzdanost.

## Virtualna Mreža (VNET) i Podmreže

VNet u Azure je u suštini predstava vaše sopstvene mreže u cloudu. To je **logička izolacija Azure clouda posvećena vašoj pretplati**. VNet vam omogućava da obezbedite i upravljate virtuelnim privatnim mrežama (VPN-ovima) u Azure i može se koristiti za hostovanje i **upravljanje različitim tipovima Azure resursa**, kao što su virtuelne mašine (VM-ovi), baze podataka i aplikativni servisi.

VNets vam pružaju **punu kontrolu nad vašim mrežnim postavkama**, uključujući **IP adrese** opsege, kreiranje podmreža, tabele ruta i mrežne prolaze.

**Podmreža** je **opseg IP adresa u vašem VNet-u**. Možete podeliti VNet na više podmreža radi organizacije i sigurnosti. Svaka podmreža u VNet-u može se koristiti za izolaciju i grupisanje resursa prema vašoj mrežnoj i aplikativnoj arhitekturi.

Štaviše, podmreže vam omogućavaju da **segmentirate vaš VNet u jednu ili više podmreža**, pružajući opseg IP adresa koje resursi mogu koristiti.

### **Primer**

* Pretpostavimo da imate VNet nazvan `MyVNet` sa opsegom IP adresa `10.0.0.0/16`. Možete kreirati podmrežu unutar ovog VNet-a, recimo `Subnet-1`, sa opsegom IP adresa `10.0.0.0/24` za hostovanje vaših web servera. Druga podmreža, `Subnet-2` sa opsegom `10.0.1.0/24`, mogla bi se koristiti za vaše baze podataka. Ova segmentacija omogućava efikasno upravljanje i sigurnosne kontrole unutar mreže.

### Enumeracija

Da biste naveli sve VNet-ove i podmreže u Azure nalogu, možete koristiti Azure Command-Line Interface (CLI). Evo koraka:

{% code overflow="wrap" %}
```bash
# List VNets
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List subnets of a VNet
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, addressPrefix:addressPrefix}" -o table
```
{% endcode %}

## Network Security Groups (NSG)

U Azure-u, **Network Security Group (NSG)** služi primarnoj funkciji filtriranja mrežnog saobraćaja ka i od Azure resursa unutar Azure Virtual Network (VNet). Sadrži set **sigurnosnih pravila** koja pažljivo diktiraju tok mrežnog saobraćaja.

Ključni aspekti NSG uključuju:

* **Kontrola Saobraćaja**: Svaki NSG sadrži pravila koja su ključna za dozvoljavanje ili blokiranje dolaznog i odlaznog mrežnog saobraćaja povezanog sa različitim Azure resursima.
* **Komponente Pravila**: Pravila unutar NSG su veoma specifična, filtrirajući saobraćaj na osnovu kriterijuma kao što su izvorna/odredišna IP adresa, port i protokol. Ova specifičnost omogućava detaljno upravljanje mrežnim saobraćajem.
* **Poboljšanje Sigurnosti**: Osiguravanjem da samo autorizovani saobraćaj može ući ili izaći iz vaših Azure resursa, NSG igra ključnu ulogu u jačanju sigurnosnog položaja vaše mrežne infrastrukture.

### **Primer**

* Zamislite da imate NSG nazvan `MyNSG` primenjen na podmrežu ili specifičnu virtuelnu mašinu unutar vašeg VNet-a. Možete kreirati pravila kao što su:
* Dolazno pravilo koje dozvoljava HTTP saobraćaj (port 80) sa bilo kog izvora ka vašim web serverima.
* Odlazno pravilo koje dozvoljava samo SQL saobraćaj (port 1433) ka specifičnom opsegu IP adresa.

### Enumeracija

{% code overflow="wrap" %}
```bash
# List NSGs
az network nsg list --query "[].{name:name, location:location}" -o table

# Get NSG rules
az network nsg rule list --nsg-name <NSGName> --resource-group <ResourceGroupName> --query "[].{name:name, priority:priority, direction:direction, access:access, protocol:protocol, sourceAddressPrefix:sourceAddressPrefix, destinationAddressPrefix:destinationAddressPrefix, sourcePortRange:sourcePortRange, destinationPortRange:destinationPortRange}" -o table
```
{% endcode %}

## Azure Firewall

Azure Firewall je upravljana, cloud-bazirana **mrežna sigurnosna usluga koja štiti vaše Azure Virtual Network resurse**. To je potpuno stateful firewall kao usluga sa ugrađenim funkcijama visoke dostupnosti i skalabilnosti.

Azure Firewall pruža **naprednije** funkcije od **NSG-ova**, uključujući **filtriranje na nivou aplikacije**, filtriranje na mrežnom nivou, filtriranje zasnovano na obaveštajnim podacima o pretnjama, i integraciju sa Azure Monitor za logovanje i analitiku.\
Može filtrirati odlazni, dolazni, spoke-to-spoke, VPN, i ExpressRoute saobraćaj. **Pravila firewalla mogu se kreirati na osnovu FQDN (Fully Qualified Domain Name), IP adresa i portova**.

### Razlike između Azure Firewall i NSG-ova

1. **Opseg:**
* **NSG:** Radi na nivou subnet-a ili mrežnog interfejsa. Namenjen je za osnovno filtriranje dolaznog i odlaznog saobraćaja sa mrežnih interfejsa (NIC), VM-ova ili subnet-ova.
* **Azure Firewall:** Operiše na nivou VNet-a, pružajući širi opseg zaštite. Dizajniran je da osigura vaše virtualne mrežne resurse i upravlja saobraćajem koji ulazi i izlazi iz VNet-a.
2. **Sposobnosti:**
* **NSG:** Pruža osnovne mogućnosti filtriranja zasnovane na IP adresi, portu i protokolu. Ne podržava napredne funkcije kao što su inspekcija na nivou aplikacije ili obaveštajni podaci o pretnjama.
* **Azure Firewall:** Nudi napredne funkcije kao što su filtriranje saobraćaja na nivou aplikacije (Layer 7), filtriranje zasnovano na obaveštajnim podacima o pretnjama, filtriranje mrežnog saobraćaja i više. Takođe podržava više javnih IP adresa.
3. **Upotreba:**
* **NSG:** Idealan za osnovno filtriranje saobraćaja na mrežnom nivou.
* **Azure Firewall:** Pogodan za složenije scenarije filtriranja gde je potrebna kontrola na nivou aplikacije, logovanje i obaveštajni podaci o pretnjama.
4. **Upravljanje i nadzor:**
* **NSG:** Nudi osnovno logovanje i integraciju sa Azure Monitor.
* **Azure Firewall:** Pruža napredne mogućnosti logovanja i analitike putem Azure Monitor, što je ključno za razumevanje prirode i obrazaca saobraćaja.

### Enumeracija

{% code overflow="wrap" %}
```bash
# List Azure Firewalls
az network firewall list --query "[].{name:name, location:location, subnet:subnet, publicIp:publicIp}" -o table

# Get network rules of a firewall
az network firewall network-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get application rules of a firewall
az network firewall application-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get nat rules of a firewall
az network firewall nat-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table
```
{% endcode %}

## Network Virtual Appliance (NVA)

Network Virtual Appliance (**NVA**) u Azure-u je virtuelni uređaj koji **obavlja mrežne funkcije unutar virtuelne mreže**. NVAs se obično koriste za mrežne funkcije koje **nisu nativno dostupne** u Azure-u ili kada je potrebna veća prilagođenost. Oni su u suštini **VMs koji pokreću mrežne aplikacije ili usluge**, kao što su firewall-ovi, WAN optimizatori ili load balanceri.

NVAs se koriste za složeno rutiranje, **bezbednost**, i **upravljanje mrežnim saobraćajem**. Mogu se implementirati iz Azure **Marketplace**, gde mnogi treći dobavljači nude svoje uređaje spremne za integraciju u Azure okruženja.

### **Primer**

* Organizacija može implementirati NVA u Azure-u da kreira **prilagođeno firewall rešenje**. Ovaj NVA može pokretati **softver treće strane za firewall**, pružajući napredne funkcije kao što su detekcija upada, inspekcija paketa, ili VPN konekcija. NVA se može konfigurisati da inspektuje i filtrira saobraćaj koji prolazi kroz njega, osiguravajući poboljšane bezbednosne mere u skladu sa politikama organizacije.

### **Enumeracija**

{% code overflow="wrap" %}
```bash
# Usually NVAs are named or tagged in a way to distinguish them from other VMs
az vm list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# For a specific VM identified as an NVA, list its network interfaces
az vm nic list --vm-name <VMName> --resource-group <ResourceGroupName> --query "[].{id:id}" -o table
```
{% endcode %}

## Azure Route Tables & User Defined Routes (UDR)

**Azure Route Tables** su funkcija unutar Microsoft Azure koja omogućava **kontrolu rutiranja mrežnog saobraćaja unutar Azure Virtual Networks (VNets)**. U suštini, one definišu kako se **paketi** **prosleđuju** između podmreža unutar VNets, između VNets, ili ka spoljnim mrežama. Svaka tabela ruta sadrži skup pravila, poznatih kao rute, koje specificiraju kako paketi treba da budu rutirani na osnovu njihovih odredišnih IP adresa.

**User Defined Routes (UDR)** u Azure su **prilagođene rute koje kreirate unutar Azure Route Tables** kako biste kontrolisali **tok mrežnog saobraćaja** unutar i između Azure Virtual Networks (VNets), i ka spoljnim vezama. UDR-ovi vam daju fleksibilnost da usmeravate mrežni saobraćaj prema vašim specifičnim zahtevima, nadjačavajući podrazumevane odluke o rutiranju koje donosi Azure.

Ove rute su posebno korisne za scenarije gde je potrebno **rutirati saobraćaj kroz virtuelni uređaj**, sprovesti specifičan put za sigurnost ili usklađenost sa politikama, ili se integrisati sa lokalnim mrežama.

### **Primer**

* Pretpostavimo da ste implementirali Network Virtual Appliance (NVA) za inspekciju saobraćaja između podmreža unutar VNet-a. Možete kreirati UDR koji usmerava sav saobraćaj iz jedne podmreže u drugu podmrežu preko NVA. Ovaj UDR osigurava da NVA pregleda saobraćaj u sigurnosne svrhe pre nego što stigne na svoje odredište.

### **Enumeracija**

{% code overflow="wrap" %}
```bash
# List Route Tables
az network route-table list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List UDRs for a table
az network route-table route list --route-table-name <RouteTableName> --resource-group <ResourceGroupName> --query "[].{name:name, addressPrefix:addressPrefix, nextHopType:nextHopType, nextHopIpAddress:nextHopIpAddress}" -o table
```
{% endcode %}

## Azure Private Link

Azure Private Link je usluga u Azure-u koja **omogućava privatni pristup Azure uslugama** tako što osigurava da **saobraćaj između vašeg Azure virtuelnog mrežnog (VNet) i usluge putuje isključivo unutar Microsoft-ove Azure backbone mreže**. Efektivno dovodi uslugu u vaš VNet. Ova postavka poboljšava sigurnost tako što ne izlaže podatke javnom internetu.

Private Link se može koristiti sa raznim Azure uslugama, kao što su Azure Storage, Azure SQL Database, i prilagođene usluge deljene putem Private Link-a. Pruža siguran način za korišćenje usluga unutar vašeg sopstvenog VNet-a ili čak iz različitih Azure pretplata.

{% hint style="danger" %}
NSG-ovi se ne primenjuju na privatne krajnje tačke, što jasno znači da povezivanje NSG-a sa podmrežom koja sadrži Private Link neće imati efekta.
{% endhint %}

### **Primer**

* Razmotrite scenario gde imate **Azure SQL Database koji želite da pristupite sigurno iz vašeg VNet-a**. Normalno, ovo bi moglo uključivati prolazak kroz javni internet. Sa Private Link-om, možete kreirati **privatnu krajnju tačku u vašem VNet-u** koja se direktno povezuje sa Azure SQL Database uslugom. Ova krajnja tačka čini da baza podataka izgleda kao da je deo vašeg sopstvenog VNet-a, dostupna putem privatne IP adrese, čime se osigurava siguran i privatan pristup.

### **Enumeracija**

{% code overflow="wrap" %}
```bash
# List Private Link Services
z network private-link-service list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List Private Endpoints
az network private-endpoint list --query "[].{name:name, location:location, resourceGroup:resourceGroup, privateLinkServiceConnections:privateLinkServiceConnections}" -o table
```
{% endcode %}

## Azure Service Endpoints

Azure Service Endpoints proširuju privatni adresni prostor vaše virtuelne mreže i identitet vašeg VNet-a na Azure usluge preko direktne veze. Omogućavanjem servisnih krajnjih tačaka, **resursi u vašem VNet-u mogu se sigurno povezati sa Azure uslugama**, kao što su Azure Storage i Azure SQL Database, koristeći Azure-ovu mrežu. Ovo osigurava da **saobraćaj iz VNet-a do Azure usluge ostaje unutar Azure mreže**, pružajući sigurniji i pouzdaniji put.

### **Primer**

* Na primer, **Azure Storage** nalog je po defaultu dostupan preko javnog interneta. Omogućavanjem **servisne krajnje tačke za Azure Storage unutar vašeg VNet-a**, možete osigurati da samo saobraćaj iz vašeg VNet-a može pristupiti nalogu za skladištenje. Firewall naloga za skladištenje se zatim može konfigurisati da prihvata saobraćaj samo iz vašeg VNet-a.

### **Enumeracija**

{% code overflow="wrap" %}
```bash
# List Virtual Networks with Service Endpoints
az network vnet list --query "[].{name:name, location:location, serviceEndpoints:serviceEndpoints}" -o table

# List Subnets with Service Endpoints
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, serviceEndpoints:serviceEndpoints}" -o table
```
{% endcode %}

### Razlike između Service Endpoints i Private Links

Microsoft preporučuje korišćenje Private Links u [**dokumentaciji**](https://learn.microsoft.com/en-us/azure/virtual-network/vnet-integration-for-azure-services#compare-private-endpoints-and-service-endpoints):\\

<figure><img src="../../../../.gitbook/assets/image (25).png" alt=""><figcaption></figcaption></figure>

**Service Endpoints:**

* Saobraćaj iz vašeg VNet-a ka Azure servisu putuje preko Microsoft Azure backbone mreže, zaobilazeći javni internet.
* Endpoint je direktna veza sa Azure servisom i ne obezbeđuje privatnu IP adresu za servis unutar VNet-a.
* Sam servis je i dalje dostupan preko svog javnog endpoint-a izvan vašeg VNet-a, osim ako ne konfigurišete firewall servisa da blokira takav saobraćaj.
* To je odnos jedan-na-jedan između subnet-a i Azure servisa.
* Manje je skupo od Private Links.

**Private Links:**

* Private Link mapira Azure servise u vaš VNet preko privatnog endpoint-a, koji je mrežni interfejs sa privatnom IP adresom unutar vašeg VNet-a.
* Azure servis se pristupa koristeći ovu privatnu IP adresu, čineći da izgleda kao da je deo vaše mreže.
* Servisi povezani preko Private Link-a mogu se pristupiti samo iz vašeg VNet-a ili povezanih mreža; nema javnog internet pristupa servisu.
* Omogućava sigurnu vezu sa Azure servisima ili vašim sopstvenim servisima hostovanim u Azure-u, kao i vezu sa servisima koje dele drugi.
* Pruža granularniju kontrolu pristupa preko privatnog endpoint-a u vašem VNet-u, za razliku od šire kontrole pristupa na nivou subnet-a sa service endpoints.

Ukratko, dok i Service Endpoints i Private Links pružaju sigurnu povezanost sa Azure servisima, **Private Links nude viši nivo izolacije i sigurnosti osiguravajući da se servisima pristupa privatno bez izlaganja javnom internetu**. Service Endpoints, s druge strane, su lakši za postavljanje za opšte slučajeve gde je potrebna jednostavna, sigurna veza sa Azure servisima bez potrebe za privatnom IP adresom u VNet-u.

## Azure Front Door (AFD) & AFD WAF

**Azure Front Door** je skalabilna i sigurna ulazna tačka za **brzu isporuku** vaših globalnih web aplikacija. **Kombinuje** različite servise kao što su globalni **load balancing, ubrzanje sajta, SSL offloading, i Web Application Firewall (WAF)** mogućnosti u jedan servis. Azure Front Door pruža inteligentno rutiranje bazirano na **najbližoj edge lokaciji korisniku**, osiguravajući optimalne performanse i pouzdanost. Pored toga, nudi rutiranje bazirano na URL-u, hosting više sajtova, sesijsku afinitet i sigurnost na aplikacionom sloju.

**Azure Front Door WAF** je dizajniran da **štiti web aplikacije od napada baziranih na web-u** bez modifikacije back-end koda. Uključuje prilagođena pravila i upravljane setove pravila za zaštitu od pretnji kao što su SQL injection, cross-site scripting, i drugi uobičajeni napadi.

### **Primer**

* Zamislite da imate globalno distribuiranu aplikaciju sa korisnicima širom sveta. Možete koristiti Azure Front Door da **rutirate korisničke zahteve ka najbližem regionalnom data centru** koji hostuje vašu aplikaciju, čime se smanjuje latencija, poboljšava korisničko iskustvo i **brani od web napada sa WAF mogućnostima**. Ako određeni region doživi prekid rada, Azure Front Door može automatski preusmeriti saobraćaj na sledeću najbolju lokaciju, osiguravajući visoku dostupnost.

### Enumeracija

{% code overflow="wrap" %}
```bash
# List Azure Front Door Instances
az network front-door list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List Front Door WAF Policies
az network front-door waf-policy list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table
```
{% endcode %}

## Azure Application Gateway i Azure Application Gateway WAF

Azure Application Gateway je **balanser opterećenja web saobraćaja** koji vam omogućava da upravljate saobraćajem ka vašim **web** aplikacijama. Nudi **Layer 7 balansiranje opterećenja, SSL terminaciju i mogućnosti web aplikacionog firewall-a (WAF)** u okviru Application Delivery Controller (ADC) kao usluge. Ključne karakteristike uključuju rutiranje zasnovano na URL-u, sesijsku afinitet zasnovanu na kolačićima i SSL offloading, što je ključno za aplikacije koje zahtevaju složene mogućnosti balansiranja opterećenja kao što su globalno rutiranje i rutiranje zasnovano na putanji.

### Primer

* Razmotrite scenario gde imate e-commerce sajt koji uključuje više poddomena za različite funkcije, kao što su korisnički nalozi i obrada plaćanja. Azure Application Gateway može **rutirati saobraćaj ka odgovarajućim web serverima na osnovu URL putanje**. Na primer, saobraćaj ka `example.com/accounts` može biti usmeren ka servisu za korisničke naloge, a saobraćaj ka `example.com/pay` može biti usmeren ka servisu za obradu plaćanja.\
I **zaštitite vaš sajt od napada koristeći WAF mogućnosti.**

### **Enumeracija**

{% code overflow="wrap" %}
```bash
# List the Web Application Firewall configurations for your Application Gateways
az network application-gateway waf-config list --gateway-name <AppGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, firewallMode:firewallMode, ruleSetType:ruleSetType, ruleSetVersion:ruleSetVersion}" -o table
```
{% endcode %}

## Azure Hub, Spoke & VNet Peering

**VNet Peering** je mrežna funkcija u Azure-u koja **omogućava direktno i besprekorno povezivanje različitih Virtual Networks (VNets)**. Kroz VNet peering, resursi u jednom VNet-u mogu komunicirati sa resursima u drugom VNet-u koristeći privatne IP adrese, **kao da su u istoj mreži**.\
**VNet Peering se takođe može koristiti sa on-prem mrežama** postavljanjem site-to-site VPN-a ili Azure ExpressRoute-a.

**Azure Hub and Spoke** je mrežna topologija koja se koristi u Azure-u za upravljanje i organizovanje mrežnog saobraćaja. **"Hub" je centralna tačka koja kontroliše i usmerava saobraćaj između različitih "spokes"**. Hub obično sadrži zajedničke servise kao što su network virtual appliances (NVAs), Azure VPN Gateway, Azure Firewall, ili Azure Bastion. **"Spokes" su VNets koji hostuju radna opterećenja i povezuju se sa hub-om koristeći VNet peering**, omogućavajući im da koriste zajedničke servise unutar hub-a. Ovaj model promoviše čist mrežni raspored, smanjujući kompleksnost centralizovanjem zajedničkih servisa koje mogu koristiti različita radna opterećenja u različitim VNet-ovima.

{% hint style="danger" %}
**VNET peering nije tranzitivan u Azure-u**, što znači da ako je spoke 1 povezan sa spoke 2 i spoke 2 je povezan sa spoke 3, onda spoke 1 ne može direktno komunicirati sa spoke 3.
{% endhint %}

### Primeri

* Zamislite kompaniju sa odvojenim odeljenjima kao što su Prodaja, HR i Razvoj, **svako sa svojim VNet-om (spokes)**. Ovi VNets **zahtevaju pristup zajedničkim resursima** kao što su centralna baza podataka, firewall i internet gateway, koji su svi locirani u **drugom VNet-u (hub)**. Korišćenjem Hub and Spoke modela, svako odeljenje može **sigurno povezati se sa zajedničkim resursima kroz hub VNet bez izlaganja tih resursa javnom internetu** ili stvaranja kompleksne mrežne strukture sa brojnim vezama.

### Enumeracija

{% code overflow="wrap" %}
```bash
# List all VNets in your subscription
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List VNet peering connections for a given VNet
az network vnet peering list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, peeringState:peeringState, remoteVnetId:remoteVnetId}" -o table

# List Shared Resources (e.g., Azure Firewall) in the Hub
az network firewall list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table
```
{% endcode %}

## Site-to-Site VPN

Site-to-Site VPN u Azure omogućava vam da **povežete vašu lokalnu mrežu sa vašom Azure Virtual Network (VNet)**, omogućavajući resursima kao što su VM-ovi unutar Azure-a da se pojavljuju kao da su na vašoj lokalnoj mreži. Ova veza se uspostavlja putem **VPN gateway-a koji šifruje saobraćaj** između dve mreže.

### **Primer**

* Firma sa glavnom kancelarijom u Njujorku ima lokalni data centar koji treba sigurno da se poveže sa svojim VNet-om u Azure-u, koji hostuje njene virtualizovane radne opterećenja. Postavljanjem **Site-to-Site VPN-a, kompanija može osigurati šifrovanu povezanost između lokalnih servera i Azure VM-ova**, omogućavajući pristup resursima sigurno u oba okruženja kao da su u istoj lokalnoj mreži.

### **Enumeracija**

{% code overflow="wrap" %}
```bash
# List VPN Gateways
az network vnet-gateway list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List VPN Connections
az network vpn-connection list --gateway-name <VpnGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, connectionType:connectionType, connectionStatus:connectionStatus}" -o table
```
{% endcode %}

## Azure ExpressRoute

Azure ExpressRoute je usluga koja pruža **privatnu, posvećenu, visokobrzinsku vezu između vaše lokalne infrastrukture i Azure data centara**. Ova veza se ostvaruje preko provajdera konektivnosti, zaobilazeći javni internet i nudeći veću pouzdanost, brže brzine, niže latencije i veću sigurnost od tipičnih internet konekcija.

### **Primer**

* Multinacionalna korporacija zahteva **konzistentnu i pouzdanu vezu sa svojim Azure uslugama zbog velikog obima podataka** i potrebe za visokim protokom. Kompanija se odlučuje za Azure ExpressRoute kako bi direktno povezala svoj lokalni data centar sa Azure-om, olakšavajući velike prenose podataka, kao što su dnevni bekapi i analitika podataka u realnom vremenu, sa poboljšanom privatnošću i brzinom.

### **Enumeracija**

{% code overflow="wrap" %}
```bash
# List ExpressRoute Circuits
az network express-route list --query "[].{name:name, location:location, resourceGroup:resourceGroup, serviceProviderName:serviceProviderName, peeringLocation:peeringLocation}" -o table
```
{% endcode %}

{% hint style="success" %}
Naučite i vežbajte AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Naučite i vežbajte GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podržite HackTricks</summary>

* Pogledajte [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Delite hacking trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
