# Az - Huduma ya Azure App & Programu za Kazi

{% hint style="success" %}
Jifunze & zoezi Udukuzi wa AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Mafunzo ya HackTricks AWS Timu Nyekundu Mtaalam (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze & zoezi Udukuzi wa GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Mafunzo ya HackTricks GCP Timu Nyekundu Mtaalam (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa michango**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Taarifa Msingi za Huduma ya Programu

[Kutoka kwa nyaraka:](https://learn.microsoft.com/en-us/azure/app-service/overview) _Azure App Service_ ni huduma inayotumia HTTP kwa kuhifadhi maombi ya wavuti, REST APIs, na sehemu za nyuma za simu. Unaweza kuendeleza kwa lugha yako pendwa, iwe ni .NET, .NET Core, Java, Ruby, Node.js, PHP, au Python. Maombi hufanya kazi na kustawi kwa urahisi kwenye mifumo ya Windows na Linux.

Kila programu inaendeshwa ndani ya sanduku lakini utengano unategemea mipango ya Huduma ya Programu

* Programu katika safu za Free na Shared zinaendeshwa kwenye VMs zilizoshirikiwa
* Programu katika safu za Standard na Premium zinaendeshwa kwenye VMs zilizotengwa

{% hint style="warning" %}
Tafadhali kumbuka kwamba **hakuna** ya utengano huo **unazuia** udhaifu mwingine wa kawaida wa wavuti (kama vile kupakia faili, au sindano). Na ikiwa **kitambulisho cha usimamizi** kinatumika, kinaweza kuwa na uwezo wa **kuvunja ruhusa zake**.
{% endhint %}

### Uchambuzi

{% tabs %}
{% tab title="az" %}
{% code overflow="wrap" %}
```bash
# List webapps
az webapp list

## Less information
az webapp list --query "[].{hostName: defaultHostName, state: state, name: name, resourcegroup: resourceGroup}"

# Get access restrictions
az webapp config access-restriction show --resource-group <res-group> -n <name>

# Remove access restrictions
az webapp config access-restriction remove --resource-group <res-group> -n <name> --rule-name <rule-name>

# Get snapshots
az webapp config snapshot list --resource-group <res-group> -n <name>

# Restore snapshot
az webapp config snapshot restore -g <res-group> -n <name> --time 2018-12-11T23:34:16.8388367

# Restart webapp
az webapp restart --name <name> --resource-group <res-group>
```
{% endcode %}
{% endtab %}

{% tab title="Az Powershell" %}
```powershell
# Get App Services and Function Apps
Get-AzWebApp
# Get only App Services
Get-AzWebApp | ?{$_.Kind -notmatch "functionapp"}
```
{% endtab %}

{% tab title="pata zote" %}
{% code overflow="wrap" %}
```bash
#!/bin/bash

# Get all App Service and Function Apps

# Define Azure subscription ID
azure_subscription="your_subscription_id"

# Log in to Azure
az login

# Select Azure subscription
az account set --subscription $azure_subscription

# Get all App Services in the specified subscription
list_app_services=$(az appservice list --query "[].{appServiceName: name, group: resourceGroup}" -o tsv)

# Iterate over each App Service
echo "$list_app_services" | while IFS=$'\t' read -r appServiceName group; do
# Get the type of the App Service
service_type=$(az appservice show --name $appServiceName --resource-group $group --query "kind" -o tsv)

# Check if it is a Function App and print its name
if [ "$service_type" == "functionapp" ]; then
echo "Function App Name: $appServiceName"
fi
done
```
#### Pata siri na upate ufikiaji wa nambari ya programu ya wavuti
```bash
# Get connection strings that could contain credentials (with DBs for example)
az webapp config connection-string list --name <name> --resource-group <res-group>
## Check how to use the DBs connection strings in the SQL page

# Get credentials to access the code and DB credentials if configured.
az webapp deployment list-publishing-profiles --resource-group <res-group> -n <name>


# Get git URL to access the code
az webapp deployment source config-local-git --resource-group <res-group> -n <name>

# Access/Modify the code via git
git clone 'https://<username>:<password>@name.scm.azurewebsites.net/repo-name.git'
## In my case the username was: $nameofthewebapp and the password some random chars
## If you change the code and do a push, the app is automatically redeployed
```
#### Kupata ufikiaji kwenye kontena ya Docker na programu ya wavuti kupitia ssh:
```bash
# Get ssh session
az webapp create-remote-connection --subscription <SUBSCRIPTION-ID> --resource-group <RG-NAME> -n <APP-SERVICE-NAME>

## If successfull you will get a message such as:
#Verifying if app is running....
#App is running. Trying to establish tunnel connection...
#Opening tunnel on port: 39895
#SSH is available { username: root, password: Docker! }

## So from that machine ssh into that port (you might need generate a new ssh session to the jump host)
ssh root@127.0.0.1 -p 39895
```
## Taarifa Msingi za Programu za Kazi

Azure Functions ni suluhisho lisilo na seva ambalo linakuruhusu kuandika msimbo mdogo, kudumisha miundombinu kidogo, na kuokoa gharama. Badala ya kuhangaika kuhusu kupeleka na kudumisha seva, miundombinu ya wingu hutoa rasilimali zote zilizosasishwa zinazohitajika kuendesha programu zako.

Katika portal ya Azure, ushirikiano kati ya Azure Functions na Azure API Management unarahisishwa, kuruhusu **vifaa vya kazi vya kichocheo cha HTTP kuwekwa wazi kama API za REST**. APIs zilizowekwa wazi kwa njia hii zinaelezewa kwa kutumia ufafanuzi wa OpenAPI, kutoa kiolesura cha kawaida, bila kujali lugha, kwa APIs za RESTful.

**Programu za Kazi zinasaidia Vitambulisho Vilivyosimamiwa.**

Zaidi ya hayo, Programu ya Kazi inaweza kuwa na vipengele fulani vinavyohitaji viwango fulani vya uwakiki, kama "msimamizi" au "anonym". Mshambuliaji anaweza kujaribu kupata ufikiaji wa **vifaa vya kazi vinavyoruhusiwa kwa anonym** ili kudukua vizuizi na kupata ufikiaji wa data au utendaji wenye hisia.
```powershell
# Get only Function Apps
Get-AzFunctionApp
```
## Marejeo

* [https://learn.microsoft.com/en-in/azure/app-service/overview](https://learn.microsoft.com/en-in/azure/app-service/overview)
* [https://learn.microsoft.com/en-us/azure/azure-functions/functions-openapi-definition](https://learn.microsoft.com/en-us/azure/azure-functions/functions-openapi-definition)

{% hint style="success" %}
Jifunze na zoezi la Udukuzi wa AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Mafunzo ya HackTricks ya Mtaalam wa Timu Nyekundu ya AWS (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze na zoezi la Udukuzi wa GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Mafunzo ya HackTricks ya Mtaalam wa Timu Nyekundu ya GCP (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
{% endhint %}
