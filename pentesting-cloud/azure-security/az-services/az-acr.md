# Az - ACR

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Treinamento HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Treinamento HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoie o HackTricks</summary>

* Verifique os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

## Informa√ß√µes B√°sicas

O Azure Container Registry (ACR) √© um servi√ßo gerenciado fornecido pela Microsoft Azure para **armazenar e gerenciar imagens de cont√™ineres Docker e outros artefatos**. Ele oferece recursos como ferramentas integradas para desenvolvedores, geo-replica√ß√£o, medidas de seguran√ßa como controle de acesso baseado em fun√ß√µes e verifica√ß√£o de imagens, compila√ß√µes automatizadas, webhooks e gatilhos, e isolamento de rede. Ele funciona com ferramentas populares como Docker CLI e Kubernetes, e se integra bem com outros servi√ßos do Azure.

### Enumerar

Para enumerar o servi√ßo, voc√™ pode usar o script [**Get-AzACR.ps1**](https://github.com/NetSPI/MicroBurst/blob/master/Misc/Get-AzACR.ps1):

{% code overflow="wrap" %}
```bash
# List Docker images inside the registry
IEX (New-Object Net.Webclient).downloadstring("https://raw.githubusercontent.com/NetSPI/MicroBurst/master/Misc/Get-AzACR.ps1")

Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Internet Explorer\Main" -Name "DisableFirstRunCustomize" -Value 2

Get-AzACR -username <username> -password <password> -registry <corp-name>.azurecr.io
```
{% endcode %}

{% tabs %}
{% tab title="az cli" %}

### List all ACRs in a subscription

```bash
az acr list --subscription <subscription_id> --query "[].{Name:name, ResourceGroup:resourceGroup, Location:location}" -o table
```

### Show ACR details

```bash
az acr show --name <acr_name> --resource-group <resource_group_name>
```

### List all repositories in an ACR

```bash
az acr repository list --name <acr_name> --resource-group <resource_group_name> --output table
```

### Show repository details

```bash
az acr repository show --name <acr_name> --repository <repository_name> --resource-group <resource_group_name>
```

### List all images in a repository

```bash
az acr repository show-tags --name <acr_name> --repository <repository_name> --detail --output table
```

### Delete an image from a repository

```bash
az acr repository delete --name <acr_name> --image <image_tag> --repository <repository_name> --resource-group <resource_group_name>
```

{% endtab %}
{% endtabs %}
```bash
az acr list --output table
az acr show --name MyRegistry --resource-group MyResourceGroup
```
{% endtab %}

{% tab title="Az Powershell" %} 

## Az Powershell

O Azure CLI √© uma ferramenta de linha de comando que fornece uma maneira f√°cil de gerenciar recursos do Azure. Ele √© constru√≠do com Node.js e pode ser executado em qualquer sistema operacional. O Azure CLI √© especialmente √∫til para automa√ß√£o de tarefas e scripts.

Para instalar o Azure CLI, siga as instru√ß√µes espec√≠ficas para o seu sistema operacional na [documenta√ß√£o oficial](https://docs.microsoft.com/pt-br/cli/azure/install-azure-cli).

Depois de instalar o Azure CLI, voc√™ pode come√ßar a us√°-lo para interagir com seus recursos do Azure, como criar e gerenciar cont√™ineres de registro do Azure (Azure Container Registry - ACR). 

### Autentica√ß√£o

Antes de come√ßar a interagir com o ACR usando o Azure CLI, voc√™ precisa se autenticar. Voc√™ pode fazer isso executando o comando `az login`, que abrir√° uma janela do navegador para autentica√ß√£o.

### Listando Registros

Para listar todos os registros de cont√™ineres do Azure em sua assinatura, voc√™ pode usar o comando:

```bash
az acr list
```

Este comando retornar√° uma lista de todos os registros de cont√™ineres dispon√≠veis em sua assinatura do Azure.

### Obtendo Detalhes do Registro

Para obter detalhes espec√≠ficos sobre um registro de cont√™iner do Azure, voc√™ pode usar o comando `az acr show` seguido pelo nome do registro:

```bash
az acr show --name <acr_name>
```

Substitua `<acr_name>` pelo nome real do registro de cont√™iner do Azure que voc√™ deseja visualizar.

### Excluindo um Registro

Se voc√™ precisar excluir um registro de cont√™iner do Azure, pode fazer isso com o comando `az acr delete`:

```bash
az acr delete --name <acr_name>
```

Lembre-se de que a exclus√£o de um registro de cont√™iner √© uma a√ß√£o irrevers√≠vel e todos os dados contidos nele ser√£o perdidos.

{% endtab %}
```powershell
# List all ACRs in your subscription
Get-AzContainerRegistry

# Get a specific ACR
Get-AzContainerRegistry -ResourceGroupName "MyResourceGroup" -Name "MyRegistry"
```
{% endtab %}
{% endtabs %}

Login & Pull do registro
```bash
docker login <corp-name>.azurecr.io --username <username> --password <password>
docker pull <corp-name>.azurecr.io/<image>:<tag>
```
{% hint style="success" %}
Aprenda e pratique Hacking AWS: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Treinamento HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Treinamento HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Suporte o HackTricks</summary>

* Verifique os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
