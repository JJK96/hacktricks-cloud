# Az - ローカルクラウド資格情報

{% hint style="success" %}
AWSハッキングの学習と練習:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCPハッキングの学習と練習: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksをサポート</summary>

* [**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェック！
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に参加するか、[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**をフォロー**してください。
* **HackTricks**と**HackTricks Cloud**のgithubリポジトリにPRを提出してハッキングテクニックを共有してください。

</details>
{% endhint %}

## ローカルトークンストレージとセキュリティ考慮事項

### Azure CLI（コマンドラインインターフェース）

Azure CLIによってトークンや機密データがローカルに保存され、セキュリティ上の懸念が引き起こされます：

1. **アクセストークン**：`C:\Users\<username>\.Azure`にある`accessTokens.json`内に平文で保存されています。
2. **サブスクリプション情報**：同じディレクトリ内の`azureProfile.json`にサブスクリプションの詳細が保存されています。
3. **ログファイル**：`.azure`内の`ErrorRecords`フォルダには、埋め込まれた資格情報を含むログや、トークンを使用してアクセスされたURLなど、機密情報が露呈されている可能性があります。

### Azure PowerShell

Azure PowerShellもトークンや機密データを保存し、ローカルでアクセスできます：

1. **アクセストークン**：`C:\Users\<username>\.Azure`にある`TokenCache.dat`にアクセストークンが平文で保存されています。
2. **サービスプリンシパルのシークレット**：これらは`AzureRmContext.json`に暗号化されていない状態で保存されています。
3. **トークン保存機能**：ユーザーは`Save-AzContext`コマンドを使用してトークンを永続化する機能を持っていますが、権限なくアクセスされることを防ぐために慎重に使用する必要があります。

## それらを見つけるための自動ツール

* [**Winpeas**](https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS/winPEASexe)
* [**Get-AzurePasswords.ps1**](https://github.com/NetSPI/MicroBurst/blob/master/AzureRM/Get-AzurePasswords.ps1)

## セキュリティ推奨事項

平文で機密データを保存していることを考慮すると、これらのファイルとディレクトリを保護するために次のような対策を取ることが重要です：
- これらのファイルへのアクセス権を制限する。
- これらのディレクトリへの権限ないアクセスや予期しない変更を定期的に監視および監査する。
- 可能な限り機密ファイルを暗号化する。
- このような機密情報の取り扱いに関するリスクとベストプラクティスについてユーザーに教育する。


{% hint style="success" %}
AWSハッキングの学習と練習:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCPハッキングの学習と練習: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksをサポート</summary>

* [**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェック！
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に参加するか、[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**をフォロー**してください。
* **HackTricks**と**HackTricks Cloud**のgithubリポジトリにPRを提出してハッキングテクニックを共有してください。

</details>
{% endhint %}
