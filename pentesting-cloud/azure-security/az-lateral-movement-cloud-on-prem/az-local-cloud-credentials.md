# Az - 로컬 클라우드 자격 증명

{% hint style="success" %}
AWS 해킹 학습 및 실습:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP 해킹 학습 및 실습: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks 지원</summary>

* [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인하세요!
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **트위터** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**를 팔로우**하세요.
* 민감한 정보를 다루는 데 대한 위험 및 모범 사례에 대해 **HackTricks** 및 **HackTricks Cloud** 깃허브 저장소에 PR을 제출하여 **해킹 트릭을 공유**하세요.

</details>
{% endhint %}

## 로컬 토큰 저장 및 보안 고려 사항

### Azure CLI (Command-Line Interface)

Azure CLI에서 토큰 및 민감한 데이터가 로컬에 저장되어 보안 문제가 발생합니다:

1. **액세스 토큰**: `C:\Users\<username>\.Azure`에 위치한 `accessTokens.json`에 평문으로 저장됩니다.
2. **구독 정보**: 동일한 디렉토리에 있는 `azureProfile.json`에는 구독 세부 정보가 저장됩니다.
3. **로그 파일**: `.azure` 내의 `ErrorRecords` 폴더에는 노출된 자격 증명을 포함하는 로그가 포함될 수 있습니다:
- 자격 증명이 포함된 실행된 명령.
- 토큰을 사용하여 액세스한 URL로 민감한 정보가 노출될 수 있습니다.

### Azure PowerShell

Azure PowerShell도 로컬에 토큰 및 민감한 데이터를 저장하며 이에 접근할 수 있습니다:

1. **액세스 토큰**: `C:\Users\<username>\.Azure`에 위치한 `TokenCache.dat`에 액세스 토큰이 평문으로 저장됩니다.
2. **서비스 주체 비밀**: 이러한 정보는 `AzureRmContext.json`에 암호화되지 않은 상태로 저장됩니다.
3. **토큰 저장 기능**: 사용자는 무단 액세스를 방지하기 위해 조심스럽게 사용해야 하는 `Save-AzContext` 명령을 사용하여 토큰을 지속시킬 수 있습니다.

## 자동 도구를 사용하여 찾기

* [**Winpeas**](https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS/winPEASexe)
* [**Get-AzurePasswords.ps1**](https://github.com/NetSPI/MicroBurst/blob/master/AzureRM/Get-AzurePasswords.ps1)

## 보안 권장 사항

평문으로 민감한 데이터를 저장하는 것을 고려할 때, 이러한 파일 및 디렉토리를 보호하기 위해 다음을 수행해야 합니다:
- 이러한 파일에 대한 액세스 권한 제한.
- 무단 액세스나 예기치 않은 변경 사항을 모니터링하고 검토하는 디렉토리 정기적 감사.
- 가능한 경우 민감한 파일에 대해 암호화 사용.
- 사용자에게 민감한 정보를 다루는 위험 및 최선의 처리 방법에 대해 교육. 

{% hint style="success" %}
AWS 해킹 학습 및 실습:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP 해킹 학습 및 실습: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks 지원</summary>

* [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인하세요!
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **트위터** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**를 팔로우**하세요.
* 민감한 정보를 다루는 데 대한 위험 및 모범 사례에 대해 **HackTricks** 및 **HackTricks Cloud** 깃허브 저장소에 PR을 제출하여 **해킹 트릭을 공유**하세요.

</details>
{% endhint %}
