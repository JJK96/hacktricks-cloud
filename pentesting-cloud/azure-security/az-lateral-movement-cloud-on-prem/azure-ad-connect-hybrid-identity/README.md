# Az AD Connect - Hibrit Kimlik

{% hint style="success" %}
AWS Hacking öğrenin ve uygulayın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking öğrenin ve uygulayın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katılın veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak PR'ler göndererek HackTricks ve HackTricks Cloud github depolarına katkıda bulunun.**

</details>
{% endhint %}

## Temel Bilgiler

**Yerinde Active Directory (AD)** ile **Azure AD** arasındaki entegrasyon, çeşitli **Tek Oturum Açma (SSO)** yöntemlerini destekleyen **Azure AD Connect** aracılığıyla sağlanır. Her bir yöntem, kullanışlı olmasına rağmen bulut veya yerinde ortamları tehlikeye atabilecek potansiyel güvenlik açıklarını sunar:

* **Pass-Through Authentication (PTA)**:
- Yerinde AD'deki ajanın tehlikeye atılmasıyla, kullanıcı şifrelerinin Azure bağlantıları için doğrulanmasına izin verilir (yerinde - Bulut).
- Yeni bir konumda kimlik doğrulamalarını doğrulamak için yeni bir ajanın kaydedilme olasılığı (Bulut - yerinde).

{% content-ref url="pta-pass-through-authentication.md" %}
[pta-pass-through-authentication.md](pta-pass-through-authentication.md)
{% endcontent-ref %}

* **Password Hash Sync (PHS)**:
- AD'deki ayrıcalıklı kullanıcıların düz metin şifrelerinin çıkarılma potansiyeli, yüksek ayrıcalıklı, otomatik oluşturulan AzureAD kullanıcısının kimlik bilgilerini içerir.

{% content-ref url="phs-password-hash-sync.md" %}
[phs-password-hash-sync.md](phs-password-hash-sync.md)
{% endcontent-ref %}

* **Federasyon**:
- SAML imzalama için kullanılan özel anahtarın çalınması, yerinde ve bulut kimliklerinin taklit edilmesini sağlar.

{% content-ref url="federation.md" %}
[federation.md](federation.md)
{% endcontent-ref %}

* **Seamless SSO:**
- `AZUREADSSOACC` kullanıcısının şifresinin çalınması, Kerberos gümüş biletlerini imzalamak için kullanılan ve herhangi bir bulut kullanıcısının taklit edilmesine izin veren bir işlemdir.

{% content-ref url="seamless-sso.md" %}
[seamless-sso.md](seamless-sso.md)
{% endcontent-ref %}

* **Bulut Kerberos Güveni**:
- AzureAD kullanıcı adlarını ve SIDs'leri manipüle ederek Global Yöneticiden yerinde Alan Yöneticisine yükselme olasılığı ve AzureAD'den TGT'ler isteme olasılığı.

{% content-ref url="az-cloud-kerberos-trust.md" %}
[az-cloud-kerberos-trust.md](az-cloud-kerberos-trust.md)
{% endcontent-ref %}

* **Varsayılan Uygulamalar**:
- Bir Uygulama Yöneticisi hesabının veya yerinde Senkronizasyon Hesabının tehlikeye atılması, dizin ayarlarının, grup üyeliklerinin, kullanıcı hesaplarının, SharePoint sitelerinin ve OneDrive dosyalarının değiştirilmesine izin verir.

{% content-ref url="az-default-applications.md" %}
[az-default-applications.md](az-default-applications.md)
{% endcontent-ref %}

Her entegrasyon yöntemi için kullanıcı senkronizasyonu gerçekleştirilir ve on-prem AD'de bir `MSOL_<kurulumkimliği>` hesabı oluşturulur. Önemli bir şekilde, hem **PHS** hem de **PTA** yöntemleri **Seamless SSO**'yu kolaylaştırır, böylece yerinde etki alanına katılmış Azure AD bilgisayarları için otomatik oturum açma sağlanır.

**Azure AD Connect**'in kurulduğunu doğrulamak için aşağıdaki PowerShell komutu, varsayılan olarak Azure AD Connect ile birlikte yüklenen **AzureADConnectHealthSync** modülünü kullanır:
```powershell
Get-ADSyncConnector
```
{% hint style="success" %}
AWS Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katılın veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak PR'ler göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>
{% endhint %}
