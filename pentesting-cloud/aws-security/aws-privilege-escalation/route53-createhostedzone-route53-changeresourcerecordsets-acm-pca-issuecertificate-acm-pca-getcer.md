# AWS - Ukarabati wa Mamlaka ya Route53

{% hint style="success" %}
Jifunze na zoezi la Udukuzi wa AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Mafunzo ya HackTricks ya Mtaalam wa Timu Nyekundu ya AWS (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze na zoezi la Udukuzi wa GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Mafunzo ya HackTricks ya Mtaalam wa Timu Nyekundu ya GCP (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>unga mkono HackTricks</summary>

* Angalia [**mpango wa usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
{% endhint %}

Kwa habari zaidi kuhusu Route53 angalia:

{% content-ref url="../aws-services/aws-route53-enum.md" %}
[aws-route53-enum.md](../aws-services/aws-route53-enum.md)
{% endcontent-ref %}

### `route53:CreateHostedZone`, `route53:ChangeResourceRecordSets`, `acm-pca:IssueCertificate`, `acm-pca:GetCertificate`

{% hint style="info" %}
Ili kutekeleza shambulio hili akaunti ya lengo lazima tayari iwe na [**Mamlaka ya Cheti ya Kibinafsi ya Meneja wa Cheti cha AWS**](https://aws.amazon.com/certificate-manager/private-certificate-authority/) **(AWS-PCA)** imewekwa kwenye akaunti, na mifano ya EC2 katika VPC(s) lazima tayari ziwe zimeingiza vyeti kuamini hiyo. Na miundombinu hii ikiwa mahali, shambulio lifuatalo linaweza kutekelezwa kwa kuvizia trafiki ya API ya AWS.
{% endhint %}

Ruhusa nyingine **zilizopendekezwa lakini sio lazima kwa sehemu ya uchambuzi** ni: `route53:GetHostedZone`, `route53:ListHostedZones`, `acm-pca:ListCertificateAuthorities`, `ec2:DescribeVpcs`

Kukiwa na VPC ya AWS na programu nyingi za asili za wingu zinazozungumza na nyingine na na API ya AWS. Kwa kuwa mawasiliano kati ya huduma ndogo za wingu mara nyingi yamefichwa kwa TLS lazima kuwe na CA ya kibinafsi kutoa vyeti halali kwa huduma hizo. **Ikiwa ACM-PCA inatumika** kwa hilo na adui anafanikiwa kupata **upatikanaji wa kudhibiti route53 na ACM-PCA CA ya kibinafsi** na seti ya chini ya ruhusa zilizoelezwa hapo juu, inaweza **kuchukua simu za maombi ya programu kwa API ya AWS** kuchukua ruhusa zao za IAM.

Hii inawezekana kwa sababu:

* AWS SDKs hawana [Kufunga Cheti](https://www.digicert.com/blog/certificate-pinning-what-is-certificate-pinning)
* Route53 inaruhusu kuunda Eneo la Kuhifadhiwa Kibinafsi na rekodi za DNS kwa majina ya kikoa la API za AWS
* CA ya Kibinafsi katika ACM-PCA haiwezi kuzuiliwa kusaini vyeti tu kwa Majina ya Kawaida maalum

**Matokeo Yanayowezekana:** Ukarabati wa moja kwa moja kwa kuvizia habari nyeti katika trafiki.

#### Utekaji <a href="#ugunduzi" id="ugunduzi"></a>

Pata hatua za utekaji katika utafiti wa awali: [**https://niebardzo.github.io/2022-03-11-aws-hijacking-route53/**](https://niebardzo.github.io/2022-03-11-aws-hijacking-route53/)

{% hint style="success" %}
Jifunze & zoezi la Udukuzi wa AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Mafunzo ya HackTricks ya Mtaalam wa Timu Nyekundu ya AWS (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze & zoezi la Udukuzi wa GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Mafunzo ya HackTricks ya Mtaalam wa Timu Nyekundu ya GCP (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>unga mkono HackTricks</summary>

* Angalia [**mpango wa usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
{% endhint %}
