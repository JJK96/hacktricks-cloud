# AWS - S3 рдЕрдЕрдереЗрдВрдЯрд┐рдХреЗрдЯреЗрдб рдПрдиреБрдо

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди **The PEASS Family** рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ **PRs рд╕рдмрдорд┐рдЯ** рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## S3 рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдмрдХреЗрдЯреНрд╕

рдПрдХ рдмрдХреЗрдЯ рдХреЛ **тАЬрд╕рд╛рд░реНрд╡рдЬрдирд┐рдХтАЭ** рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдЕрдЧрд░ **рдХреЛрдИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдХреЗрдЯ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреА рд╕реВрдЪреА** рджреЗрдЦ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ **тАЬрдирд┐рдЬреАтАЭ** рдЕрдЧрд░ рдмрдХреЗрдЯ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ **рдХреЗрд╡рд▓ рдХреБрдЫ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рд╕реВрдЪреАрдмрджреНрдз рдпрд╛ рд▓рд┐рдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред

рдХрдВрдкрдирд┐рдпрд╛рдВ **рдмрдХреЗрдЯ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рдЧрд▓рдд рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░** рдХрд░ рд╕рдХрддреА рд╣реИрдВ рдЬрд┐рд╕рд╕реЗ рдкрд╣реБрдВрдЪ рдЗрд╕реЗ рд╕рдм рдХреБрдЫ рдпрд╛ AWS рдореЗрдВ рдХрд┐рд╕реА рднреА рдЦрд╛рддреЗ рдореЗрдВ рдкреНрд░рдорд╛рдгрд┐рдд рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рджреЗ рджреЗрддрд╛ рд╣реИ (рддреЛ рдХрд┐рд╕реА рдХреЛ рднреА)ред рдзреНрдпрд╛рди рджреЗрдВ, рдХрд┐ рдРрд╕реА рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рдмрд╛рд╡рдЬреВрдж рдХреБрдЫ рдХреНрд░рд┐рдпрд╛рдПрдБ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдмрдХреЗрдЯреНрд╕ рдХреЗ рдЕрдкрдиреЗ рдкрд╣реБрдВрдЪ рдирд┐рдпрдВрддреНрд░рдг рд╕реВрдЪреА (ACLs) рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

**AWS-S3 рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдиреЗрдВ рдпрд╣рд╛рдБ:** [**http://flaws.cloud**](http://flaws.cloud/) **рдФрд░** [**http://flaws2.cloud/**](http://flaws2.cloud)

### AWS рдмрдХреЗрдЯреНрд╕ рдЦреЛрдЬрдирд╛

рдХрд┐рд╕реА рд╡реЗрдмрдкреЗрдЬ рдореЗрдВ AWS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╡реЗрдмрдкреЗрдЬ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЗ:

#### рдПрдиреБрдорд░реЗрд╢рди рдФрд░ OSINT:

* **wappalyzer** рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдкреНрд▓рдЧрдЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
* burp рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ (**рд╡реЗрдм рдХреЛ spidering** рдХрд░рдХреЗ) рдпрд╛ рдкреГрд╖реНрда рдореЗрдВ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдХреЗ рд╕рднреА **рд╕рдВрд╕рд╛рдзрди** **рд▓реЛрдб** рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ рдЬреЛ рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ рд╕рд╣реЗрдЬреЗ рдЬрд╛рдПрдВрдЧреЗред
*   рдбреЛрдореЗрдиреНрд╕ рдореЗрдВ рд╕реЗ **рд╕рдВрд╕рд╛рдзрдиреЛрдВ** рдХреА **рдЬрд╛рдБрдЪ** рдХрд░реЗрдВ:

```
http://s3.amazonaws.com/[bucket_name]/
http://[bucket_name].s3.amazonaws.com/
```
* `resources.domain.com` рдХреЗ рд░реВрдк рдореЗрдВ **CNAMES** рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рдХреНрдпреЛрдВрдХрд┐ `bucket.s3.amazonaws.com` рд╣реЛ рд╕рдХрддрд╛ рд╣реИ
* [https://buckets.grayhatwarfare.com](https://buckets.grayhatwarfare.com/) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ, рдПрдХ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдЬрд┐рд╕рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА **рдЦреБрд▓реЗ рдмрдХреЗрдЯреНрд╕** рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╣реИред
* **рдмрдХреЗрдЯ рдХрд╛ рдирд╛рдо** рдФрд░ **рдмрдХреЗрдЯ рдбреЛрдореЗрди рдирд╛рдо** **рдПрдХ рд╕рдорд╛рди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред**
* **flaws.cloud** рдХрд╛ **IP** 52.92.181.107 рд╣реИ рдФрд░ рдпрджрд┐ рдЖрдк рд╡рд╣рд╛рдБ рдЬрд╛рддреЗ рд╣реИрдВ рддреЛ рдпрд╣ рдЖрдкрдХреЛ [https://aws.amazon.com/s3/](https://aws.amazon.com/s3/) рдкрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, `dig -x 52.92.181.107` рджреЗрддрд╛ рд╣реИ `s3-website-us-west-2.amazonaws.com`ред
* рдпрд╣ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдпрд╣ рдПрдХ рдмрдХреЗрдЯ рд╣реИ рдЖрдк рднреА **рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ** [https://flaws.cloud.s3.amazonaws.com/](https://flaws.cloud.s3.amazonaws.com/)ред

#### рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕

рдЖрдк рдЙрд╕ рдХрдВрдкрдиреА рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд **рдирд╛рдореЛрдВ рдХреЛ рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕рд┐рдВрдЧ** рдХрд░рдХреЗ рдмрдХреЗрдЯреНрд╕ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ:

* [https://github.com/sa7mon/S3Scanner](https://github.com/sa7mon/S3Scanner)
* [https://github.com/clario-tech/s3-inspector](https://github.com/clario-tech/s3-inspector)
* [https://github.com/jordanpotti/AWSBucketDump](https://github.com/jordanpotti/AWSBucketDump) (рд╕рдВрднрд╛рд╡рд┐рдд рдмрдХреЗрдЯ рдирд╛рдореЛрдВ рдХреА рд╕реВрдЪреА рд╢рд╛рдорд┐рд▓ рд╣реИ)
* [https://github.com/fellchase/flumberboozle/tree/master/flumberbuckets](https://github.com/fellchase/flumberboozle/tree/master/flumberbuckets)
* [https://github.com/smaranchand/bucky](https://github.com/smaranchand/bucky)
* [https://github.com/tomdev/teh\_s3\_bucketeers](https://github.com/tomdev/teh\_s3\_bucketeers)
* [https://github.com/RhinoSecurityLabs/Security-Research/tree/master/tools/aws-pentest-tools/s3](https://github.com/RhinoSecurityLabs/Security-Research/tree/master/tools/aws-pentest-tools/s3)
* [https://github.com/Eilonh/s3crets\_scanner](https://github.com/Eilonh/s3crets\_scanner)
* [https://github.com/belane/CloudHunter](https://github.com/belane/CloudHunter)

<pre class="language-bash"><code class="lang-bash"># рдкрд░рд┐рдгрд╛рдо рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╢рдмреНрдж рд╕реВрдЪреА рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ
curl -s https://raw.githubusercontent.com/cujanovic/goaltdns/master/words.txt > /tmp/words-s3.txt.temp
curl -s https://raw.githubusercontent.com/jordanpotti/AWSBucketDump/master/BucketNames.txt >>/tmp/words-s3.txt.temp
cat /tmp/words-s3.txt.temp | sort -u > /tmp/words-s3.txt

# рдбреЛрдореЗрди рдФрд░ рд╕рдмрдбреЛрдореЗрдиреНрд╕ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЯреЗрд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╢рдмреНрдж рд╕реВрдЪреА рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ
## рдЙрди рдбреЛрдореЗрди рдФрд░ рд╕рдмрдбреЛрдореЗрдиреНрд╕ рдХреЛ subdomains.txt рдореЗрдВ рд▓рд┐рдЦреЗрдВ
cat subdomains.txt > /tmp/words-hosts-s3.txt
cat subdomains.txt | tr "." "-" >> /tmp/words-hosts-s3.txt
cat subdomains.txt | tr "." "\n" | sort -u >> /tmp/words-hosts-s3.txt

# рд╣рдорд▓реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбреЛрдореЗрди рдФрд░ рд╕рдмрдбреЛрдореЗрдиреНрд╕ рдХреЗ рд╕рд╛рде рдПрдХ рд╕реВрдЪреА рдореЗрдВ рдЖрдзрд╛рд░рд┐рдд рдкрд░рд┐рдгрд╛рдо рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ
goaltdns -l /tmp/words-hosts-s3.txt -w /tmp/words-s3.txt -o /tmp/final-words-s3.txt.temp
## рдкрд┐рдЫрд▓рд╛ рдЯреВрд▓ рд╕рдмрдбреЛрдореЗрдиреНрд╕ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рдгрд╛рдо рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдореЗрдВ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рд╣реИ, рд╣рдо рдЙрд╕ рд╕реВрдЪреА рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░реЗрдВрдЧреЗ
<strong>### ". рд╕реЗ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рд╡рд╛рд▓реА рд▓рд╛рдЗрдиреЗрдВ рд╣рдЯрд╛рдПрдВ"
</strong>cat /tmp/final-words-s3.txt.temp | grep -Ev "\.$" > /tmp/final-words-s3.txt.temp2
### TLD рдХреЗ рдмрд┐рдирд╛ рд╕реВрдЪреА рдмрдирд╛рдПрдВ
cat /tmp/final-words-s3.txt.temp2 | sed -E 's/\.[a-zA-Z0-9]+$//' > /tmp/final-words-s3.txt.temp3
### рдбреЙрдЯ рдХреЗ рдмрд┐рдирд╛ рд╕реВрдЪреА рдмрдирд╛рдПрдВ
cat /tmp/final-words-s3.txt.temp3 | tr -d "." > /tmp/final-words-s3.txt.temp4http://phantom.s3.amazonaws.com/
### рд╣рд╛рдЗрдлрд╝рди рдХреЗ рдмрд┐рдирд╛ рд╕реВрдЪреА рдмрдирд╛рдПрдВ
cat /tmp/final-words-s3.txt.temp3 | tr "." "-" > /tmp/final-words-s3.txt.temp5

## рдЕрдВрддрд┐рдо рд╢рдмреНрдж рд╕реВрдЪреА рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ
cat /tmp/final-words-s3.txt.temp2 /tmp/final-words-s3.txt.temp3 /tmp/final-words-s3.txt.temp4 /tmp/final-words-s3.txt.temp5 | grep -v -- "-\." | awk '{print tolower($0)}' | sort -u > /tmp/final-words-s3.txt
## рдХреЙрд▓ s3scanner
s3scanner --threads 100 scan --buckets-file /tmp/final-words-s3.txt  | grep bucket_exists
</code></pre>

#### рд▓реВрдЯ S3 рдмрдХреЗрдЯреНрд╕

рджрд┐рдП рдЧрдП S3 рдУрдкрди рдмрдХреЗрдЯреНрд╕, [**BucketLoot**](https://github.com/redhuntlabs/BucketLoot) рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ **рд░реЛрдЪрдХ рдЬрд╛рдирдХрд╛рд░реА рдХреА рдЦреЛрдЬ** рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### рдХреНрд╖реЗрддреНрд░ рдЦреЛрдЬреЗрдВ

рдЖрдк AWS рджреНрд╡рд╛рд░рд╛ рд╕рдорд░реНрдерд┐рдд рд╕рднреА рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЛ [**https://docs.aws.amazon.com/general/latest/gr/s3.html**](https://docs.aws.amazon.com/general/latest/gr/s3.html) рдореЗрдВ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВред

#### DNS рджреНрд╡рд╛рд░рд╛

рдЖрдк **`dig`** рдФрд░ **`nslookup`** рдХреЗ рд╕рд╛рде рдПрдХ **DNS рдЕрдиреБрд░реЛрдз рдХрд░рдХреЗ** рдмрдХреЗрдЯ рдХрд╛ рдХреНрд╖реЗрддреНрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
dig flaws.cloud
;; ANSWER SECTION:
flaws.cloud.    5    IN    A    52.218.192.11

nslookup 52.218.192.11
Non-authoritative answer:
11.192.218.52.in-addr.arpa name = s3-website-us-west-2.amazonaws.com.
```
Check that the resolved domain have the word "website".\
рдЖрдк рд╕реНрдЯреЗрдЯрд┐рдХ рд╡реЗрдмрд╕рд╛рдЗрдЯ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд╛рдХрд░: `flaws.cloud.s3-website-us-west-2.amazonaws.com`\
рдпрд╛ рдЖрдк рдмрдХреЗрдЯ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд╛рдХрд░: `flaws.cloud.s3-us-west-2.amazonaws.com`

#### By Trying

рдпрджрд┐ рдЖрдк рдПрдХ рдмрдХреЗрдЯ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди **рдбреЛрдореЗрди рдирд╛рдо рдореЗрдВ рдЖрдк рдПрдХ рдФрд░ рдХреНрд╖реЗрддреНрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреЗ рд╣реИрдВ** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдмрдХреЗрдЯ `bucket.s3.amazonaws.com` рдореЗрдВ рд╣реИ рд▓реЗрдХрд┐рди рдЖрдк `bucket.s3-website-us-west-2.amazonaws.com` рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ), рддреЛ рдЖрдкрдХреЛ **рд╕рд╣реА рд╕реНрдерд╛рди рдХрд╛ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**:

![](<../../../.gitbook/assets/image (106).png>)

### Enumerating the bucket

рдмрдХреЗрдЯ рдХреА рдЦреБрд▓рд╛рдкрди рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдкрдиреЗ рд╡реЗрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ URL рджрд░реНрдЬ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдПрдХ рдирд┐рдЬреА рдмрдХреЗрдЯ "рдкрд╣реБрдВрдЪ рдирд┐рд╖реЗрдзрд┐рдд" рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╕рд╛рдж рджреЗрдЧрд╛ред рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдмрдХреЗрдЯ рдкрд╣рд▓реЗ 1,000 рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреА рд╕реВрдЪреА рджреЗрдЧрд╛ рдЬреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВред

рд╕рднреА рдХреЗ рд▓рд┐рдП рдЦреБрд▓рд╛ рд╣реИ:

![](<../../../.gitbook/assets/image (201).png>)

рдирд┐рдЬреА:

![](<../../../.gitbook/assets/image (83).png>)

рдЖрдк рдЗрд╕реЗ cli рдХреЗ рд╕рд╛рде рднреА рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
#Use --no-sign-request for check Everyones permissions
#Use --profile <PROFILE_NAME> to indicate the AWS profile(keys) that youwant to use: Check for "Any Authenticated AWS User" permissions
#--recursive if you want list recursivelyls
#Opcionally you can select the region if you now it
aws s3 ls s3://flaws.cloud/ [--no-sign-request] [--profile <PROFILE_NAME>] [ --recursive] [--region us-west-2]
```
рдпрджрд┐ рдмрдХреЗрдЯ рдХреЗ рдкрд╛рд╕ рдбреЛрдореЗрди рдирд╛рдо рдирд╣реАрдВ рд╣реИ, рддреЛ рдЙрд╕реЗ рдЗрдирдорд░реЗрдЯ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╕рдордп, **рдХреЗрд╡рд▓ рдмрдХреЗрдЯ рдХрд╛ рдирд╛рдо** рдбрд╛рд▓реЗрдВ рдФрд░ рдкреВрд░рд╛ AWSs3 рдбреЛрдореЗрди рдирд╣реАрдВред рдЙрджрд╛рд╣рд░рдг: `s3://<BUCKETNAME>`

### рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ URL рдЯреЗрдореНрдкрд▓реЗрдЯ
```
https://{user_provided}.s3.amazonaws.com
```
### рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдмрдХреЗрдЯ рд╕реЗ рдЦрд╛рддрд╛ рдЖрдИрдбреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

рдПрдХ AWS рдЦрд╛рддрд╛ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдирдП **`S3:ResourceAccount`** **рдиреАрддрд┐ рд╕реНрдерд┐рддрд┐ рдХреБрдВрдЬреА** рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдХрд░ред рдпрд╣ рд╕реНрдерд┐рддрд┐ **S3 рдмрдХреЗрдЯ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкрд╣реБрдВрдЪ рдХреА рд╕реАрдорд╛ рд▓рдЧрд╛рддреА рд╣реИ** (рдЕрдиреНрдп рдЦрд╛рддрд╛-рдЖрдзрд╛рд░рд┐рдд рдиреАрддрд┐рдпрд╛рдБ рдЕрдиреБрд░реЛрдзрдХрд░реНрддрд╛ рдХреЗ рдЦрд╛рддреЗ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкреНрд░рддрд┐рдмрдВрдз рд▓рдЧрд╛рддреА рд╣реИрдВ)ред\
рдФрд░ рдХреНрдпреЛрдВрдХрд┐ рдиреАрддрд┐ рдореЗрдВ **рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб** рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд╕реЗ рд╕рдВрднрд╡ рд╣реИ рдЦрд╛рддрд╛ рд╕рдВрдЦреНрдпрд╛ **рдХреЗрд╡рд▓ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рдПрдХ рд╕рдордп** рдореЗрдВ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ред

рдпрд╣ рдЙрдкрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕реНрд╡рдд: рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░рддрд╛ рд╣реИ:
```bash
# Installation
pipx install s3-account-search
pip install s3-account-search
# With a bucket
s3-account-search arn:aws:iam::123456789012:role/s3_read s3://my-bucket
# With an object
s3-account-search arn:aws:iam::123456789012:role/s3_read s3://my-bucket/path/to/object.ext
```
рдпрд╣ рддрдХрдиреАрдХ API рдЧреЗрдЯрд╡реЗ URL, рд▓реИрдореНрдмрдбрд╛ URL, рдбреЗрдЯрд╛ рдПрдХреНрд╕рдЪреЗрдВрдЬ рдбреЗрдЯрд╛ рд╕реЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреА рд╣реИ рдФрд░ рдпрд╣рд╛рдБ рддрдХ рдХрд┐ рдЯреИрдЧ рдХреЗ рдорд╛рди рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП (рдЕрдЧрд░ рдЖрдк рдЯреИрдЧ рдХреБрдВрдЬреА рдЬрд╛рдирддреЗ рд╣реИрдВ)ред рдЖрдк [**рдореМрд▓рд┐рдХ рд╢реЛрдз**](https://blog.plerion.com/conditional-love-for-aws-metadata-enumeration/) рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдкрдХрд░рдг [**conditional-love**](https://github.com/plerionhq/conditional-love/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕ рд╢реЛрд╖рдг рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рдПрдХ рдмрдХреЗрдЯ рдХреЗ AWS рдЦрд╛рддреЗ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрдиреЗ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдирд╛

рдЬреИрд╕рд╛ рдХрд┐ [**рдЗрд╕ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ**](https://blog.plerion.com/things-you-wish-you-didnt-need-to-know-about-s3/) рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, **рдЕрдЧрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдмрдХреЗрдЯ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ** рддреЛ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдХрд░ рдЖрдк рдПрдХ рдЦрд╛рддрд╛ рдЖрдИрдбреА рдкреБрд╖реНрдЯрд┐ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕ рдмрдХреЗрдЯ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ:
```bash
curl -X GET "[bucketname].amazonaws.com/" \
-H "x-amz-expected-bucket-owner: [correct-account-id]"

<?xml version="1.0" encoding="UTF-8"?>
<ListBucketResult xmlns="http://s3.amazonaws.com/doc/2006-03-01/">...</ListBucketResult>
```
рдпрджрд┐ рддреНрд░реБрдЯрд┐ "рдкрд╣реБрдВрдЪ рдирд┐рд╖реЗрдзрд┐рдд" рд╣реИ рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рдЦрд╛рддрд╛ рдЖрдИрдбреА рдЧрд▓рдд рдерд╛ред

### рдореВрд▓ рдЦрд╛рддрд╛ рдЬрд╛рдБрдЪ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдИрдореЗрд▓

рдЬреИрд╕рд╛ рдХрд┐ [**рдЗрд╕ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ**](https://blog.plerion.com/things-you-wish-you-didnt-need-to-know-about-s3/) рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдХрд┐рд╕реА рдИрдореЗрд▓ рдкрддреЗ рдХрд╛ AWS рдЦрд╛рддрд╛ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрдиреЗ рдХреА рдЬрд╛рдБрдЪ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ **ACLs рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ S3 рдмрдХреЗрдЯ рдкрд░ рдИрдореЗрд▓ рдХреЛ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рджреЗрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдХреЗ**ред рдпрджрд┐ рдпрд╣ рдХреЛрдИ рддреНрд░реБрдЯрд┐ рдирд╣реАрдВ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдИрдореЗрд▓ рдХрд┐рд╕реА AWS рдЦрд╛рддреЗ рдХрд╛ рдореВрд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╣реИ:
```python
s3_client.put_bucket_acl(
Bucket=bucket_name,
AccessControlPolicy={
'Grants': [
{
'Grantee': {
'EmailAddress': 'some@emailtotest.com',
'Type': 'AmazonCustomerByEmail',
},
'Permission': 'READ'
},
],
'Owner': {
'DisplayName': 'Whatever',
'ID': 'c3d78ab5093a9ab8a5184de715d409c2ab5a0e2da66f08c2f6cc5c0bdeadbeef'
}
}
)
```
## рд╕рдВрджрд░реНрдн

* [https://www.youtube.com/watch?v=8ZXRw4Ry3mQ](https://www.youtube.com/watch?v=8ZXRw4Ry3mQ)
* [https://cloudar.be/awsblog/finding-the-account-id-of-any-public-s3-bucket/](https://cloudar.be/awsblog/finding-the-account-id-of-any-public-s3-bucket/)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ** рджрд┐рдЦрд╛рдпрд╛ рдЬрд╛рдП рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░реЗрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
