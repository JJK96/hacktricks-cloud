# AWS - Cognito Kimlik Doğrulamasız Enum

{% hint style="success" %}
AWS Hacking'i öğrenin ve uygulayın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katılın veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak PR'ler göndererek HackTricks ve HackTricks Cloud github depolarına katkıda bulunun.**

</details>
{% endhint %}

## Kimlik Doğrulamasız Cognito

Cognito, geliştiricilere **uygulama kullanıcılarına AWS hizmetlerine erişim verme** olanağı sağlayan bir AWS hizmetidir. Geliştiriciler, uygulamalarında **kimlik doğrulaması yapılmış kullanıcılara IAM rolleri vereceklerdir** (muhtemelen insanlar sadece kaydolabilecekler) ve ayrıca **kimlik doğrulamasız kullanıcılara bir IAM rolü verebilirler**.

Cognito hakkında temel bilgiler için şuraya bakın:

{% content-ref url="../aws-services/aws-cognito-enum/" %}
[aws-cognito-enum](../aws-services/aws-cognito-enum/)
{% endcontent-ref %}

### Pentesting ve enumarasyon için Pacu modülleri

[Pacu](https://github.com/RhinoSecurityLabs/pacu), AWS istismar çerçevesi, artık hesaptaki tüm Cognito varlıklarının enumarasyonunu otomatikleştiren "cognito__enum" ve "cognito__attack" modüllerini içerir ve zayıf yapılandırmaları, erişim kontrolü için kullanılan kullanıcı özniteliklerini vb. işaretler, ayrıca kullanıcı oluşturmayı (MFA desteği de dahil) ve değiştirilebilir özel özniteliklere dayalı ayrıcalık yükseltmeyi otomatikleştirir, kullanılabilir kimlik havuzu kimlik bilgileri, id belgelerindeki rol alınabilir roller vb.

Modüllerin işlevlerinin açıklaması için [blog yazısının](https://rhinosecuritylabs.com/aws/attacking-aws-cognito-with-pacu-p2) 2. bölümüne bakın. Kurulum talimatları için ana [Pacu](https://github.com/RhinoSecurityLabs/pacu) sayfasına bakın.

### Kullanım

Belirli bir kimlik havuzu ve kullanıcı havuzu istemcisine karşı kullanıcı oluşturma ve tüm ayrıcalık yükseltme vektörlerini denemek için örnek cognito__attack kullanımı:
```bash
Pacu (new:test) > run cognito__attack --username randomuser --email XX+sdfs2@gmail.com --identity_pools
us-east-2:a06XXXXX-c9XX-4aXX-9a33-9ceXXXXXXXXX --user_pool_clients
59f6tuhfXXXXXXXXXXXXXXXXXX@us-east-2_0aXXXXXXX
```
Örnek cognito__enum kullanımı, mevcut AWS hesabında görülebilen tüm kullanıcı havuzları, kullanıcı havuzu istemcileri, kimlik havuzları, kullanıcılar vb. bilgileri toplamak için:
```bash
Pacu (new:test) > run cognito__enum
```
### Kimlik Havuzu Kimliği

Kimlik Havuzları, yalnızca **Kimlik Havuzu Kimliğini bilen kimlik doğrulanmamış kullanıcılara IAM rolleri verebilir** (oldukça yaygın olarak **bulunabilir**), ve bu bilgiye sahip bir saldırgan bu IAM rolüne **erişmeye çalışabilir** ve bunu istismar edebilir.\
Ayrıca, IAM rolleri, Kimlik Havuzuna erişen **kimlik doğrulanmış kullanıcılara atanabilir**. Bir saldırgan bir kullanıcı **kaydettirebilirse** veya zaten Kimlik Havuzunda kullanılan **kimlik sağlayıcıya erişimi varsa**, kimlik doğrulanmış kullanıcılara verilen **IAM rolüne erişebilir** ve ayrıcalıklarını istismar edebilir.

[**Bunu nasıl yapacağınızı buradan kontrol edin**](../aws-services/aws-cognito-enum/cognito-identity-pools.md).

### Kullanıcı Havuzu Kimliği

Varsayılan olarak Cognito, **yeni kullanıcı kaydı yapmanıza izin verir**. Bir kullanıcı kaydı yapabilme yeteneği, size **altta yatan uygulamaya erişim** veya Cognito Kullanıcı Havuzu'nu kimlik sağlayıcı olarak kabul eden bir Kimlik Havuzunun **kimlik doğrulanmış IAM erişim rolüne erişim** sağlayabilir. [**Bunu nasıl yapacağınızı buradan kontrol edin**](../aws-services/aws-cognito-enum/cognito-user-pools.md#registration).
