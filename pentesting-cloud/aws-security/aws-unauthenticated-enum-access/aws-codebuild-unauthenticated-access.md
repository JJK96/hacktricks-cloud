# AWS - CodeBuild Unauthenticated Access

{% hint style="success" %}
Μάθετε και εξασκηθείτε στο AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε και εξασκηθείτε στο GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Γίνετε μέλος της** 💬 [**ομάδας Discord**](https://discord.gg/hRep4RUj7f) ή της [**ομάδας telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε hacking tricks υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια στο github.

</details>
{% endhint %}

## CodeBuild

Για περισσότερες πληροφορίες ελέγξτε αυτή τη σελίδα:

{% content-ref url="../aws-services/aws-codebuild-enum.md" %}
[aws-codebuild-enum.md](../aws-services/aws-codebuild-enum.md)
{% endcontent-ref %}

### buildspec.yml

Αν αποκτήσετε πρόσβαση εγγραφής σε ένα αποθετήριο που περιέχει ένα αρχείο με το όνομα **`buildspec.yml`**, μπορείτε να **backdoor** αυτό το αρχείο, το οποίο καθορίζει τις **εντολές που θα εκτελεστούν** μέσα σε ένα έργο CodeBuild και να εξάγετε τα μυστικά, να παραβιάσετε αυτό που γίνεται και επίσης να παραβιάσετε τα **διαπιστευτήρια του ρόλου IAM του CodeBuild**.

Σημειώστε ότι ακόμα και αν δεν υπάρχει κανένα αρχείο **`buildspec.yml`** αλλά γνωρίζετε ότι χρησιμοποιείται το Codebuild (ή κάποιο άλλο CI/CD) **τροποποιώντας κάποιο νόμιμο κώδικα** που πρόκειται να εκτελεστεί μπορεί επίσης να σας δώσει ένα reverse shell για παράδειγμα.

Για κάποιες σχετικές πληροφορίες μπορείτε να ελέγξετε τη σελίδα για το πώς να επιτεθείτε στα Github Actions (παρόμοιο με αυτό):

{% content-ref url="../../../pentesting-ci-cd/github-security/abusing-github-actions/" %}
[abusing-github-actions](../../../pentesting-ci-cd/github-security/abusing-github-actions/)
{% endcontent-ref %}

## Self-hosted GitHub Actions runners in AWS CodeBuild <a href="#action-runner" id="action-runner"></a>

Όπως [**αναφέρεται στα έγγραφα**](https://docs.aws.amazon.com/codebuild/latest/userguide/action-runner.html), είναι δυνατό να διαμορφώσετε το **CodeBuild** για να εκτελεί **self-hosted Github actions** όταν ενεργοποιείται μια ροή εργασίας μέσα σε ένα διαμορφωμένο αποθετήριο Github. Αυτό μπορεί να ανιχνευθεί ελέγχοντας τη διαμόρφωση του έργου CodeBuild επειδή ο **`Τύπος συμβάντος`** πρέπει να περιέχει: **`WORKFLOW_JOB_QUEUED`** και σε μια ροή εργασίας Github επειδή θα επιλέξει έναν **self-hosted** runner όπως αυτό:
```bash
runs-on: codebuild-<project-name>-${{ github.run_id }}-${{ github.run_attempt }}
```
Αυτή η νέα σχέση μεταξύ Github Actions και AWS δημιουργεί έναν άλλο τρόπο να παραβιαστεί το AWS από το Github καθώς ο κώδικας στο Github θα εκτελείται σε ένα έργο CodeBuild με συνημμένο ρόλο IAM.

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε hacking tricks υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια github.

</details>
{% endhint %}
