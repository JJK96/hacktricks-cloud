# AWS - CodeBuild Post Exploitation

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХреЛ рд╕рдорд░реНрдерди рджреЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рд╣рдореЗрдВ рдлреЙрд▓реЛ рдХрд░реЗрдВ** **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
{% endhint %}

## CodeBuild

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рджреЗрдЦреЗрдВ:

{% content-ref url="../../aws-services/aws-codebuild-enum.md" %}
[aws-codebuild-enum.md](../../aws-services/aws-codebuild-enum.md)
{% endcontent-ref %}

### CodeBuild Repo Access рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

**CodeBuild** рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕реЗ **рдХреЛрдб repo рддрдХ рдкрд╣реБрдВрдЪ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рдЬрд┐рд╕рдХрд╛ рдпрд╣ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реИред рдХрдИ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдЗрд╕ рдХреЛрдб рдХреА рдореЗрдЬрдмрд╛рдиреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

<figure><img src="../../../../.gitbook/assets/image (96).png" alt=""><figcaption></figcaption></figure>

**CodeBuild рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рд╕реНрд░реЛрдд рдкреНрд░рджрд╛рддрд╛ рддрдХ рдкрд╣реБрдВрдЪ** рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП, рдпрд╛ рддреЛ **IAM role** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдпрд╛ github/bitbucket **token рдпрд╛ OAuth access** рдХреЗ рд╕рд╛рдеред

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ **CodeBuild рдкрд░ рдЙрдиреНрдирдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рд╣реИрдВ, рд╡рд╣ рдЗрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХреА рдЧрдИ рдкрд╣реБрдВрдЪ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП repo рдФрд░ рдЕрдиреНрдп рдЬрд╣рд╛рдВ рд╕реЗрдЯ рдХреНрд░реЗрдбреНрд╕ рдХреА рдкрд╣реБрдВрдЪ рд╣реИ, рдХрд╛ рдХреЛрдб рд▓реАрдХ рдХрд░ рд╕рдХрддрд╛ рд╣реИред\
рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдмрд╕ **repo URL рдХреЛ рдмрджрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА** рдЬрд┐рд╕ рдкрд░ config credentials рдХреА рдкрд╣реБрдВрдЪ рд╣реИ (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ aws рд╡реЗрдм рдЖрдкрдХреЗ рд▓рд┐рдП рдЙрди рд╕рднреА рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░реЗрдЧрд╛):

<figure><img src="../../../../.gitbook/assets/image (107).png" alt=""><figcaption></figcaption></figure>

рдФрд░ **рдкреНрд░рддреНрдпреЗрдХ repo рдХреЛ exfiltrate рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Buildspec commands рдмрджрд▓реЗрдВ**ред

{% hint style="warning" %}
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ **рдХрд╛рд░реНрдп рджреЛрд╣рд░рд╛рд╡ рдФрд░ рдердХрд╛рдК** рд╣реИ рдФрд░ рдпрджрд┐ github token рдХреЛ **рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ** рдХреЗ рд╕рд╛рде рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ **рдЙрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ (рджреБрд░реБрдкрдпреЛрдЧ) рдирд╣реАрдВ рдХрд░ рдкрд╛рдПрдЧрд╛** рдХреНрдпреЛрдВрдХрд┐ рдЙрд╕рдХреЗ рдкрд╛рд╕ token рддрдХ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╣реИред\
рдпрд╛ рдХреНрдпрд╛ рд╣реИ? рдЕрдЧрд▓рд╛ рдЕрдиреБрднрд╛рдЧ рджреЗрдЦреЗрдВ
{% endhint %}

### AWS CodeBuild рд╕реЗ Access Tokens рд▓реАрдХ рдХрд░рдирд╛

рдЖрдк CodeBuild рдореЗрдВ рджрд┐рдП рдЧрдП access рдХреЛ Github рдЬреИрд╕реА рдкреНрд▓реЗрдЯрдлрд╛рд░реНрдореЛрдВ рдкрд░ рд▓реАрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХрд┐рд╕реА рдмрд╛рд╣рд░реА рдкреНрд▓реЗрдЯрдлрд╛рд░реНрдо рдХреЛ рдХреЛрдИ access рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛:
```bash
aws codebuild list-source-credentials
```
{% content-ref url="aws-codebuild-token-leakage.md" %}
[aws-codebuild-token-leakage.md](aws-codebuild-token-leakage.md)
{% endcontent-ref %}

### `codebuild:DeleteProject`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдкреВрд░реЗ CodeBuild рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЛ рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдиреБрдХрд╕рд╛рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдкрд░ рдирд┐рд░реНрднрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред
```bash
aws codebuild delete-project --name <value>
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡**: рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдиреБрдХрд╕рд╛рди рдФрд░ рд╣рдЯрд╛рдП рдЧрдП рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛ рдореЗрдВ рд╡реНрдпрд╡рдзрд╛рдиред

### `codebuild:TagResource` , `codebuild:UntagResource`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ CodeBuild рд╕рдВрд╕рд╛рдзрдиреЛрдВ рд╕реЗ рдЯреИрдЧ рдЬреЛрдбрд╝, рд╕рдВрд╢реЛрдзрд┐рдд рдпрд╛ рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЖрдкрдХреЗ рд╕рдВрдЧрдарди рдХреА рд▓рд╛рдЧрдд рдЖрд╡рдВрдЯрди, рд╕рдВрд╕рд╛рдзрди рдЯреНрд░реИрдХрд┐рдВрдЧ рдФрд░ рдЯреИрдЧ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдПрдХреНрд╕реЗрд╕ рдирд┐рдпрдВрддреНрд░рдг рдиреАрддрд┐рдпреЛрдВ рдореЗрдВ рд╡реНрдпрд╡рдзрд╛рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
```bash
aws codebuild tag-resource --resource-arn <value> --tags <value>
aws codebuild untag-resource --resource-arn <value> --tag-keys <value>
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡**: рд▓рд╛рдЧрдд рдЖрд╡рдВрдЯрди, рд╕рдВрд╕рд╛рдзрди рдЯреНрд░реИрдХрд┐рдВрдЧ, рдФрд░ рдЯреИрдЧ-рдЖрдзрд╛рд░рд┐рдд рдПрдХреНрд╕реЗрд╕ рдирд┐рдпрдВрддреНрд░рдг рдиреАрддрд┐рдпреЛрдВ рдХрд╛ рд╡рд┐рдШрдЯрдиред

### `codebuild:DeleteSourceCredentials`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ Git repository рдХреЗ рд▓рд┐рдП рд╕реНрд░реЛрдд рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ repository рдкрд░ рдирд┐рд░реНрднрд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд╕рд╛рдорд╛рдиреНрдп рдХрд╛рд░реНрдп рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред
```sql
aws codebuild delete-source-credentials --arn <value>
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡**: рд╕реНрд░реЛрдд рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рдХрд╛рд░рдг рдкреНрд░рднрд╛рд╡рд┐рдд рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдкрд░ рдирд┐рд░реНрднрд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд╕рд╛рдорд╛рдиреНрдп рдХрд╛рд░реНрдп рдореЗрдВ рд╡реНрдпрд╡рдзрд╛рдиред

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рд╣рдореЗрдВ** **Twitter** ЁЯРж рдкрд░ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВред

</details>
{% endhint %}
