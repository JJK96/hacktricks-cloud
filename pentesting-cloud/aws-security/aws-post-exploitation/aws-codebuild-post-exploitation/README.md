# AWS - CodeBuild Post Exploitation

{% hint style="success" %}
Jifunze na fanya mazoezi ya AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze na fanya mazoezi ya GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mipango ya usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwenye** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## CodeBuild

Kwa maelezo zaidi, angalia:

{% content-ref url="../../aws-services/aws-codebuild-enum.md" %}
[aws-codebuild-enum.md](../../aws-services/aws-codebuild-enum.md)
{% endcontent-ref %}

### Abuse CodeBuild Repo Access

Ili kusanidi **CodeBuild**, itahitaji **upatikanaji wa repo ya msimbo** ambayo itatumia. Majukwaa kadhaa yanaweza kuwa yanahifadhi msimbo huu:

<figure><img src="../../../../.gitbook/assets/image (96).png" alt=""><figcaption></figcaption></figure>

Mradi wa **CodeBuild lazima uwe na upatikanaji** kwa mtoa huduma wa chanzo uliosanidiwa, ama kupitia **IAM role** au kwa github/bitbucket **token au OAuth access**.

Mshambulizi mwenye **ruhusa za juu katika CodeBuild** anaweza kutumia vibaya upatikanaji huu uliosanidiwa kuvuja msimbo wa repo iliyosanidiwa na nyinginezo ambapo seti ya creds ina upatikanaji.\
Ili kufanya hivyo, mshambulizi atahitaji tu **kubadilisha URL ya repo kwa kila repo ambayo creds za usanidi zina upatikanaji** (kumbuka kuwa tovuti ya aws itakutajia zote):

<figure><img src="../../../../.gitbook/assets/image (107).png" alt=""><figcaption></figcaption></figure>

Na **kubadilisha amri za Buildspec ili kutoa kila repo**.

{% hint style="warning" %}
Hata hivyo, **kazi hii ni ya kurudia na kuchosha** na kama token ya github ilisajiliwa na **ruhusa za kuandika**, mshambulizi **hataweza kutumia (ab)ruhusa hizo** kwani hana upatikanaji wa token.\
Au anaweza? Angalia sehemu inayofuata
{% endhint %}

### Leaking Access Tokens from AWS CodeBuild

Unaweza kuvuja upatikanaji uliotolewa katika CodeBuild kwa majukwaa kama Github. Angalia kama upatikanaji wowote kwa majukwaa ya nje ulitolewa na:
```bash
aws codebuild list-source-credentials
```
{% content-ref url="aws-codebuild-token-leakage.md" %}
[aws-codebuild-token-leakage.md](aws-codebuild-token-leakage.md)
{% endcontent-ref %}

### `codebuild:DeleteProject`

Mshambuliaji anaweza kufuta mradi mzima wa CodeBuild, na kusababisha kupoteza usanidi wa mradi na kuathiri programu zinazotegemea mradi huo.
```bash
aws codebuild delete-project --name <value>
```
**Athari Zinawezekana**: Kupoteza usanidi wa mradi na usumbufu wa huduma kwa programu zinazotumia mradi uliofutwa.

### `codebuild:TagResource` , `codebuild:UntagResource`

Mshambuliaji anaweza kuongeza, kurekebisha, au kuondoa vitambulisho kutoka kwa rasilimali za CodeBuild, na kusababisha usumbufu katika mgao wa gharama wa shirika lako, ufuatiliaji wa rasilimali, na sera za udhibiti wa ufikiaji kulingana na vitambulisho.
```bash
aws codebuild tag-resource --resource-arn <value> --tags <value>
aws codebuild untag-resource --resource-arn <value> --tag-keys <value>
```
**Athari Zinazowezekana**: Kuvuruga mgao wa gharama, ufuatiliaji wa rasilimali, na sera za udhibiti wa ufikiaji kwa kutumia lebo.

### `codebuild:DeleteSourceCredentials`

Mshambuliaji anaweza kufuta sifa za chanzo kwa hifadhi ya Git, na kuathiri utendaji wa kawaida wa programu zinazotegemea hifadhi hiyo.
```sql
aws codebuild delete-source-credentials --arn <value>
```
**Athari Zinawezekana**: Kuvuruga utendaji wa kawaida wa programu zinazotegemea hazina iliyoathiriwa kutokana na kuondolewa kwa sifa za chanzo.

{% hint style="success" %}
Jifunze na fanya mazoezi ya AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze na fanya mazoezi ya GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mipango ya usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwenye** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
