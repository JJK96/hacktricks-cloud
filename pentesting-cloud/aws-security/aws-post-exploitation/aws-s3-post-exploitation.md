# AWS - S3 Na-Exploitation

{% hint style="success" %}
Leer & oefen AWS Hack:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hack: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Controleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}

## S3

Vir meer inligting kyk:

{% content-ref url="../aws-services/aws-s3-athena-and-glacier-enum.md" %}
[aws-s3-athena-and-glacier-enum.md](../aws-services/aws-s3-athena-and-glacier-enum.md)
{% endcontent-ref %}

### Sensitiewe Inligting

Soms sal jy sensitiewe inligting in leesbare vorm in die emmers kan vind. Byvoorbeeld, terraform staat geheime.

### Pivoting

Verskillende platforms kan S3 gebruik om sensitiewe bates te stoor.\
Byvoorbeeld, **airflow** kan **DAGs kode** daar stoor, of **webbladsye** kan direk vanaf S3 bedien word. 'n Aanvaller met skryftoestemmings kan die kode van die emmer **verander** om na ander platforms te **pivot**, of **rekeninge oorneem** deur JS-l√™ers te verander.

### S3 Ransomware

In hierdie scenario, skep die **aanvaller 'n KMS (Key Management Service) sleutel in hul eie AWS-rekening** of 'n ander gekompromitteerde rekening. Hulle maak dan hierdie **sleutel toeganklik vir enigiemand in die w√™reld**, wat enige AWS-gebruiker, rol, of rekening toelaat om voorwerpe met hierdie sleutel te versleutel. Die voorwerpe kan egter nie ontsluit word nie.

Die aanvaller identifiseer 'n teiken **S3-emmer en verkry skryfvlaktoegang** daartoe deur verskeie metodes te gebruik. Dit kan wees as gevolg van swak emmerkonfigurasie wat dit openlik blootstel of die aanvaller verkry toegang tot die AWS-omgewing self. Die aanvaller teiken tipies emmers wat sensitiewe inligting soos persoonlik identifiseerbare inligting (PII), beskermde gesondheidsinligting (PHI), logboeke, rugsteune, en meer bevat.

Om te bepaal of die emmer vir ransomeer aangeval kan word, kontroleer die aanvaller sy konfigurasie. Dit sluit in om te verifieer of **S3-voorwerpversie**ring geaktiveer is en of **multi-faktor outentifikasie verwyder (MFA verwyder) geaktiveer is**. As Voorwerpversie nie geaktiveer is nie, kan die aanvaller voortgaan. As Voorwerpversie geaktiveer is maar MFA verwyder is gedeaktiveer, kan die aanvaller **Voorwerpversie deaktiveer**. As beide Voorwerpversie en MFA verwyder geaktiveer is, word dit moeiliker vir die aanvaller om daardie spesifieke emmer te ransomeer.

Deur die AWS API te gebruik, **vervang die aanvaller elke voorwerp in die emmer met 'n versleutelde kopie met behulp van hul KMS-sleutel**. Dit versleutel die data in die emmer effektief, wat dit ontoeganklik maak sonder die sleutel.

Om verdere druk by te sit, skeduleer die aanvaller die verwydering van die KMS-sleutel wat in die aanval gebruik is. Dit gee die teiken 'n 7-dae-venster om hul data te herstel voordat die sleutel verwyder word en die data permanent verlore gaan.

Laastens kan die aanvaller 'n finale l√™er oplaai, gewoonlik genaamd "ransom-note.txt," wat instruksies vir die teiken bevat oor hoe om hul l√™ers terug te kry. Hierdie l√™er word sonder versleuteling oplaai, waarskynlik om die teiken se aandag te trek en hulle bewus te maak van die ransomeer-aanval.

**Vir meer inligting** [**kyk na die oorspronklike navorsing**](https://rhinosecuritylabs.com/aws/s3-ransomware-part-1-attack-vector/)**.**

{% hint style="success" %}
Leer & oefen AWS Hack:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hack: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kontroleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}
