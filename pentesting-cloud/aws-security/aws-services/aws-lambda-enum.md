# AWS - Lambda Enum

{% hint style="success" %}
AWS Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХреЛ рд╕рдорд░реНрдерди рджреЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рд╣рдореЗрдВ** **Twitter** ЁЯРж рдкрд░ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Lambda

Amazon Web Services (AWS) Lambda рдХреЛ рдПрдХ **рдХрдВрдкреНрдпреВрдЯ рд╕реЗрд╡рд╛** рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬреЛ рд╕рд░реНрд╡рд░ рдкреНрд░рд╛рд╡рдзрд╛рди рдпрд╛ рдкреНрд░рдмрдВрдзрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рдмрд┐рдирд╛ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рд╕рдХреНрд╖рдо рдмрдирд╛рддрд╛ рд╣реИред рдпрд╣ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕рдВрд╕рд╛рдзрди рдЖрд╡рдВрдЯрди** рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХреЗ рд▓рд┐рдП рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рдЙрдЪреНрдЪ рдЙрдкрд▓рдмреНрдзрддрд╛, рд╕реНрдХреЗрд▓реЗрдмрд┐рд▓рд┐рдЯреА рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдЬреИрд╕реА рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИред Lambda рдХрд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкрд╣рд▓реВ рдЗрд╕рдХреА рдореВрд▓реНрдп рдирд┐рд░реНрдзрд╛рд░рдг рдореЙрдбрд▓ рд╣реИ, рдЬрд╣рд╛рдВ **рд╢реБрд▓реНрдХ рдХреЗрд╡рд▓ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдХрдВрдкреНрдпреВрдЯ рд╕рдордп рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ**, рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдирд┐рд╡реЗрд╢ рдпрд╛ рджреАрд░реНрдШрдХрд╛рд▓рд┐рдХ рдкреНрд░рддрд┐рдмрджреНрдзрддрд╛рдУрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВред

Lambda рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ **рдЬрд┐рддрдиреА рдмрд╛рд░ рдЪрд╛рд╣реЗрдВ** (Cloudwatch рдХреЗ рд╕рд╛рде) рдХреЙрд▓ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, **URL** рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЛ **рдПрдХреНрд╕рдкреЛрдЬрд╝** рдХрд░рдирд╛ рдФрд░ рдЗрд╕реЗ рдХреЙрд▓ рдХрд░рдирд╛, **API Gateway** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреЙрд▓ рдХрд░рдирд╛ рдпрд╛ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ **рдШрдЯрдирд╛рдУрдВ** рдЬреИрд╕реЗ **рдбреЗрдЯрд╛ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди** рдХреЗ рдЖрдзрд╛рд░ рдкрд░ **S3** рдмрдХреЗрдЯ рдпрд╛ **DynamoDB** рдЯреЗрдмрд▓ рдореЗрдВ рдЕрдкрдбреЗрдЯ рдХрд░рдирд╛ред

Lambda рдХрд╛ **рдХреЛрдб** **`/var/task`** рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддрд╛ рд╣реИред

### Lambda Aliases Weights

рдПрдХ Lambda рдХреЗ **рдХрдИ рд╕рдВрд╕реНрдХрд░рдг** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред\
рдФрд░ рдЗрд╕реЗ **рдЙрдкрдирд╛рдореЛрдВ** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **1 рд╕реЗ рдЕрдзрд┐рдХ** рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ рдПрдХреНрд╕рдкреЛрдЬрд╝ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред **рдкреНрд░рддреНрдпреЗрдХ** рд╕рдВрд╕реНрдХрд░рдг рдХреЗ **рд╡рдЬрди** рдЬреЛ рдЙрдкрдирд╛рдо рдХреЗ рдЕрдВрджрд░ рдПрдХреНрд╕рдкреЛрдЬрд╝ рдХрд┐рдП рдЧрдП рд╣реИрдВ, рдпрд╣ рддрдп рдХрд░реЗрдВрдЧреЗ рдХрд┐ **рдХреМрди рд╕рд╛ рдЙрдкрдирд╛рдо рдХреЙрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдпрд╣ 90%-10% рд╣реЛ рд╕рдХрддрд╛ рд╣реИ)ред\
рдпрджрд┐ **рдХрд┐рд╕реА** рдЙрдкрдирд╛рдо рдХрд╛ рдХреЛрдб **рдЕрд╕реБрд░рдХреНрд╖рд┐рдд** рд╣реИ рддреЛ рдЖрдк **рдЕрдиреБрд░реЛрдз рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рддрдХ рдХрд┐ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд** рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдкреНрд░рд╛рдкреНрдд рди рд╣реЛ рдЬрд╛рдПред

![](<../../../.gitbook/assets/image (223).png>)

### Resource Policies

Lambda рд╕рдВрд╕рд╛рдзрди рдиреАрддрд┐рдпрд╛рдВ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **рдЕрдиреНрдп рд╕реЗрд╡рд╛рдУрдВ/рдЦрд╛рддреЛрдВ рдХреЛ Lambda рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВ**ред\
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдпрд╣ рдиреАрддрд┐ **рдХрд┐рд╕реА рдХреЛ рднреА URL рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХреНрд╕рдкреЛрдЬрд╝ рдХрд┐рдП рдЧрдП Lambda рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ**:

<figure><img src="https://lh4.googleusercontent.com/4PNFKBdzr3nMrPqeKkTslgwWDKxkXMdQ1SNdv7NPHykj3GX8wODrQyXOFbjk4fxHfZ8pDm5ijWgk2Vq2EGXiPRT3TQfZf1fHycvdEKBuDxJDYos1CJeMHXSeg86ZB-Ol7CNtten6xkVFQj6AhDUEWNQJrQ=s2048" alt=""><figcaption></figcaption></figure>

рдпрд╛ рдпрд╣ API Gateway рдХреЛ рдЗрд╕реЗ рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП:

<figure><img src="https://lh3.googleusercontent.com/Su0JlR0wBqb-99Z4N_2-_kMlX0Xzx2n_GpZuOPW5IeXR3FYbm8OHFDM3Ora1BpXiSjHpDVUlq4yEyXwaI3nBuze6DJ-wRf2ATsCuWbq0wuBCd34E9uIpqwheE6Cc_PopviI_93O_j2ZKXc1-AJtsBoLVUw=s2048" alt=""><figcaption></figcaption></figure>

### Lambda Database Proxies

рдЬрдм **рд╕реИрдХрдбрд╝реЛрдВ** **рд╕рдорд╡рд░реНрддреА Lambda рдЕрдиреБрд░реЛрдз** рд╣реЛрддреЗ рд╣реИрдВ, рдпрджрд┐ рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЛ **рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдФрд░ рдХрдиреЗрдХреНрд╢рди рдмрдВрдж рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ**, рддреЛ рдпрд╣ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ (lambdas рд╕реНрдЯреЗрдЯрд▓реЗрд╕ рд╣реИрдВ, рдХрдиреЗрдХреНрд╢рди рдХреЛ рдЦреБрд▓рд╛ рдирд╣реАрдВ рд░рдЦ рд╕рдХрддреЗ)ред\
рдлрд┐рд░, рдпрджрд┐ рдЖрдкрдХреЗ **Lambda рдлрд╝рдВрдХреНрд╢рдВрд╕ RDS Proxy рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░рддреЗ рд╣реИрдВ** рдмрдЬрд╛рдп рдЖрдкрдХреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЗред рдпрд╣ рд╕рдорд╡рд░реНрддреА Lambda рдлрд╝рдВрдХреНрд╢рдВрд╕ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдП рдЧрдП рдХрдИ рд╕рдорд╡рд░реНрддреА рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдХрдиреЗрдХреНрд╢рди рдкреВрд▓рд┐рдВрдЧ рдХреЛ рд╕рдВрднрд╛рд▓рддрд╛ рд╣реИред рдпрд╣ рдЖрдкрдХреЗ Lambda рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ **рдореМрдЬреВрджрд╛ рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХрд╛ рдкреБрди: рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдмрдЬрд╛рдп рдЗрд╕рдХреЗ рдХрд┐ рд╣рд░ рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рдХреЗ рд▓рд┐рдП рдирдП рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рдПред

### Lambda EFS Filesystems

рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрд░рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдФрд░ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **Lambdas EFS рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдорд╛рдЙрдВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рддрд╛рдХрд┐ Lambda рдЗрд╕реЗ рдкрдврд╝ рдФрд░ рд▓рд┐рдЦ рд╕рдХреЗред

### Lambda Layers

рдПрдХ Lambda _рд▓реЗрдпрд░_ рдПрдХ .zip рдлрд╝рд╛рдЗрд▓ рд╕рдВрдЧреНрд░рд╣ рд╣реИ рдЬрд┐рд╕рдореЗрдВ **рдЕрддрд┐рд░рд┐рдХреНрдд рдХреЛрдб** рдпрд╛ рдЕрдиреНрдп рд╕рд╛рдордЧреНрд░реА рд╣реЛ рд╕рдХрддреА рд╣реИред рдПрдХ рд▓реЗрдпрд░ рдореЗрдВ рдкреБрд╕реНрддрдХрд╛рд▓рдп, рдПрдХ [рдХрд╕реНрдЯрдо рд░рдирдЯрд╛рдЗрдо](https://docs.aws.amazon.com/lambda/latest/dg/runtimes-custom.html), рдбреЗрдЯрд╛, рдпрд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред

рдкреНрд░рддрд┐ рдлрд╝рдВрдХреНрд╢рди **рдкрд╛рдВрдЪ рд▓реЗрдпрд░ рддрдХ** рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред рдЬрдм рдЖрдк рдХрд┐рд╕реА рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдПрдХ рд▓реЗрдпрд░ рд╢рд╛рдорд┐рд▓ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ **рд╕рд╛рдордЧреНрд░реА рдХреЛ рдирд┐рд╖реНрдкрд╛рджрди рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ `/opt`** рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдирд┐рдХрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ**, рдЖрдк рдЬреЛ **рд▓реЗрдпрд░ рдмрдирд╛рддреЗ рд╣реИрдВ рд╡реЗ рдЖрдкрдХреЗ AWS рдЦрд╛рддреЗ рдХреЗ рд▓рд┐рдП **рдирд┐рдЬреА** рд╣реЛрддреА рд╣реИрдВред рдЖрдк рдЕрдиреНрдп рдЦрд╛рддреЛрдВ рдХреЗ рд╕рд╛рде рд▓реЗрдпрд░ рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рдпрд╛ рд▓реЗрдпрд░ рдХреЛ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ** рдмрдирд╛рдиреЗ рдХрд╛ рд╡рд┐рдХрд▓реНрдк рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдЖрдкрдХреЗ рдлрд╝рдВрдХреНрд╢рдВрд╕ рдХрд┐рд╕реА рд▓реЗрдпрд░ рдХрд╛ рдЙрдкрднреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕реЗ рдХрд┐рд╕реА рднрд┐рдиреНрди рдЦрд╛рддреЗ рдиреЗ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд┐рдпрд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЗ рдлрд╝рдВрдХреНрд╢рдВрд╕ **рд▓реЗрдпрд░ рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рд╣рдЯрд╛рдП рдЬрд╛рдиреЗ рдХреЗ рдмрд╛рдж рднреА, рдпрд╛ рд▓реЗрдпрд░ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЖрдкрдХреА рдЕрдиреБрдорддрд┐ рд░рджреНрдж рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рднреА рд▓реЗрдпрд░ рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдЬрд╛рд░реА рд░рдЦ рд╕рдХрддреЗ рд╣реИрдВ**ред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЖрдк рд╣рдЯрд╛рдП рдЧрдП рд▓реЗрдпрд░ рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирдпрд╛ рдлрд╝рдВрдХреНрд╢рди рдирд╣реАрдВ рдмрдирд╛ рд╕рдХрддреЗ рдпрд╛ рдлрд╝рдВрдХреНрд╢рдВрд╕ рдХреЛ рдЕрдкрдбреЗрдЯ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗред

рдХрдВрдЯреЗрдирд░ рдЗрдореЗрдЬ рдХреЗ рд░реВрдк рдореЗрдВ рддреИрдирд╛рдд рдлрд╝рдВрдХреНрд╢рдВрд╕ рд▓реЗрдпрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рдЖрдк рдЕрдкрдиреА рдкрд╕рдВрдж рдХрд╛ рд░рдирдЯрд╛рдЗрдо, рдкреБрд╕реНрддрдХрд╛рд▓рдп рдФрд░ рдЕрдиреНрдп рдирд┐рд░реНрднрд░рддрд╛рдУрдВ рдХреЛ рдХрдВрдЯреЗрдирд░ рдЗрдореЗрдЬ рдореЗрдВ рдкреИрдХреЗрдЬ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм рдЖрдк рдЗрдореЗрдЬ рдмрдирд╛рддреЗ рд╣реИрдВред

### Lambda Extensions

Lambda рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╡рд┐рднрд┐рдиреНрди **рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ, рдСрдмреНрдЬрд╝рд░реНрд╡реЗрдмрд┐рд▓рд┐рдЯреА, рд╕реБрд░рдХреНрд╖рд╛, рдФрд░ рдЧрд╡рд░реНрдиреЗрдВрд╕ рдЯреВрд▓реНрд╕** рдХреЗ рд╕рд╛рде рдлрд╝рдВрдХреНрд╢рдВрд╕ рдХреЛ рдПрдХреАрдХреГрдд рдХрд░рдХреЗ рдЙрдиреНрд╣реЗрдВ рдмрдврд╝рд╛рддреЗ рд╣реИрдВред рдпреЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди, [.zip рдЖрд░реНрдХрд╛рдЗрд╡реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Lambda рд▓реЗрдпрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬреЛрдбрд╝реЗ рдЧрдП](https://docs.aws.amazon.com/lambda/latest/dg/configuration-layers.html) рдпрд╛ [рдХрдВрдЯреЗрдирд░ рдЗрдореЗрдЬ рддреИрдирд╛рддреА рдореЗрдВ рд╢рд╛рдорд┐рд▓](https://aws.amazon.com/blogs/compute/working-with-lambda-layers-and-extensions-in-container-images/), рджреЛ рдореЛрдб рдореЗрдВ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ: **рдЖрдВрддрд░рд┐рдХ** рдФрд░ **рдмрд╛рд╣рд░реА**ред

* **рдЖрдВрддрд░рд┐рдХ рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рд░рдирдЯрд╛рдЗрдо рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╕рд╛рде рд╡рд┐рд▓рдп рдХрд░рддреЗ рд╣реИрдВ, **рднрд╛рд╖рд╛-рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░** рдФрд░ **рд░реИрдкрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕рдХреЗ рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдореЗрдВ рд╣реЗрд░рдлреЗрд░ рдХрд░рддреЗ рд╣реИрдВред рдпрд╣ рдЕрдиреБрдХреВрд▓рди **Java Correto 8 рдФрд░ 11, Node.js 10 рдФрд░ 12, рдФрд░ .NET Core 3.1** рд╕рд╣рд┐рдд рдХрдИ рд░рдирдЯрд╛рдЗрдо рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИред
* **рдмрд╛рд╣рд░реА рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдЕрд▓рдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд▓рддреЗ рд╣реИрдВ, Lambda рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдЬреАрд╡рдирдЪрдХреНрд░ рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд▓рди рд╕рдВрд░реЗрдЦрдг рдмрдирд╛рдП рд░рдЦрддреЗ рд╣реИрдВред рд╡реЗ рд╡рд┐рднрд┐рдиреНрди рд░рдирдЯрд╛рдЗрдо рдХреЗ рд╕рд╛рде рд╕рдВрдЧрдд рд╣реИрдВ рдЬреИрд╕реЗ **Node.js 10 рдФрд░ 12, Python 3.7 рдФрд░ 3.8, Ruby 2.5 рдФрд░ 2.7, Java Corretto 8 рдФрд░ 11, .NET Core 3.1**, рдФрд░ **рдХрд╕реНрдЯрдо рд░рдирдЯрд╛рдЗрдо**ред

### Enumeration
```bash
aws lambda get-account-settings

# List functions and get extra config info
aws lambda list-functions
aws lambda get-function --function-name <function_name>
aws lambda get-function-configuration --function-name <function_name>
aws lambda list-function-event-invoke-configs --function-name <function_name>
## Check for creds in env vars
aws lambda list-functions | jq '.Functions[].Environment'
## Download & check the source code
aws lambda get-function --function-name "<func_name>" --query 'Code.Location'
wget -O lambda-function.zip <url-from-previous-query>

# Get Lambda URL (if any)
aws lambda list-function-url-configs --function-name <function_name>
aws lambda get-function-url-config --function-name <function_name>

# Get who has permissions to invoke the Lambda
aws lambda get-policy --function-name <function_name>

# Versions and Aliases
aws lambda list-versions-by-function --function-name <func_name>
aws lambda list-aliases --function-name <func_name>

# List layers
aws lambda list-layers
aws lambda list-layer-versions --layer-name <name>
aws lambda get-layer-version --layer-name <name> --version-number <ver>
aws lambda get-layer-version-by-arn --arn <name> #Get external ARNs

# List other metadata
aws lambda list-event-source-mappings
aws lambda list-code-signing-configs
aws lambda list-functions-by-code-signing-config --code-signing-config-arn <arn>
```
### рдПрдХ lambda рдХреЛ invoke рдХрд░реЗрдВ

#### рдореИрдиреБрдЕрд▓
```bash
# Invoke function
aws lambda invoke --function-name FUNCTION_NAME /tmp/out
## Some functions will expect parameters, they will access them with something like:
## target_policys = event['policy_names']
## user_name = event['user_name']
aws lambda invoke --function-name <name> --cli-binary-format raw-in-base64-out --payload '{"policy_names": ["AdministratorAccess], "user_name": "sdf"}' out.txt
```
#### рдЙрдЬрд╛рдЧрд░ URL рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

#### Enumeration

Lambda рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- `aws lambda list-functions`
- `aws lambda get-function --function-name <function_name>`

#### Via IAM Roles

Lambda рдХрд╛рд░реНрдпреЛрдВ рдХреЛ IAM рднреВрдорд┐рдХрд╛рдУрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреА рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред IAM рднреВрдорд┐рдХрд╛рдУрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

- `aws iam list-roles`
- `aws iam get-role --role-name <role_name>`

#### Via CloudTrail

CloudTrail рд▓реЙрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Lambda рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред CloudTrail рд▓реЙрдЧ рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

- `aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=CreateFunction`

#### Via CloudFormation

CloudFormation рдЯреЗрдореНрдкрд▓реЗрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Lambda рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред CloudFormation рдЯреЗрдореНрдкрд▓реЗрдЯреНрд╕ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

- `aws cloudformation list-stacks`
- `aws cloudformation get-template --stack-name <stack_name>`

#### Via Serverless Framework

Serverless Framework рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Lambda рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред Serverless Framework рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

- `serverless deploy`
- `serverless info`

#### Via Terraform

Terraform рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Lambda рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред Terraform рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

- `terraform plan`
- `terraform apply`

#### Via eks

eks рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Lambda рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред eks рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

- `eksctl get cluster`
- `eksctl get nodegroup --cluster <cluster_name>`

#### Via eksctl

eksctl рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Lambda рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред eksctl рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

- `eksctl get cluster`
- `eksctl get nodegroup --cluster <cluster_name>`
```bash
aws lambda list-function-url-configs --function-name <function_name> #Get lambda URL
aws lambda get-function-url-config   --function-name <function_name> #Get lambda URL
```
#### URL рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ Lambda рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рдХрд░реЗрдВ

рдЕрдм рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рд╕рдордп рд╣реИ рдХрд┐ рд╕рдВрднрд╛рд╡рд┐рдд lambda рдлрд╝рдВрдХреНрд╢рдВрд╕ рдХреЛ рдХреИрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП:
```
aws --region us-west-2 --profile level6 lambda list-functions
```
![](<../../../.gitbook/assets/image (262).png>)

рдПрдХ lambda function рдЬрд┐рд╕реЗ "Level6" рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЙрдкрд▓рдмреНрдз рд╣реИред рдЖрдЗрдП рдЬрд╛рдиреЗрдВ рдЗрд╕реЗ рдХреИрд╕реЗ рдХреЙрд▓ рдХрд░реЗрдВ:
```bash
aws --region us-west-2 --profile level6 lambda get-policy --function-name Level6
```
![](<../../../.gitbook/assets/image (102).png>)

рдЕрдм, рдЬрдм рдЖрдкрдХреЛ рдирд╛рдо рдФрд░ ID рдкрддрд╛ рд╣реИ, рддреЛ рдЖрдк рдирд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
aws --profile level6 --region us-west-2 apigateway get-stages --rest-api-id "s33ppypa75"
```
![](<../../../.gitbook/assets/image (237).png>)

рдФрд░ рдЕрдВрдд рдореЗрдВ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░рддреЗ рд╣реБрдП рдХреЙрд▓ рдХрд░реЗрдВ (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ ID, Name рдФрд░ function-name URL рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВ): [https://s33ppypa75.execute-api.us-west-2.amazonaws.com/Prod/level6](https://s33ppypa75.execute-api.us-west-2.amazonaws.com/Prod/level6)

`URL:`**`https://<rest-api-id>.execute-api.<region>.amazonaws.com/<stageName>/<funcName>`**

#### рдЕрдиреНрдп рдЯреНрд░рд┐рдЧрд░реНрд╕

рдРрд╕реЗ рдХрдИ рдЕрдиреНрдп рд╕реНрд░реЛрдд рд╣реИрдВ рдЬреЛ рдПрдХ lambda рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ

<figure><img src="../../../.gitbook/assets/image (167).png" alt=""><figcaption></figcaption></figure>

### Privesc

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдкрд░ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **Lambda рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреИрд╕реЗ рдмрдврд╝рд╛рдПрдВ**:

{% content-ref url="../aws-privilege-escalation/aws-lambda-privesc.md" %}
[aws-lambda-privesc.md](../aws-privilege-escalation/aws-lambda-privesc.md)
{% endcontent-ref %}

### Unauthenticated Access

{% content-ref url="../aws-unauthenticated-enum-access/aws-lambda-unauthenticated-access.md" %}
[aws-lambda-unauthenticated-access.md](../aws-unauthenticated-enum-access/aws-lambda-unauthenticated-access.md)
{% endcontent-ref %}

### Post Exploitation

{% content-ref url="../aws-post-exploitation/aws-lambda-post-exploitation/" %}
[aws-lambda-post-exploitation](../aws-post-exploitation/aws-lambda-post-exploitation/)
{% endcontent-ref %}

### Persistence

{% content-ref url="../aws-persistence/aws-lambda-persistence/" %}
[aws-lambda-persistence](../aws-persistence/aws-lambda-persistence/)
{% endcontent-ref %}

## рд╕рдВрджрд░реНрдн

* [https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-concepts.html#gettingstarted-concepts-layer](https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-concepts.html#gettingstarted-concepts-layer)
* [https://aws.amazon.com/blogs/compute/building-extensions-for-aws-lambda-in-preview/](https://aws.amazon.com/blogs/compute/building-extensions-for-aws-lambda-in-preview/)

{% hint style="success" %}
AWS Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХреЛ рд╕рдорд░реНрдерди рджреЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рд╣рдореЗрдВ **Twitter** ЁЯРж рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
{% endhint %}
