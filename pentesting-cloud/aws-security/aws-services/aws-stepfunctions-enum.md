# AWS - Step Functions Enum

{% hint style="success" %}
AWS Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХреЛ рд╕рдорд░реНрдерди рджреЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рд╣рдореЗрдВ **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВред**
* **PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
{% endhint %}

## Step Functions

AWS Step Functions рдПрдХ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рд╕реЗрд╡рд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреЛ рдХрдИ AWS рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рд╕рд░реНрд╡рд░рд▓реЗрд╕ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдореЗрдВ рд╕рдордиреНрд╡рдпрд┐рдд рдФрд░ рдСрд░реНрдХреЗрд╕реНрдЯреНрд░реЗрдЯ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдмрдирд╛рддреА рд╣реИред AWS Step Functions рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдбрд┐рдЬрд╝рд╛рдЗрди рдФрд░ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╡рд┐рднрд┐рдиреНрди AWS рд╕реЗрд╡рд╛рдУрдВ рдЬреИрд╕реЗ AWS Lambda, Amazon S3, Amazon DynamoDB, рдФрд░ рдХрдИ рдЕрдиреНрдп рдХреЛ рдЪрд░рдгреЛрдВ рдХреА рдЕрдиреБрдХреНрд░рдо рдореЗрдВ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред рдпрд╣ рдСрд░реНрдХреЗрд╕реНрдЯреНрд░реЗрд╢рди рд╕реЗрд╡рд╛ рдПрдХ рджреГрд╢реНрдп рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ рдФрд░ **state machine** рдХреНрд╖рдорддрд╛рдПрдБ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЖрдк JSON-рдЖрдзрд╛рд░рд┐рдд **Amazon States Language** (ASL) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдХреЛ рдШреЛрд╖рдгрд╛рддреНрдордХ рддрд░реАрдХреЗ рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

AWS Step Functions рдЕрд╡рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рдХреЗ, рдкреБрдирдГ рдкреНрд░рдпрд╛рд╕, рддреНрд░реБрдЯрд┐рдпреЛрдВ рдФрд░ рд╕рдорд╛рдирд╛рдВрддрд░ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕рдВрднрд╛рд▓рдХрд░ рд▓рдЪреАрд▓рд╛ рдФрд░ рд╕реНрдХреЗрд▓реЗрдмрд▓ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдмрдирд╛рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕рд░рд▓ рдмрдирд╛рддрд╛ рд╣реИред рдпрд╣ рдХрдИ рдЪрд░рдгреЛрдВ рдФрд░ рдирд┐рд░реНрдгрдп рдмрд┐рдВрджреБрдУрдВ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЬрдЯрд┐рд▓ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдмреАрдЪ рдбреЗрдЯрд╛ рдФрд░ рдирд┐рд╖реНрдкрд╛рджрди рд╕реНрдерд┐рддрд┐ рдХреЗ рдкреНрд░рд╡рд╛рд╣ рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рд╕реЗрд╡рд╛ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдореБрдЦреНрдп рдЙрдкрдпреЛрдЧ рдХреЗ рдорд╛рдорд▓реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИрдВ:

- **рдбреЗрдЯрд╛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг**: рдлрд╝рд╛рдЗрд▓, рд╡реАрдбрд┐рдпреЛ рдФрд░ рдЫрд╡рд┐ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг; рдиреМрдХрд░рд┐рдпреЛрдВ рдХрд╛ рдирд┐рд╖реНрдХрд░реНрд╖рдг, рдкрд░рд┐рд╡рд░реНрддрди рдФрд░ рд▓реЛрдб (ETL); рдФрд░ рдмреИрдЪ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдФрд░ рдЙрдЪреНрдЪ рдкреНрд░рджрд░реНрд╢рди рдХрдВрдкреНрдпреВрдЯрд┐рдВрдЧ (HPC) рд╡рд░реНрдХрд▓реЛрдбред
- **рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ**: рдзреЛрдЦрд╛рдзрдбрд╝реА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛, рдЕрдиреБрдХреВрд▓рди, рд╕рд┐рдлрд╛рд░рд┐рд╢ рдФрд░ рдбреЗрдЯрд╛ рд╕рдВрд╡рд░реНрдзрдиред
- **рдорд╛рдЗрдХреНрд░реЛрд╕рд░реНрд╡рд┐рд╕ рдСрд░реНрдХреЗрд╕реНрдЯреНрд░реЗрд╢рди**: рд╕рдордХрд╛рд▓рд┐рдХ рдпрд╛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдФрд░ рдХрдВрдЯреЗрдирд░ рдСрд░реНрдХреЗрд╕реНрдЯреНрд░реЗрд╢рдиред
- **рдЖрдИрдЯреА рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╕реНрд╡рдЪрд╛рд▓рди**: рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╕реБрдзрд╛рд░, рдкрд░рд┐рдирд┐рдпреЛрдЬрди рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛; рдФрд░ рдорд╛рдирд╡ рдЕрдиреБрдореЛрджрди рдФрд░ рд╡реГрджреНрдзрд┐ред

## рдореБрдЦреНрдп рдЕрд╡рдзрд╛рд░рдгрд╛рдПрдБ

### Standard vs. Express Workflows

AWS Step Functions рджреЛ рдкреНрд░рдХрд╛рд░ рдХреЗ **state machine workflows** рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ: Standard рдФрд░ Expressред

- **Standard Workflow**: рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдкреНрд░рдХрд╛рд░ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдЪрд▓рдиреЗ рд╡рд╛рд▓реЗ, рдЯрд┐рдХрд╛рдК рдФрд░ рдСрдбрд┐рдЯреЗрдмрд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ **exactly-once execution** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реБрдП рдХрд┐ рдХрд╛рд░реНрдп рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рдЪрд▓рддреЗ рд╣реИрдВ рдЬрдм рддрдХ рдХрд┐ рдкреБрдирдГ рдкреНрд░рдпрд╛рд╕ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рди рд╣реЛрдВред рдпрд╣ рдЙрди рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдХреЗ рд▓рд┐рдП рдЖрджрд░реНрд╢ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рд╡рд┐рд╕реНрддреГрдд рдирд┐рд╖реНрдкрд╛рджрди рдЗрддрд┐рд╣рд╛рд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдФрд░ рдпрд╣ рдПрдХ рд╡рд░реНрд╖ рддрдХ рдЪрд▓ рд╕рдХрддрд╛ рд╣реИред
- **Express Workflow**: рдпрд╣ рдкреНрд░рдХрд╛рд░ рдЙрдЪреНрдЪ-рдорд╛рддреНрд░рд╛, рдЕрд▓реНрдк-рдЕрд╡рдзрд┐ рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЖрджрд░реНрд╢ рд╣реИ, рдЬреЛ рдкрд╛рдВрдЪ рдорд┐рдирдЯ рддрдХ рдЪрд▓рддреЗ рд╣реИрдВред рд╡реЗ **at-least-once execution** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдбреЗрдЯрд╛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдЬреИрд╕реЗ idempotent рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИред рдпреЗ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рд▓рд╛рдЧрдд рдФрд░ рдкреНрд░рджрд░реНрд╢рди рдХреЗ рд▓рд┐рдП рдЕрдиреБрдХреВрд▓рд┐рдд рд╣реИрдВ, рдирд┐рд╖реНрдкрд╛рджрди, рдЕрд╡рдзрд┐ рдФрд░ рдореЗрдореЛрд░реА рдЙрдкрдпреЛрдЧ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╢реБрд▓реНрдХ рд▓реЗрддреЗ рд╣реИрдВред

### States

States state machines рдХреЗ рдЖрд╡рд╢реНрдпрдХ рдЗрдХрд╛рдЗрдпрд╛рдБ рд╣реИрдВред рд╡реЗ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдХреЗ рднреАрддрд░ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдЪрд░рдгреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдЗрд╕рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрдп рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- **Task:** рдПрдХ рдХрд╛рд░реНрдп рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЕрдХреНрд╕рд░ рдПрдХ AWS рд╕реЗрд╡рд╛ рдЬреИрд╕реЗ Lambda рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред
- **Choice:** рдЗрдирдкреБрдЯ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдирд┐рд░реНрдгрдп рд▓реЗрддрд╛ рд╣реИред
- **Fail/Succeed:** рд╡рд┐рдлрд▓рддрд╛ рдпрд╛ рд╕рдлрд▓рддрд╛ рдХреЗ рд╕рд╛рде рдирд┐рд╖реНрдкрд╛рджрди рд╕рдорд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред
- **Pass:** рдЗрдирдкреБрдЯ рдХреЛ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИ рдпрд╛ рдбреЗрдЯрд╛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИред
- **Wait:** рдПрдХ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╕рдордп рдХреЗ рд▓рд┐рдП рдирд┐рд╖реНрдкрд╛рджрди рдореЗрдВ рджреЗрд░реА рдХрд░рддрд╛ рд╣реИред
- **Parallel:** рд╕рдорд╛рдирд╛рдВрддрд░ рд╢рд╛рдЦрд╛рдПрдБ рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИред
- **Map:** рд╡рд╕реНрддреБрдУрдВ рдкрд░ рдЪрд░рдгреЛрдВ рдХреЛ рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рджреЛрд╣рд░рд╛рддрд╛ рд╣реИред

### Task

рдПрдХ **Task** state рдПрдХ state machine рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд╛рд░реНрдп рдХреА рдПрдХрд▓ рдЗрдХрд╛рдИ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИред Tasks рд╡рд┐рднрд┐рдиреНрди рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдЖрдордВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рдЧрддрд┐рд╡рд┐рдзрд┐рдпрд╛рдБ, Lambda functions, AWS рд╕реЗрд╡рд╛рдПрдБ, рдпрд╛ рддреГрддреАрдп-рдкрдХреНрд╖ APIs рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

- **Activities**: рдХрд╕реНрдЯрдо рд╡рд░реНрдХрд░реНрд╕ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдЪрд▓рдиреЗ рд╡рд╛рд▓реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрддред
- Resource: **`arn:aws:states:region:account:activity:name`**.
- **Lambda Functions**: AWS Lambda functions рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИред
- Resource: **`arn:aws:lambda:region:account:function:function-name`**.
- **AWS Services**: рдЕрдиреНрдп AWS рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде рд╕реАрдзреЗ рдПрдХреАрдХреГрдд рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ DynamoDB рдпрд╛ S3ред
- Resource: **`arn:partition:states:region:account:servicename:APIname`**.
- **HTTP Task**: рддреГрддреАрдп-рдкрдХреНрд╖ APIs рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред
- Resource field: **`arn:aws:states:::http:invoke`**. рдлрд┐рд░, рдЖрдкрдХреЛ API рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рд╡рд░рдг рдкреНрд░рджрд╛рди рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬреИрд╕реЗ рдХрд┐ API URL, рд╡рд┐рдзрд┐, рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╡рд┐рд╡рд░рдгред

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдПрдХ Task state рдкрд░рд┐рднрд╛рд╖рд╛ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдЬреЛ HelloWorld рдирд╛рдордХ Lambda function рдХреЛ рдЖрдордВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ:
```json
"HelloWorld": {
"Type": "Task",
"Resource": "arn:aws:states:::lambda:invoke",
"Parameters": {
"Payload.$": "$",
"FunctionName": "arn:aws:lambda:<region>:<account-id>:function:HelloWorld"
},
"End": true
}
```
### Choice

рдПрдХ **Choice** рд╕реНрдЯреЗрдЯ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдореЗрдВ рд╕рд╢рд░реНрдд рд▓реЙрдЬрд┐рдХ рдЬреЛрдбрд╝рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдирд┐рд░реНрдгрдп рд▓рд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╢рд░реНрддреЛрдВ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╕рдВрдмрдВрдзрд┐рдд рд╕реНрдЯреЗрдЯ рдореЗрдВ рд╕рдВрдХреНрд░рдордг рдХрд░рддрд╛ рд╣реИред

- **Comparison**: рдкреНрд░рддреНрдпреЗрдХ рдЪреЙрдЗрд╕ рдирд┐рдпрдо рдореЗрдВ рдПрдХ рддреБрд▓рдирд╛ рдСрдкрд░реЗрдЯрд░ (рдЬреИрд╕реЗ, **`NumericEquals`**, **`StringEquals`**) рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдЗрдирдкреБрдЯ рд╡реЗрд░рд┐рдПрдмрд▓ рдХреА рддреБрд▓рдирд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдорд╛рди рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рд╡реЗрд░рд┐рдПрдмрд▓ рд╕реЗ рдХрд░рддрд╛ рд╣реИред
- **Next Field**: рдЪреЙрдЗрд╕ рд╕реНрдЯреЗрдЯреНрд╕ **`End`** рдлрд╝реАрд▓реНрдб рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рд╡реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдпрджрд┐ рддреБрд▓рдирд╛ рд╕рд╣реА рд╣реИ рддреЛ рдХрд┐рд╕ **`Next`** рд╕реНрдЯреЗрдЯ рдореЗрдВ рд╕рдВрдХреНрд░рдордг рдХрд░рдирд╛ рд╣реИред

**Choice** рд╕реНрдЯреЗрдЯ рдХрд╛ рдЙрджрд╛рд╣рд░рдг:
```json
{
"Variable": "$.timeStamp",
"TimestampEquals": "2000-01-01T00:00:00Z",
"Next": "TimeState"
}
```
### Fail/Succeed

рдПрдХ **`Fail`** рд╕реНрдЯреЗрдЯ рд╕реНрдЯреЗрдЯ рдорд╢реАрди рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рд░реЛрдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рд╡рд┐рдлрд▓рддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рддреНрд░реБрдЯрд┐ рдирд╛рдо рдФрд░ рдХрд╛рд░рдг рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рд╡рд┐рдлрд▓рддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╕реНрдЯреЗрдЯ рдЯрд░реНрдорд┐рдирд▓ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдпрд╣ рдирд┐рд╖реНрдкрд╛рджрди рдкреНрд░рд╡рд╛рд╣ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред

рдПрдХ **`Succeed`** рд╕реНрдЯреЗрдЯ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рд░реЛрдХрддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрдорддреМрд░ рдкрд░ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рдпрд╣ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреВрд░рд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рд╕реНрдЯреЗрдЯ рдХреЛ **`Next`** рдлрд╝реАрд▓реНрдб рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред

{% tabs %}

{% tab title="Fail example" %}
```json
"FailState": {
"Type": "Fail",
"Error": "ErrorName",
"Cause": "Error details"
}
```
{% endtab %}

{% tab title="Succeed example" %}

{% endtab %}
```json
"SuccessState": {
"Type": "Succeed"
}
```
{% endtab %}

{% endtabs %}

### Pass

рдПрдХ **Pass** state рдЕрдкрдиреЗ рдЗрдирдкреБрдЯ рдХреЛ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИ рдмрд┐рдирд╛ рдХреЛрдИ рдХрд╛рдо рдХрд┐рдП рдпрд╛ JSON state рдЗрдирдкреБрдЯ рдХреЛ рдлрд┐рд▓реНрдЯрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдо рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдо рдХрд┐рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЛ рдЕрдЧрд▓реЗ state рдореЗрдВ рдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИред рдпрд╣ state рдорд╢реАрдиреЛрдВ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдФрд░ рдирд┐рд░реНрдорд╛рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЖрдк рд╕реНрдерд┐рд░ рдбреЗрдЯрд╛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЗрд╕реЗ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```json
"PassState": {
"Type": "Pass",
"Result": {"key": "value"},
"ResultPath": "$.newField",
"Next": "NextState"
}
```
### Wait

рдПрдХ **Wait** рд╕реНрдЯреЗрдЯ рдорд╢реАрди рдХреА рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЕрд╡рдзрд┐ рдХреЗ рд▓рд┐рдП рд╡рд┐рд▓рдВрдмрд┐рдд рдХрд░рддрд╛ рд╣реИред рдкреНрд░рддреАрдХреНрд╖рд╛ рд╕рдордп рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рддреАрди рдореБрдЦреНрдп рддрд░реАрдХреЗ рд╣реИрдВ:

- **X Seconds**: рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд╢реНрдЪрд┐рдд рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рд╕реЗрдХрдВрдбред

```json
"WaitState": {
"Type": "Wait",
"Seconds": 10,
"Next": "NextState"
}
```

- **Absolute Timestamp**: рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдЯреАрдХ рд╕рдордпред

```json
"WaitState": {
"Type": "Wait",
"Timestamp": "2024-03-14T01:59:00Z",
"Next": "NextState"
}
```

- **Dynamic Wait**: рдЗрдирдкреБрдЯ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ **`SecondsPath`** рдпрд╛ **`TimestampPath`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред

```json
jsonCopiar c├│digo
"WaitState": {
"Type": "Wait",
"TimestampPath": "$.expirydate",
"Next": "NextState"
}
```


### Parallel

рдПрдХ **Parallel** рд╕реНрдЯреЗрдЯ рдЖрдкрдХреЛ рдЕрдкрдиреЗ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдХреЗ рднреАрддрд░ рдХрдИ рд╢рд╛рдЦрд╛рдУрдВ рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдкреНрд░рддреНрдпреЗрдХ рд╢рд╛рдЦрд╛ рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ рдЪрд▓рддреА рд╣реИ рдФрд░ рдЕрдкрдиреА рд╕реНрд╡рдпрдВ рдХреА рд╕реНрдЯреЗрдЯреНрд╕ рдХреА рдЕрдиреБрдХреНрд░рдордгрд┐рдХрд╛ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддреА рд╣реИред рдирд┐рд╖реНрдкрд╛рджрди рддрдм рддрдХ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИ рдЬрдм рддрдХ рд╕рднреА рд╢рд╛рдЦрд╛рдПрдБ рдкреВрд░реА рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддреАрдВ, рдЙрд╕рдХреЗ рдмрд╛рдж рдЕрдЧрд▓реЗ рд╕реНрдЯреЗрдЯ рдкрд░ рдЖрдЧреЗ рдмрдврд╝рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдореБрдЦреНрдп рдлрд╝реАрд▓реНрдбреНрд╕ рд╣реИрдВ:

- **Branches**: рд╕рдорд╛рдирд╛рдВрддрд░ рдирд┐рд╖реНрдкрд╛рджрди рдкрдереЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реА рдПрдХ рд╕рд░рдгреАред рдкреНрд░рддреНрдпреЗрдХ рд╢рд╛рдЦрд╛ рдПрдХ рдЕрд▓рдЧ рд╕реНрдЯреЗрдЯ рдорд╢реАрди рд╣реИред
- **ResultPath**: рдЗрдирдкреБрдЯ рдореЗрдВ (рдХрд╣рд╛рдБ) рд╢рд╛рдЦрд╛рдУрдВ рдХреЗ рд╕рдВрдпреБрдХреНрдд рдЖрдЙрдЯрдкреБрдЯ рдХреЛ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред
- **Retry and Catch**: рд╕рдорд╛рдирд╛рдВрддрд░ рд╕реНрдЯреЗрдЯ рдХреЗ рд▓рд┐рдП рддреНрд░реБрдЯрд┐ рд╣реИрдВрдбрд▓рд┐рдВрдЧ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рдиред
```json
"ParallelState": {
"Type": "Parallel",
"Branches": [
{
"StartAt": "Task1",
"States": { ... }
},
{
"StartAt": "Task2",
"States": { ... }
}
],
"Next": "NextState"
}
```
### Map

**Map** рд╕реНрдЯреЗрдЯ рдПрдХ рдбреЗрдЯрд╛ рд╕реЗрдЯ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдЖрдЗрдЯрдо рдХреЗ рд▓рд┐рдП рд╕реНрдЯреЗрдкреНрд╕ рдХреЗ рд╕реЗрдЯ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдмрдирд╛рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдбреЗрдЯрд╛ рдХреЗ рд╕рдорд╛рдирд╛рдВрддрд░ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЖрдк рдбреЗрдЯрд╛ рд╕реЗрдЯ рдХреЗ рдЖрдЗрдЯрдореНрд╕ рдХреЛ рдХреИрд╕реЗ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдЗрд╕рдХреЗ рдЖрдзрд╛рд░ рдкрд░ Step Functions рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЛрдбреНрд╕ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ:

- **Inline Mode**: рдкреНрд░рддреНрдпреЗрдХ JSON рдПрд░реЗ рдЖрдЗрдЯрдо рдХреЗ рд▓рд┐рдП рд╕реНрдЯреЗрдЯреНрд╕ рдХреЗ рдПрдХ рдЙрдкрд╕рдореВрд╣ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИред рдЫреЛрдЯреЗ рдкреИрдорд╛рдиреЗ рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИ рдЬрд┐рдирдореЗрдВ 40 рд╕реЗ рдХрдо рд╕рдорд╛рдирд╛рдВрддрд░ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпрд╛рдБ рд╣реЛрддреА рд╣реИрдВ, рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдХреЛ рдЙрд╕ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ **`Map`** рд╕реНрдЯреЗрдЯ рд╣реЛрддрд╛ рд╣реИред

```json
"MapState": {
"Type": "Map",
"ItemsPath": "$.arrayItems",
"ItemProcessor": {
"ProcessorConfig": {
"Mode": "INLINE"
},
"StartAt": "AddState",
"States": {
"AddState": {
"Type": "Task",
"Resource": "arn:aws:states:::lambda:invoke",
"OutputPath": "$.Payload",
"Parameters": {
"FunctionName": "arn:aws:lambda:<region>:<account-id>:function:add-function"
},
"End": true
}
}
},
"End": true
"ResultPath": "$.detail.added",
"ItemsPath": "$.added"
}
```

- **Distributed Mode**: рдЙрдЪреНрдЪ рд╕рдорд╡рд░реНрддреАрддрд╛ рдХреЗ рд╕рд╛рде рдмрдбрд╝реЗ рдкреИрдорд╛рдиреЗ рдкрд░ рд╕рдорд╛рдирд╛рдВрддрд░ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдмрдбрд╝реЗ рдбреЗрдЯрд╛ рд╕реЗрдЯреНрд╕ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдиреЗ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ Amazon S3 рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд, 10,000 рд╕рдорд╛рдирд╛рдВрддрд░ рдЪрд╛рдЗрд▓реНрдб рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдирд┐рд╖реНрдкрд╛рджрди рддрдХ рдХреА рдЙрдЪреНрдЪ рд╕рдорд╡рд░реНрддреАрддрд╛ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рддрд╛ рд╣реИ, рдЗрди рдЪрд╛рдЗрд▓реНрдб рдХреЛ рдПрдХ рдЕрд▓рдЧ рдЪрд╛рдЗрд▓реНрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд▓рд╛рддрд╛ рд╣реИред

```json
"DistributedMapState": {
"Type": "Map",
"ItemReader": {
"Resource": "arn:aws:states:::s3:getObject",
"Parameters": {
"Bucket": "my-bucket",
"Key": "data.csv"
}
},
"ItemProcessor": {
"ProcessorConfig": {
"Mode": "DISTRIBUTED",
"ExecutionType": "EXPRESS"
},
"StartAt": "ProcessItem",
"States": {
"ProcessItem": {
"Type": "Task",
"Resource": "arn:aws:lambda:region:account-id:function:my-function",
"End": true
}
}
},
"End": true
"ResultWriter": {
"Resource": "arn:aws:states:::s3:putObject",
"Parameters": {
"Bucket": "myOutputBucket",
"Prefix": "csvProcessJobs"
}
}
}
```


### Versions and aliases

Step Functions рдЖрдкрдХреЛ рд╕реНрдЯреЗрдЯ рдорд╢реАрдиреЛрдВ рдХреЗ **versions** рдФрд░ **aliases** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рдХреЛ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдПрдХ version рдПрдХ рд╕реНрдЯреЗрдЯ рдорд╢реАрди рдХрд╛ рд╕реНрдиреИрдкрд╢реЙрдЯ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред Aliases рд╕реНрдЯреЗрдЯ рдорд╢реАрди рдХреЗ рджреЛ versions рддрдХ рдХреЗ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддреЗ рд╣реИрдВред

- **Versions**: рдпреЗ рд╕реНрдЯреЗрдЯ рдорд╢реАрди рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╢реЛрдзрди рд╕реЗ рдмрдирд╛рдП рдЧрдП рдЕрдкрд░рд┐рд╡рд░реНрддрдиреАрдп рд╕реНрдиреИрдкрд╢реЙрдЯ рд╣реЛрддреЗ рд╣реИрдВред рдкреНрд░рддреНрдпреЗрдХ version рдХреЛ рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп ARN рджреНрд╡рд╛рд░рд╛ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рд╕реНрдЯреЗрдЯ рдорд╢реАрди ARN рдХреЛ version рдирдВрдмрд░ рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рддрд╛ рд╣реИ, рдЬреЛ рдХреЛрд▓рди (**`arn:aws:states:region:account-id:stateMachine:StateMachineName:version-number`**) рджреНрд╡рд╛рд░рд╛ рдЕрд▓рдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред Versions рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдк рд╕реНрдЯреЗрдЯ рдорд╢реАрди рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдПрдХ рдирдпрд╛ version рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╛ рдЗрдЪреНрдЫрд┐рдд рд╕реНрдЯреЗрдЯ рдорд╢реАрди version рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
- **Aliases**: рдпреЗ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдПрдХ рд╣реА рд╕реНрдЯреЗрдЯ рдорд╢реАрди рдХреЗ рджреЛ versions рддрдХ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдПрдХрд▓ рд╕реНрдЯреЗрдЯ рдорд╢реАрди рдХреЗ рд▓рд┐рдП рдХрдИ aliases рдмрдирд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдкреНрд░рддреНрдпреЗрдХ рдХреЛ рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп ARN рджреНрд╡рд╛рд░рд╛ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рд╕реНрдЯреЗрдЯ рдорд╢реАрди ARN рдХреЛ alias рдирд╛рдо рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рддрд╛ рд╣реИ, рдЬреЛ рдХреЛрд▓рди (**`arn:aws:states:region:account-id:stateMachine:StateMachineName:aliasName`**) рджреНрд╡рд╛рд░рд╛ рдЕрд▓рдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред Aliases рд╕реНрдЯреЗрдЯ рдорд╢реАрди рдХреЗ рджреЛ versions рдореЗрдВ рд╕реЗ рдПрдХ рдХреЗ рдмреАрдЪ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рд░реВрдЯ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдмрдирд╛рддреЗ рд╣реИрдВред рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, рдПрдХ alias рд╕реНрдЯреЗрдЯ рдорд╢реАрди рдХреЗ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ version рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЕрдиреНрдп aliases рдХреА рдУрд░ рдирд╣реАрдВред рдЗрдиреНрд╣реЗрдВ рдЖрд╡рд╢реНрдпрдХрддрд╛рдиреБрд╕рд╛рд░ рд╕реНрдЯреЗрдЯ рдорд╢реАрди рдХреЗ рдХрд┐рд╕реА рдЕрдиреНрдп version рдХреА рдУрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдбреЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдирд┐рдпрдВрддреНрд░рд┐рдд рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рдФрд░ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдкреНрд░рдмрдВрдзрди рдХреА рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред

**ASL** рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ: [**Amazon States Language**](https://states-language.net/spec.html).



## IAM Roles for State machines

AWS Step Functions AWS Identity and Access Management (IAM) roles рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реНрдЯреЗрдЯ рдорд╢реАрдиреЛрдВ рдХреЗ рднреАрддрд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдФрд░ рдХреНрд░рд┐рдпрд╛рдУрдВ рддрдХ рдкрд╣реБрдВрдЪ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИред AWS Step Functions рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ IAM roles рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдкреНрд░рдореБрдЦ рдкрд╣рд▓реВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИрдВ:

- **Execution Role**: AWS Step Functions рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рд╕реНрдЯреЗрдЯ рдорд╢реАрди рдПрдХ IAM execution role рд╕реЗ рдЬреБрдбрд╝реА рд╣реЛрддреА рд╣реИред рдпрд╣ role рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╕реНрдЯреЗрдЯ рдорд╢реАрди рдЖрдкрдХреА рдУрд░ рд╕реЗ рдХреМрди рд╕реА рдХреНрд░рд┐рдпрд╛рдПрдВ рдХрд░ рд╕рдХрддреА рд╣реИред рдЬрдм рдПрдХ рд╕реНрдЯреЗрдЯ рдорд╢реАрди AWS рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕реНрдЯреЗрдЯреНрд╕ рдХреЗ рдмреАрдЪ рд╕рдВрдХреНрд░рдордг рдХрд░рддреА рд╣реИ (рдЬреИрд╕реЗ Lambda functions рдХреЛ рдЗрдирд╡реЛрдХ рдХрд░рдирд╛, DynamoDB рддрдХ рдкрд╣реБрдВрдЪрдирд╛, рдЖрджрд┐), рддреЛ рдпрд╣ рдЙрди рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ execution role рдХреЛ рдЧреНрд░рд╣рдг рдХрд░рддреА рд╣реИред
- **Permissions**: IAM execution role рдХреЛ рдЙрди рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬреЛ рдЕрдиреНрдп AWS рд╕реЗрд╡рд╛рдУрдВ рдкрд░ рдЖрд╡рд╢реНрдпрдХ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдкрдХреА рд╕реНрдЯреЗрдЯ рдорд╢реАрди рдХреЛ AWS Lambda functions рдХреЛ рдЗрдирд╡реЛрдХ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рддреЛ IAM role рдореЗрдВ **`lambda:InvokeFunction`** рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред рдЗрд╕реА рддрд░рд╣, рдпрджрд┐ рдЗрд╕реЗ DynamoDB рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рддреЛ рдЙрдкрдпреБрдХреНрдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ (**`dynamodb:PutItem`**, **`dynamodb:UpdateItem`**, рдЖрджрд┐) рджреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдПред
- **Least Privilege**: Step Functions рдХреЗ рд▓рд┐рдП IAM roles рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреЗ рд╕рдордп рдиреНрдпреВрдирддрдо рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреЗ рд╕рд┐рджреНрдзрд╛рдВрдд рдХрд╛ рдкрд╛рд▓рди рдХрд░рдиреЗ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╕реНрдЯреЗрдЯ рдорд╢реАрди рдХреЛ рдЕрдкрдиреА рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдЖрд╡рд╢реНрдпрдХ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рджреЗрдирд╛, рдФрд░ рдЙрд╕рд╕реЗ рдЕрдзрд┐рдХ рдирд╣реАрдВред IAM рдиреАрддрд┐рдпреЛрдВ рдХреЛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдФрд░ рдХреНрд░рд┐рдпрд╛рдУрдВ рддрдХ рд╕реАрдорд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЕрдирдкреЗрдХреНрд╖рд┐рдд рдкрд╣реБрдВрдЪ рдХреЗ рдЬреЛрдЦрд┐рдо рдХреЛ рдХрдо рдХрд░рдирд╛ред

## Enumeration

ReadOnlyAccess рдиреАрддрд┐ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рднреА enumeration рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред
```bash
# State machines #

## List state machines
aws stepfunctions list-state-machines
## Retrieve informatio about the specified state machine
aws stepfunctions describe-state-machine --state-machine-arn <value>

## List verions for the specified state machine
aws stepfunctions list-state-machine-versions --state-machine-arn <value>
## List aliases for the specified state machine
aws stepfunctions list-state-machine-aliases --state-machine-arn <value>
## Retrieve informatio about the specified state machine alias
aws stepfunctions describe-state-machine-alias --state-machine-alias-arn <value>

## List executions of a state machine
aws stepfunctions list-executions --state-machine-arn <value> [--status-filter <RUNNING | SUCCEEDED | FAILED | TIMED_OUT | ABORTED | PENDING_REDRIVE>] [--redrive-filter <REDRIVEN | NOT_REDRIVEN>]
## Retrieve information and relevant metadata about a state machine execution
aws stepfunctions describe-execution --execution-arn <value>
## Retrieve information about the state machine associated to the specified execution
aws stepfunctions describe-state-machine-for-execution --execution-arn <value>
## Retrieve the history of the specified execution as a list of events
aws stepfunctions get-execution-history --execution-arn <value> [--reverse-order | --no-reverse-order] [--include-execution-data | --no-include-execution-data]

## List tags for the specified Ste Functions resource
aws stepfunctions list-tags-for-resource --resource-arn <value>

## Validate the definition of a state machine without creating the resource
aws stepfunctions validate-state-machine-definition --definition <value> [--type <STANDARD | EXPRESS>]

# Activities #

## List existing activities
aws stepfunctions list-activities
## Retrieve information about the specified activity
aws stepfunctions describe-activity --activity-arn <value>

# Map Runs #

## List map runs of an execution
aws stepfunctions list-map-runs --execution-arn <value>
## Provide information about the configuration, progress and results of a Map Run
aws stepfunctions describe-map-run --map-run-arn <value>
## Lists executions of a Map Run
aws stepfunctions list-executions --map-run-arn <value> [--status-filter <RUNNING | SUCCEEDED | FAILED | TIMED_OUT | ABORTED | PENDING_REDRIVE>] [--redrive-filter <REDRIVEN | NOT_REDRIVEN>]
```
## Privesc

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдореЗрдВ, рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **Step Functions рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреИрд╕реЗ рдмрдврд╝рд╛рдПрдВ**:

{% content-ref url="../aws-privilege-escalation/aws-stepfunctions-privesc.md" %}
[aws-stepfunctions-privesc.md](../aws-privilege-escalation/aws-stepfunctions-privesc.md)
{% endcontent-ref %}

## Post Exploitation

{% content-ref url="../aws-post-exploitation/aws-stepfunctions-post-exploitation/" %}
[aws-stepfunctions-post-exploitation](../aws-post-exploitation/aws-stepfunctions-post-exploitation/)
{% endcontent-ref %}

# References

* [https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsstepfunctions.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsstepfunctions.html)
* [https://docs.aws.amazon.com/step-functions/latest/dg/welcome.html](https://docs.aws.amazon.com/step-functions/latest/dg/welcome.html)
* [https://states-language.net/spec.html](https://states-language.net/spec.html)

{% hint style="success" %}
AWS Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХреЛ рд╕рдорд░реНрдерди рджреЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ **рд╣рдореЗрдВ рдлреЙрд▓реЛ рдХрд░реЗрдВ** **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
{% endhint %}
