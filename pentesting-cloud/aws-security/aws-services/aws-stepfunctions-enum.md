# AWS - Step Functions Enum

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ —É **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –ø–æ–¥–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}

## Step Functions

AWS Step Functions ‚Äî —Ü–µ —Å–µ—Ä–≤—ñ—Å —Ä–æ–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –∫–æ–æ—Ä–¥–∏–Ω—É–≤–∞—Ç–∏ —Ç–∞ –æ—Ä–∫–µ—Å—Ç—Ä—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ —Å–µ—Ä–≤—ñ—Å—ñ–≤ AWS —É –±–µ–∑—Å–µ—Ä–≤–µ—Ä–Ω—ñ —Ä–æ–±–æ—á—ñ –ø—Ä–æ—Ü–µ—Å–∏. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ AWS Step Functions, –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ–µ–∫—Ç—É–≤–∞—Ç–∏ —Ç–∞ –∑–∞–ø—É—Å–∫–∞—Ç–∏ —Ä–æ–±–æ—á—ñ –ø—Ä–æ—Ü–µ—Å–∏, —è–∫—ñ –∑'—î–¥–Ω—É—é—Ç—å —Ä—ñ–∑–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏ AWS, —Ç–∞–∫—ñ —è–∫ AWS Lambda, Amazon S3, Amazon DynamoDB —Ç–∞ –±–∞–≥–∞—Ç–æ —ñ–Ω—à–∏—Ö, —É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –∫—Ä–æ–∫—ñ–≤. –¶–µ–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü—ñ–π–Ω–∏–π —Å–µ—Ä–≤—ñ—Å –Ω–∞–¥–∞—î –≤—ñ–∑—É–∞–ª—å–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–æ–±–æ—á–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É —Ç–∞ –ø—Ä–æ–ø–æ–Ω—É—î –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ **state machine**, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –≤–∞–º –≤–∏–∑–Ω–∞—á–∞—Ç–∏ –∫–æ–∂–µ–Ω –∫—Ä–æ–∫ —Ä–æ–±–æ—á–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–∏–º —á–∏–Ω–æ–º, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ JSON-–æ—Å–Ω–æ–≤–Ω—É **Amazon States Language** (ASL).

AWS Step Functions —Å–ø—Ä–æ—â—É—î –ø—Ä–æ—Ü–µ—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç—ñ–π–∫–∏—Ö —Ç–∞ –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤, –∫–µ—Ä—É—é—á–∏ –ø—ñ–¥–ª–µ–≥–ª–æ—é —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é, –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–±—Ä–æ–±–ª—è—é—á–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ñ —Å–ø—Ä–æ–±–∏, –ø–æ–º–∏–ª–∫–∏ —Ç–∞ –ø–∞—Ä–∞–ª–µ–ª—å–Ω—É –æ–±—Ä–æ–±–∫—É. –í—ñ–Ω –æ—Å–æ–±–ª–∏–≤–æ –∫–æ—Ä–∏—Å–Ω–∏–π –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–∏—Ö —Ä–æ–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤, —â–æ –≤–∫–ª—é—á–∞—é—Ç—å –∫—ñ–ª—å–∫–∞ –∫—Ä–æ–∫—ñ–≤ —Ç–∞ —Ç–æ—á–æ–∫ –ø—Ä–∏–π–Ω—è—Ç—Ç—è —Ä—ñ—à–µ–Ω—å, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –ª–µ–≥–∫–æ –∫–µ—Ä—É—î –ø–æ—Ç–æ–∫–æ–º –¥–∞–Ω–∏—Ö —Ç–∞ —Å—Ç–∞–Ω–æ–º –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –º—ñ–∂ —Å–µ—Ä–≤—ñ—Å–∞–º–∏. –û—Å–Ω–æ–≤–Ω—ñ –≤–∏–ø–∞–¥–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü—å–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É –Ω–∞—Å—Ç—É–ø–Ω—ñ:

- **–û–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö**: –û–±—Ä–æ–±–∫–∞ —Ñ–∞–π–ª—ñ–≤, –≤—ñ–¥–µ–æ —Ç–∞ –∑–æ–±—Ä–∞–∂–µ–Ω—å; –µ–∫—Å—Ç—Ä–∞–∫—Ü—ñ—è, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (ETL) –∑–∞–≤–¥–∞–Ω—å; —Ç–∞ –ø–∞–∫–µ—Ç–Ω–∞ –æ–±—Ä–æ–±–∫–∞ —Ç–∞ —Ä–æ–±–æ—á—ñ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤–∏—Å–æ–∫–æ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å (HPC).
- **–ú–∞—à–∏–Ω–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è**: –í–∏—è–≤–ª–µ–Ω–Ω—è —à–∞—Ö—Ä–∞–π—Å—Ç–≤–∞, –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —Ç–∞ –∑–±–∞–≥–∞—á–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö.
- **–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü—ñ—è –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å—ñ–≤**: –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ –∞–±–æ —Ä–µ–∞–ª—å–Ω—ñ —Ä–æ–±–æ—á—ñ –ø—Ä–æ—Ü–µ—Å–∏ —Ç–∞ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü—ñ—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤.
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è –Ü–¢ —Ç–∞ –±–µ–∑–ø–µ–∫–∏**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è, —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —Ç–∞ —Ä–µ–∞–≥—É–≤–∞–Ω–Ω—è; —Ç–∞ –ª—é–¥—Å—å–∫–µ —Å—Ö–≤–∞–ª–µ–Ω–Ω—è —Ç–∞ –µ—Å–∫–∞–ª–∞—Ü—ñ—è.

## –û—Å–Ω–æ–≤–Ω—ñ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó

### Standard vs. Express Workflows

AWS Step Functions –ø—Ä–æ–ø–æ–Ω—É—î –¥–≤–∞ —Ç–∏–ø–∏ **state machine workflows**: Standard —Ç–∞ Express.

- **Standard Workflow**: –¶–µ–π —Ç–∏–ø —Ä–æ–±–æ—á–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –¥–æ–≤–≥–æ—Ç—Ä–∏–≤–∞–ª–∏—Ö, —Å—Ç—ñ–π–∫–∏—Ö —Ç–∞ –∞—É–¥–∏—Ç–æ—Ä—Å—å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤. –í—ñ–Ω –ø—ñ–¥—Ç—Ä–∏–º—É—î **exactly-once execution**, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω—å –ª–∏—à–µ –æ–¥–∏–Ω —Ä–∞–∑, —è–∫—â–æ –Ω–µ –≤–∫–∞–∑–∞–Ω–æ –ø–æ–≤—Ç–æ—Ä–Ω—ñ —Å–ø—Ä–æ–±–∏. –Ü–¥–µ–∞–ª—å–Ω–æ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è —Ä–æ–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤, —â–æ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ—ó —ñ—Å—Ç–æ—Ä—ñ—ó –≤–∏–∫–æ–Ω–∞–Ω–Ω—è, —Ç–∞ –º–æ–∂–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –¥–æ –æ–¥–Ω–æ–≥–æ —Ä–æ–∫—É.
- **Express Workflow**: –¶–µ–π —Ç–∏–ø —ñ–¥–µ–∞–ª—å–Ω–æ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –∑–∞–≤–¥–∞–Ω—å –∑ –≤–∏—Å–æ–∫–∏–º –æ–±—Å—è–≥–æ–º —Ç–∞ –∫–æ—Ä–æ—Ç–∫–æ—é —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—é, —â–æ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –¥–æ –ø'—è—Ç–∏ —Ö–≤–∏–ª–∏–Ω. –í–æ–Ω–∏ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å **at-least-once execution**, –ø—ñ–¥—Ö–æ–¥—è—Ç—å –¥–ª—è —ñ–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å, —Ç–∞–∫–∏—Ö —è–∫ –æ–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö. –¶—ñ —Ä–æ–±–æ—á—ñ –ø—Ä–æ—Ü–µ—Å–∏ –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω—ñ –¥–ª—è –≤–∞—Ä—Ç–æ—Å—Ç—ñ —Ç–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ, —Å—Ç—è–≥—É—é—á–∏ –ø–ª–∞—Ç—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–∏–∫–æ–Ω–∞–Ω—å, —Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ.

### States

States —î –æ—Å–Ω–æ–≤–Ω–∏–º–∏ –æ–¥–∏–Ω–∏—Ü—è–º–∏ state machines. –í–æ–Ω–∏ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å –æ–∫—Ä–µ–º—ñ –∫—Ä–æ–∫–∏ –≤ —Ä–æ–±–æ—á–æ–º—É –ø—Ä–æ—Ü–µ—Å—ñ, –∑–¥–∞—Ç–Ω—ñ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å–≤–æ–≥–æ —Ç–∏–ø—É:

- **Task:** –í–∏–∫–æ–Ω—É—î –∑–∞–≤–¥–∞–Ω–Ω—è, —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Å–µ—Ä–≤—ñ—Å AWS, —Ç–∞–∫–∏–π —è–∫ Lambda.
- **Choice:** –ü—Ä–∏–π–º–∞—î —Ä—ñ—à–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö.
- **Fail/Succeed:** –ó–∞–≤–µ—Ä—à—É—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑ –ø–æ–º–∏–ª–∫–æ—é –∞–±–æ —É—Å–ø—ñ—Ö–æ–º.
- **Pass:** –ü–µ—Ä–µ–¥–∞—î –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –Ω–∞ –≤–∏—Ö—ñ–¥ –∞–±–æ –≤–≤–æ–¥–∏—Ç—å –¥–∞–Ω—ñ.
- **Wait:** –ó–∞—Ç—Ä–∏–º—É—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–∞ –ø–µ–≤–Ω–∏–π —á–∞—Å.
- **Parallel:** –Ü–Ω—ñ—Ü—ñ—é—î –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ñ –≥—ñ–ª–∫–∏.
- **Map:** –î–∏–Ω–∞–º—ñ—á–Ω–æ —ñ—Ç–µ—Ä—É—î –∫—Ä–æ–∫–∏ –Ω–∞–¥ –µ–ª–µ–º–µ–Ω—Ç–∞–º–∏.

### Task

**Task** state –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î —Å–æ–±–æ—é –æ–¥–∏–Ω–∏—Ü—é —Ä–æ–±–æ—Ç–∏, —è–∫—É –≤–∏–∫–æ–Ω—É—î state machine. –ó–∞–≤–¥–∞–Ω–Ω—è –º–æ–∂—É—Ç—å –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏, –≤–∫–ª—é—á–∞—é—á–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ, Lambda —Ñ—É–Ω–∫—Ü—ñ—ó, —Å–µ—Ä–≤—ñ—Å–∏ AWS –∞–±–æ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ API.

- **Activities**: –ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ —Ä–æ–±—ñ—Ç–Ω–∏–∫–∏, —è–∫–∏–º–∏ –≤–∏ –∫–µ—Ä—É—î—Ç–µ, –ø—ñ–¥—Ö–æ–¥—è—Ç—å –¥–ª—è –¥–æ–≤–≥–æ—Ç—Ä–∏–≤–∞–ª–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤.
- –†–µ—Å—É—Ä—Å: **`arn:aws:states:region:account:activity:name`**.
- **Lambda Functions**: –í–∏–∫–æ–Ω—É—î —Ñ—É–Ω–∫—Ü—ñ—ó AWS Lambda.
- –†–µ—Å—É—Ä—Å: **`arn:aws:lambda:region:account:function:function-name`**.
- **AWS Services**: –Ü–Ω—Ç–µ–≥—Ä—É—î—Ç—å—Å—è –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑ —ñ–Ω—à–∏–º–∏ —Å–µ—Ä–≤—ñ—Å–∞–º–∏ AWS, —Ç–∞–∫–∏–º–∏ —è–∫ DynamoDB –∞–±–æ S3.
- –†–µ—Å—É—Ä—Å: **`arn:partition:states:region:account:servicename:APIname`**.
- **HTTP Task**: –í–∏–∫–ª–∏–∫–∞—î —Å—Ç–æ—Ä–æ–Ω–Ω—ñ API.
- –ü–æ–ª–µ —Ä–µ—Å—É—Ä—Å—É: **`arn:aws:states:::http:invoke`**. –ü–æ—Ç—ñ–º –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –Ω–∞–¥–∞—Ç–∏ –¥–µ—Ç–∞–ª—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –∫—ñ–Ω—Ü–µ–≤–æ—ó —Ç–æ—á–∫–∏ API, —Ç–∞–∫—ñ —è–∫ URL API, –º–µ—Ç–æ–¥ —Ç–∞ –¥–µ—Ç–∞–ª—ñ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó.

–ù–∞—Å—Ç—É–ø–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –ø–æ–∫–∞–∑—É—î –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è Task state, —è–∫–µ –≤–∏–∫–ª–∏–∫–∞—î Lambda —Ñ—É–Ω–∫—Ü—ñ—é –ø—ñ–¥ –Ω–∞–∑–≤–æ—é HelloWorld:
```json
"HelloWorld": {
"Type": "Task",
"Resource": "arn:aws:states:::lambda:invoke",
"Parameters": {
"Payload.$": "$",
"FunctionName": "arn:aws:lambda:<region>:<account-id>:function:HelloWorld"
},
"End": true
}
```
### Choice

**Choice** —Å—Ç–∞–Ω –¥–æ–¥–∞—î —É–º–æ–≤–Ω—É –ª–æ–≥—ñ–∫—É –¥–æ —Ä–æ–±–æ—á–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –ø—Ä–∏–π–º–∞—Ç–∏ —Ä—ñ—à–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö. –í—ñ–Ω –æ—Ü—ñ–Ω—é—î –≤–∫–∞–∑–∞–Ω—ñ —É–º–æ–≤–∏ —Ç–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –¥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–≥–æ —Å—Ç–∞–Ω—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.

- **Comparison**: –ö–æ–∂–Ω–µ –ø—Ä–∞–≤–∏–ª–æ –≤–∏–±–æ—Ä—É –≤–∫–ª—é—á–∞—î –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **`NumericEquals`**, **`StringEquals`**), —è–∫–∏–π –ø–æ—Ä—ñ–≤–Ω—é—î –≤—Ö—ñ–¥–Ω—É –∑–º—ñ–Ω–Ω—É –∑ –≤–∫–∞–∑–∞–Ω–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º –∞–±–æ —ñ–Ω—à–æ—é –∑–º—ñ–Ω–Ω–æ—é.
- **Next Field**: –°—Ç–∞–Ω –≤–∏–±–æ—Ä—É –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î –ø–æ–ª–µ **`End`**, –Ω–∞—Ç–æ–º—ñ—Å—Ç—å –≤–æ–Ω–∏ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å —Å—Ç–∞–Ω **`Next`**, –¥–æ —è–∫–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç—å, —è–∫—â–æ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —î —ñ—Å—Ç–∏–Ω–Ω–∏–º.

–ü—Ä–∏–∫–ª–∞–¥ —Å—Ç–∞–Ω—É **Choice**:
```json
{
"Variable": "$.timeStamp",
"TimestampEquals": "2000-01-01T00:00:00Z",
"Next": "TimeState"
}
```
### Fail/Succeed

–°—Ç–∞–Ω **`Fail`** –∑—É–ø–∏–Ω—è—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è state machine —ñ –ø–æ–∑–Ω–∞—á–∞—î –π–æ–≥–æ —è–∫ –Ω–µ–≤–¥–∞–ª–µ. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤–∫–∞–∑—ñ–≤–∫–∏ —ñ–º–µ–Ω—ñ –ø–æ–º–∏–ª–∫–∏ —Ç–∞ –ø—Ä–∏—á–∏–Ω–∏, –Ω–∞–¥–∞—é—á–∏ –¥–µ—Ç–∞–ª—ñ –ø—Ä–æ –Ω–µ–≤–¥–∞—á—É. –¶–µ–π —Å—Ç–∞–Ω —î —Ç–µ—Ä–º—ñ–Ω–∞–ª—å–Ω–∏–º, —Ç–æ–±—Ç–æ –∑–∞–≤–µ—Ä—à—É—î –ø–æ—Ç—ñ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.

–°—Ç–∞–Ω **`Succeed`** –∑—É–ø–∏–Ω—è—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ. –ó–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è workflow, –∫–æ–ª–∏ –≤—ñ–Ω —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è. –¶–µ–π —Å—Ç–∞–Ω –Ω–µ –ø–æ—Ç—Ä–µ–±—É—î –ø–æ–ª—è **`Next`**.

{% tabs %}

{% tab title="Fail example" %}
```json
"FailState": {
"Type": "Fail",
"Error": "ErrorName",
"Cause": "Error details"
}
```
{% endtab %}

{% tab title="Succeed example" %}
```json
"SuccessState": {
"Type": "Succeed"
}
```
{% endtab %}

{% endtabs %}

### Pass

–°—Ç–∞–Ω **Pass** –ø–µ—Ä–µ–¥–∞—î —Å–≤—ñ–π –≤—Ö—ñ–¥–Ω–∏–π —Å–∏–≥–Ω–∞–ª –Ω–∞ –≤–∏—Ö—ñ–¥–Ω–∏–π –∞–±–æ –±–µ–∑ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –±—É–¥—å-—è–∫–æ—ó —Ä–æ–±–æ—Ç–∏, –∞–±–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º—É—é—á–∏ –≤—Ö—ñ–¥–Ω–∏–π JSON —Å—Ç–∞–Ω –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—ñ–ª—å—Ç—Ä—ñ–≤, –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–¥–∞—î —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å—Ç–∞–Ω—É. –¶–µ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –ø–æ–±—É–¥–æ–≤–∏ state machines, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –≤–≤–æ–¥–∏—Ç–∏ —Å—Ç–∞—Ç–∏—á–Ω—ñ –¥–∞–Ω—ñ –∞–±–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ —ó—Ö.
```json
"PassState": {
"Type": "Pass",
"Result": {"key": "value"},
"ResultPath": "$.newField",
"Next": "NextState"
}
```
### Wait

–°—Ç–∞–Ω **Wait** –∑–∞—Ç—Ä–∏–º—É—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –º–∞—à–∏–Ω–∏ —Å—Ç–∞–Ω—ñ–≤ –Ω–∞ –≤–∫–∞–∑–∞–Ω–∏–π –ø–µ—Ä—ñ–æ–¥ —á–∞—Å—É. –Ü—Å–Ω—É—î —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ñ –º–µ—Ç–æ–¥–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —á–∞—Å—É –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è:

- **X Seconds**: –§—ñ–∫—Å–æ–≤–∞–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–µ–∫—É–Ω–¥ –¥–ª—è –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è.

```json
"WaitState": {
"Type": "Wait",
"Seconds": 10,
"Next": "NextState"
}
```

- **Absolute Timestamp**: –¢–æ—á–Ω–∏–π —á–∞—Å, –¥–æ —è–∫–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ —á–µ–∫–∞—Ç–∏.

```json
"WaitState": {
"Type": "Wait",
"Timestamp": "2024-03-14T01:59:00Z",
"Next": "NextState"
}
```

- **Dynamic Wait**: –ù–∞ –æ—Å–Ω–æ–≤—ñ –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **`SecondsPath`** –∞–±–æ **`TimestampPath`**.

```json
jsonCopiar c√≥digo
"WaitState": {
"Type": "Wait",
"TimestampPath": "$.expirydate",
"Next": "NextState"
}
```


### Parallel

–°—Ç–∞–Ω **Parallel** –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ –≥—ñ–ª–æ–∫ –∑–∞–≤–¥–∞–Ω—å –æ–¥–Ω–æ—á–∞—Å–Ω–æ —É –≤–∞—à–æ–º—É —Ä–æ–±–æ—á–æ–º—É –ø—Ä–æ—Ü–µ—Å—ñ. –ö–æ–∂–Ω–∞ –≥—ñ–ª–∫–∞ –ø—Ä–∞—Ü—é—î –Ω–µ–∑–∞–ª–µ–∂–Ω–æ —ñ –æ–±—Ä–æ–±–ª—è—î —Å–≤–æ—é –≤–ª–∞—Å–Ω—É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å —Å—Ç–∞–Ω—ñ–≤. –í–∏–∫–æ–Ω–∞–Ω–Ω—è —á–µ–∫–∞—î, –ø–æ–∫–∏ –≤—Å—ñ –≥—ñ–ª–∫–∏ –Ω–µ –∑–∞–≤–µ—Ä—à–∞—Ç—å—Å—è, –ø–µ—Ä—à –Ω—ñ–∂ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å—Ç–∞–Ω—É. –û—Å–Ω–æ–≤–Ω—ñ –ø–æ–ª—è:

- **Branches**: –ú–∞—Å–∏–≤, —â–æ –≤–∏–∑–Ω–∞—á–∞—î —à–ª—è—Ö–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è. –ö–æ–∂–Ω–∞ –≥—ñ–ª–∫–∞ —î –æ–∫—Ä–µ–º–æ—é –º–∞—à–∏–Ω–æ—é —Å—Ç–∞–Ω—ñ–≤.
- **ResultPath**: –í–∏–∑–Ω–∞—á–∞—î, –¥–µ (—É –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö) —Ä–æ–∑–º—ñ—Å—Ç–∏—Ç–∏ –æ–±'—î–¥–Ω–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥—ñ–ª–æ–∫.
- **Retry and Catch**: –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫ –¥–ª—è —Å—Ç–∞–Ω—É parallel.
```json
"ParallelState": {
"Type": "Parallel",
"Branches": [
{
"StartAt": "Task1",
"States": { ... }
},
{
"StartAt": "Task2",
"States": { ... }
}
],
"Next": "NextState"
}
```
### Map

**Map** —Å—Ç–∞–Ω –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –Ω–∞–±—ñ—Ä –∫—Ä–æ–∫—ñ–≤ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ –≤ –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö. –ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, —è–∫ –≤–∏ —Ö–æ—á–µ—Ç–µ –æ–±—Ä–æ–±–ª—è—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç–∏ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö, Step Functions –Ω–∞–¥–∞—î –Ω–∞—Å—Ç—É–ø–Ω—ñ —Ä–µ–∂–∏–º–∏:

- **Inline Mode**: –í–∏–∫–æ–Ω—É—î –ø—ñ–¥–º–Ω–æ–∂–∏–Ω—É —Å—Ç–∞–Ω—ñ–≤ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ JSON –º–∞—Å–∏–≤—É. –ü—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –º–∞–ª–æ–º–∞—Å—à—Ç–∞–±–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å –∑ –º–µ–Ω—à –Ω—ñ–∂ 40 –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏–º–∏ —ñ—Ç–µ—Ä–∞—Ü—ñ—è–º–∏, –≤–∏–∫–æ–Ω—É—é—á–∏ –∫–æ–∂–Ω—É –∑ –Ω–∏—Ö –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ —Ä–æ–±–æ—á–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É, —â–æ –º—ñ—Å—Ç–∏—Ç—å —Å—Ç–∞–Ω **`Map`**.

```json
"MapState": {
"Type": "Map",
"ItemsPath": "$.arrayItems",
"ItemProcessor": {
"ProcessorConfig": {
"Mode": "INLINE"
},
"StartAt": "AddState",
"States": {
"AddState": {
"Type": "Task",
"Resource": "arn:aws:states:::lambda:invoke",
"OutputPath": "$.Payload",
"Parameters": {
"FunctionName": "arn:aws:lambda:<region>:<account-id>:function:add-function"
},
"End": true
}
}
},
"End": true
"ResultPath": "$.detail.added",
"ItemsPath": "$.added"
}
```

- **Distributed Mode**: –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –≤–µ–ª–∏–∫–æ–º–∞—Å—à—Ç–∞–±–Ω–æ—ó –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –∑ –≤–∏—Å–æ–∫–æ—é –æ–¥–Ω–æ—á–∞—Å–Ω—ñ—Å—Ç—é. –ü—ñ–¥—Ç—Ä–∏–º—É—î –æ–±—Ä–æ–±–∫—É –≤–µ–ª–∏–∫–∏—Ö –Ω–∞–±–æ—Ä—ñ–≤ –¥–∞–Ω–∏—Ö, —Ç–∞–∫–∏—Ö —è–∫ —Ç—ñ, —â–æ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ Amazon S3, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –≤–∏—Å–æ–∫—É –æ–¥–Ω–æ—á–∞—Å–Ω—ñ—Å—Ç—å –¥–æ 10,000 –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –≤–∏–∫–æ–Ω–∞–Ω—å –¥–æ—á—ñ—Ä–Ω—ñ—Ö —Ä–æ–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤, –≤–∏–∫–æ–Ω—É—é—á–∏ —Ü—ñ –¥–æ—á—ñ—Ä–Ω—ñ —è–∫ –æ–∫—Ä–µ–º—ñ –¥–æ—á—ñ—Ä–Ω—ñ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.

```json
"DistributedMapState": {
"Type": "Map",
"ItemReader": {
"Resource": "arn:aws:states:::s3:getObject",
"Parameters": {
"Bucket": "my-bucket",
"Key": "data.csv"
}
},
"ItemProcessor": {
"ProcessorConfig": {
"Mode": "DISTRIBUTED",
"ExecutionType": "EXPRESS"
},
"StartAt": "ProcessItem",
"States": {
"ProcessItem": {
"Type": "Task",
"Resource": "arn:aws:lambda:region:account-id:function:my-function",
"End": true
}
}
},
"End": true
"ResultWriter": {
"Resource": "arn:aws:states:::s3:putObject",
"Parameters": {
"Bucket": "myOutputBucket",
"Prefix": "csvProcessJobs"
}
}
}
```


### Versions and aliases

Step Functions —Ç–∞–∫–æ–∂ –¥–æ–∑–≤–æ–ª—è—î –∫–µ—Ä—É–≤–∞—Ç–∏ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è–º —Ä–æ–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **versions** —Ç–∞ **aliases** —Å—Ç–∞–Ω—ñ–≤ –º–∞—à–∏–Ω. –í–µ—Ä—Å—ñ—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –∑–Ω—ñ–º–æ–∫ —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏, —è–∫–∏–π –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏. –ê–ª—ñ–∞—Å–∏ —Å–ª—É–∂–∞—Ç—å –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞–º–∏ –Ω–∞ –¥–æ –¥–≤–æ—Ö –≤–µ—Ä—Å—ñ–π —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏.

- **Versions**: –¶—ñ –Ω–µ–∑–º—ñ–Ω–Ω—ñ –∑–Ω—ñ–º–∫–∏ —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏ —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è –∑ –Ω–∞–π–Ω–æ–≤—ñ—à–æ—ó —Ä–µ–≤—ñ–∑—ñ—ó —Ü—ñ—î—ó –º–∞—à–∏–Ω–∏. –ö–æ–∂–Ω–∞ –≤–µ—Ä—Å—ñ—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î—Ç—å—Å—è —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º ARN, —è–∫–∏–π –ø–æ—î–¥–Ω—É—î ARN —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏ –∑ –Ω–æ–º–µ—Ä–æ–º –≤–µ—Ä—Å—ñ—ó, —Ä–æ–∑–¥—ñ–ª–µ–Ω–∏–º –¥–≤–æ–∫—Ä–∞–ø–∫–æ—é (**`arn:aws:states:region:account-id:stateMachine:StateMachineName:version-number`**). –í–µ—Ä—Å—ñ—ó –Ω–µ –º–æ–∂–Ω–∞ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏, –∞–ª–µ –≤–∏ –º–æ–∂–µ—Ç–µ –æ–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞–Ω –º–∞—à–∏–Ω–∏ —Ç–∞ –æ–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±–∞–∂–∞–Ω—É –≤–µ—Ä—Å—ñ—é —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏.
- **Aliases**: –¶—ñ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –ø–æ—Å–∏–ª–∞—Ç–∏—Å—è –Ω–∞ –¥–æ –¥–≤–æ—Ö –≤–µ—Ä—Å—ñ–π –æ–¥–Ω—ñ—î—ó —ñ —Ç—ñ—î—ó –∂ —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏. –ú–æ–∂–Ω–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ –∞–ª—ñ–∞—Å—ñ–≤ –¥–ª—è –æ–¥–Ω—ñ—î—ó —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏, –∫–æ–∂–µ–Ω –∑ —è–∫–∏—Ö —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î—Ç—å—Å—è —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º ARN, —Å—Ç–≤–æ—Ä–µ–Ω–∏–º —à–ª—è—Ö–æ–º –ø–æ—î–¥–Ω–∞–Ω–Ω—è ARN —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏ –∑ —ñ–º'—è–º –∞–ª—ñ–∞—Å–∞, —Ä–æ–∑–¥—ñ–ª–µ–Ω–∏–º –¥–≤–æ–∫—Ä–∞–ø–∫–æ—é (**`arn:aws:states:region:account-id:stateMachine:StateMachineName:aliasName`**). –ê–ª—ñ–∞—Å–∏ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –º–∞—Ä—à—Ä—É—Ç–∏–∑—É–≤–∞—Ç–∏ —Ç—Ä–∞—Ñ—ñ–∫ –º—ñ–∂ –æ–¥–Ω—ñ—î—é –∑ –¥–≤–æ—Ö –≤–µ—Ä—Å—ñ–π —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ, –∞–ª—ñ–∞—Å –º–æ–∂–µ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ –æ–¥–Ω—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É –≤–µ—Ä—Å—ñ—é —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏, –∞–ª–µ –Ω–µ –Ω–∞ —ñ–Ω—à—ñ –∞–ª—ñ–∞—Å–∏. –á—Ö –º–æ–∂–Ω–∞ –æ–Ω–æ–≤–∏—Ç–∏ –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ —ñ–Ω—à—É –≤–µ—Ä—Å—ñ—é —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏ –∑–∞ –ø–æ—Ç—Ä–µ–±–∏, –ø–æ–ª–µ–≥—à—É—é—á–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω—ñ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–æ–±–æ—á–∏–º–∏ –ø—Ä–æ—Ü–µ—Å–∞–º–∏.

–î–ª—è –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ **ASL**, –¥–∏–≤—ñ—Ç—å—Å—è: [**Amazon States Language**](https://states-language.net/spec.html).



## IAM Roles for State machines

AWS Step Functions –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î AWS Identity and Access Management (IAM) —Ä–æ–ª—ñ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤ —Ç–∞ –¥—ñ–π —É –º–µ–∂–∞—Ö —Å—Ç–∞–Ω—ñ–≤ –º–∞—à–∏–Ω. –û—Å—å –∫–ª—é—á–æ–≤—ñ –∞—Å–ø–µ–∫—Ç–∏, –ø–æ–≤'—è–∑–∞–Ω—ñ –∑ –±–µ–∑–ø–µ–∫–æ—é —Ç–∞ IAM —Ä–æ–ª—è–º–∏ –≤ AWS Step Functions:

- **Execution Role**: –ö–æ–∂–Ω–∞ —Å—Ç–∞–Ω –º–∞—à–∏–Ω–∞ –≤ AWS Step Functions –∞—Å–æ—Ü—ñ—é—î—Ç—å—Å—è –∑ IAM —Ä–æ–ª–ª—é –≤–∏–∫–æ–Ω–∞–Ω–Ω—è. –¶—è —Ä–æ–ª—å –≤–∏–∑–Ω–∞—á–∞—î, —è–∫—ñ –¥—ñ—ó —Å—Ç–∞–Ω –º–∞—à–∏–Ω–∞ –º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –≤—ñ–¥ –≤–∞—à–æ–≥–æ —ñ–º–µ–Ω—ñ. –ö–æ–ª–∏ —Å—Ç–∞–Ω –º–∞—à–∏–Ω–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –º—ñ–∂ —Å—Ç–∞–Ω–∞–º–∏, —â–æ –≤–∑–∞—î–º–æ–¥—ñ—é—Ç—å –∑ AWS —Å–µ—Ä–≤—ñ—Å–∞–º–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏–∫–ª–∏–∫ —Ñ—É–Ω–∫—Ü—ñ–π Lambda, –¥–æ—Å—Ç—É–ø –¥–æ DynamoDB —Ç–æ—â–æ), –≤–æ–Ω–∞ –ø—Ä–∏–π–º–∞—î —Ü—é —Ä–æ–ª—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü–∏—Ö –¥—ñ–π.
- **Permissions**: IAM —Ä–æ–ª—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞ –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏, —è–∫—ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥—ñ—ó –Ω–∞ —ñ–Ω—à–∏—Ö AWS —Å–µ—Ä–≤—ñ—Å–∞—Ö. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –≤–∞—à–∞ —Å—Ç–∞–Ω –º–∞—à–∏–Ω–∞ –ø–æ–≤–∏–Ω–Ω–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó AWS Lambda, IAM —Ä–æ–ª—å –ø–æ–≤–∏–Ω–Ω–∞ –º–∞—Ç–∏ –¥–æ–∑–≤–æ–ª–∏ **`lambda:InvokeFunction`**. –ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ, —è–∫—â–æ –≤–æ–Ω–∞ –ø–æ–≤–∏–Ω–Ω–∞ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ –≤ DynamoDB, –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –Ω–∞–¥–∞–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –¥–æ–∑–≤–æ–ª–∏ (**`dynamodb:PutItem`**, **`dynamodb:UpdateItem`** —Ç–æ—â–æ).
- **Least Privilege**: –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –¥–æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏—Å—è –ø—Ä–∏–Ω—Ü–∏–ø—É –Ω–∞–π–º–µ–Ω—à–∏—Ö –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –ø—Ä–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—ñ IAM —Ä–æ–ª–µ–π –¥–ª—è Step Functions. –¶–µ –æ–∑–Ω–∞—á–∞—î –Ω–∞–¥–∞–Ω–Ω—è –ª–∏—à–µ —Ç–∏—Ö –¥–æ–∑–≤–æ–ª—ñ–≤, —è–∫—ñ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –¥—ñ–π —Å—Ç–∞–Ω –º–∞—à–∏–Ω–∏, —ñ –Ω–µ –±—ñ–ª—å—à–µ. IAM –ø–æ–ª—ñ—Ç–∏–∫–∏ –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –æ–±–º–µ–∂–µ–Ω—ñ –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ —Ç–∞ –¥—ñ–π, –∑–º–µ–Ω—à—É—é—á–∏ —Ä–∏–∑–∏–∫ –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É.

## Enumeration

ReadOnlyAccess –ø–æ–ª—ñ—Ç–∏–∫–∞ –¥–æ—Å—Ç–∞—Ç–Ω—è –¥–ª—è –≤—Å—ñ—Ö –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –¥—ñ–π –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–Ω–Ω—è.
```bash
# State machines #

## List state machines
aws stepfunctions list-state-machines
## Retrieve informatio about the specified state machine
aws stepfunctions describe-state-machine --state-machine-arn <value>

## List verions for the specified state machine
aws stepfunctions list-state-machine-versions --state-machine-arn <value>
## List aliases for the specified state machine
aws stepfunctions list-state-machine-aliases --state-machine-arn <value>
## Retrieve informatio about the specified state machine alias
aws stepfunctions describe-state-machine-alias --state-machine-alias-arn <value>

## List executions of a state machine
aws stepfunctions list-executions --state-machine-arn <value> [--status-filter <RUNNING | SUCCEEDED | FAILED | TIMED_OUT | ABORTED | PENDING_REDRIVE>] [--redrive-filter <REDRIVEN | NOT_REDRIVEN>]
## Retrieve information and relevant metadata about a state machine execution
aws stepfunctions describe-execution --execution-arn <value>
## Retrieve information about the state machine associated to the specified execution
aws stepfunctions describe-state-machine-for-execution --execution-arn <value>
## Retrieve the history of the specified execution as a list of events
aws stepfunctions get-execution-history --execution-arn <value> [--reverse-order | --no-reverse-order] [--include-execution-data | --no-include-execution-data]

## List tags for the specified Ste Functions resource
aws stepfunctions list-tags-for-resource --resource-arn <value>

## Validate the definition of a state machine without creating the resource
aws stepfunctions validate-state-machine-definition --definition <value> [--type <STANDARD | EXPRESS>]

# Activities #

## List existing activities
aws stepfunctions list-activities
## Retrieve information about the specified activity
aws stepfunctions describe-activity --activity-arn <value>

# Map Runs #

## List map runs of an execution
aws stepfunctions list-map-runs --execution-arn <value>
## Provide information about the configuration, progress and results of a Map Run
aws stepfunctions describe-map-run --map-run-arn <value>
## Lists executions of a Map Run
aws stepfunctions list-executions --map-run-arn <value> [--status-filter <RUNNING | SUCCEEDED | FAILED | TIMED_OUT | ABORTED | PENDING_REDRIVE>] [--redrive-filter <REDRIVEN | NOT_REDRIVEN>]
```
## Privesc

–ù–∞ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫ **–∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –¥–æ–∑–≤–æ–ª–∞–º–∏ Step Functions –¥–ª—è –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤**:

{% content-ref url="../aws-privilege-escalation/aws-stepfunctions-privesc.md" %}
[aws-stepfunctions-privesc.md](../aws-privilege-escalation/aws-stepfunctions-privesc.md)
{% endcontent-ref %}

## Post Exploitation

{% content-ref url="../aws-post-exploitation/aws-stepfunctions-post-exploitation/" %}
[aws-stepfunctions-post-exploitation](../aws-post-exploitation/aws-stepfunctions-post-exploitation/)
{% endcontent-ref %}

# References

* [https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsstepfunctions.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsstepfunctions.html)
* [https://docs.aws.amazon.com/step-functions/latest/dg/welcome.html](https://docs.aws.amazon.com/step-functions/latest/dg/welcome.html)
* [https://states-language.net/spec.html](https://states-language.net/spec.html)

{% hint style="success" %}
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ –Ω–∞–º–∏** —É **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –ø–æ–¥–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
