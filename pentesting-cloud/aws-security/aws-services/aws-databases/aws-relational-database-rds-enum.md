# AWS - Απαρίθμηση Σχεσιακής Βάσης Δεδομένων (RDS)

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο Hacking του AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Εκπαίδευση HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο Hacking του GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Εκπαίδευση HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε** στην 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Κοινοποιήστε κόλπα χάκερ με την υποβολή PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια στο github.

</details>
{% endhint %}

## Βασικές Πληροφορίες

Η υπηρεσία **Relational Database Service (RDS)** που προσφέρεται από το AWS σχεδιάστηκε για να διευκολύνει την ανάπτυξη, λειτουργία και κλιμάκωση μιας **σχεσιακής βάσης δεδομένων στο cloud**. Αυτή η υπηρεσία προσφέρει τα πλεονεκτήματα της οικονομικής αποδοτικότητας και της κλιμάκωσης ενώ αυτοματοποιεί εργασίες που απαιτούν πολύ χρόνο όπως η παροχή υλικού, η ρύθμιση της βάσης δεδομένων, η ενημέρωση και η δημιουργία αντιγράφων ασφαλείας.

Το AWS RDS υποστηρίζει διάφορους δημοφιλείς μηχανές σχεσιακών βάσεων δεδομένων, συμπεριλαμβανομένων των MySQL, PostgreSQL, MariaDB, Oracle Database, Microsoft SQL Server και Amazon Aurora, με συμβατότητα τόσο για MySQL όσο και για PostgreSQL.

Τα βασικά χαρακτηριστικά του RDS περιλαμβάνουν:

- Η **διαχείριση των περιπτώσεων βάσης δεδομένων** είναι απλοποιημένη.
- Δημιουργία **αντιγράφων για ανάγνωση** για βελτίωση της απόδοσης ανάγνωσης.
- Ρύθμιση **αναπτυγμένων αντιγράφων σε πολλές ζώνες διαθεσιμότητας (AZ)** για να διασφαλιστεί η υψηλή διαθεσιμότητα και οι μηχανισμοί ανακατεύθυνσης.
- **Ενσωμάτωση** με άλλες υπηρεσίες του AWS, όπως:
- AWS Identity and Access Management (**IAM**) για ανθεκτικό έλεγχο πρόσβασης.
- AWS **CloudWatch** για περιεκτική παρακολούθηση και μετρήσεις.
- AWS Key Management Service (**KMS**) για τη διασφάλιση της κρυπτογράφησης στην ανάπαυση.

## Διαπιστευτήρια

Κατά τη δημιουργία του συστήματος βάσης δεδομένων, το κύριο **όνομα χρήστη** μπορεί να ρυθμιστεί (**`admin`** από προεπιλογή). Για τη δημιουργία του κωδικού πρόσβασης αυτού του χρήστη μπορείτε:

* **Να δηλώσετε** έναν **κωδικό πρόσβασης** μόνοι σας
* Να πείτε στο RDS να τον **δημιουργήσει αυτόματα**
* Να πείτε στο RDS να το διαχειριστεί στο **AWS Secret Manager** κρυπτογραφημένο με ένα KMS κλειδί

<figure><img src="../../../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

### Ταυτοποίηση

Υπάρχουν 3 επιλογές ταυτοποίησης, αλλά η χρήση του **κύριου κωδικού πρόσβασης είναι πάντα επιτρεπόμενη**:

<figure><img src="../../../../.gitbook/assets/image (19) (2).png" alt=""><figcaption></figcaption></figure>

### Δημόσια Πρόσβαση & VPC

Από προεπιλογή **δεν χορηγείται δημόσια πρόσβαση** στις βάσεις δεδομένων, ωστόσο **θα μπορούσε να χορηγηθεί**. Επομένως, από προεπιλογή μόνο μηχανές από την ίδια VPC θα μπορούν να έχουν πρόσβαση εάν το επιλεγμένο **ομάδα ασφαλείας** (αποθηκεύονται στο EC2 SG) το επιτρέπει.

Αντί να εκθέτετε μια περίπτωση βάσης δεδομένων, είναι δυνατό να δημιουργήσετε ένα **RDS Proxy** το οποίο **βελτιώνει** τη **κλιμάκωση** και τη **διαθεσιμότητα** του συστήματος βάσης δεδομένων.

Επιπλέον, η **θύρα βάσης δεδομένων μπορεί να τροποποιηθεί** επίσης.

### Κρυπτογράφηση

Η **κρυπτογράφηση είναι ενεργοποιημένη από προεπιλογή** χρησιμοποιώντας ένα διαχειριζόμενο κλειδί AWS (θα μπορούσε να επιλεγεί ένα CMK αντί αυτού).

Με την ενεργοποίηση της κρυπτογράφησης, ενεργοποιείτε τη **κρυπτογράφηση στην ανάπαυση για την αποθήκευση, τα αντίγραφα ασφαλείας, τα αντίγραφα για ανάγνωση και τα αντίγραφα ασφαλείας**. Τα κλειδιά για τη διαχείριση αυτής της κρυπτογράφησης μπορούν να εκδοθούν χρησιμοποιώντας το **KMS**.\
Δεν είναι δυνατό να προστεθεί αυτό το επίπεδο κρυπτογράφησης μετά τη δημιουργία της βάσης δεδομένων σας. **Πρέπει να γίνει κατά τη δημιουργία της**.

Ωστόσο, υπάρχει ένας **τρόπος εργασίας που σας επιτρέπει να κρυπτογραφήσετε μια μη κρυπτογραφημένη βάση δεδομένων ως εξής**. Μπορείτε να δημιουργήσετε ένα αντίγραφο ασφαλείας της μη κρυπτογραφημένης βάσης δεδομένων σας, να δημιουργήσετε ένα κρυπτογραφημένο αντίγραφο αυτού του αντιγράφου ασφαλείας, να χρησιμοποιήσετε αυτό το κρυπτογραφημένο αντίγραφο ασφαλείας για να δημιουργήσετε μια νέα βάση δεδομένων και στη συνέχεια, τελικά, η βάση δεδομένων σας θα είναι κρυπτογραφημένη.

#### Διαφανής Κρυπτογράφηση Δεδομένων (TDE)

Παράλληλα με τις δυνατότητες κρυπτογράφησης που είναι ενσωματωμένες στο RDS στο επίπεδο εφαρμογής, το RDS υποστηρίζει επίσης **επιπλέον μηχανισμούς κρυπτογράφησης στο επίπεδο πλατφόρμας** για την προστασία δεδομένων στην ανάπαυση. Αυτό περιλαμβάνει τη **Διαφανή Κρυπτογράφηση Δεδομένων (TDE)** για Oracle και SQL Server. Ωστόσο, είναι κρίσιμο να σημειωθεί ότι ενώ η TDE βελτιώνει την ασφάλεια με την κρυπτογράφηση δεδομένων στην ανάπαυση, ενδέχεται επίσης να **επηρεάσει την απόδοση της βάσης δεδομένων**. Αυτή η επίδραση στην απόδοση είναι ιδιαίτερα εμφανής όταν χρησιμοποιείται σε συνδυασμό με κρυπτογραφικές λειτουργίες MySQL ή λειτουργίες κρυπτογράφησης Microsoft Transact-SQL.

Για να χρησιμοποιήσετε την TDE, απαιτούντ
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### Μη εξουσιοδοτημένη πρόσβαση

{% content-ref url="../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### Ανύψωση δικαιωμάτων

{% content-ref url="../../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### Μετά από εκμετάλλευση

{% content-ref url="../../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### Διατήρηση

{% content-ref url="../../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### Εισβολή SQL

Υπάρχουν τρόποι για πρόσβαση στα δεδομένα DynamoDB με **σύνταξη SQL**, επομένως, είναι εφικτές και οι κλασικές **εισβολές SQL**.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο Hacking του AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Εκπαίδευση HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο Hacking του GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Εκπαίδευση HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε** 💬 στην ομάδα [**Discord**](https://discord.gg/hRep4RUj7f) ή στην ομάδα [**telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε κόλπα χάκινγκ υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια στο GitHub.

</details>
{% endhint %}
