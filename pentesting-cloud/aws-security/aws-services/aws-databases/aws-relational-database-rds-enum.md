# AWS - Relasionele Databasis (RDS) Enum

{% hint style="success" %}
Leer & oefen AWS Hack: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hack: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Controleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}

## Basiese Inligting

Die **Relasionele Databasisdiens (RDS)** wat deur AWS aangebied word, is ontwerp om die implementering, werking en skaalvergroting van 'n **relasionele databasis in die wolk** te stroomlyn. Hierdie diens bied die voordele van koste-effektiwiteit en skaalbaarheid terwyl dit arbeidsintensiewe take soos hardewarevoorsiening, databasiskonfigurasie, patching en rugsteun outomatiseer.

AWS RDS ondersteun verskeie algemeen gebruikte relasionele databasis-enjins insluitend MySQL, PostgreSQL, MariaDB, Oracle Database, Microsoft SQL Server, en Amazon Aurora, met verenigbaarheid vir beide MySQL en PostgreSQL.

Kernkenmerke van RDS sluit in:

- **Bestuur van databasisinstansies** is vereenvoudig.
- Skepping van **leesvervaardigings** om leesvermo√´ te verbeter.
- Konfigurasie van **multi-Beskikbaarheidsone (AZ) implementasies** om ho√´ beskikbaarheid en oorvalmeganismes te verseker.
- **Integrasie** met ander AWS-dienste, soos:
- AWS Identity and Access Management (**IAM**) vir robuuste toegangsbeheer.
- AWS **CloudWatch** vir omvattende monitering en metriese.
- AWS Key Management Service (**KMS**) om versekering by rus te verseker.


## Gelde

Wanneer die DB-kluster geskep word, kan die hoof **gebruikersnaam** gekonfigureer word (**`admin`** standaard). Om die wagwoord van hierdie gebruiker te genereer, kan jy:

* **'n wagwoord** self aandui
* S√™ vir RDS om dit **outomaties te genereer**
* S√™ vir RDS om dit te bestuur in **AWS Secret Manager** versleutel met 'n KMS-sleutel

<figure><img src="../../../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

### Verifikasie

Daar is 3 tipes verifikasie-opsies, maar die gebruik van die **hoofwagwoord is altyd toegelaat**:

<figure><img src="../../../../.gitbook/assets/image (19) (2).png" alt=""><figcaption></figcaption></figure>

### Publieke Toegang & VPC

Standaard word **geen publieke toegang verleen** tot die databasisse nie, maar dit **kan verleen word**. Daarom sal slegs masjiene van dieselfde VPC dit kan benader as die gekose **sekuriteitsgroep** (word in EC2 SG gestoor) dit toelaat.

In plaas daarvan om 'n DB-instansie bloot te stel, is dit moontlik om 'n **RDS Proxy** te skep wat die **skaalbaarheid** en **beskikbaarheid** van die DB-kluster **verbeter**.

Verder kan die **databasispoort ook gewysig** word.

### Versleuteling

**Versleuteling is standaard geaktiveer** deur 'n AWS-bestuurde sleutel (daar kan 'n CMK in plaas daarvan gekies word).

Deur jou versleuteling te aktiveer, aktiveer jy **versleuteling by rus vir jou stoor, snagskote, leesvervaardigings en jou rugsteune**. Sleutels om hierdie versleuteling te bestuur, kan uitgereik word deur **KMS** te gebruik.\
Dit is nie moontlik om hierdie vlak van versleuteling by te voeg nadat jou databasis geskep is nie. **Dit moet gedoen word tydens sy skepping**.

Daar is egter 'n **omweg wat jou toelaat om 'n onversleutelde databasis te versleutel as volg**. Jy kan 'n snagskoot van jou onversleutelde databasis skep, 'n versleutelde kopie van daardie snagskoot skep, daardie versleutelde snagskoot gebruik om 'n nuwe databasis te skep, en dan, uiteindelik, sal jou databasis dan versleutel wees.

#### Deursigtige Data Versleuteling (TDE)

Benewens die versleutelingsvermo√´nskappe inherent aan RDS op die toepassingsvlak, ondersteun RDS ook **bykomende platformvlak-versleutelingsmeganismes** om data by rus te beskerm. Dit sluit **Deursigtige Data Versleuteling (TDE)** vir Oracle en SQL Server in. Dit is egter noodsaaklik om daarop te let dat terwyl TDE die sekuriteit verbeter deur data by rus te versleutel, dit ook die databasis se prestasie kan **be√Ønvloed**. Hierdie prestasie-impak is veral merkbaar wanneer dit saam met MySQL-kriptografiese funksies of Microsoft Transact-SQL-kriptografiese funksies gebruik word.

Om TDE te gebruik, is sekere voorlopige stappe vereis:

1. **Opsiegroepassosiasie**:
- Die databasis moet geassosieer word met 'n opsiegroep. Opsiegroepe dien as houers vir instellings en kenmerke, wat databasisbestuur fasiliteer, insluitend sekuriteitsverbeterings.
- Dit is egter belangrik om daarop te let dat opsiegroepe slegs beskikbaar is vir spesifieke databasis-enjins en -weergawes.

2. **Insluiting van TDE in Opsiegroep**:
- Nadat dit geassosieer is met 'n opsiegroep, moet die Oracle Deursigtige Data Versleuteling-opsie in daardie groep ingesluit word.
- Dit is noodsaaklik om te erken dat sodra die TDE-opsie by 'n opsiegroep gevoeg word, dit 'n permanente kenmerk word en nie verwyder kan word nie.

3. **TDE Versleutelingsmodusse**:
- TDE bied twee onderskeie versleutelingsmodusse:
- **TDE Tabelruimte Versleuteling**: Hierdie modus versleutel hele tabelle, wat 'n bre√´r omvang van data beskerming bied.
- **TDE Kolomversleuteling**: Hierdie modus fokus op die versleuteling van spesifieke, individuele elemente binne die databasis, wat meer fynbeheer oor watter data versleutel word, toelaat.

Die begrip van hierdie voorvereistes en die operasionele fynhede van TDE is noodsaaklik vir die doeltreffende implementering en bestuur van versleuteling binne RDS, wat beide data-sekuriteit en voldoening aan nodige standaarde verseker.

### Enumerasie

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### Ongeverifieerde Toegang

{% content-ref url="../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### Privesc

{% content-ref url="../../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### Na Exploitatie

{% content-ref url="../../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### Volharding

{% content-ref url="../../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### SQL Injeksie

Daar is maniere om toegang tot DynamoDB-data te verkry met **SQL-sintaksis**, daarom is tipiese **SQL-injeksies ook moontlik**.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

{% hint style="success" %}
Leer & oefen AWS Hackery:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hackery: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kontroleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hack-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}
