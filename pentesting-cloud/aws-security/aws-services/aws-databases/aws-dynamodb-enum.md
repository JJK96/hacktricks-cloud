# AWS - Enumeratinga DynamoDB

{% hint style="success" %}
Jifunze & zoezi Udukuzi wa AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Mafunzo ya HackTricks ya Mtaalam wa Timu Nyekundu ya AWS (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze & zoezi Udukuzi wa GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Mafunzo ya HackTricks ya Mtaalam wa Timu Nyekundu ya GCP (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa michango**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## DynamoDB

### Taarifa Msingi

Amazon DynamoDB inapishwa na AWS kama **hifadhidata ya NoSQL ya aina ya ufunguo, bila seva, iliyosimamiwa kabisa**, iliyoundwa kwa ajili ya kuendesha programu zenye utendaji wa juu bila kujali ukubwa wao. Huduma hii inahakikisha vipengele imara ikiwa ni pamoja na hatua za usalama asilia, nakala rudufu isiyosimamishwa, nakala za moja kwa moja kwenye mikoa mingi, uwekaji wa cache ya kumbukumbu, na zana za kuuza data kwa urahisi.

Katika muktadha wa DynamoDB, badala ya kuanzisha hifadhidata ya jadi, **meza huanzishwa**. Kila meza inahitaji maelezo ya **ufunguo wa sehemu** kama sehemu muhimu ya **ufunguo wa msingi wa meza**. Ufunguo huu wa sehemu, kimsingi **thamani ya hash**, inacheza jukumu muhimu katika kupata vitu na usambazaji wa data kwenye wenyeweji mbalimbali. Usambazaji huu ni muhimu kwa kudumisha uwezo na upatikanaji wa hifadhidata. Aidha, kuna chaguo la kuingiza **ufunguo wa aina** ili kuboresha zaidi utaratibu wa data.

### Ufichaji

Kwa chaguo-msingi, DynamoDB hutumia ufunguo wa KMS ambao **unamilikiwa na Amazon DynamoDB**, hata sio ufunguo uliosimamiwa na AWS ambao angalau unamilikiwa na akaunti yako.

<figure><img src="https://lh4.googleusercontent.com/JjtNS7aA-_GRMgZb4v93jWEQJi6DQdUPq0FEpzZPdeyCeNoG05p0NJiV9Zs-ULs_-Tfjmx0W1ZgsE2Ui2ljo7D-1a87Xny-gpLVQO0XmXdFoph9ci1RepbVNwaCe9oPruEZSEDxGTxF5dIv6pW1WpT6kWA=s2048" alt=""><figcaption></figcaption></figure>

### Nakala Rudufu & Kuuza kwa S3

Inawezekana **kupanga** kizazi cha **nakala rudufu za meza** au kuziumba **kwa ombi**. Zaidi ya hayo, pia inawezekana kuwezesha **uponyaji wa wakati wa kufanya (PITR) kwa meza.** Upyaji wa wakati wa kufanya hutoa **nakala rudufu** endelevu za data yako ya DynamoDB kwa **siku 35** ili kukusaidia kulinda dhidi ya operesheni za kuandika au kufuta kwa bahati mbaya.

Pia inawezekana kuuza **data ya meza kwenda S3**, lakini meza inahitaji kuwa na **PITR imewezeshwa**.

### GUI

Kuna GUI kwa huduma za Dynamo za ndani kama [DynamoDB Local](https://aws.amazon.com/blogs/aws/dynamodb-local-for-desktop-development/), [dynalite](https://github.com/mhart/dynalite), [localstack](https://github.com/localstack/localstack), n.k, ambazo zinaweza kuwa na manufaa: [https://github.com/aaronshaf/dynamodb-admin](https://github.com/aaronshaf/dynamodb-admin)

### Urambazaji
```bash
# Tables
aws dynamodb list-tables
aws dynamodb describe-table --table-name <t_name> #Get metadata info
## The primary key and sort key will appear inside the KeySchema field

#Check if point in time recovery is enabled
aws dynamodb describe-continuous-backups \
--table-name tablename

# Backups
aws dynamodb list-backups
aws dynamodb describe-backup --backup-arn <arn>
aws dynamodb describe-continuous-backups --table-name <t_name>

# Global tables
aws dynamodb list-global-tables
aws dynamodb describe-global-table --global-table-name <name>

# Exports
aws dynamodb list-exports
aws dynamodb describe-export --export-arn <arn>

# Misc
aws dynamodb describe-endpoints #Dynamodb endpoints
```
### Upatikanaji usiothibitishwa

{% content-ref url="../../aws-unauthenticated-enum-access/aws-dynamodb-unauthenticated-access.md" %}
[aws-dynamodb-unauthenticated-access.md](../../aws-unauthenticated-enum-access/aws-dynamodb-unauthenticated-access.md)
{% endcontent-ref %}

### Privesc

{% content-ref url="../../aws-privilege-escalation/aws-dynamodb-privesc.md" %}
[aws-dynamodb-privesc.md](../../aws-privilege-escalation/aws-dynamodb-privesc.md)
{% endcontent-ref %}

### Baada ya Uvamizi

{% content-ref url="../../aws-post-exploitation/aws-dynamodb-post-exploitation.md" %}
[aws-dynamodb-post-exploitation.md](../../aws-post-exploitation/aws-dynamodb-post-exploitation.md)
{% endcontent-ref %}

### Uthabiti

{% content-ref url="../../aws-persistence/aws-dynamodb-persistence.md" %}
[aws-dynamodb-persistence.md](../../aws-persistence/aws-dynamodb-persistence.md)
{% endcontent-ref %}

## Uingizaji wa DynamoDB

### Uingizaji wa SQL

Kuna njia za kupata data ya DynamoDB na **muundo wa SQL**, kwa hivyo, **uingizaji wa SQL wa kawaida pia ni wa kawaida**.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

### Uingizaji wa NoSQL

Katika DynamoDB **masharti** tofauti yanaweza kutumika kufikia data, kama katika Uingizaji wa NoSQL wa kawaida ikiwa ni **inawezekana kuunganisha masharti zaidi** kufikia data unaweza kupata data iliyofichwa (au kudump meza nzima).\
Unaweza kupata hapa masharti yanayoungwa mkono na DynamoDB: [https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API\_Condition.html](https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API\_Condition.html)

Tambua kwamba **masharti tofauti** yanategemewa ikiwa data inafikiwa kupitia **`query`** au kupitia **`scan`**.

{% hint style="info" %}
Kwa kweli, hatua za **Utafutaji** inahitaji kutaja **masharti "EQ" (sawa)** katika ufunguo wa **msingi** ili kufanye kazi, ikifanya iwe **chini ya uwezekano wa uingizaji wa NoSQL** (na pia kufanya operesheni iwe ya kikomo sana).
{% endhint %}

Ikiwa unaweza **kubadilisha kulinganisha** inayofanywa au kuongeza mpya, unaweza kupata data zaidi.
```bash
# Comparators to dump the database
"NE": "a123" #Get everything that doesn't equal "a123"
"NOT_CONTAINS": "a123" #What you think
"GT": " " #All strings are greater than a space
```
### Uingizaji wa Json wa Raw

**DynamoDB** inakubali vitu vya **Json** kutafuta data ndani ya DB. Ikiwa utagundua unaweza kuandika kwenye kipengee cha json kilichotumwa kutafuta, unaweza kufanya DB itoe, yaliyomo yote.

Kwa mfano, kuingiza katika ombi kama:
```bash
'{"Id": {"ComparisonOperator": "EQ","AttributeValueList": [{"N": "' + user_input + '"}]}}'
```
{% endcode %}

Mshambuliaji anaweza kuingiza kitu kama hiki:

`1000"}],"ComparisonOperator": "GT","AttributeValueList": [{"N": "0`

suluhisha hali ya "EQ" inayotafuta kitambulisho 1000 na kisha kutafuta data zote na kitambulisho cha herufi kikubwa kuliko 0, ambayo ni yote.

### Uingizaji wa Mali

Baadhi ya SDK huruhusu kutumia herufi inayoonyesha uchujaji utakaofanywa kama:
```java
new ScanSpec().withProjectionExpression("UserName").withFilterExpression(user_input+" = :username and Password = :password").withValueMap(valueMap)
```
{% endcode %}

Unahitaji kujua kwamba kutafuta katika DynamoDB kwa **kubadilisha** thamani ya sifa katika **maelezo ya kuchuja** wakati wa kutafuta vitu, vidole vinapaswa **kuanza** na herufi **`:`**. Vidole kama hivyo vitakuwa **badala** na thamani halisi ya **sifa wakati wa uendeshaji**.

Kwa hivyo, kuingia kama ile ya awali inaweza kuepukwa na kitu kama hiki:
```bash
:username = :username or :username
# This will generate the query:
# :username = :username or :username = :username and Password = :password
# which is always true
```
{% hint style="success" %}
Jifunze na zoea Udukuzi wa AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Mafunzo ya HackTricks kwa Wataalam wa Timu Nyekundu ya AWS (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze na zoea Udukuzi wa GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Mafunzo ya HackTricks kwa Wataalam wa Timu Nyekundu ya GCP (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>unga mkono HackTricks</summary>

* Angalia [**mpango wa usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
