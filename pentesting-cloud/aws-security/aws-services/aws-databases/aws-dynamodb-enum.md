# AWS - DynamoDB Enum

{% hint style="success" %}
Leer & oefen AWS Hack:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hack: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kontroleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}

## DynamoDB

### Basiese Inligting

Amazon DynamoDB word deur AWS aangebied as 'n **volledig bestuurde, serverlose, sleutel-waarde NoSQL-databasis**, wat geskik is vir die aandrywing van ho√´-prestasie-toepassings ongeag hul grootte. Die diens verseker robuuste kenmerke insluitend inherente sekuriteitsmaatre√´ls, ononderbroke rugsteune, outomatiese replikasie oor verskeie streke, ge√Øntegreerde in-memory caching, en gerieflike data-uitvoerhulpmiddels.

In die konteks van DynamoDB, eerder as om 'n tradisionele databasis te vestig, **word tabelle geskep**. Elke tabel vereis die spesifikasie van 'n **partisiesleutel** as 'n integrale komponent van die **tabel se prim√™re sleutel**. Hierdie partisiesleutel, essensieel 'n **hashwaarde**, speel 'n kritieke rol in beide die herwinning van items en die verspreiding van data oor verskeie gasheer. Hierdie verspreiding is noodsaaklik vir die handhawing van beide die skaalbaarheid en beskikbaarheid van die databasis. Daar is ook 'n opsie om 'n **sorteersleutel** in te sluit om data-organisasie verder te verfyn.

### Versleuteling

Standaard gebruik DynamoDB 'n KMS-sleutel wat **aan Amazon DynamoDB behoort**, selfs nie die AWS-bestuurde sleutel wat ten minste aan jou rekening behoort nie.

<figure><img src="https://lh4.googleusercontent.com/JjtNS7aA-_GRMgZb4v93jWEQJi6DQdUPq0FEpzZPdeyCeNoG05p0NJiV9Zs-ULs_-Tfjmx0W1ZgsE2Ui2ljo7D-1a87Xny-gpLVQO0XmXdFoph9ci1RepbVNwaCe9oPruEZSEDxGTxF5dIv6pW1WpT6kWA=s2048" alt=""><figcaption></figcaption></figure>

### Rugsteune & Uitvoer na S3

Dit is moontlik om die generering van **tabelrugsteune te skeduleer** of om hulle op **aanvraag** te skep. Daarbenewens is dit ook moontlik om **Punt-in-tyd-herwinning (PITR) vir 'n tabel te aktiveer.** Punt-in-tyd-herwinning bied voortdurende **rugsteune** van jou DynamoDB-data vir **35 dae** om jou te help teen ongelukkige skryf- of verwyderingsoperasies te beskerm.

Dit is ook moontlik om **die data van 'n tabel na S3 uit te voer**, maar die tabel moet **PITR geaktiveer** h√™.

### GUI

Daar is 'n GUI vir plaaslike Dynamo-dienste soos [DynamoDB Local](https://aws.amazon.com/blogs/aws/dynamodb-local-for-desktop-development/), [dynalite](https://github.com/mhart/dynalite), [localstack](https://github.com/localstack/localstack), ens., wat nuttig kan wees: [https://github.com/aaronshaf/dynamodb-admin](https://github.com/aaronshaf/dynamodb-admin)

### Enumerasie
```bash
# Tables
aws dynamodb list-tables
aws dynamodb describe-table --table-name <t_name> #Get metadata info
## The primary key and sort key will appear inside the KeySchema field

#Check if point in time recovery is enabled
aws dynamodb describe-continuous-backups \
--table-name tablename

# Backups
aws dynamodb list-backups
aws dynamodb describe-backup --backup-arn <arn>
aws dynamodb describe-continuous-backups --table-name <t_name>

# Global tables
aws dynamodb list-global-tables
aws dynamodb describe-global-table --global-table-name <name>

# Exports
aws dynamodb list-exports
aws dynamodb describe-export --export-arn <arn>

# Misc
aws dynamodb describe-endpoints #Dynamodb endpoints
```
### Ongeverifieerde Toegang

{% content-ref url="../../aws-unauthenticated-enum-access/aws-dynamodb-unauthenticated-access.md" %}
[aws-dynamodb-unauthenticated-access.md](../../aws-unauthenticated-enum-access/aws-dynamodb-unauthenticated-access.md)
{% endcontent-ref %}

### Privesc

{% content-ref url="../../aws-privilege-escalation/aws-dynamodb-privesc.md" %}
[aws-dynamodb-privesc.md](../../aws-privilege-escalation/aws-dynamodb-privesc.md)
{% endcontent-ref %}

### Post Exploitation

{% content-ref url="../../aws-post-exploitation/aws-dynamodb-post-exploitation.md" %}
[aws-dynamodb-post-exploitation.md](../../aws-post-exploitation/aws-dynamodb-post-exploitation.md)
{% endcontent-ref %}

### Volharding

{% content-ref url="../../aws-persistence/aws-dynamodb-persistence.md" %}
[aws-dynamodb-persistence.md](../../aws-persistence/aws-dynamodb-persistence.md)
{% endcontent-ref %}

## DynamoDB Inspruiting

### SQL Inspruiting

Daar is maniere om toegang tot DynamoDB-data te kry met **SQL-sintaksis**, daarom is tipiese **SQL-inspuitings ook moontlik**.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

### NoSQL Inspruiting

In DynamoDB kan verskillende **voorwaardes** gebruik word om data op te haal, soos in 'n tipiese NoSQL Inspruiting as dit moontlik is om **meer voorwaardes te koppel om** data op te haal, kan jy verskuilde data verkry (of die hele tabel dump).\
Jy kan hierdie voorwaardes wat deur DynamoDB ondersteun word hier vind: [https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API\_Condition.html](https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API\_Condition.html)

Let daarop dat **verskillende voorwaardes** ondersteun word as die data benader word via **`query`** of via **`scan`**.

{% hint style="info" %}
Eintlik moet **Query**-aksies die **voorwaarde "EQ" (gelyk)** in die **prim√™re** sleutel spesifiseer om te werk, wat dit baie **minder vatbaar vir NoSQL-inspuitings** maak (en maak ook die operasie baie beperk).
{% endhint %}

As jy die **vergelyking kan verander** wat uitgevoer word of nuwes kan byvoeg, kan jy meer data ophaal.
```bash
# Comparators to dump the database
"NE": "a123" #Get everything that doesn't equal "a123"
"NOT_CONTAINS": "a123" #What you think
"GT": " " #All strings are greater than a space
```
### Roue Json inspuiting

**DynamoDB** aanvaar **Json**-voorwerpe om vir data binne die DB te **soek**. As jy vind dat jy kan skryf in die json-voorwerp wat gestuur word om te soek, kan jy die DB-dump maak, al die inhoud.

Byvoorbeeld, inspuiting in 'n versoek soos:
```bash
'{"Id": {"ComparisonOperator": "EQ","AttributeValueList": [{"N": "' + user_input + '"}]}}'
```
{% endcode %}

'n Aanvaller kan iets soos inspuit:

`1000"}],"ComparisonOperator": "GT","AttributeValueList": [{"N": "0`

herstel die "EQ"-toestand wat soek na die ID 1000 en dan kyk vir al die data met 'n Id-string groter as 0, wat almal is.

### :property Inspruiting

Sommige SDK's maak dit moontlik om 'n string te gebruik wat die filter wat uitgevoer moet word, aandui soos:
```java
new ScanSpec().withProjectionExpression("UserName").withFilterExpression(user_input+" = :username and Password = :password").withValueMap(valueMap)
```
{% endcode %}

Jy moet weet dat as jy in DynamoDB soek vir die **vervang** van 'n attribuut **waarde** in **filter uitdrukkings** terwyl jy die items skandeer, moet die tokens **begin** met die **`:`** karakter. Sulke tokens sal **vervang** word met die werklike **attribuut waarde tydens uitvoering**.

Daarom kan 'n login soos die vorige een omseil word met iets soos:
```bash
:username = :username or :username
# This will generate the query:
# :username = :username or :username = :username and Password = :password
# which is always true
```
{% hint style="success" %}
Leer & oefen AWS Hack:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hack: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kontroleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}
