# AWS - EMR Enum

{% hint style="success" %}
Aprende y practica AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprende y practica GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

## EMR

El servicio Elastic MapReduce (EMR) de AWS, a partir de la versi칩n 4.8.0, introdujo una caracter칤stica de **configuraci칩n de seguridad** que mejora la protecci칩n de datos al permitir a los usuarios especificar configuraciones de cifrado para datos en reposo y en tr치nsito dentro de los cl칰steres EMR, que son grupos escalables de instancias EC2 dise침ados para procesar marcos de big data como Apache Hadoop y Spark.

Las caracter칤sticas clave incluyen:

* **Cifrado predeterminado del cl칰ster**: Por defecto, los datos en reposo dentro de un cl칰ster no est치n cifrados. Sin embargo, habilitar el cifrado proporciona acceso a varias caracter칤sticas:
* **Linux Unified Key Setup**: Cifra los vol칰menes del cl칰ster EBS. Los usuarios pueden optar por AWS Key Management Service (KMS) o un proveedor de claves personalizado.
* **Cifrado HDFS de c칩digo abierto**: Ofrece dos opciones de cifrado para Hadoop:
* Secure Hadoop RPC (Remote Procedure Call), configurado en privacidad, aprovechando el Simple Authentication Security Layer.
* Cifrado de transferencia de bloques HDFS, configurado en verdadero, utiliza el algoritmo AES-256.
* **Cifrado en tr치nsito**: Se enfoca en asegurar los datos durante la transferencia. Las opciones incluyen:
* **Open Source Transport Layer Security (TLS)**: El cifrado se puede habilitar eligiendo un proveedor de certificados:
* **PEM**: Requiere la creaci칩n manual y empaquetado de certificados PEM en un archivo zip, referenciado desde un bucket S3.
* **Custom**: Implica agregar una clase Java personalizada como proveedor de certificados que suministra artefactos de cifrado.

Una vez que un proveedor de certificados TLS se integra en la configuraci칩n de seguridad, se pueden activar las siguientes caracter칤sticas de cifrado espec칤ficas de la aplicaci칩n, que var칤an seg칰n la versi칩n de EMR:

* **Hadoop**:
* Podr칤a reducir el shuffle cifrado usando TLS.
* Secure Hadoop RPC con Simple Authentication Security Layer y HDFS Block Transfer con AES-256 se activan con cifrado en reposo.
* **Presto** (EMR versi칩n 5.6.0+):
* La comunicaci칩n interna entre nodos de Presto se asegura usando SSL y TLS.
* **Tez Shuffle Handler**:
* Utiliza TLS para el cifrado.
* **Spark**:
* Emplea TLS para el protocolo Akka.
* Usa Simple Authentication Security Layer y 3DES para Block Transfer Service.
* El servicio de shuffle externo se asegura con Simple Authentication Security Layer.

Estas caracter칤sticas en conjunto mejoran la postura de seguridad de los cl칰steres EMR, especialmente en lo que respecta a la protecci칩n de datos durante las fases de almacenamiento y transmisi칩n.

#### Enumeraci칩n
```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Get studio URLs
```
#### Privesc

{% content-ref url="../aws-privilege-escalation/aws-emr-privesc.md" %}
[aws-emr-privesc.md](../aws-privilege-escalation/aws-emr-privesc.md)
{% endcontent-ref %}

## Referencias

* [https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/](https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/)

{% hint style="success" %}
Aprende y practica AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprende y practica GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya HackTricks</summary>

* Revisa los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
