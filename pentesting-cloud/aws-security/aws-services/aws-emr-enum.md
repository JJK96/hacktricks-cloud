# AWS - EMR Enum

{% hint style="success" %}
Μάθετε και εξασκηθείτε στο AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε και εξασκηθείτε στο GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε hacking tricks υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια στο github.

</details>
{% endhint %}

## EMR

Η υπηρεσία Elastic MapReduce (EMR) της AWS, ξεκινώντας από την έκδοση 4.8.0, εισήγαγε μια λειτουργία **διαμόρφωσης ασφάλειας** που ενισχύει την προστασία δεδομένων επιτρέποντας στους χρήστες να καθορίζουν ρυθμίσεις κρυπτογράφησης για δεδομένα σε ανάπαυση και σε μεταφορά εντός των EMR clusters, τα οποία είναι κλιμακούμενες ομάδες EC2 instances σχεδιασμένες για την επεξεργασία πλαισίων μεγάλων δεδομένων όπως το Apache Hadoop και το Spark.

Βασικά χαρακτηριστικά περιλαμβάνουν:

* **Προεπιλεγμένη Κρυπτογράφηση Cluster**: Από προεπιλογή, τα δεδομένα σε ανάπαυση εντός ενός cluster δεν είναι κρυπτογραφημένα. Ωστόσο, η ενεργοποίηση της κρυπτογράφησης παρέχει πρόσβαση σε αρκετές λειτουργίες:
* **Linux Unified Key Setup**: Κρυπτογραφεί τους EBS cluster volumes. Οι χρήστες μπορούν να επιλέξουν το AWS Key Management Service (KMS) ή έναν προσαρμοσμένο πάροχο κλειδιών.
* **Open-Source HDFS Encryption**: Προσφέρει δύο επιλογές κρυπτογράφησης για το Hadoop:
* Ασφαλές Hadoop RPC (Remote Procedure Call), ρυθμισμένο σε privacy, χρησιμοποιώντας το Simple Authentication Security Layer.
* Κρυπτογράφηση μεταφοράς HDFS Block, ρυθμισμένη σε true, χρησιμοποιώντας τον αλγόριθμο AES-256.
* **Κρυπτογράφηση σε Μεταφορά**: Εστιάζει στην ασφάλεια των δεδομένων κατά τη μεταφορά. Οι επιλογές περιλαμβάνουν:
* **Open Source Transport Layer Security (TLS)**: Η κρυπτογράφηση μπορεί να ενεργοποιηθεί επιλέγοντας έναν πάροχο πιστοποιητικών:
* **PEM**: Απαιτεί χειροκίνητη δημιουργία και δέσμευση των PEM πιστοποιητικών σε ένα zip αρχείο, αναφερόμενο από έναν S3 bucket.
* **Custom**: Περιλαμβάνει την προσθήκη μιας προσαρμοσμένης κλάσης Java ως πάροχο πιστοποιητικών που παρέχει κρυπτογραφικά αντικείμενα.

Μόλις ένας πάροχος πιστοποιητικών TLS ενσωματωθεί στη διαμόρφωση ασφάλειας, οι ακόλουθες λειτουργίες κρυπτογράφησης εφαρμογών μπορούν να ενεργοποιηθούν, ποικίλλοντας ανάλογα με την έκδοση του EMR:

* **Hadoop**:
* Μπορεί να μειώσει την κρυπτογραφημένη ανακατανομή χρησιμοποιώντας TLS.
* Ασφαλές Hadoop RPC με Simple Authentication Security Layer και HDFS Block Transfer με AES-256 ενεργοποιούνται με κρυπτογράφηση σε ανάπαυση.
* **Presto** (EMR έκδοση 5.6.0+):
* Η εσωτερική επικοινωνία μεταξύ των κόμβων Presto είναι ασφαλισμένη χρησιμοποιώντας SSL και TLS.
* **Tez Shuffle Handler**:
* Χρησιμοποιεί TLS για κρυπτογράφηση.
* **Spark**:
* Χρησιμοποιεί TLS για το πρωτόκολλο Akka.
* Χρησιμοποιεί Simple Authentication Security Layer και 3DES για την υπηρεσία μεταφοράς μπλοκ.
* Η εξωτερική υπηρεσία ανακατανομής είναι ασφαλισμένη με το Simple Authentication Security Layer.

Αυτές οι λειτουργίες συλλογικά ενισχύουν τη στάση ασφαλείας των EMR clusters, ειδικά όσον αφορά την προστασία δεδομένων κατά τις φάσεις αποθήκευσης και μετάδοσης.

#### Enumeration
```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Get studio URLs
```
#### Privesc

{% content-ref url="../aws-privilege-escalation/aws-emr-privesc.md" %}
[aws-emr-privesc.md](../aws-privilege-escalation/aws-emr-privesc.md)
{% endcontent-ref %}

## Αναφορές

* [https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/](https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/)

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε hacking tricks υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια στο github.

</details>
{% endhint %}
