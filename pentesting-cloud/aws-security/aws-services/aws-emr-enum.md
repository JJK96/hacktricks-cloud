# AWS - EMR Enum

{% hint style="success" %}
Aprenda e pratique AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprenda e pratique GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo no Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo no telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

## EMR

O servi√ßo Elastic MapReduce (EMR) da AWS, a partir da vers√£o 4.8.0, introduziu um recurso de **configura√ß√£o de seguran√ßa** que aprimora a prote√ß√£o de dados, permitindo que os usu√°rios especifiquem configura√ß√µes de criptografia para dados em repouso e em tr√¢nsito dentro dos clusters EMR, que s√£o grupos escal√°veis de inst√¢ncias EC2 projetados para processar frameworks de big data como Apache Hadoop e Spark.

Caracter√≠sticas principais incluem:

* **Criptografia Padr√£o do Cluster**: Por padr√£o, os dados em repouso dentro de um cluster n√£o s√£o criptografados. No entanto, habilitar a criptografia fornece acesso a v√°rios recursos:
* **Linux Unified Key Setup**: Criptografa volumes de cluster EBS. Os usu√°rios podem optar pelo AWS Key Management Service (KMS) ou um provedor de chave personalizado.
* **Criptografia HDFS de C√≥digo Aberto**: Oferece duas op√ß√µes de criptografia para Hadoop:
* Secure Hadoop RPC (Remote Procedure Call), configurado para privacidade, aproveitando o Simple Authentication Security Layer.
* Criptografia de transfer√™ncia de bloco HDFS, configurada para true, utiliza o algoritmo AES-256.
* **Criptografia em Tr√¢nsito**: Foca na seguran√ßa dos dados durante a transfer√™ncia. As op√ß√µes incluem:
* **Open Source Transport Layer Security (TLS)**: A criptografia pode ser habilitada escolhendo um provedor de certificado:
* **PEM**: Requer a cria√ß√£o manual e empacotamento de certificados PEM em um arquivo zip, referenciado de um bucket S3.
* **Custom**: Envolve adicionar uma classe Java personalizada como um provedor de certificado que fornece artefatos de criptografia.

Uma vez que um provedor de certificado TLS √© integrado na configura√ß√£o de seguran√ßa, os seguintes recursos de criptografia espec√≠ficos de aplicativos podem ser ativados, variando com base na vers√£o do EMR:

* **Hadoop**:
* Pode reduzir o shuffle criptografado usando TLS.
* Secure Hadoop RPC com Simple Authentication Security Layer e HDFS Block Transfer com AES-256 s√£o ativados com criptografia em repouso.
* **Presto** (vers√£o EMR 5.6.0+):
* A comunica√ß√£o interna entre os n√≥s Presto √© protegida usando SSL e TLS.
* **Tez Shuffle Handler**:
* Utiliza TLS para criptografia.
* **Spark**:
* Emprega TLS para o protocolo Akka.
* Usa Simple Authentication Security Layer e 3DES para Block Transfer Service.
* O servi√ßo de shuffle externo √© protegido com o Simple Authentication Security Layer.

Esses recursos coletivamente aprimoram a postura de seguran√ßa dos clusters EMR, especialmente no que diz respeito √† prote√ß√£o de dados durante as fases de armazenamento e transmiss√£o.

#### Enumera√ß√£o
```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Get studio URLs
```
#### Privesc

{% content-ref url="../aws-privilege-escalation/aws-emr-privesc.md" %}
[aws-emr-privesc.md](../aws-privilege-escalation/aws-emr-privesc.md)
{% endcontent-ref %}

## Refer√™ncias

* [https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/](https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/)

{% hint style="success" %}
Aprenda e pratique AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Aprenda e pratique GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Suporte HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo no Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo no telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
