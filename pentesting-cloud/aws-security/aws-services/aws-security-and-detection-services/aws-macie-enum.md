# AWS - Macie Enum

{% hint style="success" %}
AWS Hacking'ı öğrenin ve uygulayın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katılın veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına PR göndererek destek olun.

</details>
{% endhint %}

# Macie

Amazon Macie, bir AWS hesabı içindeki verileri **otomatik olarak tespit etmek, sınıflandırmak ve tanımlamak** için tasarlanmış bir hizmet olarak öne çıkar. **Makine öğrenimi** kullanarak sürekli olarak verileri izler ve analiz eder, genellikle bulut izi etkinlik verilerini ve kullanıcı davranış kalıplarını inceleyerek olağandışı veya şüpheli faaliyetleri tespit eder ve uyarır.

Amazon Macie'nin Temel Özellikleri:

1. **Etkin Veri İncelemesi**: AWS hesabı içinde çeşitli işlemler gerçekleştiğinde verileri etkin bir şekilde incelemek için makine öğrenimini kullanır.
2. **Anomali Tespiti**: Düzensiz faaliyetleri veya erişim kalıplarını tanımlar, potansiyel veri maruziyeti risklerini azaltmak için uyarılar oluşturur.
3. **Sürekli İzleme**: Amazon S3'te yeni verileri otomatik olarak izler ve tespit eder, zamanla veri erişim kalıplarına uyum sağlamak için makine öğrenimi ve yapay zeka kullanır.
4. **NLP ile Veri Sınıflandırma**: Doğal dil işleme (NLP) kullanarak farklı veri türlerini sınıflandırır ve yorumlar, bulguları önceliklendirmek için risk puanları atar.
5. **Güvenlik İzlemesi**: API anahtarları, gizli anahtarlar ve kişisel bilgiler de dahil olmak üzere güvenlik hassas verileri tanımlar, veri sızıntılarını önlemeye yardımcı olur.

Amazon Macie, bir **bölgesel hizmet**tir ve işlevselliği için 'AWSMacieServiceCustomerSetupRole' IAM Rolü ve etkinleştirilmiş bir AWS CloudTrail gerektirir.

## Uyarı Sistemi

Macie, uyarıları önceden tanımlanmış kategorilere ayırır:

- Anonim erişim
- Veri uyumluluğu
- Kimlik Bilgisi Kaybı
- Ayrıcalık yükseltme
- Fidye yazılımı
- Şüpheli erişim vb.

Bu uyarılar etkili yanıt ve çözüm için detaylı açıklamalar ve sonuç ayrıntıları sağlar.

## Gösterge Tablosu Özellikleri

Gösterge tablosu, verileri şu bölümlere ayırır:

- S3 Nesneleri (zaman aralığına göre, ACL, PII)
- Yüksek riskli CloudTrail etkinlikleri/kullanıcılar
- Etkinlik Konumları
- CloudTrail kullanıcı kimlik türleri ve daha fazlası.

## Kullanıcı Sınıflandırması

Kullanıcılar, API çağrılarının risk seviyesine göre kademelere ayrılır:

- **Platin**: Yüksek riskli API çağrıları, genellikle yönetici ayrıcalıklarıyla.
- **Altın**: Altyapıyla ilgili API çağrıları.
- **Gümüş**: Orta riskli API çağrıları.
- **Bronz**: Düşük riskli API çağrıları.

## Kimlik Türleri

Kimlik türleri, Kök, IAM kullanıcısı, Varsayılan Rol, Federasyon Kullanıcısı, AWS Hesabı ve AWS Hizmeti olmak üzere isteklerin kaynağını gösterir.

## Veri Sınıflandırma

Veri sınıflandırma şunları kapsar:

- İçerik Türü: Algılanan içerik türüne göre.
- Dosya Uzantısı: Dosya uzantısına göre.
- Tema: Dosyalardaki anahtar kelimelere göre kategorize edilir.
- Regex: Belirli regex kalıplarına göre kategorize edilir.

Bu kategoriler arasındaki en yüksek risk, dosyanın nihai risk seviyesini belirler.

## Araştırma ve Analiz

Amazon Macie'nin araştırma işlevi, derinlemesine analiz için tüm Macie verileri üzerinde özel sorgular yapılmasına olanak tanır. Filtreler arasında CloudTrail Verileri, S3 Kova özellikleri ve S3 Nesneleri bulunur. Ayrıca, Amazon Macie'yi paylaşmak için diğer hesapları davet etmeyi destekler, işbirlikçi veri yönetimi ve güvenlik izleme sağlar.


## Numaralandırma
```
# Get buckets
aws macie2 describe-buckets

# Org config
aws macie2 describe-organization-configuration

# Get admin account (if any)
aws macie2 get-administrator-account
aws macie2 list-organization-admin-accounts # Run from the management account of the org

# Get macie account members (run this form the admin account)
aws macie2 list-members

# Check if automated sensitive data discovey is enabled
aws macie2 get-automated-discovery-configuration

# Get findings
aws macie2 list-findings
aws macie2 get-findings --finding-ids <ids>
aws macie2 list-findings-filters
aws macie2 get -findings-filters --id <id>

# Get allow lists
aws macie2 list-allow-lists
aws macie2 get-allow-list --id <id>

# Get different info
aws macie2 list-classification-jobs
aws macie2 list-classification-scopes
aws macie2 list-custom-data-identifiers
```
### Saldırı Sonrası İşlemler

{% hint style="success" %}
Bir saldırganın bakış açısından, bu hizmet saldırganı tespit etmek için değil, depolanan dosyalardaki hassas bilgileri tespit etmek içindir. Bu nedenle, bu hizmet bir saldırganın kovalamak isteyebileceği hassas bilgileri bulmasına **yardımcı olabilir**.\
Ancak, belki bir saldırgan da kurbanın uyarılar almasını engellemek ve bu bilgileri daha kolay çalmak için bu hizmeti bozmaya ilgi duyabilir.
{% endhint %}

TODO: PR'lar kabul edilir!

# Referanslar
* [https://cloudacademy.com/blog/introducing-aws-security-hub/](https://cloudacademy.com/blog/introducing-aws-security-hub/)

{% hint style="success" %}
AWS Hacking'i öğrenin ve uygulayın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katılın veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak PR'ler göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>
{% endhint %}
