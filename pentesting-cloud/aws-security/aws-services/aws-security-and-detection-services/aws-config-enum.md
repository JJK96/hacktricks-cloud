# AWS - Config Enum

{% hint style="success" %}
Μάθετε και εξασκηθείτε στο AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε και εξασκηθείτε στο GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε hacking tricks υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια στο github.

</details>
{% endhint %}

## AWS Config

Το AWS Config **καταγράφει αλλαγές πόρων**, έτσι οποιαδήποτε αλλαγή σε έναν πόρο που υποστηρίζεται από το Config μπορεί να καταγραφεί, το οποίο θα **καταγράψει τι άλλαξε μαζί με άλλα χρήσιμα μεταδεδομένα, όλα αποθηκευμένα μέσα σε ένα αρχείο γνωστό ως στοιχείο διαμόρφωσης**, ένα CI. Αυτή η υπηρεσία είναι **ειδική για την περιοχή**.

Ένα στοιχείο διαμόρφωσης ή **CI** όπως είναι γνωστό, είναι ένα βασικό συστατικό του AWS Config. Αποτελείται από ένα αρχείο JSON που **περιέχει τις πληροφορίες διαμόρφωσης, τις πληροφορίες σχέσεων και άλλα μεταδεδομένα ως στιγμιότυπο ενός υποστηριζόμενου πόρου**. Όλες οι πληροφορίες που μπορεί να καταγράψει το AWS Config για έναν πόρο καταγράφονται μέσα στο CI. Ένα CI δημιουργείται **κάθε φορά** που ένας υποστηριζόμενος πόρος έχει μια αλλαγή στη διαμόρφωσή του με οποιονδήποτε τρόπο. Εκτός από την καταγραφή των λεπτομερειών του επηρεαζόμενου πόρου, το AWS Config θα καταγράψει επίσης CI για οποιουσδήποτε άμεσα σχετιζόμενους πόρους για να διασφαλίσει ότι η αλλαγή δεν επηρέασε και αυτούς τους πόρους.

* **Μεταδεδομένα**: Περιέχει λεπτομέρειες για το ίδιο το στοιχείο διαμόρφωσης. Ένα αναγνωριστικό έκδοσης και ένα αναγνωριστικό διαμόρφωσης, που αναγνωρίζουν μοναδικά το CI. Άλλες πληροφορίες μπορεί να περιλαμβάνουν ένα MD5Hash που σας επιτρέπει να συγκρίνετε άλλα CI που έχουν ήδη καταγραφεί για τον ίδιο πόρο.
* **Χαρακτηριστικά**: Αυτό περιέχει κοινές **πληροφορίες χαρακτηριστικών για τον πραγματικό πόρο**. Μέσα σε αυτή την ενότητα, έχουμε επίσης ένα μοναδικό αναγνωριστικό πόρου και οποιεσδήποτε ετικέτες κλειδιού-τιμής που σχετίζονται με τον πόρο. Ο τύπος του πόρου αναφέρεται επίσης. Για παράδειγμα, αν αυτό ήταν ένα CI για μια EC2 instance, οι τύποι πόρων που αναφέρονται θα μπορούσαν να είναι η διεπαφή δικτύου ή η ελαστική διεύθυνση IP για αυτή την EC2 instance.
* **Σχέσεις**: Αυτό περιέχει πληροφορίες για οποιαδήποτε συνδεδεμένη **σχέση που μπορεί να έχει ο πόρος**. Έτσι, μέσα σε αυτή την ενότητα, θα εμφανίζεται μια σαφής περιγραφή οποιασδήποτε σχέσης με άλλους πόρους που είχε αυτός ο πόρος. Για παράδειγμα, αν το CI ήταν για μια EC2 instance, η ενότητα σχέσεων μπορεί να δείχνει τη σύνδεση με ένα VPC μαζί με το υποδίκτυο στο οποίο βρίσκεται η EC2 instance.
* **Τρέχουσα διαμόρφωση**: Αυτό θα εμφανίσει τις ίδιες πληροφορίες που θα δημιουργούνταν αν εκτελούσατε μια περιγραφή ή λίστα API κλήσεων που έγιναν από το AWS CLI. Το AWS Config χρησιμοποιεί τις ίδιες API κλήσεις για να λάβει τις ίδιες πληροφορίες.
* **Σχετικά γεγονότα**: Αυτό σχετίζεται με το AWS CloudTrail. Αυτό θα εμφανίσει το **αναγνωριστικό γεγονότος του AWS CloudTrail που σχετίζεται με την αλλαγή που προκάλεσε τη δημιουργία αυτού του CI**. Δημιουργείται ένα νέο CI για κάθε αλλαγή που γίνεται σε έναν πόρο. Ως αποτέλεσμα, θα δημιουργηθούν διαφορετικά αναγνωριστικά γεγονότων CloudTrail.

**Ιστορικό διαμόρφωσης**: Είναι δυνατό να αποκτήσετε το ιστορικό διαμόρφωσης των πόρων χάρη στα στοιχεία διαμόρφωσης. Ένα ιστορικό διαμόρφωσης παραδίδεται κάθε 6 ώρες και περιέχει όλα τα CI για έναν συγκεκριμένο τύπο πόρου.

**Ροές διαμόρφωσης**: Τα στοιχεία διαμόρφωσης αποστέλλονται σε ένα SNS Topic για να επιτρέψουν την ανάλυση των δεδομένων.

**Στιγμιότυπα διαμόρφωσης**: Τα στοιχεία διαμόρφωσης χρησιμοποιούνται για τη δημιουργία ενός στιγμιότυπου όλων των υποστηριζόμενων πόρων σε μια συγκεκριμένη χρονική στιγμή.

**Το S3 χρησιμοποιείται για την αποθήκευση** των αρχείων Ιστορικού Διαμόρφωσης και οποιωνδήποτε στιγμιότυπων διαμόρφωσης των δεδομένων σας μέσα σε έναν μόνο κάδο, ο οποίος ορίζεται μέσα στον καταγραφέα διαμόρφωσης. Αν έχετε πολλαπλούς λογαριασμούς AWS, μπορεί να θέλετε να συγκεντρώσετε τα αρχεία ιστορικού διαμόρφωσης στον ίδιο κάδο S3 για τον κύριο λογαριασμό σας. Ωστόσο, θα χρειαστεί να παραχωρήσετε δικαιώματα εγγραφής για αυτή την υπηρεσία, config.amazonaws.com, και τους δευτερεύοντες λογαριασμούς σας με δικαιώματα εγγραφής στον κάδο S3 στον κύριο λογαριασμό σας.

### Λειτουργία

* Όταν κάνετε αλλαγές, για παράδειγμα σε μια λίστα ελέγχου πρόσβασης ομάδας ασφαλείας ή κάδου —> ενεργοποιείται ως ένα Γεγονός που ανιχνεύεται από το AWS Config
* Αποθηκεύει τα πάντα σε κάδο S3
* Ανάλογα με τη ρύθμιση, μόλις κάτι αλλάξει, μπορεί να ενεργοποιήσει μια λειτουργία lambda Ή να προγραμματίσει μια λειτουργία lambda για να εξετάζει περιοδικά τις ρυθμίσεις του AWS Config
* Η Lambda τροφοδοτεί πίσω στο Config
* Αν παραβιαστεί ένας κανόνας, το Config ενεργοποιεί ένα SNS

![](<../../../../.gitbook/assets/image (126).png>)

### Κανόνες Config

Οι κανόνες Config είναι ένας εξαιρετικός τρόπος για να σας βοηθήσουν **να επιβάλλετε συγκεκριμένους ελέγχους συμμόρφωσης** **και ελέγχους στους πόρους σας**, και σας επιτρέπει να υιοθετήσετε μια ιδανική προδιαγραφή ανάπτυξης για κάθε τύπο πόρου σας. Κάθε κανόνας **είναι ουσιαστικά μια λειτουργία lambda** που όταν καλείται αξιολογεί τον πόρο και εκτελεί κάποια απλή λογική για να καθορίσει το αποτέλεσμα συμμόρφωσης με τον κανόνα. **Κάθε φορά που γίνεται μια αλλαγή** σε έναν από τους υποστηριζόμενους πόρους σας, **το AWS Config θα ελέγχει τη συμμόρφωση με οποιουσδήποτε κανόνες config που έχετε σε ισχύ**.\
Το AWS έχει έναν αριθμό **προκαθορισμένων κανόνων** που εμπίπτουν στην ομπρέλα της ασφάλειας και είναι έτοιμοι για χρήση. Για παράδειγμα, Rds-storage-encrypted. Αυτό ελέγχει αν η κρυπτογράφηση αποθήκευσης είναι ενεργοποιημένη από τις βάσεις δεδομένων RDS σας. Encrypted-volumes. Αυτό ελέγχει αν οποιοσδήποτε EBS τόμος που έχει κατάσταση συνδεδεμένου είναι κρυπτογραφημένος.

* **Κανόνες διαχειριζόμενοι από το AWS**: Σύνολο προκαθορισμένων κανόνων που καλύπτουν πολλές βέλτιστες πρακτικές, οπότε αξίζει πάντα να περιηγηθείτε σε αυτούς τους κανόνες πρώτα πριν δημιουργήσετε τους δικούς σας, καθώς υπάρχει πιθανότητα ο κανόνας να υπάρχει ήδη.
* **Προσαρμοσμένοι κανόνες**: Μπορείτε να δημιουργήσετε τους δικούς σας κανόνες για να ελέγξετε συγκεκριμένες προσαρμοσμένες διαμορφώσεις.

Όριο 50 κανόνων config ανά περιοχή πριν χρειαστεί να επικοινωνήσετε με το AWS για αύξηση.\
Τα μη συμμορφούμενα αποτελέσματα ΔΕΝ διαγράφονται.

{% hint style="success" %}
Μάθετε και εξασκηθείτε στο AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε και εξασκηθείτε στο GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε hacking tricks υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια στο github.

</details>
{% endhint %}
