# AWS - Config Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## AWS Config

AWS Config **rejestruje zmiany zasobów**, więc każda zmiana zasobu obsługiwanego przez Config może być zarejestrowana, co **zarejestruje, co się zmieniło wraz z innymi przydatnymi metadanymi, wszystko przechowywane w pliku znanym jako element konfiguracji**, CI. Ta usługa jest **specyficzna dla regionu**.

Element konfiguracji lub **CI**, jak jest znany, jest kluczowym komponentem AWS Config. Składa się z pliku JSON, który **zawiera informacje o konfiguracji, informacje o relacjach i inne metadane jako migawkowy widok zasobu w danym momencie**. Wszystkie informacje, które AWS Config może zarejestrować dla zasobu, są przechwytywane w CI. CI jest tworzony **za każdym razem**, gdy zasób obsługiwany ma jakąkolwiek zmianę w konfiguracji. Oprócz rejestrowania szczegółów dotyczących zmienionego zasobu, AWS Config zarejestruje również CI dla wszelkich bezpośrednio powiązanych zasobów, aby upewnić się, że zmiana nie wpłynęła również na te zasoby.

* **Metadane**: Zawiera szczegóły dotyczące samego elementu konfiguracji. Identyfikator wersji i identyfikator konfiguracji, które jednoznacznie identyfikują CI. Inne informacje mogą obejmować MD5Hash, który pozwala porównać inne CI już zarejestrowane dla tego samego zasobu.
* **Atrybuty**: Zawiera wspólne **informacje o atrybutach dotyczące rzeczywistego zasobu**. W tej sekcji mamy również unikalny identyfikator zasobu i wszelkie tagi klucz-wartość powiązane z zasobem. Typ zasobu jest również wymieniony. Na przykład, jeśli byłby to CI dla instancji EC2, wymienione typy zasobów mogą obejmować interfejs sieciowy lub elastyczny adres IP dla tej instancji EC2.
* **Relacje**: Zawiera informacje o wszelkich powiązanych **relacjach, jakie może mieć zasób**. W tej sekcji znajdzie się jasny opis wszelkich relacji z innymi zasobami, jakie miał ten zasób. Na przykład, jeśli CI dotyczyłby instancji EC2, sekcja relacji może pokazywać połączenie z VPC wraz z podsiecią, w której znajduje się instancja EC2.
* **Bieżąca konfiguracja:** Wyświetli te same informacje, które byłyby generowane, gdybyś wykonał wywołanie API describe lub list za pomocą AWS CLI. AWS Config używa tych samych wywołań API, aby uzyskać te same informacje.
* **Powiązane zdarzenia**: Dotyczy AWS CloudTrail. Wyświetli **identyfikator zdarzenia AWS CloudTrail, który jest związany ze zmianą, która spowodowała utworzenie tego CI**. Nowy CI jest tworzony za każdą zmianę dokonaną w zasobie. W rezultacie zostaną utworzone różne identyfikatory zdarzeń CloudTrail.

**Historia konfiguracji**: Możliwe jest uzyskanie historii konfiguracji zasobów dzięki elementom konfiguracji. Historia konfiguracji jest dostarczana co 6 godzin i zawiera wszystkie CI dla określonego typu zasobu.

**Strumienie konfiguracji**: Elementy konfiguracji są wysyłane do tematu SNS, aby umożliwić analizę danych.

**Migawki konfiguracji**: Elementy konfiguracji są używane do tworzenia migawki wszystkich obsługiwanych zasobów w danym momencie.

**S3 jest używany do przechowywania** plików historii konfiguracji i wszelkich migawek konfiguracji danych w jednym wiadrze, które jest zdefiniowane w rejestratorze konfiguracji. Jeśli masz wiele kont AWS, możesz chcieć zintegrować pliki historii konfiguracji w tym samym wiadrze S3 dla swojego głównego konta. Jednak będziesz musiał przyznać dostęp do zapisu dla tego serwisu, config.amazonaws.com, oraz swoim kontom wtórnym z dostępem do zapisu do wiadra S3 na swoim głównym koncie.

### Funkcjonowanie

* Kiedy dokonujesz zmian, na przykład w grupie zabezpieczeń lub liście kontroli dostępu do wiadra —> uruchamia się jako zdarzenie przechwycone przez AWS Config
* Wszystko jest przechowywane w wiadrze S3
* W zależności od konfiguracji, gdy coś się zmienia, może to uruchomić funkcję lambda LUB zaplanować funkcję lambda, aby okresowo przeglądała ustawienia AWS Config
* Lambda przekazuje informacje z powrotem do Config
* Jeśli zasada została złamana, Config uruchamia SNS

![](<../../../../.gitbook/assets/image (126).png>)

### Zasady Config

Zasady Config to świetny sposób na **wymuszanie określonych kontroli zgodności** **i kontroli w zasobach**, i pozwala na przyjęcie idealnej specyfikacji wdrożenia dla każdego typu zasobu. Każda zasada **jest w zasadzie funkcją lambda**, która po wywołaniu ocenia zasób i wykonuje prostą logikę, aby określić wynik zgodności z zasadą. **Za każdym razem, gdy dokonywana jest zmiana** w jednym z obsługiwanych zasobów, **AWS Config sprawdzi zgodność z wszelkimi zasadami config, które masz w miejscu**.\
AWS ma wiele **zdefiniowanych zasad**, które są gotowe do użycia. Na przykład, Rds-storage-encrypted. Sprawdza, czy szyfrowanie pamięci masowej jest aktywowane przez twoje instancje bazy danych RDS. Encrypted-volumes. Sprawdza, czy jakiekolwiek woluminy EBS, które mają stan dołączony, są zaszyfrowane.

* **Zasady zarządzane przez AWS**: Zestaw zdefiniowanych zasad, które obejmują wiele najlepszych praktyk, więc zawsze warto przeglądać te zasady najpierw przed ustawieniem własnych, ponieważ istnieje szansa, że zasada już istnieje.
* **Zasady niestandardowe**: Możesz tworzyć własne zasady, aby sprawdzać określone niestandardowe konfiguracje.

Limit 50 zasad config na region, zanim będziesz musiał skontaktować się z AWS w celu zwiększenia limitu.\
Wyniki niezgodne nie są usuwane.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
