# AWS - Config Enum

{% hint style="success" %}
Naučite i vežbajte AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Naučite i vežbajte GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podržite HackTricks</summary>

* Pogledajte [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Delite hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

## AWS Config

AWS Config **beleži promene resursa**, tako da svaka promena resursa podržanog od strane Config može biti zabeležena, što će **zabeležiti šta je promenjeno zajedno sa drugim korisnim metapodacima, sve sadržano u fajlu poznatom kao konfiguraciona stavka**, CI. Ova usluga je **specifična za region**.

Konfiguraciona stavka ili **CI** kako je poznata, je ključna komponenta AWS Config. Sastoji se od JSON fajla koji **sadrži informacije o konfiguraciji, informacije o odnosima i druge metapodatke kao trenutni prikaz podržanog resursa**. Sve informacije koje AWS Config može zabeležiti za resurs su sadržane unutar CI. CI se kreira **svaki put** kada se napravi promena u konfiguraciji podržanog resursa na bilo koji način. Pored beleženja detalja o pogođenom resursu, AWS Config će takođe zabeležiti CI za sve direktno povezane resurse kako bi se osiguralo da promena nije uticala i na te resurse.

* **Metapodaci**: Sadrže detalje o samoj konfiguracionoj stavci. ID verzije i ID konfiguracije, koji jedinstveno identifikuju CI. Ostale informacije mogu uključivati MD5Hash koji vam omogućava da uporedite druge CI već zabeležene za isti resurs.
* **Atributi**: Ovo sadrži zajedničke **informacije o atributima stvarnog resursa**. U ovom delu imamo i jedinstveni ID resursa, i sve ključne vrednosti tagova koje su povezane sa resursom. Tip resursa je takođe naveden. Na primer, ako je ovo CI za EC2 instancu, tipovi resursa navedeni mogu biti mrežni interfejs ili elastična IP adresa za tu EC2 instancu.
* **Odnosi**: Ovo sadrži informacije o bilo kojoj povezanoj **vezi koju resurs može imati**. Tako bi u ovom delu bio jasan opis bilo koje veze sa drugim resursima koje ovaj resurs ima. Na primer, ako je CI za EC2 instancu, deo o odnosima može prikazati vezu sa VPC-om zajedno sa podmrežom u kojoj se EC2 instanca nalazi.
* **Trenutna konfiguracija:** Ovo će prikazati iste informacije koje bi bile generisane ako biste izvršili describe ili list API poziv napravljen od strane AWS CLI. AWS Config koristi iste API pozive da dobije iste informacije.
* **Povezani događaji**: Ovo se odnosi na AWS CloudTrail. Ovo će prikazati **AWS CloudTrail ID događaja koji je povezan sa promenom koja je pokrenula kreiranje ovog CI**. Novi CI se pravi za svaku promenu napravljenu na resursu. Kao rezultat, biće kreirani različiti CloudTrail ID-ovi događaja.

**Istorija konfiguracije**: Moguće je dobiti istoriju konfiguracije resursa zahvaljujući konfiguracionim stavkama. Istorija konfiguracije se isporučuje svakih 6 sati i sadrži sve CI za određeni tip resursa.

**Tokovi konfiguracije**: Konfiguracione stavke se šalju na SNS Topic kako bi se omogućila analiza podataka.

**Snimci konfiguracije**: Konfiguracione stavke se koriste za kreiranje trenutnog snimka svih podržanih resursa.

**S3 se koristi za skladištenje** fajlova istorije konfiguracije i bilo kojih snimaka konfiguracije vaših podataka unutar jednog bucket-a, koji je definisan unutar snimača konfiguracije. Ako imate više AWS naloga, možda ćete želeti da agregirate svoje fajlove istorije konfiguracije u isti S3 bucket za vaš primarni nalog. Međutim, moraćete da dodelite pristup za pisanje ovom servisnom principu, config.amazonaws.com, i vašim sekundarnim nalozima sa pristupom za pisanje u S3 bucket u vašem primarnom nalogu.

### Funkcionisanje

* Kada napravite promene, na primer u sigurnosnoj grupi ili listi za kontrolu pristupa bucket-a —> pokreće se kao događaj koji prepoznaje AWS Config
* Sve se skladišti u S3 bucket
* U zavisnosti od postavke, čim se nešto promeni može pokrenuti lambda funkciju ILI zakazati lambda funkciju da periodično pregleda AWS Config postavke
* Lambda vraća informacije Config-u
* Ako je pravilo prekršeno, Config pokreće SNS

![](<../../../../.gitbook/assets/image (126).png>)

### Config Rules

Config pravila su odličan način da vam pomognu **da sprovedete specifične provere usklađenosti** **i kontrole preko vaših resursa**, i omogućava vam da usvojite idealnu specifikaciju za implementaciju za svaki od vaših tipova resursa. Svako pravilo **je u suštini lambda funkcija** koja kada se pozove procenjuje resurs i izvršava jednostavnu logiku da odredi rezultat usklađenosti sa pravilom. **Svaki put kada se napravi promena** na jednom od vaših podržanih resursa, **AWS Config će proveriti usklađenost sa bilo kojim config pravilima koja imate**.\
AWS ima brojna **predefinisana pravila** koja spadaju pod sigurnosni kišobran i spremna su za upotrebu. Na primer, Rds-storage-encrypted. Ovo proverava da li je enkripcija skladišta aktivirana za vaše RDS baze podataka. Encrypted-volumes. Ovo proverava da li su bilo koji EBS volumeni koji su u stanju povezivanja enkriptovani.

* **AWS Upravljana pravila**: Set predefinisanih pravila koja pokrivaju mnoge najbolje prakse, tako da je uvek vredno pregledati ova pravila pre nego što postavite svoja jer postoji šansa da pravilo već postoji.
* **Prilagođena pravila**: Možete kreirati svoja pravila da proverite specifične prilagođene konfiguracije.

Limit od 50 config pravila po regionu pre nego što morate kontaktirati AWS za povećanje.\
Rezultati koji nisu usklađeni se NE brišu.

{% hint style="success" %}
Naučite i vežbajte AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Naučite i vežbajte GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podržite HackTricks</summary>

* Pogledajte [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Delite hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
