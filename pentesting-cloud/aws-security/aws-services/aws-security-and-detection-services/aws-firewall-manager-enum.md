# AWS - Firewall Manager Enum

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichen.

</details>
{% endhint %}

## Firewall Manager

**AWS Firewall Manager** vereinfacht die Verwaltung und Wartung von **AWS WAF, AWS Shield Advanced, Amazon VPC-Sicherheitsgruppen und Netzwerk-Zugriffskontrolllisten (ACLs), und AWS Network Firewall, AWS Route 53 Resolver DNS Firewall und Firewalls von Drittanbietern** √ºber mehrere Konten und Ressourcen hinweg. Es erm√∂glicht Ihnen, Ihre Firewall-Regeln, Shield Advanced-Schutzma√ünahmen, VPC-Sicherheitsgruppen und Network Firewall-Einstellungen nur einmal zu konfigurieren, wobei der Dienst **diese Regeln und Schutzma√ünahmen automatisch √ºber Ihre Konten und Ressourcen hinweg durchsetzt**, einschlie√ülich neu hinzugef√ºgter.

Der Dienst bietet die M√∂glichkeit, **bestimmte Ressourcen zusammenzufassen und zu sch√ºtzen**, wie z.B. solche, die ein gemeinsames Tag teilen oder alle Ihre CloudFront-Distributionen. Ein wesentlicher Vorteil des Firewall Managers ist seine F√§higkeit, **automatisch Schutz auf neu hinzugef√ºgte Ressourcen** in Ihrem Konto auszudehnen.

Eine **Regelgruppe** (eine Sammlung von WAF-Regeln) kann in eine AWS Firewall Manager-Richtlinie aufgenommen werden, die dann mit bestimmten AWS-Ressourcen wie CloudFront-Distributionen oder Anwendungs-Load-Balancern verkn√ºpft wird.

AWS Firewall Manager bietet **verwaltete Anwendungs- und Protokolllisten**, um die Konfiguration und Verwaltung von Sicherheitsgruppenrichtlinien zu vereinfachen. Diese Listen erm√∂glichen es Ihnen, die Protokolle und Anwendungen zu definieren, die von Ihren Richtlinien erlaubt oder abgelehnt werden. Es gibt zwei Arten von verwalteten Listen:

* **Firewall Manager verwaltete Listen**: Diese Listen umfassen **FMS-Default-Public-Access-Apps-Allowed**, **FMS-Default-Protocols-Allowed** und **FMS-Default-Protocols-Allowed**. Sie werden vom Firewall Manager verwaltet und enthalten h√§ufig verwendete Anwendungen und Protokolle, die der allgemeinen √ñffentlichkeit erlaubt oder verweigert werden sollten. Es ist nicht m√∂glich, sie zu bearbeiten oder zu l√∂schen, jedoch k√∂nnen Sie deren Version ausw√§hlen.
* **Benutzerdefinierte verwaltete Listen**: Diese Listen verwalten Sie selbst. Sie k√∂nnen benutzerdefinierte Anwendungs- und Protokolllisten erstellen, die auf die Bed√ºrfnisse Ihrer Organisation zugeschnitten sind. Im Gegensatz zu den vom Firewall Manager verwalteten Listen haben diese Listen keine Versionen, aber Sie haben die volle Kontrolle √ºber benutzerdefinierte Listen, sodass Sie sie nach Bedarf erstellen, bearbeiten und l√∂schen k√∂nnen.

Es ist wichtig zu beachten, dass **Firewall Manager-Richtlinien nur "Block"- oder "Count"-Aktionen** f√ºr eine Regelgruppe zulassen, ohne eine "Allow"-Option.

### Voraussetzungen

Die folgenden Voraussetzungen m√ºssen erf√ºllt sein, bevor Sie mit der Konfiguration des Firewall Managers beginnen, um die Ressourcen Ihrer Organisation effektiv zu sch√ºtzen. Diese Schritte bieten die grundlegende Einrichtung, die erforderlich ist, damit der Firewall Manager Sicherheitsrichtlinien durchsetzen und die Einhaltung in Ihrer AWS-Umgebung sicherstellen kann:

1. **AWS Organizations beitreten und konfigurieren:** Stellen Sie sicher, dass Ihr AWS-Konto Teil der AWS Organizations-Organisation ist, in der die AWS Firewall Manager-Richtlinien implementiert werden sollen. Dies erm√∂glicht eine zentrale Verwaltung von Ressourcen und Richtlinien √ºber mehrere AWS-Konten innerhalb der Organisation.
2. **Ein AWS Firewall Manager-Standardadministrator-Konto erstellen:** Richten Sie ein Standardadministrator-Konto speziell f√ºr die Verwaltung von Firewall Manager-Sicherheitsrichtlinien ein. Dieses Konto ist f√ºr die Konfiguration und Durchsetzung von Sicherheitsrichtlinien in der gesamten Organisation verantwortlich. Nur das Verwaltungskonto der Organisation kann Firewall Manager-Standardadministrator-Konten erstellen.
3. **AWS Config aktivieren:** Aktivieren Sie AWS Config, um dem Firewall Manager die erforderlichen Konfigurationsdaten und Einblicke zu liefern, die zur effektiven Durchsetzung von Sicherheitsrichtlinien erforderlich sind. AWS Config hilft bei der Analyse, √úberpr√ºfung, √úberwachung und √úberpr√ºfung von Ressourcenkonfigurationen und -√§nderungen, was eine bessere Sicherheitsverwaltung erm√∂glicht.
4. **F√ºr Drittanbieter-Richtlinien im AWS Marketplace abonnieren und Drittanbieter-Einstellungen konfigurieren:** Wenn Sie planen, Drittanbieter-Firewall-Richtlinien zu nutzen, abonnieren Sie diese im AWS Marketplace und konfigurieren Sie die erforderlichen Einstellungen. Dieser Schritt stellt sicher, dass der Firewall Manager Richtlinien von vertrauensw√ºrdigen Drittanbietern integrieren und durchsetzen kann.
5. **F√ºr Network Firewall- und DNS Firewall-Richtlinien Ressourcenteilung aktivieren:** Aktivieren Sie die Ressourcenteilung speziell f√ºr Network Firewall- und DNS Firewall-Richtlinien. Dies erm√∂glicht es dem Firewall Manager, Firewall-Schutzma√ünahmen auf die VPCs und die DNS-Aufl√∂sung Ihrer Organisation anzuwenden und die Netzwerksicherheit zu verbessern.
6. **Um AWS Firewall Manager in Regionen zu verwenden, die standardm√§√üig deaktiviert sind:** Wenn Sie beabsichtigen, den Firewall Manager in AWS-Regionen zu verwenden, die standardm√§√üig deaktiviert sind, stellen Sie sicher, dass Sie die erforderlichen Schritte unternehmen, um dessen Funktionalit√§t in diesen Regionen zu aktivieren. Dies stellt eine konsistente Sicherheitsdurchsetzung in allen Regionen sicher, in denen Ihre Organisation t√§tig ist.

Weitere Informationen finden Sie unter:¬†[Erste Schritte mit AWS Firewall Manager AWS WAF-Richtlinien](https://docs.aws.amazon.com/waf/latest/developerguide/getting-started-fms.html).

### Arten von Schutzrichtlinien

AWS Firewall Manager verwaltet mehrere Arten von Richtlinien, um Sicherheitskontrollen √ºber verschiedene Aspekte der Infrastruktur Ihrer Organisation durchzusetzen:

1. **AWS WAF-Richtlinie:** Dieser Richtlinientyp unterst√ºtzt sowohl AWS WAF als auch AWS WAF Classic. Sie k√∂nnen festlegen, welche Ressourcen durch die Richtlinie gesch√ºtzt werden. F√ºr AWS WAF-Richtlinien k√∂nnen Sie Gruppen von Regelgruppen angeben, die zuerst und zuletzt in der Web-ACL ausgef√ºhrt werden. Dar√ºber hinaus k√∂nnen Kontoinhaber Regeln und Regelgruppen hinzuf√ºgen, die zwischen diesen Gruppen ausgef√ºhrt werden.
2. **Shield Advanced-Richtlinie:** Diese Richtlinie wendet Shield Advanced-Schutzma√ünahmen auf Ihre Organisation f√ºr bestimmte Ressourcentypen an. Sie hilft, DDoS-Angriffe und andere Bedrohungen abzuwehren.
3. **Amazon VPC-Sicherheitsgruppenrichtlinie:** Mit dieser Richtlinie k√∂nnen Sie Sicherheitsgruppen verwalten, die in Ihrer gesamten Organisation verwendet werden, und eine grundlegende Reihe von Regeln in Ihrer AWS-Umgebung durchsetzen, um den Netzwerkzugriff zu steuern.
4. **Amazon VPC-Netzwerk-Zugriffskontrolllisten (ACL)-Richtlinie:** Dieser Richtlinientyp gibt Ihnen die Kontrolle √ºber Netzwerk-ACLs, die in Ihrer Organisation verwendet werden, und erm√∂glicht es Ihnen, eine grundlegende Reihe von Netzwerk-ACLs in Ihrer AWS-Umgebung durchzusetzen.
5. **Network Firewall-Richtlinie:** Diese Richtlinie wendet den AWS Network Firewall-Schutz auf die VPCs Ihrer Organisation an und verbessert die Netzwerksicherheit, indem der Datenverkehr basierend auf vordefinierten Regeln gefiltert wird.
6. **Amazon Route 53 Resolver DNS Firewall-Richtlinie:** Diese Richtlinie wendet DNS Firewall-Schutzma√ünahmen auf die VPCs Ihrer Organisation an und hilft, b√∂sartige Domain-Aufl√∂sungsversuche zu blockieren und Sicherheitsrichtlinien f√ºr den DNS-Datenverkehr durchzusetzen.
7. **Drittanbieter-Firewall-Richtlinie:** Dieser Richtlinientyp wendet Schutzma√ünahmen von Drittanbieter-Firewalls an, die durch ein Abonnement √ºber die AWS Marketplace-Konsole verf√ºgbar sind. Es erm√∂glicht Ihnen, zus√§tzliche Sicherheitsma√ünahmen von vertrauensw√ºrdigen Anbietern in Ihre AWS-Umgebung zu integrieren.
1. **Palo Alto Networks Cloud NGFW-Richtlinie:** Diese Richtlinie wendet Palo Alto Networks Cloud Next Generation Firewall (NGFW)-Schutzma√ünahmen und Regelstapel auf die VPCs Ihrer Organisation an und bietet fortschrittlichen Bedrohungsschutz und sicherheitskontrollen auf Anwendungsebene.
2. **Fortigate Cloud Native Firewall (CNF) as a Service-Richtlinie:** Diese Richtlinie wendet Fortigate Cloud Native Firewall (CNF) as a Service-Schutzma√ünahmen an und bietet branchenf√ºhrenden Bedrohungsschutz, Web Application Firewall (WAF) und API-Schutz, die speziell f√ºr Cloud-Infrastrukturen entwickelt wurden.

### Administratorkonten

AWS Firewall Manager bietet Flexibilit√§t bei der Verwaltung von Firewall-Ressourcen innerhalb Ihrer Organisation durch seinen administrativen Umfang und zwei Arten von Administratorkonten.

**Der administrative Umfang definiert die Ressourcen, die ein Firewall Manager-Administrator verwalten kann**. Nachdem ein AWS Organizations-Verwaltungskonto eine Organisation beim Firewall Manager registriert hat, kann es zus√§tzliche Administratoren mit unterschiedlichen administrativen Umf√§ngen erstellen. Diese Umf√§nge k√∂nnen umfassen:

- Konten oder organisatorische Einheiten (OUs), auf die der Administrator Richtlinien anwenden kann.
- Regionen, in denen der Administrator Aktionen durchf√ºhren kann.
- Firewall Manager-Richtlinientypen, die der Administrator verwalten kann.

Der administrative Umfang kann entweder **vollst√§ndig oder eingeschr√§nkt** sein. Der vollst√§ndige Umfang gew√§hrt dem Administrator Zugriff auf **alle angegebenen Ressourcentypen, Regionen und Richtlinientypen**. Im Gegensatz dazu gew√§hrt der **eingeschr√§nkte Umfang administrative Berechtigungen nur f√ºr einen Teil der Ressourcen, Regionen oder Richtlinientypen**. Es ist ratsam, Administratoren nur die Berechtigungen zu gew√§hren, die sie zur Erf√ºllung ihrer Aufgaben ben√∂tigen. Sie k√∂nnen jede Kombination dieser administrativen Umfangsbedingungen auf einen Administrator anwenden, um die Einhaltung des Prinzips der minimalen Rechte sicherzustellen.

Es gibt zwei verschiedene Arten von Administratorkonten, die jeweils spezifische Rollen und Verantwortlichkeiten erf√ºllen:

- **Standardadministrator:**
- Das Standardadministrator-Konto wird vom Verwaltungskonto der AWS Organizations-Organisation w√§hrend des Onboarding-Prozesses zum Firewall Manager erstellt.
- Dieses Konto hat die F√§higkeit, Drittanbieter-Firewalls zu verwalten und verf√ºgt √ºber einen vollst√§ndigen administrativen Umfang.
- Es dient als prim√§res Administratorkonto f√ºr den Firewall Manager und ist verantwortlich f√ºr die Konfiguration und Durchsetzung von Sicherheitsrichtlinien in der gesamten Organisation.
- W√§hrend der Standardadministrator vollen Zugriff auf alle Ressourcentypen und administrativen Funktionen hat, operiert er auf derselben Ebene wie andere Administratoren, wenn mehrere Administratoren innerhalb der Organisation genutzt werden.
- **Firewall Manager-Administratoren:**
- Diese Administratoren k√∂nnen Ressourcen innerhalb des vom Verwaltungskonto der AWS Organizations definierten administrativen Umfangs verwalten.
- Firewall Manager-Administratoren werden erstellt, um spezifische Rollen innerhalb der Organisation zu erf√ºllen, was die Delegation von Verantwortlichkeiten erm√∂glicht und gleichzeitig Sicherheits- und Compliance-Standards aufrechterh√§lt.
- Bei der Erstellung √ºberpr√ºft der Firewall Manager mit AWS Organizations, ob das Konto bereits ein delegierter Administrator ist. Wenn nicht, ruft der Firewall Manager Organizations auf, um das Konto als delegierten Administrator f√ºr den Firewall Manager zu benennen.

Die Verwaltung dieser Administratorkonten umfasst deren Erstellung im Firewall Manager und die Definition ihrer administrativen Umf√§nge gem√§√ü den Sicherheitsanforderungen der Organisation und dem Prinzip der minimalen Rechte. Durch die Zuweisung geeigneter administrativer Rollen k√∂nnen Organisationen eine effektive Sicherheitsverwaltung sicherstellen und gleichzeitig eine granulare Kontrolle √ºber den Zugriff auf sensible Ressourcen aufrechterhalten.

Es ist wichtig zu betonen, dass **nur ein Konto innerhalb einer Organisation als Firewall Manager-Standardadministrator dienen kann**, gem√§√ü dem Prinzip "**first in, last out**". Um einen neuen Standardadministrator zu benennen, m√ºssen eine Reihe von Schritten befolgt werden:

- Zuerst muss jedes Firewall Manager-Administratorkonto sein eigenes Konto widerrufen.
- Dann kann der bestehende Standardadministrator sein eigenes Konto widerrufen, wodurch die Organisation effektiv vom Firewall Manager abgemeldet wird. Dieser Prozess f√ºhrt zur L√∂schung aller vom widerrufenen Konto erstellten Firewall Manager-Richtlinien.
- Abschlie√üend muss das Verwaltungskonto der AWS Organizations den neuen Firewall Manager-Standardadministrator benennen.

## Enumeration
```
# Users/Administrators

## Get the AWS Organizations account that is associated with AWS Firewall Manager as the AWS Firewall Manager default administrator
aws fms get-admin-account

## List of Firewall Manager administrators within the organization
aws fms list-admin-accounts-for-organization # ReadOnlyAccess policy is not enough for this

## Return a list of the member accounts in the FM administrator's AWS organization
aws fms list-member-accounts # Only a Firewall Manager administrator or the Organization's management account can make this request

## List the accounts that are managing the specified AWS Organizations member account
aws fms list-admins-managing-account # ReadOnlyAccess policy is not enough for this

# Resources

## Get the resources that a Firewall Manager administrator can manage
aws fms get-admin-scope --admin-account <value> # ReadOnlyAccess policy is not enough for this

## Returns the summary of the resource sets used
aws fms list-resource-sets # ReadOnlyAccess policy is not enough for this

## Get information about a specific resource set
aws fms get-resource-set --identifier <value>  # ReadOnlyAccess policy is not enough for this

## Retrieve the list of tags for a given resource
aws fms list-tags-for-resource --resource-arn <value>

## List of the resources in the AWS Organization's accounts that are available to be associated with a FM resource set. Only one account is supported per request.
aws fms list-compliance-status --member-account-ids <value> --resource-type <value> # ReadOnlyAccess policy is not enough for this

## List the resources that are currently associated to a resource set
aws fms list-resource-set-resources --identifier <value> # ReadOnlyAccess policy is not enough for this

# Policies

## Returns the list of policies
aws fms list-policies

## Get information about the specified AWS Firewall Manager policy
aws fms get-policy --policy-id <value>

## List all of the third-party firewall policies that are associated with the third-party firewall administrator's account
aws fms list-third-party-firewall-firewall-policies --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

# AppsList

## Return a list of apps list
aws fms list-apps-lists --max-results [1-100]

## Get information about the specified AWS Firewall Manager applications list
aws fms get-apps-list --list-id <value>

# Protocols

## Get the details of the Firewall Manager protocols list.
aws fms list-protocols-lists

## Get information about the specified AWS Firewall Manager Protocols list
aws fms get-protocols-list --list-id <value>

# Compliance

## Return a summary of which member accounts are protected by the specified policy
aws fms list-compliance-status --policy-id <policy-id>

## Get detailed compliance information about the specified member account (resources that are in and out of compliance with the specified policy)
aws fms get-compliance-detail --policy-id <value> --member-account <value>

# Other useful info

## Get information about the SNS topic that is used to record AWS Firewall Manager SNS logs (if any)
aws fms get-notification-channel

## Get policy-level attack summary information in the event of a potential DDoS attack
aws fms get-protection-status --policy-id <value> # Just for Shield Advanced policy

## Get the onboarding status of a Firewall Manager admin account to third-party firewall vendor tenant.
aws fms get-third-party-firewall-association-status --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

## Get violations' details for a resource based on the specified AWS Firewall Manager policy and AWS account.
aws fms get-violation-details --policy-id <value> --member-account <value> --resource-id <value> --resource-type <value>
```
## Post Exploitation / Bypass Detection

### `organizations:DescribeOrganization` & (`fms:AssociateAdminAccount`, `fms:DisassociateAdminAccount`, `fms:PutAdminAccount`)
Ein Angreifer mit der **`fms:AssociateAdminAccount`**-Berechtigung k√∂nnte das Standard-Administrator-Konto des Firewall Managers festlegen. Mit der **`fms:PutAdminAccount`**-Berechtigung k√∂nnte ein Angreifer ein Firewall Manager-Administrator-Konto erstellen oder aktualisieren, und mit der **`fms:DisassociateAdminAccount`**-Berechtigung k√∂nnte ein potenzieller Angreifer die aktuelle Zuordnung des Firewall Manager-Administrator-Kontos entfernen.

- Die Disassoziation des **Firewall Manager-Standard-Administrators folgt der First-in-Last-out-Politik**. Alle Firewall Manager-Administratoren m√ºssen disassoziiert werden, bevor der Firewall Manager-Standard-Administrator das Konto disassoziieren kann.
- Um einen Firewall Manager-Administrator durch **PutAdminAccount** zu erstellen, muss das Konto zu der Organisation geh√∂ren, die zuvor mit **AssociateAdminAccount** beim Firewall Manager registriert wurde.
- Die Erstellung eines Firewall Manager-Administrator-Kontos kann nur durch das Verwaltungskonto der Organisation erfolgen.
```bash
aws fms associate-admin-account --admin-account <value>
aws fms disassociate-admin-account
aws fms put-admin-account --admin-account <value>
```
**Potenzielle Auswirkungen:** Verlust der zentralen Verwaltung, Umgehung von Richtlinien, Verst√∂√üe gegen die Compliance und St√∂rung der Sicherheitskontrollen innerhalb der Umgebung.

### `fms:PutPolicy`, `fms:DeletePolicy`

Ein Angreifer mit den Berechtigungen **`fms:PutPolicy`**, **`fms:DeletePolicy`** w√§re in der Lage, eine AWS Firewall Manager-Richtlinie zu erstellen, zu √§ndern oder dauerhaft zu l√∂schen.
```bash
aws fms put-policy --policy <value> | --cli-input-json file://<policy.json> [--tag-list <value>]
aws fms delete-policy --policy-id <value> [--delete-all-policy-resources | --no-delete-all-policy-resources]
```
Ein Beispiel f√ºr eine permissive Richtlinie durch eine permissive Sicherheitsgruppe, um die Erkennung zu umgehen, k√∂nnte die folgende sein:
```json
{
"Policy": {
"PolicyName": "permisive_policy",
"SecurityServicePolicyData": {
"Type": "SECURITY_GROUPS_COMMON",
"ManagedServiceData": "{\"type\":\"SECURITY_GROUPS_COMMON\",\"securityGroups\":[{\"id\":\"<permisive_security_group_id>\"}], \"applyToAllEC2InstanceENIs\":\"true\",\"IncludeSharedVPC\":\"true\"}"
},
"ResourceTypeList": ["AWS::EC2::Instance", "AWS::EC2::NetworkInterface", "AWS::EC2::SecurityGroup", "AWS::ElasticLoadBalancingV2::LoadBalancer", "AWS::ElasticLoadBalancing::LoadBalancer"],
"ResourceType": "AWS::EC2::SecurityGroup",
"ExcludeResourceTags": false,
"ResourceTags": [],
"RemediationEnabled": true
},
"TagList": []
}
```
**Potenzielle Auswirkungen:** Demontage von Sicherheitskontrollen, Umgehung von Richtlinien, Verst√∂√üe gegen die Compliance, betriebliche St√∂rungen und potenzielle Datenlecks innerhalb der Umgebung.

### `fms:BatchAssociateResource`, `fms:BatchDisassociateResource`, `fms:PutResourceSet`, `fms:DeleteResourceSet`

Ein Angreifer mit den Berechtigungen **`fms:BatchAssociateResource`** und **`fms:BatchDisassociateResource`** w√§re in der Lage, Ressourcen zu einem Firewall Manager-Ressourcensatz hinzuzuf√ºgen oder daraus zu entfernen. Dar√ºber hinaus w√ºrden die Berechtigungen **`fms:PutResourceSet`** und **`fms:DeleteResourceSet`** einem Angreifer erm√∂glichen, diese Ressourcens√§tze im AWS Firewall Manager zu erstellen, zu √§ndern oder zu l√∂schen.
```bash
# Associate/Disassociate resources from a resource set
aws fms batch-associate-resource --resource-set-identifier <value> --items <value>
aws fms batch-disassociate-resource --resource-set-identifier <value> --items <value>

# Create, modify or delete a resource set
aws fms put-resource-set --resource-set <value> [--tag-list <value>]
aws fms delete-resource-set --identifier <value>
```
**Potenzielle Auswirkungen:** Das Hinzuf√ºgen einer unn√∂tigen Menge an Elementen zu einem Ressourcensatz erh√∂ht das Rauschniveau im Service und kann potenziell einen DoS verursachen. Dar√ºber hinaus k√∂nnten √Ñnderungen der Ressourcens√§tze zu einer Unterbrechung der Ressourcen, Umgehung von Richtlinien, Compliance-Verst√∂√üen und St√∂rungen der Sicherheitskontrollen innerhalb der Umgebung f√ºhren.

### `fms:PutAppsList`, `fms:DeleteAppsList`

Ein Angreifer mit den Berechtigungen **`fms:PutAppsList`** und **`fms:DeleteAppsList`** w√§re in der Lage, Anwendungslisten im AWS Firewall Manager zu erstellen, zu √§ndern oder zu l√∂schen. Dies k√∂nnte kritisch sein, da unautorisierte Anwendungen Zugang zur √ñffentlichkeit erhalten k√∂nnten oder der Zugang zu autorisierten Anwendungen verweigert werden k√∂nnte, was einen DoS verursachen w√ºrde.
```bash
aws fms put-apps-list --apps-list <value> [--tag-list <value>]
aws fms delete-apps-list --list-id <value>
```
**Potenzielle Auswirkungen:** Dies k√∂nnte zu Fehlkonfigurationen, Umgehung von Richtlinien, Verst√∂√üen gegen Compliance-Vorgaben und St√∂rungen der Sicherheitskontrollen innerhalb der Umgebung f√ºhren.

### `fms:PutProtocolsList`, `fms:DeleteProtocolsList`

Ein Angreifer mit den Berechtigungen **`fms:PutProtocolsList`** und **`fms:DeleteProtocolsList`** w√§re in der Lage, Protokolllisten im AWS Firewall Manager zu erstellen, zu √§ndern oder zu l√∂schen. √Ñhnlich wie bei Anwendungslisten k√∂nnte dies kritisch sein, da unautorisierte Protokolle von der Allgemeinheit verwendet werden k√∂nnten oder die Nutzung autorisierter Protokolle verweigert werden k√∂nnte, was zu einem DoS f√ºhren w√ºrde.
```bash
aws fms put-protocols-list --apps-list <value> [--tag-list <value>]
aws fms delete-protocols-list --list-id <value>
```
**Potenzielle Auswirkungen:** Dies k√∂nnte zu Fehlkonfigurationen, Umgehung von Richtlinien, Verst√∂√üen gegen Compliance-Vorgaben und St√∂rungen der Sicherheitskontrollen innerhalb der Umgebung f√ºhren.

### `fms:PutNotificationChannel`, `fms:DeleteNotificationChannel`

Ein Angreifer mit den Berechtigungen **`fms:PutNotificationChannel`** und **`fms:DeleteNotificationChannel`** w√§re in der Lage, die IAM-Rolle und das Amazon Simple Notification Service (SNS) Thema zu l√∂schen und zu bestimmen, das Firewall Manager verwendet, um SNS-Protokolle aufzuzeichnen.

Um **`fms:PutNotificationChannel`** au√üerhalb der Konsole zu verwenden, m√ºssen Sie die Zugriffsrichtlinie des SNS-Themas einrichten, die es dem angegebenen **SnsRoleName** erlaubt, SNS-Protokolle zu ver√∂ffentlichen. Wenn der angegebene **SnsRoleName** eine andere Rolle als die **`AWSServiceRoleForFMS`** ist, erfordert dies eine Vertrauensbeziehung, die es dem Firewall Manager-Dienstprinzipal **fms.amazonaws.com** erlaubt, diese Rolle zu √ºbernehmen.

F√ºr Informationen zur Konfiguration einer SNS-Zugriffsrichtlinie:

{% content-ref url="../aws-services/aws-sns-enum.md" %}
[aws-sns-enum.md](../aws-services/aws-sns-enum.md)
{% endcontent-ref %}
```bash
aws fms put-notification-channel --sns-topic-arn <value> --sns-role-name <value>
aws fms delete-notification-channel
```
**Potenzielle Auswirkungen:** Dies k√∂nnte potenziell zu verpassten Sicherheitswarnungen, verz√∂gerter Incident Response, m√∂glichen Datenlecks und betrieblichen St√∂rungen innerhalb der Umgebung f√ºhren.

### `fms:AssociateThirdPartyFirewall`, `fms:DisssociateThirdPartyFirewall`
Ein Angreifer mit den Berechtigungen **`fms:AssociateThirdPartyFirewall`**, **`fms:DisssociateThirdPartyFirewall`** w√§re in der Lage, Drittanbieter-Firewalls zu verbinden oder zu trennen, die zentral √ºber AWS Firewall Manager verwaltet werden.
{% hint style="warning" %}
Nur der Standardadministrator kann Drittanbieter-Firewalls erstellen und verwalten.
{% endhint %}
```bash
aws fms associate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
aws fms disassociate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
```
**Potentieller Einfluss:** Die Dissoziation w√ºrde zu einer Umgehung der Richtlinien, Compliance-Verst√∂√üen und St√∂rungen der Sicherheitskontrollen innerhalb der Umgebung f√ºhren. Die Assoziation hingegen w√ºrde zu einer St√∂rung der Kosten- und Budgetzuweisung f√ºhren.

### `fms:TagResource`, `fms:UntagResource`

Ein Angreifer w√§re in der Lage, Tags von Firewall Manager-Ressourcen hinzuzuf√ºgen, zu √§ndern oder zu entfernen, was die Kostenverteilung, Ressourcennachverfolgung und Zugriffskontrollrichtlinien Ihrer Organisation basierend auf Tags st√∂ren w√ºrde.
```bash
aws fms tag-resource --resource-arn <value> --tag-list <value>
aws fms untag-resource --resource-arn <value> --tag-keys <value>
```
**Potenzielle Auswirkungen**: St√∂rung der Kostenallokation, Ressourcennachverfolgung und tagbasierten Zugriffskontrollrichtlinien.

## Referenzen

* [https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html](https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html)
* [https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html](https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html)

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtze HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}
