# AWS - Firewall Manager Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Firewall Manager

**AWS Firewall Manager** —Å–ø—Ä–æ—â—É—î —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç–∞ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è **AWS WAF, AWS Shield Advanced, Amazon VPC security groups and Network Access Control Lists (ACLs), and AWS Network Firewall, AWS Route 53 Resolver DNS Firewall and third-party firewalls** —á–µ—Ä–µ–∑ –∫—ñ–ª—å–∫–∞ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ —Ç–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –Ω–∞–ª–∞—à—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä–∞, –∑–∞—Ö–∏—Å—Ç Shield Advanced, –≥—Ä—É–ø–∏ –±–µ–∑–ø–µ–∫–∏ VPC —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Network Firewall –ª–∏—à–µ –æ–¥–∏–Ω —Ä–∞–∑, –ø—Ä–∏ —Ü—å–æ–º—É —Å–µ—Ä–≤—ñ—Å **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î —Ü—ñ –ø—Ä–∞–≤–∏–ª–∞ —Ç–∞ –∑–∞—Ö–∏—Å—Ç–∏ –¥–æ –≤–∞—à–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ —Ç–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤**, –≤–∫–ª—é—á–∞—é—á–∏ –Ω–æ–≤—ñ –¥–æ–¥–∞–Ω—ñ.

–°–µ—Ä–≤—ñ—Å –ø—Ä–æ–ø–æ–Ω—É—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å **–≥—Ä—É–ø—É–≤–∞—Ç–∏ —Ç–∞ –∑–∞—Ö–∏—â–∞—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏ —Ä–∞–∑–æ–º**, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ç—ñ, —â–æ –º–∞—é—Ç—å —Å–ø—ñ–ª—å–Ω–∏–π —Ç–µ–≥ –∞–±–æ –≤—Å—ñ –≤–∞—à—ñ CloudFront —Ä–æ–∑–ø–æ–¥—ñ–ª–∏. –ó–Ω–∞—á–Ω–æ—é –ø–µ—Ä–µ–≤–∞–≥–æ—é Firewall Manager —î –π–æ–≥–æ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑—à–∏—Ä—é–≤–∞—Ç–∏ –∑–∞—Ö–∏—Å—Ç –Ω–∞ –Ω–æ–≤—ñ –¥–æ–¥–∞–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏** —É –≤–∞—à–æ–º—É –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ.

**–ì—Ä—É–ø–∞ –ø—Ä–∞–≤–∏–ª** (–∫–æ–ª–µ–∫—Ü—ñ—è –ø—Ä–∞–≤–∏–ª WAF) –º–æ–∂–µ –±—É—Ç–∏ –≤–∫–ª—é—á–µ–Ω–∞ –≤ –ø–æ–ª—ñ—Ç–∏–∫—É AWS Firewall Manager, —è–∫–∞ –ø–æ—Ç—ñ–º –ø–æ–≤'—è–∑—É—î—Ç—å—Å—è –∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ AWS, —Ç–∞–∫–∏–º–∏ —è–∫ CloudFront —Ä–æ–∑–ø–æ–¥—ñ–ª–∏ –∞–±–æ –±–∞–ª–∞–Ω—Å—É–≤–∞–ª—å–Ω–∏–∫–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ–¥–∞—Ç–∫—ñ–≤.

AWS Firewall Manager –Ω–∞–¥–∞—î **–∫–µ—Ä–æ–≤–∞–Ω—ñ —Å–ø–∏—Å–∫–∏ –¥–æ–¥–∞—Ç–∫—ñ–≤ —Ç–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤** –¥–ª—è —Å–ø—Ä–æ—â–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø–æ–ª—ñ—Ç–∏–∫–∞–º–∏ –≥—Ä—É–ø –±–µ–∑–ø–µ–∫–∏. –¶—ñ —Å–ø–∏—Å–∫–∏ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤–∏–∑–Ω–∞—á–∞—Ç–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ —Ç–∞ –¥–æ–¥–∞—Ç–∫–∏, –¥–æ–∑–≤–æ–ª–µ–Ω—ñ –∞–±–æ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω—ñ –≤–∞—à–∏–º–∏ –ø–æ–ª—ñ—Ç–∏–∫–∞–º–∏. –Ü—Å–Ω—É—î –¥–≤–∞ —Ç–∏–ø–∏ –∫–µ—Ä–æ–≤–∞–Ω–∏—Ö —Å–ø–∏—Å–∫—ñ–≤:

* **Firewall Manager –∫–µ—Ä–æ–≤–∞–Ω—ñ —Å–ø–∏—Å–∫–∏**: –¶—ñ —Å–ø–∏—Å–∫–∏ –≤–∫–ª—é—á–∞—é—Ç—å **FMS-Default-Public-Access-Apps-Allowed**, **FMS-Default-Protocols-Allowed** —Ç–∞ **FMS-Default-Protocols-Allowed**. –í–æ–Ω–∏ –∫–µ—Ä—É—é—Ç—å—Å—è Firewall Manager —ñ –≤–∫–ª—é—á–∞—é—Ç—å –∑–∞–≥–∞–ª—å–Ω–æ–≤–∂–∏–≤–∞–Ω—ñ –¥–æ–¥–∞—Ç–∫–∏ —Ç–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏, —è–∫—ñ –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ –∞–±–æ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω—ñ –¥–ª—è –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É. –á—Ö –Ω–µ –º–æ–∂–Ω–∞ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∞–±–æ –≤–∏–¥–∞–ª—è—Ç–∏, –æ–¥–Ω–∞–∫, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–±—Ä–∞—Ç–∏ —ó—Ö –≤–µ—Ä—Å—ñ—é.
* **–ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –∫–µ—Ä–æ–≤–∞–Ω—ñ —Å–ø–∏—Å–∫–∏**: –í–∏ –∫–µ—Ä—É—î—Ç–µ —Ü–∏–º–∏ —Å–ø–∏—Å–∫–∞–º–∏ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ. –í–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ —Å–ø–∏—Å–∫–∏ –¥–æ–¥–∞—Ç–∫—ñ–≤ —Ç–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤, –∞–¥–∞–ø—Ç–æ–≤–∞–Ω—ñ –¥–æ –ø–æ—Ç—Ä–µ–± –≤–∞—à–æ—ó –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó. –ù–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ –∫–µ—Ä–æ–≤–∞–Ω–∏—Ö —Å–ø–∏—Å–∫—ñ–≤ Firewall Manager, —Ü—ñ —Å–ø–∏—Å–∫–∏ –Ω–µ –º–∞—é—Ç—å –≤–µ—Ä—Å—ñ–π, –∞–ª–µ –≤–∏ –º–∞—î—Ç–µ –ø–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏–º–∏ —Å–ø–∏—Å–∫–∞–º–∏, —â–æ –¥–æ–∑–≤–æ–ª—è—î —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏, —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ç–∞ –≤–∏–¥–∞–ª—è—Ç–∏ —ó—Ö –∑–∞ –ø–æ—Ç—Ä–µ–±–∏.

–í–∞–∂–ª–∏–≤–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ **–ø–æ–ª—ñ—Ç–∏–∫–∏ Firewall Manager –¥–æ–∑–≤–æ–ª—è—é—Ç—å –ª–∏—à–µ –¥—ñ—ó "Block" –∞–±–æ "Count"** –¥–ª—è –≥—Ä—É–ø–∏ –ø—Ä–∞–≤–∏–ª, –±–µ–∑ –æ–ø—Ü—ñ—ó "Allow".

### –ü–µ—Ä–µ–¥—É–º–æ–≤–∏

–ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏ –ø–µ—Ä–µ–¥—É–º–æ–≤ –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω—ñ –ø–µ—Ä–µ–¥ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º Firewall Manager –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∑–∞—Ö–∏—Å—Ç—É —Ä–µ—Å—É—Ä—Å—ñ–≤ –≤–∞—à–æ—ó –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó. –¶—ñ –∫—Ä–æ–∫–∏ –∑–∞–±–µ–∑–ø–µ—á—É—é—Ç—å –æ—Å–Ω–æ–≤–Ω—É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è, –Ω–µ–æ–±—Ö—ñ–¥–Ω—É –¥–ª—è Firewall Manager –¥–ª—è –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –ø–æ–ª—ñ—Ç–∏–∫ –±–µ–∑–ø–µ–∫–∏ —Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ —É –≤–∞—à–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ AWS:

1. **–ü—Ä–∏—î–¥–Ω–∞–Ω–Ω—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è AWS Organizations:** –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∞—à –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å AWS —î —á–∞—Å—Ç–∏–Ω–æ—é –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó AWS Organizations, –¥–µ –ø–ª–∞–Ω—É—î—Ç—å—Å—è –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –ø–æ–ª—ñ—Ç–∏–∫ AWS Firewall Manager. –¶–µ –¥–æ–∑–≤–æ–ª—è—î —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å–∞–º–∏ —Ç–∞ –ø–æ–ª—ñ—Ç–∏–∫–∞–º–∏ —á–µ—Ä–µ–∑ –∫—ñ–ª—å–∫–∞ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ AWS —É –º–µ–∂–∞—Ö –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó.
2. **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º AWS Firewall Manager:** –°—Ç–≤–æ—Ä—ñ—Ç—å –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø–æ–ª—ñ—Ç–∏–∫–∞–º–∏ –±–µ–∑–ø–µ–∫–∏ Firewall Manager. –¶–µ–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –±—É–¥–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –∑–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –ø–æ–ª—ñ—Ç–∏–∫ –±–µ–∑–ø–µ–∫–∏ —á–µ—Ä–µ–∑ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—é. –¢—ñ–ª—å–∫–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—î—é –º–æ–∂–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º Firewall Manager.
3. **–£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è AWS Config:** –ê–∫—Ç–∏–≤—É–π—Ç–µ AWS Config, —â–æ–± –Ω–∞–¥–∞—Ç–∏ Firewall Manager –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Ç–∞ —ñ–Ω—Å–∞–π—Ç–∏, –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –ø–æ–ª—ñ—Ç–∏–∫ –±–µ–∑–ø–µ–∫–∏. AWS Config –¥–æ–ø–æ–º–∞–≥–∞—î –∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏, –∞—É–¥—ñ—é–≤–∞—Ç–∏, –º–æ–Ω—ñ—Ç–æ—Ä–∏—Ç–∏ —Ç–∞ –∞—É–¥—ñ—é–≤–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Ä–µ—Å—É—Ä—Å—ñ–≤ —Ç–∞ –∑–º—ñ–Ω–∏, —Å–ø—Ä–∏—è—é—á–∏ –∫—Ä–∞—â–æ–º—É —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—é –±–µ–∑–ø–µ–∫–æ—é.
4. **–î–ª—è –ø–æ–ª—ñ—Ç–∏–∫ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö –≤–∏—Ä–æ–±–Ω–∏–∫—ñ–≤, –ø—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ AWS Marketplace —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å:** –Ø–∫—â–æ –≤–∏ –ø–ª–∞–Ω—É—î—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø–æ–ª—ñ—Ç–∏–∫–∏ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä—ñ–≤, –ø—ñ–¥–ø–∏—à—ñ—Ç—å—Å—è –Ω–∞ –Ω–∏—Ö —É AWS Marketplace —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–π—Ç–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è. –¶–µ–π –∫—Ä–æ–∫ –∑–∞–±–µ–∑–ø–µ—á—É—î —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é —Ç–∞ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –ø–æ–ª—ñ—Ç–∏–∫ –≤—ñ–¥ –Ω–∞–¥—ñ–π–Ω–∏—Ö —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫—ñ–≤.
5. **–î–ª—è –ø–æ–ª—ñ—Ç–∏–∫ Network Firewall —Ç–∞ DNS Firewall, —É–≤—ñ–º–∫–Ω–µ–Ω–Ω—è —Å–ø—ñ–ª—å–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤:** –£–≤—ñ–º–∫–Ω—ñ—Ç—å —Å–ø—ñ–ª—å–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –¥–ª—è –ø–æ–ª—ñ—Ç–∏–∫ Network Firewall —Ç–∞ DNS Firewall. –¶–µ –¥–æ–∑–≤–æ–ª—è—î Firewall Manager –∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ –∑–∞—Ö–∏—Å—Ç –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä–∞ –¥–æ VPC —Ç–∞ DNS-—Ä–µ–∑–æ–ª—é—Ü—ñ—ó –≤–∞—à–æ—ó –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó, –ø—ñ–¥–≤–∏—â—É—é—á–∏ –±–µ–∑–ø–µ–∫—É –º–µ—Ä–µ–∂—ñ.
6. **–î–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è AWS Firewall Manager —É —Ä–µ–≥—ñ–æ–Ω–∞—Ö, —è–∫—ñ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–∏–º–∫–Ω–µ–Ω—ñ:** –Ø–∫—â–æ –≤–∏ –º–∞—î—Ç–µ –Ω–∞–º—ñ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Firewall Manager —É —Ä–µ–≥—ñ–æ–Ω–∞—Ö AWS, —è–∫—ñ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–∏–º–∫–Ω–µ–Ω—ñ, –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∏ –≤–∂–∏–ª–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –∑–∞—Ö–æ–¥—ñ–≤ –¥–ª—è —É–≤—ñ–º–∫–Ω–µ–Ω–Ω—è –π–æ–≥–æ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ –≤ —Ü–∏—Ö —Ä–µ–≥—ñ–æ–Ω–∞—Ö. –¶–µ –∑–∞–±–µ–∑–ø–µ—á—É—î –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–µ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏ —É –≤—Å—ñ—Ö —Ä–µ–≥—ñ–æ–Ω–∞—Ö, –¥–µ –ø—Ä–∞—Ü—é—î –≤–∞—à–∞ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—è.

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ: [Getting started with AWS Firewall Manager AWS WAF policies](https://docs.aws.amazon.com/waf/latest/developerguide/getting-started-fms.html).

### –¢–∏–ø–∏ –ø–æ–ª—ñ—Ç–∏–∫ –∑–∞—Ö–∏—Å—Ç—É

AWS Firewall Manager –∫–µ—Ä—É—î –∫—ñ–ª—å–∫–æ–º–∞ —Ç–∏–ø–∞–º–∏ –ø–æ–ª—ñ—Ç–∏–∫ –¥–ª—è –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª—é –±–µ–∑–ø–µ–∫–∏ —á–µ—Ä–µ–∑ —Ä—ñ–∑–Ω—ñ –∞—Å–ø–µ–∫—Ç–∏ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –≤–∞—à–æ—ó –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó:

1. **AWS WAF Policy:** –¶–µ–π —Ç–∏–ø –ø–æ–ª—ñ—Ç–∏–∫–∏ –ø—ñ–¥—Ç—Ä–∏–º—É—î —è–∫ AWS WAF, —Ç–∞–∫ —ñ AWS WAF Classic. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∑–Ω–∞—á–∏—Ç–∏, —è–∫—ñ —Ä–µ—Å—É—Ä—Å–∏ –∑–∞—Ö–∏—â–µ–Ω—ñ –ø–æ–ª—ñ—Ç–∏–∫–æ—é. –î–ª—è –ø–æ–ª—ñ—Ç–∏–∫ AWS WAF –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∫–∞–∑–∞—Ç–∏ –Ω–∞–±–æ—Ä–∏ –≥—Ä—É–ø –ø—Ä–∞–≤–∏–ª, —è–∫—ñ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –ø–µ—Ä—à–∏–º–∏ —Ç–∞ –æ—Å—Ç–∞–Ω–Ω—ñ–º–∏ —É –≤–µ–±-ACL. –ö—Ä—ñ–º —Ç–æ–≥–æ, –≤–ª–∞—Å–Ω–∏–∫–∏ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ –º–æ–∂—É—Ç—å –¥–æ–¥–∞–≤–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ —Ç–∞ –≥—Ä—É–ø–∏ –ø—Ä–∞–≤–∏–ª –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –º—ñ–∂ —Ü–∏–º–∏ –Ω–∞–±–æ—Ä–∞–º–∏.
2. **Shield Advanced Policy:** –¶—è –ø–æ–ª—ñ—Ç–∏–∫–∞ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î –∑–∞—Ö–∏—Å—Ç Shield Advanced —á–µ—Ä–µ–∑ –≤–∞—à—É –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—é –¥–ª—è –∑–∞–∑–Ω–∞—á–µ–Ω–∏—Ö —Ç–∏–ø—ñ–≤ —Ä–µ—Å—É—Ä—Å—ñ–≤. –í–æ–Ω–∞ –¥–æ–ø–æ–º–∞–≥–∞—î –∑–∞—Ö–∏—Å—Ç–∏—Ç–∏ –≤—ñ–¥ DDoS-–∞—Ç–∞–∫ —Ç–∞ —ñ–Ω—à–∏—Ö –∑–∞–≥—Ä–æ–∑.
3. **Amazon VPC Security Group Policy:** –ó —Ü—ñ—î—é –ø–æ–ª—ñ—Ç–∏–∫–æ—é –≤–∏ –º–æ–∂–µ—Ç–µ –∫–µ—Ä—É–≤–∞—Ç–∏ –≥—Ä—É–ø–∞–º–∏ –±–µ–∑–ø–µ–∫–∏, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —á–µ—Ä–µ–∑ –≤–∞—à—É –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—é, –∑–∞—Å—Ç–æ—Å–æ–≤—É—é—á–∏ –±–∞–∑–æ–≤–∏–π –Ω–∞–±—ñ—Ä –ø—Ä–∞–≤–∏–ª —á–µ—Ä–µ–∑ –≤–∞—à–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ AWS –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É –¥–æ –º–µ—Ä–µ–∂—ñ.
4. **Amazon VPC Network Access Control List (ACL) Policy:** –¶–µ–π —Ç–∏–ø –ø–æ–ª—ñ—Ç–∏–∫–∏ –Ω–∞–¥–∞—î –≤–∞–º –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –º–µ—Ä–µ–∂–µ–≤–∏–º–∏ ACL, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —É –≤–∞—à—ñ–π –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ –±–∞–∑–æ–≤–∏–π –Ω–∞–±—ñ—Ä –º–µ—Ä–µ–∂–µ–≤–∏—Ö ACL —á–µ—Ä–µ–∑ –≤–∞—à–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ AWS.
5. **Network Firewall Policy:** –¶—è –ø–æ–ª—ñ—Ç–∏–∫–∞ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î –∑–∞—Ö–∏—Å—Ç AWS Network Firewall –¥–æ VPC –≤–∞—à–æ—ó –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó, –ø—ñ–¥–≤–∏—â—É—é—á–∏ –±–µ–∑–ø–µ–∫—É –º–µ—Ä–µ–∂—ñ —à–ª—è—Ö–æ–º —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó —Ç—Ä–∞—Ñ—ñ–∫—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –≤–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –ø—Ä–∞–≤–∏–ª.
6. **Amazon Route 53 Resolver DNS Firewall Policy:** –¶—è –ø–æ–ª—ñ—Ç–∏–∫–∞ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î –∑–∞—Ö–∏—Å—Ç DNS Firewall –¥–æ VPC –≤–∞—à–æ—ó –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó, –¥–æ–ø–æ–º–∞–≥–∞—é—á–∏ –±–ª–æ–∫—É–≤–∞—Ç–∏ —Å–ø—Ä–æ–±–∏ —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è –¥–æ–º–µ–Ω—ñ–≤ —Ç–∞ –∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ –ø–æ–ª—ñ—Ç–∏–∫–∏ –±–µ–∑–ø–µ–∫–∏ –¥–ª—è DNS-—Ç—Ä–∞—Ñ—ñ–∫—É.
7. **Third-Party Firewall Policy:** –¶–µ–π —Ç–∏–ø –ø–æ–ª—ñ—Ç–∏–∫–∏ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä—ñ–≤, —è–∫—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ –∑–∞ –ø—ñ–¥–ø–∏—Å–∫–æ—é —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å AWS Marketplace. –¶–µ –¥–æ–∑–≤–æ–ª—è—î —ñ–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∑–∞—Ö–æ–¥–∏ –±–µ–∑–ø–µ–∫–∏ –≤—ñ–¥ –Ω–∞–¥—ñ–π–Ω–∏—Ö –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫—ñ–≤ —É –≤–∞—à–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ AWS.
1. **Palo Alto Networks Cloud NGFW Policy:** –¶—è –ø–æ–ª—ñ—Ç–∏–∫–∞ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î –∑–∞—Ö–∏—Å—Ç Palo Alto Networks Cloud Next Generation Firewall (NGFW) —Ç–∞ –ø—Ä–∞–≤–∏–ª–∞ –¥–æ VPC –≤–∞—à–æ—ó –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –ø–µ—Ä–µ–¥–æ–≤–∏–π –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ –∑–∞–≥—Ä–æ–∑ —Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å –±–µ–∑–ø–µ–∫–∏ –Ω–∞ —Ä—ñ–≤–Ω—ñ –¥–æ–¥–∞—Ç–∫—ñ–≤.
2. **Fortigate Cloud Native Firewall (CNF) as a Service Policy:** –¶—è –ø–æ–ª—ñ—Ç–∏–∫–∞ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î –∑–∞—Ö–∏—Å—Ç Fortigate Cloud Native Firewall (CNF) as a Service, –ø—Ä–æ–ø–æ–Ω—É—é—á–∏ –ø–µ—Ä–µ–¥–æ–≤–∏–π –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ –∑–∞–≥—Ä–æ–∑, –≤–µ–±-–∞–ø–ª—ñ–∫–∞—Ü—ñ–π–Ω–∏–π –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä (WAF) —Ç–∞ –∑–∞—Ö–∏—Å—Ç API, –∞–¥–∞–ø—Ç–æ–≤–∞–Ω–∏–π –¥–ª—è —Ö–º–∞—Ä–Ω–∏—Ö —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä.

### –û–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

AWS Firewall Manager –ø—Ä–æ–ø–æ–Ω—É—î –≥–Ω—É—á–∫—ñ—Å—Ç—å –≤ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—ñ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä–∞ —É –≤–∞—à—ñ–π –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∏–π –æ–±—Å—è–≥ —Ç–∞ –¥–≤–∞ —Ç–∏–ø–∏ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

**–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∏–π –æ–±—Å—è–≥ –≤–∏–∑–Ω–∞—á–∞—î —Ä–µ—Å—É—Ä—Å–∏, —è–∫–∏–º–∏ –º–æ–∂–µ –∫–µ—Ä—É–≤–∞—Ç–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä Firewall Manager**. –ü—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è AWS Organizations –ø—ñ–¥–∫–ª—é—á–∞—î –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—é –¥–æ Firewall Manager, –≤—ñ–Ω –º–æ–∂–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤ –∑ —Ä—ñ–∑–Ω–∏–º–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∏–º–∏ –æ–±—Å—è–≥–∞–º–∏. –¶—ñ –æ–±—Å—è–≥–∏ –º–æ–∂—É—Ç—å –≤–∫–ª—é—á–∞—Ç–∏:

- –û–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –∞–±–æ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π–Ω—ñ –æ–¥–∏–Ω–∏—Ü—ñ (OUs), –¥–æ —è–∫–∏—Ö –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ –∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ –ø–æ–ª—ñ—Ç–∏–∫–∏.
- –†–µ–≥—ñ–æ–Ω–∏, –¥–µ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥—ñ—ó.
- –¢–∏–ø–∏ –ø–æ–ª—ñ—Ç–∏–∫ Firewall Manager, —è–∫–∏–º–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ –∫–µ—Ä—É–≤–∞—Ç–∏.

–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∏–π –æ–±—Å—è–≥ –º–æ–∂–µ –±—É—Ç–∏ –∞–±–æ **–ø–æ–≤–Ω–∏–º, –∞–±–æ –æ–±–º–µ–∂–µ–Ω–∏–º**. –ü–æ–≤–Ω–∏–π –æ–±—Å—è–≥ –Ω–∞–¥–∞—î –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—É –¥–æ—Å—Ç—É–ø –¥–æ **–≤—Å—ñ—Ö –∑–∞–∑–Ω–∞—á–µ–Ω–∏—Ö —Ç–∏–ø—ñ–≤ —Ä–µ—Å—É—Ä—Å—ñ–≤, —Ä–µ–≥—ñ–æ–Ω—ñ–≤ —Ç–∞ —Ç–∏–ø—ñ–≤ –ø–æ–ª—ñ—Ç–∏–∫**. –ù–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ —Ü—å–æ–≥–æ, **–æ–±–º–µ–∂–µ–Ω–∏–π –æ–±—Å—è–≥ –Ω–∞–¥–∞—î –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∏–π –¥–æ–∑–≤—ñ–ª –ª–∏—à–µ –Ω–∞ –ø—ñ–¥–º–Ω–æ–∂–∏–Ω—É —Ä–µ—Å—É—Ä—Å—ñ–≤, —Ä–µ–≥—ñ–æ–Ω—ñ–≤ –∞–±–æ —Ç–∏–ø—ñ–≤ –ø–æ–ª—ñ—Ç–∏–∫**. –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –Ω–∞–¥–∞–≤–∞—Ç–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –ª–∏—à–µ —Ç—ñ –¥–æ–∑–≤–æ–ª–∏, —è–∫—ñ —ó–º –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–≤–æ—ó—Ö —Ä–æ–ª–µ–π. –í–∏ –º–æ–∂–µ—Ç–µ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –±—É–¥—å-—è–∫—É –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—é —Ü–∏—Ö —É–º–æ–≤ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –æ–±—Å—è–≥—É –¥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –¥–æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø—Ä–∏–Ω—Ü–∏–ø—É –Ω–∞–π–º–µ–Ω—à–∏—Ö –ø—Ä–∏–≤—ñ–ª–µ—ó–≤.

–Ü—Å–Ω—É—é—Ç—å –¥–≤–∞ —Ä—ñ–∑–Ω—ñ —Ç–∏–ø–∏ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –∫–æ–∂–µ–Ω –∑ —è–∫–∏—Ö –≤–∏–∫–æ–Ω—É—î –ø–µ–≤–Ω—ñ —Ä–æ–ª—ñ —Ç–∞ –æ–±–æ–≤'—è–∑–∫–∏:

- **–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º:**
- –û–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –æ–±–ª—ñ–∫–æ–≤–∏–º –∑–∞–ø–∏—Å–æ–º —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—î—é AWS Organizations –ø—ñ–¥ —á–∞—Å –ø—Ä–æ—Ü–µ—Å—É –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ Firewall Manager.
- –¶–µ–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –º–∞—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∫–µ—Ä—É–≤–∞—Ç–∏ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ–º–∏ –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä–∞–º–∏ —Ç–∞ –≤–æ–ª–æ–¥—ñ—î –ø–æ–≤–Ω–∏–º –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∏–º –æ–±—Å—è–≥–æ–º.
- –í—ñ–Ω —Å–ª—É–∂–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–∏–º –æ–±–ª—ñ–∫–æ–≤–∏–º –∑–∞–ø–∏—Å–æ–º –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è Firewall Manager, –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∏–º –∑–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –ø–æ–ª—ñ—Ç–∏–∫ –±–µ–∑–ø–µ–∫–∏ —á–µ—Ä–µ–∑ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—é.
- –•–æ—á–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –º–∞—î –ø–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –≤—Å—ñ—Ö —Ç–∏–ø—ñ–≤ —Ä–µ—Å—É—Ä—Å—ñ–≤ —Ç–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π, –≤—ñ–Ω –ø—Ä–∞—Ü—é—î –Ω–∞ —Ç–æ–º—É –∂ —Ä—ñ–≤–Ω—ñ, —â–æ –π —ñ–Ω—à—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏, —è–∫—â–æ –≤ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –∫—ñ–ª—å–∫–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤.
- **–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏ Firewall Manager:**
- –¶—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏ –º–æ–∂—É—Ç—å –∫–µ—Ä—É–≤–∞—Ç–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –≤ –º–µ–∂–∞—Ö –æ–±—Å—è–≥—É, –≤–∏–∑–Ω–∞—á–µ–Ω–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–∏–º –∑–∞–ø–∏—Å–æ–º —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è AWS Organizations, —è–∫ –≤–∏–∑–Ω–∞—á–µ–Ω–æ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –æ–±—Å—è–≥—É.
- –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏ Firewall Manager —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–µ–≤–Ω–∏—Ö —Ä–æ–ª–µ–π —É –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –¥–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è –æ–±–æ–≤'—è–∑–∫—ñ–≤ –ø—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ñ–≤ –±–µ–∑–ø–µ–∫–∏ —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ.
- –ü—ñ–¥ —á–∞—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è Firewall Manager –ø–µ—Ä–µ–≤—ñ—Ä—è—î –∑ AWS Organizations, —á–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –≤–∂–µ —î –¥–µ–ª–µ–≥–æ–≤–∞–Ω–∏–º –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º. –Ø–∫—â–æ –Ω—ñ, Firewall Manager –∑–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ Organizations, —â–æ–± –ø—Ä–∏–∑–Ω–∞—á–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å —è–∫ –¥–µ–ª–µ–≥–æ–≤–∞–Ω–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è Firewall Manager.

–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ü–∏–º–∏ –æ–±–ª—ñ–∫–æ–≤–∏–º–∏ –∑–∞–ø–∏—Å–∞–º–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤–∫–ª—é—á–∞—î —ó—Ö —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —É Firewall Manager —Ç–∞ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —ó—Ö –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∏—Ö –æ–±—Å—è–≥—ñ–≤ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –≤–∏–º–æ–≥ –±–µ–∑–ø–µ–∫–∏ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó —Ç–∞ –ø—Ä–∏–Ω—Ü–∏–ø—É –Ω–∞–π–º–µ–Ω—à–∏—Ö –ø—Ä–∏–≤—ñ–ª–µ—ó–≤. –ü—Ä–∏–∑–Ω–∞—á–∞—é—á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ñ —Ä–æ–ª—ñ, –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó –º–æ–∂—É—Ç—å –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±–µ–∑–ø–µ–∫–æ—é –ø—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—é –Ω–∞–¥ –¥–æ—Å—Ç—É–ø–æ–º –¥–æ —á—É—Ç–ª–∏–≤–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤.

–í–∞–∂–ª–∏–≤–æ –ø—ñ–¥–∫—Ä–µ—Å–ª–∏—Ç–∏, —â–æ **–ª–∏—à–µ –æ–¥–∏–Ω –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å —É –º–µ–∂–∞—Ö –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó –º–æ–∂–µ —Å–ª—É–∂–∏—Ç–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º Firewall Manager**, –¥–æ—Ç—Ä–∏–º—É—é—á–∏—Å—å –ø—Ä–∏–Ω—Ü–∏–ø—É "**–ø–µ—Ä—à–∏–π —É–≤—ñ–π—à–æ–≤, –æ—Å—Ç–∞–Ω–Ω—ñ–π –≤–∏–π—à–æ–≤**". –©–æ–± –ø—Ä–∏–∑–Ω–∞—á–∏—Ç–∏ –Ω–æ–≤–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ä—è–¥ –∫—Ä–æ–∫—ñ–≤:

- –°–ø–æ—á–∞—Ç–∫—É –∫–æ–∂–µ–Ω –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ Firewall Manager –ø–æ–≤–∏–Ω–µ–Ω –≤—ñ–¥–∫–ª–∏–∫–∞—Ç–∏ —Å–≤—ñ–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å.
- –ü–æ—Ç—ñ–º —ñ—Å–Ω—É—é—á–∏–π –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –º–æ–∂–µ –≤—ñ–¥–∫–ª–∏–∫–∞—Ç–∏ —Å–≤—ñ–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å, –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤—ñ–¥–∫–ª—é—á–∞—é—á–∏ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—é –≤—ñ–¥ Firewall Manager. –¶–µ–π –ø—Ä–æ—Ü–µ—Å –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö –ø–æ–ª—ñ—Ç–∏–∫ Firewall Manager, —Å—Ç–≤–æ—Ä–µ–Ω–∏—Ö –≤—ñ–¥–∫–ª–∏–∫–∞–Ω–∏–º –æ–±–ª—ñ–∫–æ–≤–∏–º –∑–∞–ø–∏—Å–æ–º.
- –ù–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è, –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è AWS Organizations –ø–æ–≤–∏–Ω–µ–Ω –ø—Ä–∏–∑–Ω–∞—á–∏—Ç–∏ –Ω–æ–≤–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º Firewall Manager.

## Enumeration
```
# Users/Administrators

## Get the AWS Organizations account that is associated with AWS Firewall Manager as the AWS Firewall Manager default administrator
aws fms get-admin-account

## List of Firewall Manager administrators within the organization
aws fms list-admin-accounts-for-organization # ReadOnlyAccess policy is not enough for this

## Return a list of the member accounts in the FM administrator's AWS organization
aws fms list-member-accounts # Only a Firewall Manager administrator or the Organization's management account can make this request

## List the accounts that are managing the specified AWS Organizations member account
aws fms list-admins-managing-account # ReadOnlyAccess policy is not enough for this

# Resources

## Get the resources that a Firewall Manager administrator can manage
aws fms get-admin-scope --admin-account <value> # ReadOnlyAccess policy is not enough for this

## Returns the summary of the resource sets used
aws fms list-resource-sets # ReadOnlyAccess policy is not enough for this

## Get information about a specific resource set
aws fms get-resource-set --identifier <value>  # ReadOnlyAccess policy is not enough for this

## Retrieve the list of tags for a given resource
aws fms list-tags-for-resource --resource-arn <value>

## List of the resources in the AWS Organization's accounts that are available to be associated with a FM resource set. Only one account is supported per request.
aws fms list-compliance-status --member-account-ids <value> --resource-type <value> # ReadOnlyAccess policy is not enough for this

## List the resources that are currently associated to a resource set
aws fms list-resource-set-resources --identifier <value> # ReadOnlyAccess policy is not enough for this

# Policies

## Returns the list of policies
aws fms list-policies

## Get information about the specified AWS Firewall Manager policy
aws fms get-policy --policy-id <value>

## List all of the third-party firewall policies that are associated with the third-party firewall administrator's account
aws fms list-third-party-firewall-firewall-policies --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

# AppsList

## Return a list of apps list
aws fms list-apps-lists --max-results [1-100]

## Get information about the specified AWS Firewall Manager applications list
aws fms get-apps-list --list-id <value>

# Protocols

## Get the details of the Firewall Manager protocols list.
aws fms list-protocols-lists

## Get information about the specified AWS Firewall Manager Protocols list
aws fms get-protocols-list --list-id <value>

# Compliance

## Return a summary of which member accounts are protected by the specified policy
aws fms list-compliance-status --policy-id <policy-id>

## Get detailed compliance information about the specified member account (resources that are in and out of compliance with the specified policy)
aws fms get-compliance-detail --policy-id <value> --member-account <value>

# Other useful info

## Get information about the SNS topic that is used to record AWS Firewall Manager SNS logs (if any)
aws fms get-notification-channel

## Get policy-level attack summary information in the event of a potential DDoS attack
aws fms get-protection-status --policy-id <value> # Just for Shield Advanced policy

## Get the onboarding status of a Firewall Manager admin account to third-party firewall vendor tenant.
aws fms get-third-party-firewall-association-status --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

## Get violations' details for a resource based on the specified AWS Firewall Manager policy and AWS account.
aws fms get-violation-details --policy-id <value> --member-account <value> --resource-id <value> --resource-type <value>
```
## Post Exploitation / Bypass Detection

### `organizations:DescribeOrganization` & (`fms:AssociateAdminAccount`, `fms:DisassociateAdminAccount`, `fms:PutAdminAccount`)
–ê—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫ –∑ –¥–æ–∑–≤–æ–ª–æ–º **`fms:AssociateAdminAccount`** –∑–º–æ–∂–µ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –¥–ª—è Firewall Manager. –ó –¥–æ–∑–≤–æ–ª–æ–º **`fms:PutAdminAccount`** –∞—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫ –∑–º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∞–±–æ –æ–Ω–æ–≤–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ Firewall Manager, –∞ –∑ –¥–æ–∑–≤–æ–ª–æ–º **`fms:DisassociateAdminAccount`** –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –∞—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫ –∑–º–æ–∂–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –∞—Å–æ—Ü—ñ–∞—Ü—ñ—é –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ Firewall Manager.

- –í—ñ–¥'—î–¥–Ω–∞–Ω–Ω—è **–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º Firewall Manager —Å–ª—ñ–¥—É—î –ø–æ–ª—ñ—Ç–∏—Ü—ñ –ø–µ—Ä—à–∏–π –ø—Ä–∏–π—à–æ–≤ - –æ—Å—Ç–∞–Ω–Ω—ñ–π –ø—ñ—à–æ–≤**. –£—Å—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏ Firewall Manager –ø–æ–≤–∏–Ω–Ω—ñ –≤—ñ–¥'—î–¥–Ω–∞—Ç–∏—Å—è, –ø–µ—Ä—à –Ω—ñ–∂ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º Firewall Manager –∑–º–æ–∂–µ –≤—ñ–¥'—î–¥–Ω–∞—Ç–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å.
- –©–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ Firewall Manager –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **PutAdminAccount**, –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –ø–æ–≤–∏–Ω–µ–Ω –Ω–∞–ª–µ–∂–∞—Ç–∏ –¥–æ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó, —è–∫–∞ —Ä–∞–Ω—ñ—à–µ –±—É–ª–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–∞ –¥–æ Firewall Manager –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **AssociateAdminAccount**.
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ Firewall Manager –º–æ–∂–µ –±—É—Ç–∏ –∑–¥—ñ–π—Å–Ω–µ–Ω–æ –ª–∏—à–µ –æ–±–ª—ñ–∫–æ–≤–∏–º –∑–∞–ø–∏—Å–æ–º —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—î—é.
```bash
aws fms associate-admin-account --admin-account <value>
aws fms disassociate-admin-account
aws fms put-admin-account --admin-account <value>
```
**Potential Impact:** –í—Ç—Ä–∞—Ç–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è, —É—Ö–∏–ª–µ–Ω–Ω—è –≤—ñ–¥ –ø–æ–ª—ñ—Ç–∏–∫–∏, –ø–æ—Ä—É—à–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ —Ç–∞ –ø–æ—Ä—É—à–µ–Ω–Ω—è –∑–∞—Ö–æ–¥—ñ–≤ –±–µ–∑–ø–µ–∫–∏ –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ.

### `fms:PutPolicy`, `fms:DeletePolicy`

–ê—Ç–∞–∫—É—é—á–∏–π –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏ **`fms:PutPolicy`**, **`fms:DeletePolicy`** –∑–º–æ–∂–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏, –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∞–±–æ –Ω–∞–∑–∞–≤–∂–¥–∏ –≤–∏–¥–∞–ª—è—Ç–∏ –ø–æ–ª—ñ—Ç–∏–∫—É AWS Firewall Manager.
```bash
aws fms put-policy --policy <value> | --cli-input-json file://<policy.json> [--tag-list <value>]
aws fms delete-policy --policy-id <value> [--delete-all-policy-resources | --no-delete-all-policy-resources]
```
–ü—Ä–∏–∫–ª–∞–¥ –ø–æ–ª—ñ—Ç–∏–∫–∏ –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏ —á–µ—Ä–µ–∑ –¥–æ–∑–≤–æ–ª–µ–Ω—É security group, —â–æ–± –æ–±—ñ–π—Ç–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—è, –º–æ–∂–µ –±—É—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–º:
```json
{
"Policy": {
"PolicyName": "permisive_policy",
"SecurityServicePolicyData": {
"Type": "SECURITY_GROUPS_COMMON",
"ManagedServiceData": "{\"type\":\"SECURITY_GROUPS_COMMON\",\"securityGroups\":[{\"id\":\"<permisive_security_group_id>\"}], \"applyToAllEC2InstanceENIs\":\"true\",\"IncludeSharedVPC\":\"true\"}"
},
"ResourceTypeList": ["AWS::EC2::Instance", "AWS::EC2::NetworkInterface", "AWS::EC2::SecurityGroup", "AWS::ElasticLoadBalancingV2::LoadBalancer", "AWS::ElasticLoadBalancing::LoadBalancer"],
"ResourceType": "AWS::EC2::SecurityGroup",
"ExcludeResourceTags": false,
"ResourceTags": [],
"RemediationEnabled": true
},
"TagList": []
}
```
**Potential Impact:** –î–µ–º–æ–Ω—Ç–∞–∂ –∑–∞—Å–æ–±—ñ–≤ –±–µ–∑–ø–µ–∫–∏, —É—Ö–∏–ª–µ–Ω–Ω—è –≤—ñ–¥ –ø–æ–ª—ñ—Ç–∏–∫–∏, –ø–æ—Ä—É—à–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ, –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω—ñ –∑–±–æ—ó —Ç–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –≤–∏—Ç–æ–∫–∏ –¥–∞–Ω–∏—Ö —É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ.

### `fms:BatchAssociateResource`, `fms:BatchDisassociateResource`, `fms:PutResourceSet`, `fms:DeleteResourceSet`

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏ **`fms:BatchAssociateResource`** —Ç–∞ **`fms:BatchDisassociateResource`** –∑–º–æ–∂–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –∞—Å–æ—Ü—ñ—é–≤–∞—Ç–∏ –∞–±–æ –≤—ñ–¥'—î–¥–Ω—É–≤–∞—Ç–∏ —Ä–µ—Å—É—Ä—Å–∏ –≤—ñ–¥ –Ω–∞–±–æ—Ä—É —Ä–µ—Å—É—Ä—Å—ñ–≤ Firewall Manager. –ö—Ä—ñ–º —Ç–æ–≥–æ, –¥–æ–∑–≤–æ–ª–∏ **`fms:PutResourceSet`** —Ç–∞ **`fms:DeleteResourceSet`** –¥–æ–∑–≤–æ–ª—è—Ç—å –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏, –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∞–±–æ –≤–∏–¥–∞–ª—è—Ç–∏ —Ü—ñ –Ω–∞–±–æ—Ä–∏ —Ä–µ—Å—É—Ä—Å—ñ–≤ –∑ AWS Firewall Manager.
```bash
# Associate/Disassociate resources from a resource set
aws fms batch-associate-resource --resource-set-identifier <value> --items <value>
aws fms batch-disassociate-resource --resource-set-identifier <value> --items <value>

# Create, modify or delete a resource set
aws fms put-resource-set --resource-set <value> [--tag-list <value>]
aws fms delete-resource-set --identifier <value>
```
**Potential Impact:** –î–æ–¥–∞–≤–∞–Ω–Ω—è –∑–∞–π–≤–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –¥–æ –Ω–∞–±–æ—Ä—É —Ä–µ—Å—É—Ä—Å—ñ–≤ –∑–±—ñ–ª—å—à–∏—Ç—å —Ä—ñ–≤–µ–Ω—å —à—É–º—É –≤ –°–µ—Ä–≤—ñ—Å—ñ, —â–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –º–æ–∂–µ —Å–ø—Ä–∏—á–∏–Ω–∏—Ç–∏ DoS. –ö—Ä—ñ–º —Ç–æ–≥–æ, –∑–º—ñ–Ω–∏ –≤ –Ω–∞–±–æ—Ä–∞—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ –º–æ–∂—É—Ç—å –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –ø–æ—Ä—É—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ —Ä–µ—Å—É—Ä—Å—ñ–≤, –æ–±—Ö–æ–¥—É –ø–æ–ª—ñ—Ç–∏–∫, –ø–æ—Ä—É—à–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ —Ç–∞ –ø–æ—Ä—É—à–µ–Ω–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª—é –±–µ–∑–ø–µ–∫–∏ –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ.

### `fms:PutAppsList`, `fms:DeleteAppsList`

–ê—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫ –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏ **`fms:PutAppsList`** —Ç–∞ **`fms:DeleteAppsList`** –∑–º–æ–∂–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏, –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∞–±–æ –≤–∏–¥–∞–ª—è—Ç–∏ —Å–ø–∏—Å–∫–∏ –¥–æ–¥–∞—Ç–∫—ñ–≤ –∑ AWS Firewall Manager. –¶–µ –º–æ–∂–µ –±—É—Ç–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ, –æ—Å–∫—ñ–ª—å–∫–∏ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ñ –¥–æ–¥–∞—Ç–∫–∏ –º–æ–∂—É—Ç—å –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É, –∞–±–æ –¥–æ—Å—Ç—É–ø –¥–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤ –º–æ–∂–µ –±—É—Ç–∏ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–∏–π, —â–æ —Å–ø—Ä–∏—á–∏–Ω–∏—Ç—å DoS.
```bash
aws fms put-apps-list --apps-list <value> [--tag-list <value>]
aws fms delete-apps-list --list-id <value>
```
**Potential Impact:** –¶–µ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π, –æ–±—Ö–æ–¥—É –ø–æ–ª—ñ—Ç–∏–∫, –ø–æ—Ä—É—à–µ–Ω—å –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ —Ç–∞ –ø–æ—Ä—É—à–µ–Ω–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª—é –±–µ–∑–ø–µ–∫–∏ –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ.

### `fms:PutProtocolsList`, `fms:DeleteProtocolsList`

–ê—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫ –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏ **`fms:PutProtocolsList`** —Ç–∞ **`fms:DeleteProtocolsList`** –∑–º–æ–∂–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏, –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∞–±–æ –≤–∏–¥–∞–ª—è—Ç–∏ —Å–ø–∏—Å–∫–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ –∑ AWS Firewall Manager. –¢–∞–∫ —Å–∞–º–æ, —è–∫ —ñ –∑—ñ —Å–ø–∏—Å–∫–∞–º–∏ –¥–æ–¥–∞—Ç–∫—ñ–≤, —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ, –æ—Å–∫—ñ–ª—å–∫–∏ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è –∑–∞–≥–∞–ª—å–Ω–æ—é –ø—É–±–ª—ñ–∫–æ—é, –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ –º–æ–∂–µ –±—É—Ç–∏ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ, —â–æ —Å–ø—Ä–∏—á–∏–Ω–∏—Ç—å DoS.
```bash
aws fms put-protocols-list --apps-list <value> [--tag-list <value>]
aws fms delete-protocols-list --list-id <value>
```
**–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤:** –¶–µ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π, –æ–±—Ö–æ–¥—É –ø–æ–ª—ñ—Ç–∏–∫, –ø–æ—Ä—É—à–µ–Ω—å –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ —Ç–∞ –ø–æ—Ä—É—à–µ–Ω–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª—é –±–µ–∑–ø–µ–∫–∏ –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ.

### `fms:PutNotificationChannel`, `fms:DeleteNotificationChannel`

–ê—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫ –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏ **`fms:PutNotificationChannel`** —Ç–∞ **`fms:DeleteNotificationChannel`** –∑–º–æ–∂–µ –≤–∏–¥–∞–ª—è—Ç–∏ —Ç–∞ –ø—Ä–∏–∑–Ω–∞—á–∞—Ç–∏ —Ä–æ–ª—å IAM —ñ —Ç–µ–º—É Amazon Simple Notification Service (SNS), —è–∫—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î Firewall Manager –¥–ª—è –∑–∞–ø–∏—Å—É –∂—É—Ä–Ω–∞–ª—ñ–≤ SNS.

–©–æ–± –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **`fms:PutNotificationChannel`** –ø–æ–∑–∞ –∫–æ–Ω—Å–æ–ª–ª—é, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –ø–æ–ª—ñ—Ç–∏–∫—É –¥–æ—Å—Ç—É–ø—É –¥–æ —Ç–µ–º–∏ SNS, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –≤–∫–∞–∑–∞–Ω–æ–º—É **SnsRoleName** –ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –∂—É—Ä–Ω–∞–ª–∏ SNS. –Ø–∫—â–æ –Ω–∞–¥–∞–Ω–∏–π **SnsRoleName** —î —Ä–æ–ª–ª—é, –≤—ñ–¥–º—ñ–Ω–Ω–æ—é –≤—ñ–¥ **`AWSServiceRoleForFMS`**, –ø–æ—Ç—Ä—ñ–±–Ω–∞ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞ –¥–æ–≤—ñ—Ä—á–∞ –≤—ñ–¥–Ω–æ—Å–∏–Ω–∞, —â–æ–± –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –ø—Ä–∏–Ω—Ü–∏–ø–∞–ª—É —Å–ª—É–∂–±–∏ Firewall Manager **fms.amazonaws.com** –ø—Ä–∏–π–º–∞—Ç–∏ —Ü—é —Ä–æ–ª—å.

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–æ–ª—ñ—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø—É –¥–æ SNS:

{% content-ref url="../aws-services/aws-sns-enum.md" %}
[aws-sns-enum.md](../aws-services/aws-sns-enum.md)
{% endcontent-ref %}
```bash
aws fms put-notification-channel --sns-topic-arn <value> --sns-role-name <value>
aws fms delete-notification-channel
```
**Potential Impact:** –¶–µ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –ø—Ä–æ–ø—É—Å–∫—É —Å–ø–æ–≤—ñ—â–µ–Ω—å –ø—Ä–æ –±–µ–∑–ø–µ–∫—É, –∑–∞—Ç—Ä–∏–º–∫–∏ —É —Ä–µ–∞–≥—É–≤–∞–Ω–Ω—ñ –Ω–∞ —ñ–Ω—Ü–∏–¥–µ–Ω—Ç–∏, –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö –≤–∏—Ç–æ–∫—ñ–≤ –¥–∞–Ω–∏—Ö —Ç–∞ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–∏—Ö –∑–±–æ—ó–≤ —É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ.

### `fms:AssociateThirdPartyFirewall`, `fms:DisssociateThirdPartyFirewall`
–ê—Ç–∞–∫—É—é—á–∏–π –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏ **`fms:AssociateThirdPartyFirewall`**, **`fms:DisssociateThirdPartyFirewall`** –∑–º–æ–∂–µ –∞—Å–æ—Ü—ñ—é–≤–∞—Ç–∏ –∞–±–æ –≤—ñ–¥'—î–¥–Ω—É–≤–∞—Ç–∏ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ —Ñ–∞—î—Ä–≤–æ–ª–∏ –≤—ñ–¥ —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —á–µ—Ä–µ–∑ AWS Firewall Manager.
{% hint style="warning" %}
–¢—ñ–ª—å–∫–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –º–æ–∂–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Ç–∞ –∫–µ—Ä—É–≤–∞—Ç–∏ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ–º–∏ —Ñ–∞—î—Ä–≤–æ–ª–∞–º–∏.
{% endhint %}
```bash
aws fms associate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
aws fms disassociate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
```
**Potential Impact:** –í—ñ–¥'—î–¥–Ω–∞–Ω–Ω—è –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –æ–±—Ö–æ–¥—É –ø–æ–ª—ñ—Ç–∏–∫–∏, –ø–æ—Ä—É—à–µ–Ω—å –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ —Ç–∞ –ø–æ—Ä—É—à–µ–Ω–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª—é –±–µ–∑–ø–µ–∫–∏ –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ. –ó —ñ–Ω—à–æ–≥–æ –±–æ–∫—É, –∞—Å–æ—Ü—ñ–∞—Ü—ñ—è –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –ø–æ—Ä—É—à–µ–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É –≤–∏—Ç—Ä–∞—Ç —ñ –±—é–¥–∂–µ—Ç—É.

### `fms:TagResource`, `fms:UntagResource`

–ê—Ç–∞–∫—É—é—á–∏–π –∑–º–æ–∂–µ –¥–æ–¥–∞–≤–∞—Ç–∏, –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∞–±–æ –≤–∏–¥–∞–ª—è—Ç–∏ —Ç–µ–≥–∏ –∑ —Ä–µ—Å—É—Ä—Å—ñ–≤ Firewall Manager, –ø–æ—Ä—É—à—É—é—á–∏ —Ä–æ–∑–ø–æ–¥—ñ–ª –≤–∏—Ç—Ä–∞—Ç, –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤ —Ç–∞ –ø–æ–ª—ñ—Ç–∏–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç–µ–≥—ñ–≤ –≤–∞—à–æ—ó –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó.
```bash
aws fms tag-resource --resource-arn <value> --tag-list <value>
aws fms untag-resource --resource-arn <value> --tag-keys <value>
```
**Potential Impact**: –ü–æ—Ä—É—à–µ–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É –≤–∏—Ç—Ä–∞—Ç, –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤ —Ç–∞ –ø–æ–ª—ñ—Ç–∏–∫ –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç–µ–≥—ñ–≤.

## References

* [https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html](https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html)
* [https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html](https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html)

{% hint style="success" %}
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ –Ω–∞–º–∏** —É **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –ø–æ–¥–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
