# AWS - Firewall Manager Enum

{% hint style="success" %}
AWS Hacking öğrenin ve pratik yapın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking öğrenin ve pratik yapın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'da takip edin.**
* **HackTricks'e PR göndererek hacking ipuçlarını paylaşın** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub depolarına.

</details>
{% endhint %}

## Firewall Manager

**AWS Firewall Manager**, **AWS WAF, AWS Shield Advanced, Amazon VPC güvenlik grupları ve Ağ Erişim Kontrol Listeleri (ACL'ler), AWS Network Firewall, AWS Route 53 Resolver DNS Firewall ve üçüncü taraf firewall'ların** yönetimini ve bakımını kolaylaştırır. Güvenlik duvarı kurallarınızı, Shield Advanced korumalarını, VPC güvenlik gruplarını ve Network Firewall ayarlarını bir kez yapılandırmanıza olanak tanır ve hizmet, bu kuralları ve korumaları hesaplarınız ve kaynaklarınız arasında otomatik olarak uygular, yeni eklenenler de dahil.

Hizmet, ortak bir etiketi paylaşan kaynaklar veya tüm CloudFront dağıtımları gibi belirli kaynakları gruplama ve koruma yeteneği sunar. Firewall Manager'ın önemli bir avantajı, hesabınıza yeni eklenen kaynaklara otomatik olarak koruma genişletebilmesidir.

Bir **kural grubu** (bir WAF kuralları koleksiyonu), belirli AWS kaynaklarına (örneğin CloudFront dağıtımları veya uygulama yük dengeleyicileri) bağlı bir AWS Firewall Manager Politikasına dahil edilebilir.

AWS Firewall Manager, güvenlik grubu politikalarının yapılandırılmasını ve yönetimini basitleştirmek için **yönetilen uygulama ve protokol listeleri** sağlar. Bu listeler, politikalarınız tarafından izin verilen veya reddedilen protokolleri ve uygulamaları tanımlamanıza olanak tanır. İki tür yönetilen liste vardır:

* **Firewall Manager yönetilen listeleri**: Bu listeler **FMS-Default-Public-Access-Apps-Allowed**, **FMS-Default-Protocols-Allowed** ve **FMS-Default-Protocols-Allowed** içerir. Bu listeler Firewall Manager tarafından yönetilir ve genel halka izin verilmesi veya reddedilmesi gereken yaygın olarak kullanılan uygulamaları ve protokolleri içerir. Bu listeleri düzenlemek veya silmek mümkün değildir, ancak sürümünü seçebilirsiniz.
* **Özel yönetilen listeler**: Bu listeleri kendiniz yönetirsiniz. Kuruluşunuzun ihtiyaçlarına göre özel uygulama ve protokol listeleri oluşturabilirsiniz. Firewall Manager yönetilen listelerinin aksine, bu listelerin sürümleri yoktur, ancak özel listeler üzerinde tam kontrole sahipsiniz, bu da gerektiğinde oluşturma, düzenleme ve silme işlemlerini yapmanıza olanak tanır.

**Firewall Manager politikalarının bir kural grubu için yalnızca "Block" veya "Count" eylemlerine izin verdiğini**, "Allow" seçeneğinin olmadığını belirtmek önemlidir.

### Önkoşullar

Firewall Manager'ı yapılandırmaya başlamadan önce kuruluşunuzun kaynaklarını etkili bir şekilde korumak için aşağıdaki önkoşul adımlarının tamamlanması gerekmektedir. Bu adımlar, Firewall Manager'ın güvenlik politikalarını uygulaması ve AWS ortamınızda uyumluluğu sağlaması için gerekli temel ayarları sağlar:

1. **AWS Organizations'a katılın ve yapılandırın:** AWS hesabınızın, AWS Firewall Manager politikalarının uygulanmasının planlandığı AWS Organizations organizasyonunun bir parçası olduğundan emin olun. Bu, organizasyon içindeki birden fazla AWS hesabı arasında kaynakların ve politikaların merkezi olarak yönetilmesine olanak tanır.
2. **Bir AWS Firewall Manager Varsayılan Yönetici Hesabı oluşturun:** Firewall Manager güvenlik politikalarını yönetmek için özel olarak bir varsayılan yönetici hesabı oluşturun. Bu hesap, organizasyon genelinde güvenlik politikalarını yapılandırmaktan ve uygulamaktan sorumlu olacaktır. Organizasyonun yönetim hesabı, Firewall Manager varsayılan yönetici hesaplarını oluşturabilen tek hesaptır.
3. **AWS Config'i etkinleştirin:** AWS Config'i etkinleştirerek Firewall Manager'a güvenlik politikalarını etkili bir şekilde uygulamak için gerekli yapılandırma verilerini ve içgörüleri sağlayın. AWS Config, kaynak yapılandırmalarını ve değişikliklerini analiz etmeye, denetlemeye, izlemeye ve denetlemeye yardımcı olur, daha iyi güvenlik yönetimi sağlar.
4. **Üçüncü Taraf Politikaları için, AWS Marketplace'te abone olun ve Üçüncü Taraf Ayarlarını Yapılandırın:** Üçüncü taraf firewall politikalarını kullanmayı planlıyorsanız, AWS Marketplace'te bunlara abone olun ve gerekli ayarları yapılandırın. Bu adım, Firewall Manager'ın güvenilir üçüncü taraf satıcılardan gelen politikaları entegre etmesini ve uygulamasını sağlar.
5. **Ağ Firewall ve DNS Firewall Politikaları için kaynak paylaşımını etkinleştirin:** Ağ Firewall ve DNS Firewall politikaları için özel olarak kaynak paylaşımını etkinleştirin. Bu, Firewall Manager'ın organizasyonunuzun VPC'lerine ve DNS çözümlemesine firewall korumaları uygulamasına olanak tanır, ağ güvenliğini artırır.
6. **Varsayılan olarak devre dışı bırakılan Bölgelerde AWS Firewall Manager'ı kullanmak için:** Firewall Manager'ı varsayılan olarak devre dışı bırakılan AWS bölgelerinde kullanmayı planlıyorsanız, bu bölgelerde işlevselliğini etkinleştirmek için gerekli adımları attığınızdan emin olun. Bu, organizasyonunuzun faaliyet gösterdiği tüm bölgelerde tutarlı güvenlik uygulamasını sağlar.

Daha fazla bilgi için, [AWS WAF politikaları ile AWS Firewall Manager'a başlama](https://docs.aws.amazon.com/waf/latest/developerguide/getting-started-fms.html) sayfasına bakın.

### Koruma politikası türleri

AWS Firewall Manager, kuruluşunuzun altyapısının farklı yönlerinde güvenlik kontrollerini uygulamak için çeşitli politika türlerini yönetir:

1. **AWS WAF Politikası:** Bu politika türü hem AWS WAF hem de AWS WAF Classic'i destekler. Politika tarafından korunan kaynakları tanımlayabilirsiniz. AWS WAF politikaları için, web ACL'de ilk ve son çalışacak kural gruplarını belirtebilirsiniz. Ayrıca, hesap sahipleri bu setler arasında çalışacak kurallar ve kural grupları ekleyebilir.
2. **Shield Advanced Politikası:** Bu politika, belirli kaynak türleri için organizasyonunuz genelinde Shield Advanced korumalarını uygular. DDoS saldırılarına ve diğer tehditlere karşı koruma sağlar.
3. **Amazon VPC Güvenlik Grubu Politikası:** Bu politika ile organizasyonunuz genelinde kullanılan güvenlik gruplarını yönetebilir, AWS ortamınızda ağ erişimini kontrol etmek için temel bir kural seti uygulayabilirsiniz.
4. **Amazon VPC Ağ Erişim Kontrol Listesi (ACL) Politikası:** Bu politika türü, organizasyonunuzda kullanılan ağ ACL'leri üzerinde kontrol sağlar, AWS ortamınızda temel bir ağ ACL seti uygulamanıza olanak tanır.
5. **Ağ Firewall Politikası:** Bu politika, organizasyonunuzun VPC'lerine AWS Network Firewall koruması uygular, önceden tanımlanmış kurallara dayalı olarak trafiği filtreleyerek ağ güvenliğini artırır.
6. **Amazon Route 53 Resolver DNS Firewall Politikası:** Bu politika, organizasyonunuzun VPC'lerine DNS Firewall korumaları uygular, kötü niyetli alan adı çözümleme girişimlerini engellemeye ve DNS trafiği için güvenlik politikalarını uygulamaya yardımcı olur.
7. **Üçüncü Taraf Firewall Politikası:** Bu politika türü, AWS Marketplace konsolu aracılığıyla abonelikle kullanılabilen üçüncü taraf firewall'ların korumalarını uygular. Güvenilir satıcılardan ek güvenlik önlemlerini AWS ortamınıza entegre etmenize olanak tanır.
1. **Palo Alto Networks Cloud NGFW Politikası:** Bu politika, organizasyonunuzun VPC'lerine Palo Alto Networks Cloud Next Generation Firewall (NGFW) korumalarını ve kural setlerini uygular, gelişmiş tehdit önleme ve uygulama düzeyinde güvenlik kontrolleri sağlar.
2. **Fortigate Cloud Native Firewall (CNF) as a Service Politikası:** Bu politika, Fortigate Cloud Native Firewall (CNF) as a Service korumalarını uygular, bulut altyapıları için endüstri lideri tehdit önleme, web uygulama firewall (WAF) ve API koruması sunar.

### Yönetici hesapları

AWS Firewall Manager, organizasyonunuz içinde firewall kaynaklarını yönetme esnekliği sunar ve iki tür yönetici hesabı ile yönetim kapsamını belirler.

**Yönetim kapsamı, bir Firewall Manager yöneticisinin yönetebileceği kaynakları tanımlar**. Bir AWS Organizations yönetim hesabı, bir organizasyonu Firewall Manager'a dahil ettikten sonra, farklı yönetim kapsamlarına sahip ek yöneticiler oluşturabilir. Bu kapsamlar şunları içerebilir:

- Yöneticinin politikaları uygulayabileceği hesaplar veya organizasyon birimleri (OU'lar).
- Yöneticinin işlem yapabileceği bölgeler.
- Yöneticinin yönetebileceği Firewall Manager politika türleri.

Yönetim kapsamı, **tam veya kısıtlı** olabilir. Tam kapsam, yöneticiye **belirtilen tüm kaynak türlerine, bölgelere ve politika türlerine** erişim sağlar. Buna karşılık, **kısıtlı kapsam, yöneticinin yalnızca belirli bir kaynak, bölge veya politika türü alt kümesine yönetim izni sağlar**. Yöneticilere, rollerini etkili bir şekilde yerine getirmeleri için gereken izinleri vermek önerilir. Bu yönetim kapsamı koşullarının herhangi bir kombinasyonunu bir yöneticiye uygulayarak, en az ayrıcalık ilkesine uyulmasını sağlayabilirsiniz.

Her biri belirli roller ve sorumluluklar üstlenen iki farklı yönetici hesabı türü vardır:

- **Varsayılan Yönetici:**
- Varsayılan yönetici hesabı, Firewall Manager'a dahil olma sürecinde AWS Organizations organizasyonunun yönetim hesabı tarafından oluşturulur.
- Bu hesap, üçüncü taraf firewall'ları yönetme yeteneğine sahiptir ve tam yönetim kapsamına sahiptir.
- Organizasyon genelinde güvenlik politikalarını yapılandırmaktan ve uygulamaktan sorumlu birincil yönetici hesabı olarak hizmet eder.
- Varsayılan yönetici, tüm kaynak türlerine ve yönetim işlevlerine tam erişime sahipken, organizasyon içinde birden fazla yönetici kullanılıyorsa diğer yöneticilerle aynı düzeyde çalışır.
- **Firewall Manager Yöneticileri:**
- Bu yöneticiler, AWS Organizations yönetim hesabı tarafından belirlenen kapsam dahilinde kaynakları yönetebilir, yönetim kapsamı yapılandırması ile tanımlanır.
- Firewall Manager yöneticileri, organizasyon içinde belirli rolleri yerine getirmek için oluşturulur, sorumlulukların devredilmesine olanak tanır ve güvenlik ve uyumluluk standartlarını korur.
- Oluşturulduğunda, Firewall Manager, hesabın zaten atanmış bir yönetici olup olmadığını belirlemek için AWS Organizations ile kontrol eder. Değilse, Firewall Manager, hesabı Firewall Manager için atanmış bir yönetici olarak belirlemek için Organizations'a çağrı yapar.

Bu yönetici hesaplarını yönetmek, onları Firewall Manager içinde oluşturmayı ve organizasyonun güvenlik gereksinimlerine ve en az ayrıcalık ilkesine göre yönetim kapsamlarını tanımlamayı içerir. Uygun yönetim rollerini atayarak, organizasyonlar etkili güvenlik yönetimini sağlarken hassas kaynaklara erişim üzerinde ayrıntılı kontrol sağlayabilir.

**Bir organizasyon içinde yalnızca bir hesabın Firewall Manager varsayılan yöneticisi olarak hizmet edebileceğini** vurgulamak önemlidir, "**ilk giren, son çıkan**" ilkesine uyar. Yeni bir varsayılan yönetici atamak için bir dizi adım izlenmelidir:

- İlk olarak, her Firewall Manager yöneticisi kendi hesabını iptal etmelidir.
- Ardından, mevcut varsayılan yönetici kendi hesabını iptal edebilir, bu da organizasyonun Firewall Manager'dan çıkışını sağlar. Bu işlem, iptal edilen hesap tarafından oluşturulan tüm Firewall Manager politikalarının silinmesiyle sonuçlanır.
- Son olarak, AWS Organizations yönetim hesabı, Firewall Manager varsayılan yöneticisini atamalıdır.

## Enumeration
```
# Users/Administrators

## Get the AWS Organizations account that is associated with AWS Firewall Manager as the AWS Firewall Manager default administrator
aws fms get-admin-account

## List of Firewall Manager administrators within the organization
aws fms list-admin-accounts-for-organization # ReadOnlyAccess policy is not enough for this

## Return a list of the member accounts in the FM administrator's AWS organization
aws fms list-member-accounts # Only a Firewall Manager administrator or the Organization's management account can make this request

## List the accounts that are managing the specified AWS Organizations member account
aws fms list-admins-managing-account # ReadOnlyAccess policy is not enough for this

# Resources

## Get the resources that a Firewall Manager administrator can manage
aws fms get-admin-scope --admin-account <value> # ReadOnlyAccess policy is not enough for this

## Returns the summary of the resource sets used
aws fms list-resource-sets # ReadOnlyAccess policy is not enough for this

## Get information about a specific resource set
aws fms get-resource-set --identifier <value>  # ReadOnlyAccess policy is not enough for this

## Retrieve the list of tags for a given resource
aws fms list-tags-for-resource --resource-arn <value>

## List of the resources in the AWS Organization's accounts that are available to be associated with a FM resource set. Only one account is supported per request.
aws fms list-compliance-status --member-account-ids <value> --resource-type <value> # ReadOnlyAccess policy is not enough for this

## List the resources that are currently associated to a resource set
aws fms list-resource-set-resources --identifier <value> # ReadOnlyAccess policy is not enough for this

# Policies

## Returns the list of policies
aws fms list-policies

## Get information about the specified AWS Firewall Manager policy
aws fms get-policy --policy-id <value>

## List all of the third-party firewall policies that are associated with the third-party firewall administrator's account
aws fms list-third-party-firewall-firewall-policies --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

# AppsList

## Return a list of apps list
aws fms list-apps-lists --max-results [1-100]

## Get information about the specified AWS Firewall Manager applications list
aws fms get-apps-list --list-id <value>

# Protocols

## Get the details of the Firewall Manager protocols list.
aws fms list-protocols-lists

## Get information about the specified AWS Firewall Manager Protocols list
aws fms get-protocols-list --list-id <value>

# Compliance

## Return a summary of which member accounts are protected by the specified policy
aws fms list-compliance-status --policy-id <policy-id>

## Get detailed compliance information about the specified member account (resources that are in and out of compliance with the specified policy)
aws fms get-compliance-detail --policy-id <value> --member-account <value>

# Other useful info

## Get information about the SNS topic that is used to record AWS Firewall Manager SNS logs (if any)
aws fms get-notification-channel

## Get policy-level attack summary information in the event of a potential DDoS attack
aws fms get-protection-status --policy-id <value> # Just for Shield Advanced policy

## Get the onboarding status of a Firewall Manager admin account to third-party firewall vendor tenant.
aws fms get-third-party-firewall-association-status --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

## Get violations' details for a resource based on the specified AWS Firewall Manager policy and AWS account.
aws fms get-violation-details --policy-id <value> --member-account <value> --resource-id <value> --resource-type <value>
```
## Post Exploitation / Bypass Detection

### `organizations:DescribeOrganization` & (`fms:AssociateAdminAccount`, `fms:DisassociateAdminAccount`, `fms:PutAdminAccount`)
**`fms:AssociateAdminAccount`** iznine sahip bir saldırgan, Firewall Manager varsayılan yönetici hesabını ayarlayabilir. **`fms:PutAdminAccount`** iznine sahip bir saldırgan, bir Firewall Manager yönetici hesabı oluşturabilir veya güncelleyebilir ve **`fms:DisassociateAdminAccount`** iznine sahip potansiyel bir saldırgan, mevcut Firewall Manager yönetici hesabı ilişkilendirmesini kaldırabilir.

- **Firewall Manager varsayılan yöneticisinin ilişkisinin kesilmesi, ilk giren-son çıkar politikasını takip eder**. Tüm Firewall Manager yöneticileri ilişkiyi kesmelidir ki Firewall Manager varsayılan yöneticisi hesabı ilişkiyi kesebilsin.
- **PutAdminAccount** ile bir Firewall Manager yöneticisi oluşturmak için, hesap daha önce **AssociateAdminAccount** kullanılarak Firewall Manager'a dahil edilmiş olan organizasyona ait olmalıdır.
- Bir Firewall Manager yönetici hesabı oluşturma işlemi yalnızca organizasyonun yönetim hesabı tarafından yapılabilir.
```bash
aws fms associate-admin-account --admin-account <value>
aws fms disassociate-admin-account
aws fms put-admin-account --admin-account <value>
```
**Potansiyel Etki:** Merkezi yönetimin kaybı, politika ihlali, uyumluluk ihlalleri ve ortam içindeki güvenlik kontrollerinin bozulması.

### `fms:PutPolicy`, `fms:DeletePolicy`

**`fms:PutPolicy`**, **`fms:DeletePolicy`** izinlerine sahip bir saldırgan, bir AWS Firewall Manager politikasını oluşturabilir, değiştirebilir veya kalıcı olarak silebilir.
```bash
aws fms put-policy --policy <value> | --cli-input-json file://<policy.json> [--tag-list <value>]
aws fms delete-policy --policy-id <value> [--delete-all-policy-resources | --no-delete-all-policy-resources]
```
Bir algılamayı atlatmak için izin verici güvenlik grubu aracılığıyla izin verici politika örneği aşağıdaki gibi olabilir:
```json
{
"Policy": {
"PolicyName": "permisive_policy",
"SecurityServicePolicyData": {
"Type": "SECURITY_GROUPS_COMMON",
"ManagedServiceData": "{\"type\":\"SECURITY_GROUPS_COMMON\",\"securityGroups\":[{\"id\":\"<permisive_security_group_id>\"}], \"applyToAllEC2InstanceENIs\":\"true\",\"IncludeSharedVPC\":\"true\"}"
},
"ResourceTypeList": ["AWS::EC2::Instance", "AWS::EC2::NetworkInterface", "AWS::EC2::SecurityGroup", "AWS::ElasticLoadBalancingV2::LoadBalancer", "AWS::ElasticLoadBalancing::LoadBalancer"],
"ResourceType": "AWS::EC2::SecurityGroup",
"ExcludeResourceTags": false,
"ResourceTags": [],
"RemediationEnabled": true
},
"TagList": []
}
```
**Potansiyel Etki:** Güvenlik kontrollerinin kaldırılması, politika ihlalleri, uyumluluk ihlalleri, operasyonel kesintiler ve ortamda potansiyel veri ihlalleri.

### `fms:BatchAssociateResource`, `fms:BatchDisassociateResource`, `fms:PutResourceSet`, `fms:DeleteResourceSet`

**`fms:BatchAssociateResource`** ve **`fms:BatchDisassociateResource`** izinlerine sahip bir saldırgan, sırasıyla bir Firewall Manager kaynak setinden kaynakları ilişkilendirebilir veya ilişkilendirmeyi kaldırabilir. Ayrıca, **`fms:PutResourceSet`** ve **`fms:DeleteResourceSet`** izinleri, bir saldırganın AWS Firewall Manager'dan bu kaynak setlerini oluşturmasına, değiştirmesine veya silmesine olanak tanır.
```bash
# Associate/Disassociate resources from a resource set
aws fms batch-associate-resource --resource-set-identifier <value> --items <value>
aws fms batch-disassociate-resource --resource-set-identifier <value> --items <value>

# Create, modify or delete a resource set
aws fms put-resource-set --resource-set <value> [--tag-list <value>]
aws fms delete-resource-set --identifier <value>
```
**Potansiyel Etki:** Bir kaynak setine gereksiz miktarda öğe eklenmesi, Hizmette gürültü seviyesini artırarak potansiyel olarak bir DoS'a neden olabilir. Ayrıca, kaynak setlerindeki değişiklikler kaynak kesintisine, politika ihlaline, uyumluluk ihlallerine ve ortam içindeki güvenlik kontrollerinin bozulmasına yol açabilir.

### `fms:PutAppsList`, `fms:DeleteAppsList`

**`fms:PutAppsList`** ve **`fms:DeleteAppsList`** izinlerine sahip bir saldırgan, AWS Firewall Manager'dan uygulama listeleri oluşturabilir, değiştirebilir veya silebilir. Bu kritik olabilir, çünkü yetkisiz uygulamalara genel halka erişim izni verilebilir veya yetkili uygulamalara erişim engellenebilir, bu da bir DoS'a neden olabilir.
```bash
aws fms put-apps-list --apps-list <value> [--tag-list <value>]
aws fms delete-apps-list --list-id <value>
```
**Potansiyel Etki:** Bu, yanlış yapılandırmalara, politika ihlallerine, uyumluluk ihlallerine ve ortam içindeki güvenlik kontrollerinin bozulmasına neden olabilir.

### `fms:PutProtocolsList`, `fms:DeleteProtocolsList`

**`fms:PutProtocolsList`** ve **`fms:DeleteProtocolsList`** izinlerine sahip bir saldırgan, AWS Firewall Manager'dan protokol listeleri oluşturabilir, değiştirebilir veya silebilir. Uygulama listelerinde olduğu gibi, bu da kritik olabilir çünkü yetkisiz protokoller genel kamu tarafından kullanılabilir veya yetkili protokollerin kullanımı engellenebilir, bu da bir DoS'a neden olabilir.
```bash
aws fms put-protocols-list --apps-list <value> [--tag-list <value>]
aws fms delete-protocols-list --list-id <value>
```
**Potansiyel Etki:** Bu, yanlış yapılandırmalara, politika ihlallerine, uyumluluk ihlallerine ve ortam içindeki güvenlik kontrollerinin bozulmasına neden olabilir.

### `fms:PutNotificationChannel`, `fms:DeleteNotificationChannel`

**`fms:PutNotificationChannel`** ve **`fms:DeleteNotificationChannel`** izinlerine sahip bir saldırgan, Firewall Manager'ın SNS günlüklerini kaydetmek için kullandığı IAM rolünü ve Amazon Simple Notification Service (SNS) konusunu silebilir ve belirleyebilir.

**`fms:PutNotificationChannel`**'ı konsol dışında kullanmak için, belirtilen **SnsRoleName**'in SNS günlüklerini yayınlamasına izin veren bir SNS konu erişim politikası ayarlamanız gerekir. Sağlanan **SnsRoleName**, **`AWSServiceRoleForFMS`** dışında bir rol ise, Firewall Manager hizmet prensipali **fms.amazonaws.com**'un bu rolü üstlenmesine izin verecek şekilde bir güven ilişkisi yapılandırılması gereklidir.

Bir SNS erişim politikası yapılandırma hakkında bilgi için:

{% content-ref url="../aws-services/aws-sns-enum.md" %}
[aws-sns-enum.md](../aws-services/aws-sns-enum.md)
{% endcontent-ref %}
```bash
aws fms put-notification-channel --sns-topic-arn <value> --sns-role-name <value>
aws fms delete-notification-channel
```
**Potansiyel Etki:** Bu, güvenlik uyarılarının kaçırılmasına, olay müdahalesinin gecikmesine, potansiyel veri ihlallerine ve ortam içinde operasyonel kesintilere yol açabilir.

### `fms:AssociateThirdPartyFirewall`, `fms:DisssociateThirdPartyFirewall`
**`fms:AssociateThirdPartyFirewall`**, **`fms:DisssociateThirdPartyFirewall`** izinlerine sahip bir saldırgan, üçüncü taraf güvenlik duvarlarını AWS Firewall Manager üzerinden merkezi olarak yönetilecek şekilde ilişkilendirebilir veya ilişkilendirmeyi kaldırabilir.
{% hint style="warning" %}
Yalnızca varsayılan yönetici üçüncü taraf güvenlik duvarlarını oluşturabilir ve yönetebilir.
{% endhint %}
```bash
aws fms associate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
aws fms disassociate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
```
**Potansiyel Etki:** Ayrılma, politika ihlaline, uyumluluk ihlallerine ve ortam içindeki güvenlik kontrollerinin bozulmasına yol açar. Öte yandan, ilişkilendirme maliyet ve bütçe tahsisatının bozulmasına yol açar.

### `fms:TagResource`, `fms:UntagResource`

Bir saldırgan, Firewall Manager kaynaklarından etiket ekleyebilir, değiştirebilir veya kaldırabilir, bu da organizasyonunuzun maliyet tahsisini, kaynak takibini ve etiketlere dayalı erişim kontrol politikalarını bozabilir.
```bash
aws fms tag-resource --resource-arn <value> --tag-list <value>
aws fms untag-resource --resource-arn <value> --tag-keys <value>
```
**Potansiyel Etki**: Maliyet tahsisi, kaynak takibi ve etiket tabanlı erişim kontrol politikalarının bozulması.

## Referanslar

* [https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html](https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html)
* [https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html](https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html)

{% hint style="success" %}
AWS Hacking öğrenin ve pratik yapın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking öğrenin ve pratik yapın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **HackTricks ve** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github depolarına PR göndererek hacking ipuçlarını paylaşın.**

</details>
{% endhint %}
