# AWS - Firewall Manager Enum

{% hint style="success" %}
AWS Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХреЛ рд╕рдорд░реНрдерди рджреЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рд╣рдореЗрдВ **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
{% endhint %}

## Firewall Manager

**AWS Firewall Manager** рдХрдИ рдЦрд╛рддреЛрдВ рдФрд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдореЗрдВ **AWS WAF, AWS Shield Advanced, Amazon VPC security groups рдФрд░ Network Access Control Lists (ACLs), рдФрд░ AWS Network Firewall, AWS Route 53 Resolver DNS Firewall рдФрд░ рддреГрддреАрдп-рдкрдХреНрд╖ firewalls** рдХреЗ рдкреНрд░рдмрдВрдзрди рдФрд░ рд░рдЦрд░рдЦрд╛рд╡ рдХреЛ рд╕рд░рд▓ рдмрдирд╛рддрд╛ рд╣реИред рдпрд╣ рдЖрдкрдХреЛ рдЕрдкрдиреЗ firewall рдирд┐рдпрдореЛрдВ, Shield Advanced рд╕реБрд░рдХреНрд╖рд╛, VPC security groups, рдФрд░ Network Firewall рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рд╕реЗрд╡рд╛ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЗрди рдирд┐рдпрдореЛрдВ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдЖрдкрдХреЗ рдЦрд╛рддреЛрдВ рдФрд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдореЗрдВ рд▓рд╛рдЧреВ рдХрд░рддреА рд╣реИ**, рдЬрд┐рд╕рдореЗрдВ рдирдП рдЬреЛрдбрд╝реЗ рдЧрдП рднреА рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

рд╕реЗрд╡рд╛ рдЖрдкрдХреЛ **рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рд╕рдореВрд╣рд┐рдд рдФрд░ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдиреЗ** рдХреА рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рд╡реЗ рдЬреЛ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЯреИрдЧ рд╕рд╛рдЭрд╛ рдХрд░рддреЗ рд╣реИрдВ рдпрд╛ рдЖрдкрдХреЗ рд╕рднреА CloudFront рд╡рд┐рддрд░рдгред Firewall Manager рдХрд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд▓рд╛рдн рдпрд╣ рд╣реИ рдХрд┐ рдпрд╣ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдирдП рдЬреЛрдбрд╝реЗ рдЧрдП рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ**ред

рдПрдХ **rule group** (WAF рдирд┐рдпрдореЛрдВ рдХрд╛ рд╕рдВрдЧреНрд░рд╣) рдХреЛ AWS Firewall Manager Policy рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдлрд┐рд░ CloudFront рд╡рд┐рддрд░рдг рдпрд╛ application load balancers рдЬреИрд╕реЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ AWS рд╕рдВрд╕рд╛рдзрдиреЛрдВ рд╕реЗ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред

AWS Firewall Manager **managed application рдФрд░ protocol lists** рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ security group рдиреАрддрд┐рдпреЛрдВ рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдФрд░ рдкреНрд░рдмрдВрдзрди рдХреЛ рд╕рд░рд▓ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдпреЗ рд╕реВрдЪрд┐рдпрд╛рдБ рдЖрдкрдХреЛ рдЙрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдФрд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдкрдХреА рдиреАрддрд┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрдорддрд┐ рдпрд╛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рджреЛ рдкреНрд░рдХрд╛рд░ рдХреА managed lists рд╣реИрдВ:

* **Firewall Manager managed lists**: рдЗрди рд╕реВрдЪрд┐рдпреЛрдВ рдореЗрдВ **FMS-Default-Public-Access-Apps-Allowed**, **FMS-Default-Protocols-Allowed** рдФрд░ **FMS-Default-Protocols-Allowed** рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдЗрдиреНрд╣реЗрдВ Firewall Manager рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдореЗрдВ рдЖрдорддреМрд░ рдкрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдФрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдо рдЬрдирддрд╛ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рдпрд╛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдЗрдиреНрд╣реЗрдВ рд╕рдВрдкрд╛рджрд┐рдд рдпрд╛ рд╣рдЯрд╛рдпрд╛ рдирд╣реАрдВ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк рдЗрд╕рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* **Custom managed lists**: рдЖрдк рдЗрди рд╕реВрдЪрд┐рдпреЛрдВ рдХреЛ рд╕реНрд╡рдпрдВ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдЖрдк рдЕрдкрдиреА рд╕рдВрдЧрдарди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдХрд╕реНрдЯрдо рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдФрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕реВрдЪрд┐рдпрд╛рдБ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред Firewall Manager managed lists рдХреЗ рд╡рд┐рдкрд░реАрдд, рдЗрди рд╕реВрдЪрд┐рдпреЛрдВ рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЖрдкрдХреЗ рдкрд╛рд╕ рдХрд╕реНрдЯрдо рд╕реВрдЪрд┐рдпреЛрдВ рдкрд░ рдкреВрд░реНрдг рдирд┐рдпрдВрддреНрд░рдг рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЖрдк рдЖрд╡рд╢реНрдпрдХрддрд╛рдиреБрд╕рд╛рд░ рдЙрдиреНрд╣реЗрдВ рдмрдирд╛, рд╕рдВрдкрд╛рджрд┐рдд рдФрд░ рд╣рдЯрд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╣ рдзреНрдпрд╛рди рд░рдЦрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ **Firewall Manager рдиреАрддрд┐рдпрд╛рдБ рдХреЗрд╡рд▓ "Block" рдпрд╛ "Count" рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВ** рдХрд┐рд╕реА rule group рдХреЗ рд▓рд┐рдП, "Allow" рд╡рд┐рдХрд▓реНрдк рдХреЗ рдмрд┐рдирд╛ред

### Prerequisites

Firewall Manager рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреВрд░реНрд╡рд╛рдкреЗрдХреНрд╖рд┐рдд рдЪрд░рдгреЛрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рддрд╛рдХрд┐ рдЖрдкрдХреЗ рд╕рдВрдЧрдарди рдХреЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рдкреНрд░рднрд╛рд╡реА рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХреА рдЬрд╛ рд╕рдХреЗред рдпреЗ рдЪрд░рдг Firewall Manager рдХреЛ рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐рдпреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдФрд░ рдЖрдкрдХреЗ AWS рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдЕрдиреБрдкрд╛рд▓рди рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдмреБрдирд┐рдпрд╛рджреА рд╕реЗрдЯрдЕрдк рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ:

1. **AWS Organizations рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдФрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ:** рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдХрд╛ AWS рдЦрд╛рддрд╛ рдЙрд╕ AWS Organizations рд╕рдВрдЧрдарди рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ рдЬрд╣рд╛рдБ AWS Firewall Manager рдиреАрддрд┐рдпреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреА рдпреЛрдЬрдирд╛ рд╣реИред рдпрд╣ рд╕рдВрдЧрдарди рдХреЗ рднреАрддрд░ рдХрдИ AWS рдЦрд╛рддреЛрдВ рдореЗрдВ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдФрд░ рдиреАрддрд┐рдпреЛрдВ рдХреЗ рдХреЗрдВрджреНрд░реАрдХреГрдд рдкреНрд░рдмрдВрдзрди рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
2. **AWS Firewall Manager Default Administrator Account рдмрдирд╛рдПрдВ:** рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ Firewall Manager рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐рдпреЛрдВ рдХреЗ рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП рдПрдХ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЦрд╛рддрд╛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВред рдпрд╣ рдЦрд╛рддрд╛ рд╕рдВрдЧрдарди рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐рдпреЛрдВ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдФрд░ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реЛрдЧрд╛ред рдХреЗрд╡рд▓ рд╕рдВрдЧрдарди рдХрд╛ рдкреНрд░рдмрдВрдзрди рдЦрд╛рддрд╛ Firewall Manager рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЦрд╛рддреЗ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред
3. **AWS Config рд╕рдХреНрд╖рдо рдХрд░реЗрдВ:** AWS Config рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░реЗрдВ рддрд╛рдХрд┐ Firewall Manager рдХреЛ рдЖрд╡рд╢реНрдпрдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдбреЗрдЯрд╛ рдФрд░ рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ рдкреНрд░рджрд╛рди рдХреА рдЬрд╛ рд╕рдХреЗ рдЬреЛ рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐рдпреЛрдВ рдХреЛ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред AWS Config рд╕рдВрд╕рд╛рдзрди рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдФрд░ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг, рдСрдбрд┐рдЯ, рдореЙрдирд┐рдЯрд░ рдФрд░ рдСрдбрд┐рдЯ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдмреЗрд╣рддрд░ рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рдмрдВрдзрди рдХреА рд╕реБрд╡рд┐рдзрд╛ рдорд┐рд▓рддреА рд╣реИред
4. **рддреГрддреАрдп-рдкрдХреНрд╖ рдиреАрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП, AWS Marketplace рдореЗрдВ рд╕рджрд╕реНрдпрддрд╛ рд▓реЗрдВ рдФрд░ рддреГрддреАрдп-рдкрдХреНрд╖ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ:** рдпрджрд┐ рдЖрдк рддреГрддреАрдп-рдкрдХреНрд╖ firewall рдиреАрддрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛ рд░рд╣реЗ рд╣реИрдВ, рддреЛ AWS Marketplace рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рд╕рдмреНрд╕рдХреНрд░рд╛рдЗрдм рдХрд░реЗрдВ рдФрд░ рдЖрд╡рд╢реНрдпрдХ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВред рдпрд╣ рдЪрд░рдг рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ Firewall Manager рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рддреГрддреАрдп-рдкрдХреНрд╖ рд╡рд┐рдХреНрд░реЗрддрд╛рдУрдВ рд╕реЗ рдиреАрддрд┐рдпреЛрдВ рдХреЛ рдПрдХреАрдХреГрдд рдФрд░ рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
5. **Network Firewall рдФрд░ DNS Firewall рдиреАрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП, рд╕рдВрд╕рд╛рдзрди рд╕рд╛рдЭрд╛рдХрд░рдг рд╕рдХреНрд╖рдо рдХрд░реЗрдВ:** рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ Network Firewall рдФрд░ DNS Firewall рдиреАрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрд╕рд╛рдзрди рд╕рд╛рдЭрд╛рдХрд░рдг рд╕рдХреНрд╖рдо рдХрд░реЗрдВред рдпрд╣ Firewall Manager рдХреЛ рдЖрдкрдХреЗ рд╕рдВрдЧрдарди рдХреЗ VPCs рдФрд░ DNS рд╕рдВрдХрд▓реНрдк рдкрд░ firewall рд╕реБрд░рдХреНрд╖рд╛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рд╕реБрд░рдХреНрд╖рд╛ рдмрдврд╝рддреА рд╣реИред
6. **рдЙрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ AWS Firewall Manager рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрдХреНрд╖рдо рд╣реИрдВ:** рдпрджрд┐ рдЖрдк рдЙрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ Firewall Manager рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдЗрд░рд╛рджрд╛ рд░рдЦрддреЗ рд╣реИрдВ рдЬреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрдХреНрд╖рдо рд╣реИрдВ, рддреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдк рдЙрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рдЗрд╕рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдХрджрдо рдЙрдард╛рддреЗ рд╣реИрдВред рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдкрдХреЗ рд╕рдВрдЧрдарди рдХреЗ рд╕рдВрдЪрд╛рд▓рди рд╡рд╛рд▓реЗ рд╕рднреА рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рд▓рдЧрд╛рддрд╛рд░ рд╕реБрд░рдХреНрд╖рд╛ рд▓рд╛рдЧреВ рд╣реЛред

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рджреЗрдЦреЗрдВ:┬а[Getting started with AWS Firewall Manager AWS WAF policies](https://docs.aws.amazon.com/waf/latest/developerguide/getting-started-fms.html).

### Types of protection policies

AWS Firewall Manager рдЖрдкрдХреЗ рд╕рдВрдЧрдарди рдХреЗ рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдВрдЪреЗ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдкрд╣рд▓реБрдУрдВ рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдпрдВрддреНрд░рдг рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдкреНрд░рдХрд╛рд░ рдХреА рдиреАрддрд┐рдпреЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рддрд╛ рд╣реИ:

1. **AWS WAF Policy:** рдпрд╣ рдиреАрддрд┐ рдкреНрд░рдХрд╛рд░ AWS WAF рдФрд░ AWS WAF Classic рджреЛрдиреЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред рдЖрдк рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди рд╕реЗ рд╕рдВрд╕рд╛рдзрди рдиреАрддрд┐ рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рд╣реИрдВред AWS WAF рдиреАрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП, рдЖрдк рд╡реЗрдм ACL рдореЗрдВ рдкрд╣рд▓реЗ рдФрд░ рдЕрдВрддрд┐рдо рдЪрд▓рдиреЗ рд╡рд╛рд▓реЗ rule groups рдХреЗ рд╕реЗрдЯ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдЦрд╛рддрд╛ рдорд╛рд▓рд┐рдХ рдЗрди рд╕реЗрдЯреЛрдВ рдХреЗ рдмреАрдЪ рдЪрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдпрдо рдФрд░ rule groups рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред
2. **Shield Advanced Policy:** рдпрд╣ рдиреАрддрд┐ рдЖрдкрдХреЗ рд╕рдВрдЧрдарди рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕рдВрд╕рд╛рдзрди рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП Shield Advanced рд╕реБрд░рдХреНрд╖рд╛ рд▓рд╛рдЧреВ рдХрд░рддреА рд╣реИред рдпрд╣ DDoS рд╣рдорд▓реЛрдВ рдФрд░ рдЕрдиреНрдп рдЦрддрд░реЛрдВ рд╕реЗ рдмрдЪрд╛рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИред
3. **Amazon VPC Security Group Policy:** рдЗрд╕ рдиреАрддрд┐ рдХреЗ рд╕рд╛рде, рдЖрдк рдЕрдкрдиреЗ рд╕рдВрдЧрдарди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ security groups рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЕрдкрдиреЗ AWS рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ рдПрдХреНрд╕реЗрд╕ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдпрдореЛрдВ рдХрд╛ рдПрдХ рдЖрдзрд╛рд░рднреВрдд рд╕реЗрдЯ рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
4. **Amazon VPC Network Access Control List (ACL) Policy:** рдпрд╣ рдиреАрддрд┐ рдкреНрд░рдХрд╛рд░ рдЖрдкрдХреЛ рдЖрдкрдХреЗ рд╕рдВрдЧрдарди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ network ACLs рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЖрдк рдЕрдкрдиреЗ AWS рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ ACLs рдХрд╛ рдПрдХ рдЖрдзрд╛рд░рднреВрдд рд╕реЗрдЯ рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
5. **Network Firewall Policy:** рдпрд╣ рдиреАрддрд┐ рдЖрдкрдХреЗ рд╕рдВрдЧрдарди рдХреЗ VPCs рдкрд░ AWS Network Firewall рд╕реБрд░рдХреНрд╖рд╛ рд▓рд╛рдЧреВ рдХрд░рддреА рд╣реИ, рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдирд┐рдпрдореЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрдврд╝рд╛рддреА рд╣реИред
6. **Amazon Route 53 Resolver DNS Firewall Policy:** рдпрд╣ рдиреАрддрд┐ рдЖрдкрдХреЗ рд╕рдВрдЧрдарди рдХреЗ VPCs рдкрд░ DNS Firewall рд╕реБрд░рдХреНрд╖рд╛ рд▓рд╛рдЧреВ рдХрд░рддреА рд╣реИ, рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдбреЛрдореЗрди рд╕рдВрдХрд▓реНрдк рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рдиреЗ рдФрд░ DNS рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐рдпреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИред
7. **Third-Party Firewall Policy:** рдпрд╣ рдиреАрддрд┐ рдкреНрд░рдХрд╛рд░ рддреГрддреАрдп-рдкрдХреНрд╖ firewalls рд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рд▓рд╛рдЧреВ рдХрд░рддреА рд╣реИ, рдЬреЛ AWS Marketplace рдХрдВрд╕реЛрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рджрд╕реНрдпрддрд╛ рджреНрд╡рд╛рд░рд╛ рдЙрдкрд▓рдмреНрдз рд╣реИрдВред рдпрд╣ рдЖрдкрдХреЛ рдЕрдкрдиреЗ AWS рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд╡рд┐рдХреНрд░реЗрддрд╛рдУрдВ рд╕реЗ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рдХреЛ рдПрдХреАрдХреГрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
1. **Palo Alto Networks Cloud NGFW Policy:** рдпрд╣ рдиреАрддрд┐ рдЖрдкрдХреЗ рд╕рдВрдЧрдарди рдХреЗ VPCs рдкрд░ Palo Alto Networks Cloud Next Generation Firewall (NGFW) рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдирд┐рдпрдореЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреА рд╣реИ, рдЙрдиреНрдирдд рдЦрддрд░реЗ рдХреА рд░реЛрдХрдерд╛рдо рдФрд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧ-рд╕реНрддрд░реАрдп рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред
2. **Fortigate Cloud Native Firewall (CNF) as a Service Policy:** рдпрд╣ рдиреАрддрд┐ Fortigate Cloud Native Firewall (CNF) as a Service рд╕реБрд░рдХреНрд╖рд╛ рд▓рд╛рдЧреВ рдХрд░рддреА рд╣реИ, рдХреНрд▓рд╛рдЙрдб рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдВрдЪреЗ рдХреЗ рд▓рд┐рдП рдЙрджреНрдпреЛрдЧ-рдЕрдЧреНрд░рдгреА рдЦрддрд░реЗ рдХреА рд░реЛрдХрдерд╛рдо, рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ firewall (WAF), рдФрд░ API рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред

### Administrator accounts

AWS Firewall Manager рдЖрдкрдХреЗ рд╕рдВрдЧрдарди рдХреЗ рднреАрддрд░ firewall рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдкреНрд░рдмрдВрдзрди рдореЗрдВ рд▓рдЪреАрд▓рд╛рдкрди рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЗрд╕рдХреЗ рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рджрд╛рдпрд░реЗ рдФрд░ рджреЛ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЦрд╛рддреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред

**рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рджрд╛рдпрд░рд╛ рдЙрди рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдПрдХ Firewall Manager рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред рдПрдХ AWS Organizations рдкреНрд░рдмрдВрдзрди рдЦрд╛рддрд╛ Firewall Manager рдореЗрдВ рдПрдХ рд╕рдВрдЧрдарди рдХреЛ рдСрдирдмреЛрд░реНрдб рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдпрд╣ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рджрд╛рдпрд░реЛрдВ рдХреЗ рд╕рд╛рде рдЕрддрд┐рд░рд┐рдХреНрдд рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрди рджрд╛рдпрд░реЛрдВ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ:

- рдЦрд╛рддреЗ рдпрд╛ рд╕рдВрдЧрдардирд╛рддреНрдордХ рдЗрдХрд╛рдЗрдпрд╛рдБ (OUs) рдЬрд┐рди рдкрд░ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдиреАрддрд┐рдпрд╛рдБ рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
- рдХреНрд╖реЗрддреНрд░ рдЬрд╣рд╛рдБ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреНрд░рд┐рдпрд╛рдПрдБ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
- Firewall Manager рдиреАрддрд┐ рдкреНрд░рдХрд╛рд░ рдЬрд┐рдиреНрд╣реЗрдВ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рджрд╛рдпрд░рд╛ рдпрд╛ рддреЛ **рдкреВрд░реНрдг рдпрд╛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд** рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдкреВрд░реНрдг рджрд╛рдпрд░рд╛ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреЛ **рд╕рднреА рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕рдВрд╕рд╛рдзрди рдкреНрд░рдХрд╛рд░реЛрдВ, рдХреНрд╖реЗрддреНрд░реЛрдВ, рдФрд░ рдиреАрддрд┐ рдкреНрд░рдХрд╛рд░реЛрдВ** рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд, **рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рджрд╛рдпрд░рд╛ рдХреЗрд╡рд▓ рд╕рдВрд╕рд╛рдзрдиреЛрдВ, рдХреНрд╖реЗрддреНрд░реЛрдВ, рдпрд╛ рдиреАрддрд┐ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рдПрдХ рдЙрдкрд╕рдореБрдЪреНрдЪрдп рддрдХ рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рдЕрдиреБрдорддрд┐ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ**ред рдпрд╣ рд╕рд▓рд╛рд╣ рджреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХреЛрдВ рдХреЛ рдХреЗрд╡рд▓ рдЙрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рдкреНрд░рджрд╛рди рдХрд░реЗрдВ рдЬрд┐рдирдХреА рдЙрдиреНрд╣реЗрдВ рдЕрдкрдиреА рднреВрдорд┐рдХрд╛рдУрдВ рдХреЛ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдЖрдк рдХрд┐рд╕реА рднреА рд╕рдВрдпреЛрдЬрди рдореЗрдВ рдЗрди рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рджрд╛рдпрд░рд╛ рд╢рд░реНрддреЛрдВ рдХреЛ рдПрдХ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдкрд░ рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдиреНрдпреВрдирддрдо рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреЗ рд╕рд┐рджреНрдзрд╛рдВрдд рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реБрдПред

рджреЛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЦрд╛рддреЗ рд╣реИрдВ, рдкреНрд░рддреНрдпреЗрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рднреВрдорд┐рдХрд╛рдУрдВ рдФрд░ рдЬрд┐рдореНрдореЗрджрд╛рд░рд┐рдпреЛрдВ рдХреА рд╕реЗрд╡рд╛ рдХрд░рддреЗ рд╣реИрдВ:

- **Default Administrator:**
- рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЦрд╛рддрд╛ AWS Organizations рд╕рдВрдЧрдарди рдХреЗ рдкреНрд░рдмрдВрдзрди рдЦрд╛рддреЗ рджреНрд╡рд╛рд░рд╛ Firewall Manager рдореЗрдВ рдСрдирдмреЛрд░реНрдбрд┐рдВрдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рджреМрд░рд╛рди рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- рдЗрд╕ рдЦрд╛рддреЗ рдореЗрдВ рддреГрддреАрдп-рдкрдХреНрд╖ firewalls рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрддреА рд╣реИ рдФрд░ рдЗрд╕рдореЗрдВ рдкреВрд░реНрдг рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рджрд╛рдпрд░рд╛ рд╣реЛрддрд╛ рд╣реИред
- рдпрд╣ Firewall Manager рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рдердорд┐рдХ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЦрд╛рддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рд╕рдВрдЧрдарди рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐рдпреЛрдВ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдФрд░ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реЛрддрд╛ рд╣реИред
- рдЬрдмрдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреЗ рдкрд╛рд╕ рд╕рднреА рд╕рдВрд╕рд╛рдзрди рдкреНрд░рдХрд╛рд░реЛрдВ рдФрд░ рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛рдУрдВ рддрдХ рдкреВрд░реНрдг рдкрд╣реБрдВрдЪ рд╣реЛрддреА рд╣реИ, рдпрд╣ рд╕рдВрдЧрдарди рдХреЗ рднреАрддрд░ рдХрдИ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдкрд░ рдЕрдиреНрдп рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХреЛрдВ рдХреЗ рд╕рдорд╛рди рд╕реНрддрд░ рдкрд░ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИред
- **Firewall Manager Administrators:**
- рдпреЗ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ AWS Organizations рдкреНрд░рдмрдВрдзрди рдЦрд╛рддреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рджрд╛рдпрд░реЗ рдХреЗ рднреАрддрд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕рд╛ рдХрд┐ рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рджрд╛рдпрд░рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
- Firewall Manager рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рд╕рдВрдЧрдарди рдХреЗ рднреАрддрд░ рд╡рд┐рд╢рд┐рд╖реНрдЯ рднреВрдорд┐рдХрд╛рдУрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЬрд┐рдореНрдореЗрджрд╛рд░рд┐рдпреЛрдВ рдХрд╛ рд╡рд┐рддрд░рдг рд╣реЛрддрд╛ рд╣реИ рдЬрдмрдХрд┐ рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдЕрдиреБрдкрд╛рд▓рди рдорд╛рдирдХреЛрдВ рдХреЛ рдмрдирд╛рдП рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред
- рдирд┐рд░реНрдорд╛рдг рдХреЗ рд╕рдордп, Firewall Manager AWS Organizations рдХреЗ рд╕рд╛рде рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдЦрд╛рддрд╛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рд╣реИред рдпрджрд┐ рдирд╣реАрдВ, рддреЛ Firewall Manager Organizations рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЦрд╛рддреЗ рдХреЛ Firewall Manager рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдирд╛рдорд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

рдЗрди рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЦрд╛рддреЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди Firewall Manager рдХреЗ рднреАрддрд░ рдЙрдиреНрд╣реЗрдВ рдмрдирд╛рдирд╛ рдФрд░ рд╕рдВрдЧрдарди рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдФрд░ рдиреНрдпреВрдирддрдо рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреЗ рд╕рд┐рджреНрдзрд╛рдВрдд рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЙрдирдХреЗ рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рджрд╛рдпрд░реЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рдЙрдкрдпреБрдХреНрдд рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рднреВрдорд┐рдХрд╛рдУрдВ рдХреЛ рд╕реМрдВрдкрдХрд░, рд╕рдВрдЧрдарди рдкреНрд░рднрд╛рд╡реА рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рдмрдВрдзрди рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдмрдХрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рдкрд░ рд╕реВрдХреНрд╖реНрдо рдирд┐рдпрдВрддреНрд░рдг рдмрдирд╛рдП рд░рдЦ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ **рдХреЗрд╡рд▓ рдПрдХ рдЦрд╛рддрд╛ рд╕рдВрдЧрдарди рдХреЗ рднреАрддрд░ Firewall Manager рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░ рд╕рдХрддрд╛ рд╣реИ**, "**рдкрд╣рд▓реЗ рдЕрдВрджрд░, рдЖрдЦрд┐рд░реА рдмрд╛рд╣рд░**" рдХреЗ рд╕рд┐рджреНрдзрд╛рдВрдд рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реБрдПред рдПрдХ рдирдпрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдирд╛рдорд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ:

- рдкрд╣рд▓реЗ, рдкреНрд░рддреНрдпреЗрдХ Firewall Administrator рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЦрд╛рддреЗ рдХреЛ рдЕрдкрдиреЗ рдЦрд╛рддреЗ рдХреЛ рд░рджреНрдж рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред
- рдлрд┐рд░, рдореМрдЬреВрджрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреЛ рдЕрдкрдиреЗ рдЦрд╛рддреЗ рдХреЛ рд░рджреНрдж рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЬрд┐рд╕рд╕реЗ рд╕рдВрдЧрдарди рдХреЛ Firewall Manager рд╕реЗ рдСрдлрд╝рдмреЛрд░реНрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рд░рджреНрдж рдХрд┐рдП рдЧрдП рдЦрд╛рддреЗ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рд╕рднреА Firewall Manager рдиреАрддрд┐рдпреЛрдВ рдХреЛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред
- рдЕрдВрдд рдореЗрдВ, AWS Organizations рдкреНрд░рдмрдВрдзрди рдЦрд╛рддреЗ рдХреЛ Firewall Manager рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреЛ рдирд╛рдорд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

## Enumeration
```
# Users/Administrators

## Get the AWS Organizations account that is associated with AWS Firewall Manager as the AWS Firewall Manager default administrator
aws fms get-admin-account

## List of Firewall Manager administrators within the organization
aws fms list-admin-accounts-for-organization # ReadOnlyAccess policy is not enough for this

## Return a list of the member accounts in the FM administrator's AWS organization
aws fms list-member-accounts # Only a Firewall Manager administrator or the Organization's management account can make this request

## List the accounts that are managing the specified AWS Organizations member account
aws fms list-admins-managing-account # ReadOnlyAccess policy is not enough for this

# Resources

## Get the resources that a Firewall Manager administrator can manage
aws fms get-admin-scope --admin-account <value> # ReadOnlyAccess policy is not enough for this

## Returns the summary of the resource sets used
aws fms list-resource-sets # ReadOnlyAccess policy is not enough for this

## Get information about a specific resource set
aws fms get-resource-set --identifier <value>  # ReadOnlyAccess policy is not enough for this

## Retrieve the list of tags for a given resource
aws fms list-tags-for-resource --resource-arn <value>

## List of the resources in the AWS Organization's accounts that are available to be associated with a FM resource set. Only one account is supported per request.
aws fms list-compliance-status --member-account-ids <value> --resource-type <value> # ReadOnlyAccess policy is not enough for this

## List the resources that are currently associated to a resource set
aws fms list-resource-set-resources --identifier <value> # ReadOnlyAccess policy is not enough for this

# Policies

## Returns the list of policies
aws fms list-policies

## Get information about the specified AWS Firewall Manager policy
aws fms get-policy --policy-id <value>

## List all of the third-party firewall policies that are associated with the third-party firewall administrator's account
aws fms list-third-party-firewall-firewall-policies --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

# AppsList

## Return a list of apps list
aws fms list-apps-lists --max-results [1-100]

## Get information about the specified AWS Firewall Manager applications list
aws fms get-apps-list --list-id <value>

# Protocols

## Get the details of the Firewall Manager protocols list.
aws fms list-protocols-lists

## Get information about the specified AWS Firewall Manager Protocols list
aws fms get-protocols-list --list-id <value>

# Compliance

## Return a summary of which member accounts are protected by the specified policy
aws fms list-compliance-status --policy-id <policy-id>

## Get detailed compliance information about the specified member account (resources that are in and out of compliance with the specified policy)
aws fms get-compliance-detail --policy-id <value> --member-account <value>

# Other useful info

## Get information about the SNS topic that is used to record AWS Firewall Manager SNS logs (if any)
aws fms get-notification-channel

## Get policy-level attack summary information in the event of a potential DDoS attack
aws fms get-protection-status --policy-id <value> # Just for Shield Advanced policy

## Get the onboarding status of a Firewall Manager admin account to third-party firewall vendor tenant.
aws fms get-third-party-firewall-association-status --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

## Get violations' details for a resource based on the specified AWS Firewall Manager policy and AWS account.
aws fms get-violation-details --policy-id <value> --member-account <value> --resource-id <value> --resource-type <value>
```
## Post Exploitation / Bypass Detection

### `organizations:DescribeOrganization` & (`fms:AssociateAdminAccount`, `fms:DisassociateAdminAccount`, `fms:PutAdminAccount`)
рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ **`fms:AssociateAdminAccount`** рдЕрдиреБрдорддрд┐ рд╣реИ, рд╡рд╣ Firewall Manager рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреНрд░рд╢рд╛рд╕рдХ рдЦрд╛рддрд╛ рд╕реЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред **`fms:PutAdminAccount`** рдЕрдиреБрдорддрд┐ рдХреЗ рд╕рд╛рде, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ Firewall Manager рдкреНрд░рд╢рд╛рд╕рдХ рдЦрд╛рддрд╛ рдмрдирд╛ рдпрд╛ рдЕрдкрдбреЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **`fms:DisassociateAdminAccount`** рдЕрдиреБрдорддрд┐ рдХреЗ рд╕рд╛рде, рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рд╣рдорд▓рд╛рд╡рд░ рд╡рд░реНрддрдорд╛рди Firewall Manager рдкреНрд░рд╢рд╛рд╕рдХ рдЦрд╛рддрд╛ рд╕рдВрдШ рдХреЛ рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИред

- **Firewall Manager рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреНрд░рд╢рд╛рд╕рдХ рдХрд╛ рд╡рд┐рдШрдЯрди рдкрд╣рд▓реЗ-рдЖрдЦрд┐рд░реА-рдЖрдЙрдЯ рдиреАрддрд┐ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддрд╛ рд╣реИ**ред рд╕рднреА Firewall Manager рдкреНрд░рд╢рд╛рд╕рдХреЛрдВ рдХреЛ рд╡рд┐рдШрдЯрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ Firewall Manager рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреНрд░рд╢рд╛рд╕рдХ рдЦрд╛рддрд╛ рд╡рд┐рдШрдЯрд┐рдд рдХрд░ рд╕рдХреЗред
- **PutAdminAccount** рджреНрд╡рд╛рд░рд╛ Firewall Manager рдкреНрд░рд╢рд╛рд╕рдХ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЦрд╛рддрд╛ рдЙрд╕ рд╕рдВрдЧрдарди рдХрд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕реЗ рдкрд╣рд▓реЗ **AssociateAdminAccount** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Firewall Manager рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред
- Firewall Manager рдкреНрд░рд╢рд╛рд╕рдХ рдЦрд╛рддрд╛ рдХреЗрд╡рд▓ рд╕рдВрдЧрдарди рдХреЗ рдкреНрд░рдмрдВрдзрди рдЦрд╛рддреЗ рджреНрд╡рд╛рд░рд╛ рд╣реА рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```bash
aws fms associate-admin-account --admin-account <value>
aws fms disassociate-admin-account
aws fms put-admin-account --admin-account <value>
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдХреЗрдВрджреНрд░реАрдХреГрдд рдкреНрд░рдмрдВрдзрди рдХрд╛ рдиреБрдХрд╕рд╛рди, рдиреАрддрд┐ рд╕реЗ рдмрдЪрд╛рд╡, рдЕрдиреБрдкрд╛рд▓рди рдЙрд▓реНрд▓рдВрдШрди, рдФрд░ рд╡рд╛рддрд╛рд╡рд░рдг рдХреЗ рднреАрддрд░ рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдпрдВрддреНрд░рдгреЛрдВ рдХрд╛ рд╡рд┐рдШрдЯрдиред

### `fms:PutPolicy`, `fms:DeletePolicy`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ **`fms:PutPolicy`**, **`fms:DeletePolicy`** рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реИрдВ, рд╡рд╣ рдПрдХ AWS Firewall Manager рдиреАрддрд┐ рдХреЛ рдмрдирд╛, рд╕рдВрд╢реЛрдзрд┐рдд рдпрд╛ рд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИред
```bash
aws fms put-policy --policy <value> | --cli-input-json file://<policy.json> [--tag-list <value>]
aws fms delete-policy --policy-id <value> [--delete-all-policy-resources | --no-delete-all-policy-resources]
```
рдПрдХ рдЙрджрд╛рд╣рд░рдг рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓реА рдиреАрддрд┐ рдХрд╛, рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдореВрд╣ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдЬреЛ рдбрд┐рдЯреЗрдХреНрд╢рди рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:
```json
{
"Policy": {
"PolicyName": "permisive_policy",
"SecurityServicePolicyData": {
"Type": "SECURITY_GROUPS_COMMON",
"ManagedServiceData": "{\"type\":\"SECURITY_GROUPS_COMMON\",\"securityGroups\":[{\"id\":\"<permisive_security_group_id>\"}], \"applyToAllEC2InstanceENIs\":\"true\",\"IncludeSharedVPC\":\"true\"}"
},
"ResourceTypeList": ["AWS::EC2::Instance", "AWS::EC2::NetworkInterface", "AWS::EC2::SecurityGroup", "AWS::ElasticLoadBalancingV2::LoadBalancer", "AWS::ElasticLoadBalancing::LoadBalancer"],
"ResourceType": "AWS::EC2::SecurityGroup",
"ExcludeResourceTags": false,
"ResourceTags": [],
"RemediationEnabled": true
},
"TagList": []
}
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдпрдВрддреНрд░рдгреЛрдВ рдХрд╛ рд╡рд┐рдШрдЯрди, рдиреАрддрд┐ рд╕реЗ рдмрдЪрд╛рд╡, рдЕрдиреБрдкрд╛рд▓рди рдЙрд▓реНрд▓рдВрдШрди, рдкрд░рд┐рдЪрд╛рд▓рди рдореЗрдВ рд╡реНрдпрд╡рдзрд╛рди, рдФрд░ рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЗ рднреАрддрд░ рд╕рдВрднрд╛рд╡рд┐рдд рдбреЗрдЯрд╛ рдЙрд▓реНрд▓рдВрдШрдиред

### `fms:BatchAssociateResource`, `fms:BatchDisassociateResource`, `fms:PutResourceSet`, `fms:DeleteResourceSet`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ **`fms:BatchAssociateResource`** рдФрд░ **`fms:BatchDisassociateResource`** рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реИрдВ, рд╡рд╣ рдХреНрд░рдорд╢рдГ Firewall Manager рд╕рдВрд╕рд╛рдзрди рд╕реЗрдЯ рд╕реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдпрд╛ рд╣рдЯрд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛ред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, **`fms:PutResourceSet`** рдФрд░ **`fms:DeleteResourceSet`** рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ AWS Firewall Manager рд╕реЗ рдЗрди рд╕рдВрд╕рд╛рдзрди рд╕реЗрдЯреЛрдВ рдХреЛ рдмрдирд╛рдиреЗ, рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдпрд╛ рд╣рдЯрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдВрдЧреАред
```bash
# Associate/Disassociate resources from a resource set
aws fms batch-associate-resource --resource-set-identifier <value> --items <value>
aws fms batch-disassociate-resource --resource-set-identifier <value> --items <value>

# Create, modify or delete a resource set
aws fms put-resource-set --resource-set <value> [--tag-list <value>]
aws fms delete-resource-set --identifier <value>
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рд╕рдВрд╕рд╛рдзрди рд╕реЗрдЯ рдореЗрдВ рдЕрдирд╛рд╡рд╢реНрдпрдХ рдорд╛рддреНрд░рд╛ рдореЗрдВ рдЖрдЗрдЯрдо рдЬреЛрдбрд╝рдиреЗ рд╕реЗ рд╕реЗрд╡рд╛ рдореЗрдВ рд╢реЛрд░ рдХрд╛ рд╕реНрддрд░ рдмрдврд╝ рдЬрд╛рдПрдЧрд╛, рдЬрд┐рд╕рд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ DoS рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕рдВрд╕рд╛рдзрди рд╕реЗрдЯ рдореЗрдВ рдмрджрд▓рд╛рд╡ рд╕реЗ рд╕рдВрд╕рд╛рдзрди рдореЗрдВ рд╡реНрдпрд╡рдзрд╛рди, рдиреАрддрд┐ рд╕реЗ рдмрдЪрд╛рд╡, рдЕрдиреБрдкрд╛рд▓рди рдЙрд▓реНрд▓рдВрдШрди, рдФрд░ рд╡рд╛рддрд╛рд╡рд░рдг рдХреЗ рднреАрддрд░ рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдпрдВрддреНрд░рдгреЛрдВ рдореЗрдВ рд╡реНрдпрд╡рдзрд╛рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### `fms:PutAppsList`, `fms:DeleteAppsList`

**`fms:PutAppsList`** рдФрд░ **`fms:DeleteAppsList`** рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рд╣рдорд▓рд╛рд╡рд░ AWS Firewall Manager рд╕реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реВрдЪрд┐рдпреЛрдВ рдХреЛ рдмрдирд╛, рд╕рдВрд╢реЛрдзрд┐рдд рдпрд╛ рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЕрдирдзрд┐рдХреГрдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдкрд╣реБрдВрдЪ рдХреА рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, рдпрд╛ рдЕрдзрд┐рдХреГрдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдкрд╣реБрдВрдЪ рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ DoS рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
```bash
aws fms put-apps-list --apps-list <value> [--tag-list <value>]
aws fms delete-apps-list --list-id <value>
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдЗрд╕рд╕реЗ рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди, рдиреАрддрд┐ рдЙрд▓реНрд▓рдВрдШрди, рдЕрдиреБрдкрд╛рд▓рди рдЙрд▓реНрд▓рдВрдШрди, рдФрд░ рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЗ рднреАрддрд░ рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдпрдВрддреНрд░рдгреЛрдВ рдореЗрдВ рд╡реНрдпрд╡рдзрд╛рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### `fms:PutProtocolsList`, `fms:DeleteProtocolsList`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ **`fms:PutProtocolsList`** рдФрд░ **`fms:DeleteProtocolsList`** рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реИрдВ, рд╡рд╣ AWS Firewall Manager рд╕реЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕реВрдЪрд┐рдпреЛрдВ рдХреЛ рдмрдирд╛, рд╕рдВрд╢реЛрдзрд┐рдд рдпрд╛ рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕реА рддрд░рд╣ рдЬреИрд╕реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реВрдЪрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рд╣реЛрддрд╛ рд╣реИ, рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЕрдирдзрд┐рдХреГрдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрдо рдЬрдирддрд╛ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╛ рдЕрдзрд┐рдХреГрдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ DoS рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
```bash
aws fms put-protocols-list --apps-list <value> [--tag-list <value>]
aws fms delete-protocols-list --list-id <value>
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдЗрд╕рд╕реЗ рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди, рдиреАрддрд┐ рд╕реЗ рдмрдЪрд╛рд╡, рдЕрдиреБрдкрд╛рд▓рди рдЙрд▓реНрд▓рдВрдШрди, рдФрд░ рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЗ рднреАрддрд░ рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдпрдВрддреНрд░рдгреЛрдВ рдореЗрдВ рд╡реНрдпрд╡рдзрд╛рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### `fms:PutNotificationChannel`, `fms:DeleteNotificationChannel`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ **`fms:PutNotificationChannel`** рдФрд░ **`fms:DeleteNotificationChannel`** рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реИрдВ, рд╡рд╣ IAM рднреВрдорд┐рдХрд╛ рдФрд░ Amazon Simple Notification Service (SNS) рд╡рд┐рд╖рдп рдХреЛ рд╣рдЯрд╛ рдФрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ Firewall Manager SNS рд▓реЙрдЧ рд░рд┐рдХреЙрд░реНрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИред

рдХрдВрд╕реЛрд▓ рдХреЗ рдмрд╛рд╣рд░ **`fms:PutNotificationChannel`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ SNS рд╡рд┐рд╖рдп рдХреА рдПрдХреНрд╕реЗрд╕ рдиреАрддрд┐ рд╕реЗрдЯ рдХрд░рдиреА рд╣реЛрдЧреА, рдЬрд┐рд╕рд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ **SnsRoleName** рдХреЛ SNS рд▓реЙрдЧ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИред рдпрджрд┐ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ **SnsRoleName** **`AWSServiceRoleForFMS`** рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдХреЛрдИ рдЕрдиреНрдп рднреВрдорд┐рдХрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ Firewall Manager рд╕реЗрд╡рд╛ рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓ **fms.amazonaws.com** рдХреЛ рдЗрд╕ рднреВрдорд┐рдХрд╛ рдХреЛ рдЧреНрд░рд╣рдг рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЯреНрд░рд╕реНрдЯ рд╕рдВрдмрдВрдз рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

SNS рдПрдХреНрд╕реЗрд╕ рдиреАрддрд┐ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП:

{% content-ref url="../aws-services/aws-sns-enum.md" %}
[aws-sns-enum.md](../aws-services/aws-sns-enum.md)
{% endcontent-ref %}
```bash
aws fms put-notification-channel --sns-topic-arn <value> --sns-role-name <value>
aws fms delete-notification-channel
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдЗрд╕рд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рдЕрд▓рд░реНрдЯ рдЫреВрдЯ рд╕рдХрддреЗ рд╣реИрдВ, рдШрдЯрдирд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рджреЗрд░реА рд╣реЛ рд╕рдХрддреА рд╣реИ, рд╕рдВрднрд╛рд╡рд┐рдд рдбреЗрдЯрд╛ рдЙрд▓реНрд▓рдВрдШрди рдФрд░ рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЗ рднреАрддрд░ рдкрд░рд┐рдЪрд╛рд▓рди рд╡реНрдпрд╡рдзрд╛рди рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

### `fms:AssociateThirdPartyFirewall`, `fms:DisssociateThirdPartyFirewall`
рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ **`fms:AssociateThirdPartyFirewall`**, **`fms:DisssociateThirdPartyFirewall`** рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реИрдВ, рд╡рд╣ AWS Firewall Manager рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреЗрдВрджреНрд░реАрдХреГрдд рд░реВрдк рд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рддреГрддреАрдп-рдкрдХреНрд╖ рдлрд╛рдпрд░рд╡реЙрд▓ рдХреЛ рдЬреЛрдбрд╝ рдпрд╛ рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИред
{% hint style="warning" %}
рдХреЗрд╡рд▓ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рддреГрддреАрдп-рдкрдХреНрд╖ рдлрд╛рдпрд░рд╡реЙрд▓ рдмрдирд╛ рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}
```bash
aws fms associate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
aws fms disassociate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдЕрд╕реЛрд╕рд┐рдПрд╢рди рд╣рдЯрд╛рдиреЗ рд╕реЗ рдиреАрддрд┐ рдХрд╛ рдЙрд▓реНрд▓рдВрдШрди, рдЕрдиреБрдкрд╛рд▓рди рдЙрд▓реНрд▓рдВрдШрди, рдФрд░ рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЗ рднреАрддрд░ рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдпрдВрддреНрд░рдгреЛрдВ рдореЗрдВ рд╡реНрдпрд╡рдзрд╛рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рджреВрд╕рд░реА рдУрд░, рдЕрд╕реЛрд╕рд┐рдПрд╢рди рд╕реЗ рд▓рд╛рдЧрдд рдФрд░ рдмрдЬрдЯ рдЖрд╡рдВрдЯрди рдореЗрдВ рд╡реНрдпрд╡рдзрд╛рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### `fms:TagResource`, `fms:UntagResource`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ Firewall Manager рд╕рдВрд╕рд╛рдзрдиреЛрдВ рд╕реЗ рдЯреИрдЧ рдЬреЛрдбрд╝рдиреЗ, рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ, рдпрд╛ рд╣рдЯрд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛, рдЬрд┐рд╕рд╕реЗ рдЖрдкрдХреА рд╕рдВрдЧрдарди рдХреА рд▓рд╛рдЧрдд рдЖрд╡рдВрдЯрди, рд╕рдВрд╕рд╛рдзрди рдЯреНрд░реИрдХрд┐рдВрдЧ, рдФрд░ рдЯреИрдЧ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдПрдХреНрд╕реЗрд╕ рдирд┐рдпрдВрддреНрд░рдг рдиреАрддрд┐рдпреЛрдВ рдореЗрдВ рд╡реНрдпрд╡рдзрд╛рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
```bash
aws fms tag-resource --resource-arn <value> --tag-list <value>
aws fms untag-resource --resource-arn <value> --tag-keys <value>
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡**: рд▓рд╛рдЧрдд рдЖрд╡рдВрдЯрди, рд╕рдВрд╕рд╛рдзрди рдЯреНрд░реИрдХрд┐рдВрдЧ, рдФрд░ рдЯреИрдЧ-рдЖрдзрд╛рд░рд┐рдд рдПрдХреНрд╕реЗрд╕ рдирд┐рдпрдВрддреНрд░рдг рдиреАрддрд┐рдпреЛрдВ рдХрд╛ рд╡рд┐рдШрдЯрдиред

## рд╕рдВрджрд░реНрдн

* [https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html](https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html)
* [https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html](https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html)

{% hint style="success" %}
AWS Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХреЛ рд╕рдорд░реНрдерди рджреЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рд╣рдореЗрдВ **Twitter** ЁЯРж рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
{% endhint %}
