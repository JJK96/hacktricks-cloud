# AWS - Firewall Manager Enum

{% hint style="success" %}
Jifunze na fanya mazoezi ya AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze na fanya mazoezi ya GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mipango ya usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Firewall Manager

**AWS Firewall Manager** inarahisisha usimamizi na matengenezo ya **AWS WAF, AWS Shield Advanced, Amazon VPC security groups na Network Access Control Lists (ACLs), na AWS Network Firewall, AWS Route 53 Resolver DNS Firewall na firewalls za wahusika wa tatu** kwenye akaunti na rasilimali nyingi. Inakuwezesha kusanidi sheria za firewall zako, ulinzi wa Shield Advanced, vikundi vya usalama vya VPC, na mipangilio ya Network Firewall mara moja, na huduma **inazitekeleza kiotomatiki sheria na ulinzi huu kwenye akaunti na rasilimali zako**, ikijumuisha zile mpya zilizoongezwa.

Huduma hii inatoa uwezo wa **kugroup na kulinda rasilimali maalum pamoja**, kama zile zinazoshiriki tag ya kawaida au usambazaji wako wote wa CloudFront. Faida kubwa ya Firewall Manager ni uwezo wake wa **kuongeza ulinzi kiotomatiki kwa rasilimali mpya zilizoongezwa** kwenye akaunti yako.

**Kikundi cha sheria** (mkusanyiko wa sheria za WAF) kinaweza kuingizwa kwenye Sera ya AWS Firewall Manager, ambayo kisha inahusishwa na rasilimali maalum za AWS kama usambazaji wa CloudFront au mizani ya mzigo wa programu.

AWS Firewall Manager inatoa **orodha za programu na itifaki zilizodhibitiwa** ili kurahisisha usanidi na usimamizi wa sera za vikundi vya usalama. Orodha hizi zinakuwezesha kufafanua itifaki na programu zinazoruhusiwa au kukataliwa na sera zako. Kuna aina mbili za orodha zilizodhibitiwa:

* **Orodha zilizodhibitiwa na Firewall Manager**: Orodha hizi zinajumuisha **FMS-Default-Public-Access-Apps-Allowed**, **FMS-Default-Protocols-Allowed** na **FMS-Default-Protocols-Allowed**. Zinasimamiwa na Firewall Manager na zinajumuisha programu na itifaki zinazotumika mara kwa mara ambazo zinapaswa kuruhusiwa au kukataliwa kwa umma. Haiwezekani kuhariri au kufuta, hata hivyo, unaweza kuchagua toleo lake.
* **Orodha zilizodhibitiwa na mtumiaji**: Unasimamia orodha hizi mwenyewe. Unaweza kuunda orodha za programu na itifaki maalum zilizobinafsishwa kwa mahitaji ya shirika lako. Tofauti na orodha zilizodhibitiwa na Firewall Manager, orodha hizi hazina matoleo, lakini una udhibiti kamili juu ya orodha maalum, kukuwezesha kuunda, kuhariri, na kufuta kama inavyohitajika.

Ni muhimu kutambua kwamba **sera za Firewall Manager zinaruhusu tu vitendo vya "Block" au "Count"** kwa kikundi cha sheria, bila chaguo la "Allow".

### Mahitaji ya Awali

Hatua zifuatazo za awali lazima zikamilishwe kabla ya kuendelea kusanidi Firewall Manager ili kuanza kulinda rasilimali za shirika lako kwa ufanisi. Hatua hizi zinatoa usanidi wa msingi unaohitajika kwa Firewall Manager kutekeleza sera za usalama na kuhakikisha uzingatiaji katika mazingira yako ya AWS:

1. **Jiunge na usanidi AWS Organizations:** Hakikisha akaunti yako ya AWS ni sehemu ya shirika la AWS Organizations ambapo sera za AWS Firewall Manager zinapangwa kupandikizwa. Hii inaruhusu usimamizi wa kati wa rasilimali na sera kwenye akaunti nyingi za AWS ndani ya shirika.
2. **Unda Akaunti ya Msimamizi Chaguo-msingi ya AWS Firewall Manager:** Anzisha akaunti ya msimamizi chaguo-msingi maalum kwa ajili ya kusimamia sera za usalama za Firewall Manager. Akaunti hii itakuwa na jukumu la kusanidi na kutekeleza sera za usalama kwenye shirika. Akaunti ya usimamizi ya shirika pekee ndiyo inayoweza kuunda akaunti za msimamizi chaguo-msingi za Firewall Manager.
3. **Wezesha AWS Config:** Washa AWS Config ili kutoa Firewall Manager data ya usanidi na maarifa yanayohitajika kutekeleza sera za usalama kwa ufanisi. AWS Config husaidia kuchambua, kukagua, kufuatilia na kukagua usanidi wa rasilimali na mabadiliko, kuwezesha usimamizi bora wa usalama.
4. **Kwa Sera za Wahusika wa Tatu, Jiandikishe kwenye AWS Marketplace na Usanidi Mipangilio ya Wahusika wa Tatu:** Ikiwa unapanga kutumia sera za firewall za wahusika wa tatu, jiandikishe kwao kwenye AWS Marketplace na usanidi mipangilio inayohitajika. Hatua hii inahakikisha kwamba Firewall Manager inaweza kuunganisha na kutekeleza sera kutoka kwa wauzaji wa wahusika wa tatu wanaoaminika.
5. **Kwa Sera za Network Firewall na DNS Firewall, wezesha kushiriki rasilimali:** Wezesha kushiriki rasilimali maalum kwa sera za Network Firewall na DNS Firewall. Hii inaruhusu Firewall Manager kutumia ulinzi wa firewall kwenye VPCs na azimio la DNS la shirika lako, kuboresha usalama wa mtandao.
6. **Kutumia AWS Firewall Manager katika Mikoa ambayo imezimwa kwa chaguo-msingi:** Ikiwa unakusudia kutumia Firewall Manager katika mikoa ya AWS ambayo imezimwa kwa chaguo-msingi, hakikisha unachukua hatua zinazohitajika kuwezesha utendaji wake katika mikoa hiyo. Hii inahakikisha utekelezaji wa usalama thabiti katika mikoa yote ambapo shirika lako linafanya kazi.

Kwa maelezo zaidi, angalia:¬†[Getting started with AWS Firewall Manager AWS WAF policies](https://docs.aws.amazon.com/waf/latest/developerguide/getting-started-fms.html).

### Aina za sera za ulinzi

AWS Firewall Manager inasimamia aina kadhaa za sera ili kutekeleza udhibiti wa usalama katika nyanja tofauti za miundombinu ya shirika lako:

1. **Sera ya AWS WAF:** Aina hii ya sera inasaidia AWS WAF na AWS WAF Classic. Unaweza kufafanua ni rasilimali zipi zinalindwa na sera. Kwa sera za AWS WAF, unaweza kubainisha seti za vikundi vya sheria kuendesha kwanza na mwisho kwenye web ACL. Zaidi ya hayo, wamiliki wa akaunti wanaweza kuongeza sheria na vikundi vya sheria kuendesha kati ya seti hizi.
2. **Sera ya Shield Advanced:** Sera hii inatumika kwa ulinzi wa Shield Advanced kwenye shirika lako kwa aina maalum za rasilimali. Inasaidia kulinda dhidi ya mashambulizi ya DDoS na vitisho vingine.
3. **Sera ya Amazon VPC Security Group:** Kwa sera hii, unaweza kusimamia vikundi vya usalama vinavyotumika katika shirika lako, kutekeleza seti ya msingi ya sheria katika mazingira yako ya AWS kudhibiti upatikanaji wa mtandao.
4. **Sera ya Amazon VPC Network Access Control List (ACL):** Aina hii ya sera inakupa udhibiti juu ya ACLs za mtandao zinazotumika katika shirika lako, kukuwezesha kutekeleza seti ya msingi ya ACLs za mtandao katika mazingira yako ya AWS.
5. **Sera ya Network Firewall:** Sera hii inatumika kwa ulinzi wa AWS Network Firewall kwenye VPCs za shirika lako, kuboresha usalama wa mtandao kwa kuchuja trafiki kulingana na sheria zilizobainishwa.
6. **Sera ya Amazon Route 53 Resolver DNS Firewall:** Sera hii inatumika kwa ulinzi wa DNS Firewall kwenye VPCs za shirika lako, kusaidia kuzuia majaribio ya azimio la domain hasidi na kutekeleza sera za usalama kwa trafiki ya DNS.
7. **Sera ya Firewall ya Wahusika wa Tatu:** Aina hii ya sera inatumika kwa ulinzi kutoka kwa firewalls za wahusika wa tatu, ambazo zinapatikana kwa usajili kupitia console ya AWS Marketplace. Inakuruhusu kuunganisha hatua za ziada za usalama kutoka kwa wauzaji wanaoaminika katika mazingira yako ya AWS.
1. **Sera ya Palo Alto Networks Cloud NGFW:** Sera hii inatumika kwa ulinzi wa Palo Alto Networks Cloud Next Generation Firewall (NGFW) na rulestacks kwenye VPCs za shirika lako, kutoa ulinzi wa hali ya juu dhidi ya vitisho na udhibiti wa usalama wa kiwango cha programu.
2. **Sera ya Fortigate Cloud Native Firewall (CNF) as a Service:** Sera hii inatumika kwa ulinzi wa Fortigate Cloud Native Firewall (CNF) as a Service, ikitoa ulinzi wa hali ya juu dhidi ya vitisho, firewall ya programu ya wavuti (WAF), na ulinzi wa API uliobinafsishwa kwa miundombinu ya wingu.

### Akaunti za msimamizi

AWS Firewall Manager inatoa kubadilika katika kusimamia rasilimali za firewall ndani ya shirika lako kupitia wigo wake wa kiutawala na aina mbili za akaunti za msimamizi.

**Wigo wa kiutawala unafafanua rasilimali ambazo msimamizi wa Firewall Manager anaweza kusimamia**. Baada ya akaunti ya usimamizi ya AWS Organizations kuingiza shirika kwenye Firewall Manager, inaweza kuunda wasimamizi wa ziada wenye wigo tofauti wa kiutawala. Miongozo hii inaweza kujumuisha:

- Akaunti au vitengo vya shirika (OUs) ambavyo msimamizi anaweza kutumia sera.
- Mikoa ambapo msimamizi anaweza kufanya vitendo.
- Aina za sera za Firewall Manager ambazo msimamizi anaweza kusimamia.

Wigo wa kiutawala unaweza kuwa **kamili au mdogo**. Wigo kamili unampa msimamizi ufikiaji wa **aina zote za rasilimali, mikoa, na aina za sera** zilizobainishwa. Kinyume chake, **wigo mdogo unatoa ruhusa za kiutawala kwa subset tu ya rasilimali, mikoa, au aina za sera**. Inashauriwa kuwapa wasimamizi ruhusa wanazohitaji tu kutimiza majukumu yao kwa ufanisi. Unaweza kutumia mchanganyiko wowote wa masharti haya ya wigo wa kiutawala kwa msimamizi, kuhakikisha uzingatiaji wa kanuni ya upatikanaji mdogo.

Kuna aina mbili tofauti za akaunti za msimamizi, kila moja ikihudumia majukumu na majukumu maalum:

- **Msimamizi Chaguo-msingi:**
- Akaunti ya msimamizi chaguo-msingi inaundwa na akaunti ya usimamizi ya AWS Organizations wakati wa mchakato wa kuingiza kwenye Firewall Manager.
- Akaunti hii ina uwezo wa kusimamia firewalls za wahusika wa tatu na ina wigo kamili wa kiutawala.
- Inahudumu kama akaunti ya msimamizi mkuu wa Firewall Manager, inayohusika na kusanidi na kutekeleza sera za usalama kwenye shirika.
- Wakati msimamizi chaguo-msingi ana ufikiaji kamili wa aina zote za rasilimali na utendaji wa kiutawala, inafanya kazi kwa kiwango sawa na wasimamizi wengine ikiwa wasimamizi wengi wanatumiwa ndani ya shirika.
- **Wasimamizi wa Firewall Manager:**
- Wasimamizi hawa wanaweza kusimamia rasilimali ndani ya wigo uliowekwa na akaunti ya usimamizi ya AWS Organizations, kama ilivyobainishwa na usanidi wa wigo wa kiutawala.
- Wasimamizi wa Firewall Manager wameundwa kutimiza majukumu maalum ndani ya shirika, kuruhusu ugawaji wa majukumu huku wakidumisha viwango vya usalama na uzingatiaji.
- Baada ya kuundwa, Firewall Manager inakagua na AWS Organizations kubaini ikiwa akaunti tayari ni msimamizi aliyepewa. Ikiwa sivyo, Firewall Manager inaita Organizations kuteua akaunti kama msimamizi aliyepewa kwa Firewall Manager.

Kusimamia akaunti hizi za msimamizi kunahusisha kuziunda ndani ya Firewall Manager na kufafanua wigo wao wa kiutawala kulingana na mahitaji ya usalama ya shirika na kanuni ya upatikanaji mdogo. Kwa kuwapa majukumu ya kiutawala yanayofaa, mashirika yanaweza kuhakikisha usimamizi wa usalama wa ufanisi huku yakidumisha udhibiti wa kina juu ya ufikiaji wa rasilimali nyeti.

Ni muhimu kuangazia kwamba **akaunti moja tu ndani ya shirika inaweza kuhudumu kama msimamizi chaguo-msingi wa Firewall Manager**, ikizingatia kanuni ya "**kwanza kuingia, mwisho kutoka**". Kuteua msimamizi mpya chaguo-msingi, mfululizo wa hatua lazima ufuatwe:

- Kwanza, kila akaunti ya msimamizi wa Firewall Manager lazima ijiondoe yenyewe.
- Kisha, msimamizi chaguo-msingi wa sasa anaweza kujiondoa mwenyewe, kwa ufanisi kuondoa shirika kutoka kwa Firewall Manager. Mchakato huu unasababisha kufutwa kwa sera zote za Firewall Manager zilizoundwa na akaunti iliyojiondoa.
- Hatimaye, akaunti ya usimamizi ya AWS Organizations lazima itoe msimamizi chaguo-msingi wa Firewall Manager.

## Enumeration
```
# Users/Administrators

## Get the AWS Organizations account that is associated with AWS Firewall Manager as the AWS Firewall Manager default administrator
aws fms get-admin-account

## List of Firewall Manager administrators within the organization
aws fms list-admin-accounts-for-organization # ReadOnlyAccess policy is not enough for this

## Return a list of the member accounts in the FM administrator's AWS organization
aws fms list-member-accounts # Only a Firewall Manager administrator or the Organization's management account can make this request

## List the accounts that are managing the specified AWS Organizations member account
aws fms list-admins-managing-account # ReadOnlyAccess policy is not enough for this

# Resources

## Get the resources that a Firewall Manager administrator can manage
aws fms get-admin-scope --admin-account <value> # ReadOnlyAccess policy is not enough for this

## Returns the summary of the resource sets used
aws fms list-resource-sets # ReadOnlyAccess policy is not enough for this

## Get information about a specific resource set
aws fms get-resource-set --identifier <value>  # ReadOnlyAccess policy is not enough for this

## Retrieve the list of tags for a given resource
aws fms list-tags-for-resource --resource-arn <value>

## List of the resources in the AWS Organization's accounts that are available to be associated with a FM resource set. Only one account is supported per request.
aws fms list-compliance-status --member-account-ids <value> --resource-type <value> # ReadOnlyAccess policy is not enough for this

## List the resources that are currently associated to a resource set
aws fms list-resource-set-resources --identifier <value> # ReadOnlyAccess policy is not enough for this

# Policies

## Returns the list of policies
aws fms list-policies

## Get information about the specified AWS Firewall Manager policy
aws fms get-policy --policy-id <value>

## List all of the third-party firewall policies that are associated with the third-party firewall administrator's account
aws fms list-third-party-firewall-firewall-policies --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

# AppsList

## Return a list of apps list
aws fms list-apps-lists --max-results [1-100]

## Get information about the specified AWS Firewall Manager applications list
aws fms get-apps-list --list-id <value>

# Protocols

## Get the details of the Firewall Manager protocols list.
aws fms list-protocols-lists

## Get information about the specified AWS Firewall Manager Protocols list
aws fms get-protocols-list --list-id <value>

# Compliance

## Return a summary of which member accounts are protected by the specified policy
aws fms list-compliance-status --policy-id <policy-id>

## Get detailed compliance information about the specified member account (resources that are in and out of compliance with the specified policy)
aws fms get-compliance-detail --policy-id <value> --member-account <value>

# Other useful info

## Get information about the SNS topic that is used to record AWS Firewall Manager SNS logs (if any)
aws fms get-notification-channel

## Get policy-level attack summary information in the event of a potential DDoS attack
aws fms get-protection-status --policy-id <value> # Just for Shield Advanced policy

## Get the onboarding status of a Firewall Manager admin account to third-party firewall vendor tenant.
aws fms get-third-party-firewall-association-status --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

## Get violations' details for a resource based on the specified AWS Firewall Manager policy and AWS account.
aws fms get-violation-details --policy-id <value> --member-account <value> --resource-id <value> --resource-type <value>
```
## Post Exploitation / Bypass Detection

### `organizations:DescribeOrganization` & (`fms:AssociateAdminAccount`, `fms:DisassociateAdminAccount`, `fms:PutAdminAccount`)
Mshambuliaji mwenye ruhusa ya **`fms:AssociateAdminAccount`** ataweza kuweka akaunti ya msimamizi chaguo-msingi ya Firewall Manager. Kwa ruhusa ya **`fms:PutAdminAccount`**, mshambuliaji ataweza kuunda au kusasisha akaunti ya msimamizi ya Firewall Manager na kwa ruhusa ya **`fms:DisassociateAdminAccount`**, mshambuliaji anaweza kuondoa ushirikiano wa akaunti ya msimamizi ya Firewall Manager ya sasa.

- Kutenganishwa kwa **msimamizi chaguo-msingi wa Firewall Manager hufuata sera ya kwanza-kuingia-mwisho-kutoka**. Wasimamizi wote wa Firewall Manager lazima watenganishwe kabla ya msimamizi chaguo-msingi wa Firewall Manager kutenganisha akaunti.
- Ili kuunda msimamizi wa Firewall Manager kwa **PutAdminAccount**, akaunti lazima iwe ya shirika ambalo lilijiunga awali na Firewall Manager kwa kutumia **AssociateAdminAccount**.
- Uundaji wa akaunti ya msimamizi wa Firewall Manager unaweza kufanywa tu na akaunti ya usimamizi ya shirika.
```bash
aws fms associate-admin-account --admin-account <value>
aws fms disassociate-admin-account
aws fms put-admin-account --admin-account <value>
```
**Athari Zinazowezekana:** Kupoteza usimamizi wa kati, kukwepa sera, ukiukaji wa uzingatiaji, na kuvuruga udhibiti wa usalama ndani ya mazingira.

### `fms:PutPolicy`, `fms:DeletePolicy`

Mshambuliaji mwenye ruhusa za **`fms:PutPolicy`**, **`fms:DeletePolicy`** ataweza kuunda, kurekebisha au kufuta kabisa sera ya AWS Firewall Manager.
```bash
aws fms put-policy --policy <value> | --cli-input-json file://<policy.json> [--tag-list <value>]
aws fms delete-policy --policy-id <value> [--delete-all-policy-resources | --no-delete-all-policy-resources]
```
Mfano wa sera ya kuruhusu kupitia kikundi cha usalama kinachoruhusu, ili kupita utambuzi, inaweza kuwa kama ifuatavyo:
```json
{
"Policy": {
"PolicyName": "permisive_policy",
"SecurityServicePolicyData": {
"Type": "SECURITY_GROUPS_COMMON",
"ManagedServiceData": "{\"type\":\"SECURITY_GROUPS_COMMON\",\"securityGroups\":[{\"id\":\"<permisive_security_group_id>\"}], \"applyToAllEC2InstanceENIs\":\"true\",\"IncludeSharedVPC\":\"true\"}"
},
"ResourceTypeList": ["AWS::EC2::Instance", "AWS::EC2::NetworkInterface", "AWS::EC2::SecurityGroup", "AWS::ElasticLoadBalancingV2::LoadBalancer", "AWS::ElasticLoadBalancing::LoadBalancer"],
"ResourceType": "AWS::EC2::SecurityGroup",
"ExcludeResourceTags": false,
"ResourceTags": [],
"RemediationEnabled": true
},
"TagList": []
}
```
**Athari Zinazowezekana:** Kuvunjwa kwa udhibiti wa usalama, kukwepa sera, ukiukaji wa uzingatiaji, usumbufu wa kiutendaji, na uvujaji wa data ndani ya mazingira.

### `fms:BatchAssociateResource`, `fms:BatchDisassociateResource`, `fms:PutResourceSet`, `fms:DeleteResourceSet`

Mshambuliaji mwenye ruhusa za **`fms:BatchAssociateResource`** na **`fms:BatchDisassociateResource`** ataweza kuhusisha au kutenganisha rasilimali kutoka kwenye seti ya rasilimali ya Firewall Manager mtawalia. Zaidi ya hayo, ruhusa za **`fms:PutResourceSet`** na **`fms:DeleteResourceSet`** zitamruhusu mshambuliaji kuunda, kurekebisha au kufuta seti hizi za rasilimali kutoka AWS Firewall Manager.
```bash
# Associate/Disassociate resources from a resource set
aws fms batch-associate-resource --resource-set-identifier <value> --items <value>
aws fms batch-disassociate-resource --resource-set-identifier <value> --items <value>

# Create, modify or delete a resource set
aws fms put-resource-set --resource-set <value> [--tag-list <value>]
aws fms delete-resource-set --identifier <value>
```
**Athari Zinazowezekana:** Kuongeza idadi isiyo ya lazima ya vitu kwenye seti ya rasilimali itaongeza kiwango cha kelele katika Huduma na inaweza kusababisha DoS. Aidha, mabadiliko ya seti za rasilimali yanaweza kusababisha usumbufu wa rasilimali, kukwepa sera, ukiukaji wa uzingatiaji, na usumbufu wa udhibiti wa usalama ndani ya mazingira.

### `fms:PutAppsList`, `fms:DeleteAppsList`

Mshambulizi mwenye ruhusa za **`fms:PutAppsList`** na **`fms:DeleteAppsList`** ataweza kuunda, kurekebisha au kufuta orodha za programu kutoka AWS Firewall Manager. Hii inaweza kuwa muhimu, kwani programu zisizoidhinishwa zinaweza kuruhusiwa kupata umma kwa ujumla, au ufikiaji wa programu zilizoidhinishwa unaweza kukataliwa, na kusababisha DoS.
```bash
aws fms put-apps-list --apps-list <value> [--tag-list <value>]
aws fms delete-apps-list --list-id <value>
```
**Potential Impact:** Hii inaweza kusababisha mipangilio isiyo sahihi, kukwepa sera, ukiukaji wa uzingatiaji, na kuvuruga udhibiti wa usalama ndani ya mazingira.

### `fms:PutProtocolsList`, `fms:DeleteProtocolsList`

Mshambulizi mwenye ruhusa za **`fms:PutProtocolsList`** na **`fms:DeleteProtocolsList`** ataweza kuunda, kurekebisha au kufuta orodha za itifaki kutoka AWS Firewall Manager. Vivyo hivyo kama ilivyo kwa orodha za maombi, hii inaweza kuwa muhimu kwani itifaki zisizoidhinishwa zinaweza kutumiwa na umma kwa ujumla, au matumizi ya itifaki zilizoidhinishwa yanaweza kukataliwa, na kusababisha DoS.
```bash
aws fms put-protocols-list --apps-list <value> [--tag-list <value>]
aws fms delete-protocols-list --list-id <value>
```
**Athari Zinawezekana:** Hii inaweza kusababisha mipangilio isiyo sahihi, kukwepa sera, ukiukaji wa uzingatiaji, na kuvuruga udhibiti wa usalama ndani ya mazingira.

### `fms:PutNotificationChannel`, `fms:DeleteNotificationChannel`

Mshambulizi mwenye ruhusa za **`fms:PutNotificationChannel`** na **`fms:DeleteNotificationChannel`** ataweza kufuta na kuteua jukumu la IAM na mada ya Amazon Simple Notification Service (SNS) ambayo Firewall Manager hutumia kurekodi magogo ya SNS.

Ili kutumia **`fms:PutNotificationChannel`** nje ya dashibodi, unahitaji kusanidi sera ya ufikiaji ya mada ya SNS, kuruhusu **SnsRoleName** maalum kuchapisha magogo ya SNS. Ikiwa **SnsRoleName** iliyotolewa ni jukumu tofauti na **`AWSServiceRoleForFMS`**, inahitaji uhusiano wa uaminifu uliosanidiwa kuruhusu kanuni ya huduma ya Firewall Manager **fms.amazonaws.com** kuchukua jukumu hili.

Kwa habari kuhusu kusanidi sera ya ufikiaji ya SNS:

{% content-ref url="../aws-services/aws-sns-enum.md" %}
[aws-sns-enum.md](../aws-services/aws-sns-enum.md)
{% endcontent-ref %}
```bash
aws fms put-notification-channel --sns-topic-arn <value> --sns-role-name <value>
aws fms delete-notification-channel
```
**Athari Zinazowezekana:** Hii inaweza kusababisha kukosa arifa za usalama, kuchelewesha majibu ya matukio, uvujaji wa data na usumbufu wa kiutendaji ndani ya mazingira.

### `fms:AssociateThirdPartyFirewall`, `fms:DisssociateThirdPartyFirewall`
Mshambuliaji mwenye ruhusa za **`fms:AssociateThirdPartyFirewall`**, **`fms:DisssociateThirdPartyFirewall`** ataweza kuunganisha au kutenganisha firewalls za wahusika wengine kutoka kusimamiwa kwa pamoja kupitia AWS Firewall Manager.
{% hint style="warning" %}
Msimamizi chaguo-msingi pekee ndiye anayeweza kuunda na kusimamia firewalls za wahusika wengine.
{% endhint %}
```bash
aws fms associate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
aws fms disassociate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
```
**Athari Zinazowezekana:** Kutenganisha kungeweza kusababisha kukwepa sera, ukiukaji wa uzingatiaji, na kuvuruga udhibiti wa usalama ndani ya mazingira. Kuunganisha kwa upande mwingine kungeweza kusababisha kuvuruga mgao wa gharama na bajeti.

### `fms:TagResource`, `fms:UntagResource`

Mshambuliaji angeweza kuongeza, kurekebisha, au kuondoa vitambulisho kutoka kwa rasilimali za Firewall Manager, kuvuruga mgao wa gharama wa shirika lako, ufuatiliaji wa rasilimali, na sera za udhibiti wa ufikiaji kulingana na vitambulisho.
```bash
aws fms tag-resource --resource-arn <value> --tag-list <value>
aws fms untag-resource --resource-arn <value> --tag-keys <value>
```
**Athari Zinazowezekana**: Kuvuruga mgao wa gharama, ufuatiliaji wa rasilimali, na sera za udhibiti wa ufikiaji kwa msingi wa lebo.

## Marejeleo

* [https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html](https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html)
* [https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html](https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html)

{% hint style="success" %}
Jifunze & fanya mazoezi ya AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze & fanya mazoezi ya GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mipango ya usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwenye** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
