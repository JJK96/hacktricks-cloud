# AWS - ECS Enum

{% hint style="success" %}
Leer & oefen AWS Hack: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hack: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Controleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}

## ECS

### Basiese Inligting

Amazon **Elastic Container Services** of ECS bied 'n platform om **gekonteineriseerde toepassings in die wolk te gasheer**. ECS het twee **implementeringsmetodes**, **EC2**-instansietipe en 'n **serverlose** opsie, **Fargate**. Die diens **maak dit baie maklik en pynvry om konteiners in die wolk te hardloop**.

ECS werk met die volgende drie boublokke: **Klusters**, **Dienste**, en **Taakdefinisies**.

* **Klusters** is **groepe van konteiners** wat in die wolk hardloop. Soos voorheen genoem, is daar twee beginsoorte vir konteiners, EC2 en Fargate. AWS definieer die **EC2**-beginsoort as wat kli√´nte toelaat "om \[hul] gekonteineriseerde toepassings op 'n kluster van Amazon EC2-instansies wat \[hulle] **bestuur**" te hardloop. **Fargate** is soortgelyk en word gedefinieer as "wat jou toelaat om jou gekonteineriseerde toepassings te hardloop **sonder die nodigheid om die agtergrondinfrastruktuur te voorsien en te bestuur**".
* **Dienste** word binne 'n kluster geskep en is verantwoordelik vir **die hardloop van die take**. Binne 'n diensdefinisie **definieer jy die aantal take om te hardloop, outomatiese skaalvergroting, kapasiteitsverskaffer (Fargate/EC2/Extern),** **netwerkinligting** soos VPC's, subnetwerke, en sekuriteitsgroepe.
* Daar is **2 tipes toepassings**:
* **Diens**: 'n groep take wat 'n langdurige rekenwerk hanteer wat gestop en heraangestel kan word. Byvoorbeeld, 'n webtoepassing.
* **Taak**: 'n selfstaande taak wat hardloop en be√´indig. Byvoorbeeld, 'n lotwerk.
* Onder die dienstoepassings is daar **2 tipes diensbeplanners**:
* [**REPLIKA**](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs\_services.html): Die replika-beplanningsstrategie plaas en **handhaaf die gewenste aantal** take regoor jou kluster. As om een ‚Äã‚Äãof ander rede 'n taak afgesluit word, word 'n nuwe een op dieselfde of 'n ander node gelanseer.
* [**DAEMON**](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs\_services.html): Plaas presies een taak op elke aktiewe kontainerinstansie wat die nodige vereistes het. Daar is geen behoefte om 'n gewenste aantal take te spesifiseer, 'n taakplaasingsstrategie te gebruik, of Diensoutomatiese Skaleringbeleide te gebruik nie.
* **Taakdefinisies** is verantwoordelik vir **die definisie van watter konteiners sal hardloop** en die verskeie parameters wat met die konteiners gekonfigureer sal word soos **poorttoewysings** met die gasheer, **omgewingsveranderlikes**, Docker **ingangspunt**...
* Kontroleer **omgewingsveranderlikes vir sensitiewe inligting**!

### Sensitiewe Data In Taakdefinisies

Taakdefinisies is verantwoordelik vir **die konfigurasie van die werklike konteiners wat in ECS sal hardloop**. Aangesien taakdefinisies definieer hoe konteiners sal hardloop, kan 'n oorvloed inligting binne gevind word.

Pacu kan ECS opnoem (lys-klusters, lys-kontainer-instansies, lys-dienste, lys-taakdefinisies), dit kan ook taakdefinisies dump.

### Opnoeming
```bash
# Clusters info
aws ecs list-clusters
aws ecs describe-clusters --clusters <cluster>

# Container instances
## An Amazon ECS container instance is an Amazon EC2 instance that is running the Amazon ECS container agent and has been registered into an Amazon ECS cluster.
aws ecs list-container-instances --cluster <cluster>
aws ecs describe-container-instances --cluster <cluster> --container-instances <container_instance_arn>

# Services info
aws ecs list-services --cluster <cluster>
aws ecs describe-services --cluster <cluster> --services <services>
aws ecs describe-task-sets --cluster <cluster> --service <service>

# Task definitions
aws ecs list-task-definition-families
aws ecs list-task-definitions
aws ecs list-tasks --cluster <cluster>
aws ecs describe-tasks --cluster <cluster> --tasks <tasks>
## Look for env vars and secrets used from the task definition
aws ecs describe-task-definition --task-definition <TASK_NAME>:<VERSION>
```
### Ongeverifieerde Toegang

{% content-ref url="../aws-unauthenticated-enum-access/aws-ecs-unauthenticated-enum.md" %}
[aws-ecs-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-ecs-unauthenticated-enum.md)
{% endcontent-ref %}

### Privesc

Op die volgende bladsy kan jy sien hoe om **ECS-toestemmings te misbruik om voorregte te eskaleer**:

{% content-ref url="../aws-privilege-escalation/aws-ecs-privesc.md" %}
[aws-ecs-privesc.md](../aws-privilege-escalation/aws-ecs-privesc.md)
{% endcontent-ref %}

### Post Exploitation

{% content-ref url="../aws-post-exploitation/aws-ecs-post-exploitation.md" %}
[aws-ecs-post-exploitation.md](../aws-post-exploitation/aws-ecs-post-exploitation.md)
{% endcontent-ref %}

### Volharding

{% content-ref url="../aws-persistence/aws-ecs-persistence.md" %}
[aws-ecs-persistence.md](../aws-persistence/aws-ecs-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
Leer & oefen AWS Hack: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hack: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kontroleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}
