# AWS - ECS Enum

{% hint style="success" %}
Jifunze na zoezi la Udukuzi wa AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Mafunzo ya HackTricks ya Mtaalam wa Timu Nyekundu ya AWS (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze na zoezi la Udukuzi wa GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Mafunzo ya HackTricks ya Mtaalam wa Timu Nyekundu ya GCP (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa michango**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
{% endhint %}

## ECS

### Taarifa Msingi

Amazon **Elastic Container Services** au ECS hutoa jukwaa la **kuhosti programu zilizowekwa kwenye kontena kwenye wingu**. ECS ina njia mbili za **kupeleka**, aina ya **mfano wa EC2** na chaguo la **bila seva**, **Fargate**. Huduma hiyo **inafanya kuendesha kontena kwenye wingu kuwa rahisi sana na bila maumivu**.

ECS inafanya kazi kwa kutumia vijenzi vifuatavyo vitatu: **Vikundi**, **Huduma**, na **Ufafanuzi wa Kazi**.

* **Vikundi** ni **vikundi vya kontena** vinavyoendesha kwenye wingu. Kama ilivyotajwa awali, kuna aina mbili za uzinduzi kwa kontena, EC2 na Fargate. AWS inaelezea aina ya **uzinduzi wa EC2** kama kuruhusu wateja "kuendesha programu zao zilizowekwa kwenye kontena kwenye kikundi cha visa vya Amazon EC2 ambavyo \[wanavisimamia]". **Fargate** ni sawa na hilo na inaelezwa kama "kuruhusu kuendesha programu zilizowekwa kwenye kontena **bila haja ya kutoa na kusimamia** miundombinu ya nyuma".
* **Huduma** zinaundwa ndani ya kikundi na zinahusika na **kuendesha kazi**. Ndani ya ufafanuzi wa huduma **unafafanua idadi ya kazi za kuendesha, upanuzi wa moja kwa moja, mtoa huduma wa uwezo (Fargate/EC2/External),** **habari za mtandao** kama VPC's, subneti, na vikundi vya usalama.
* Kuna **aina 2 za programu**:
  * **Huduma**: Kikundi cha kazi zinazoshughulikia kazi ndefu ya kompyuta ambayo inaweza kusimamishwa na kuanzishwa upya. Kwa mfano, programu ya wavuti.
  * **Kazi**: Kazi ya kujitegemea inayoruka na kufunga. Kwa mfano, kazi ya kundi.
* Kati ya programu za huduma, kuna **aina 2 za mipangilio ya huduma**:
  * [**REPLICA**](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs\_services.html): Mkakati wa kupanga nakala huziweka na **kudumisha idadi inayotakikana** ya kazi kwenye kikundi chako. Ikiwa kwa sababu fulani kazi inazimwa, mpya huanzishwa kwenye nodi ile ile au tofauti.
  * [**DAEMON**](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs\_services.html): Inapeleka kazi moja tu kwenye kila kifaa cha kontena kilicho na mahitaji yanayohitajika. Hakuna haja ya kutaja idadi inayotakikana ya kazi, mkakati wa mahali pa kazi, au kutumia sera za upanuzi wa huduma.
* **Ufafanuzi wa Kazi** unahusika na **kufafanua ni kontena zipi zitaendeshwa** na vigezo mbalimbali vitakavyoconfigurewa na kontena kama vile **ramani za bandari** na mwenyeji, **vigezo vya mazingira**, **entrypoint ya Docker**...
* Angalia **vigezo vya mazingira kwa habari nyeti**!

### Data Nyeti Katika Ufafanuzi wa Kazi

Ufafanuzi wa kazi unahusika na **kuwezesha kontena halisi zitakazoendeshwa kwenye ECS**. Kwa kuwa ufafanuzi wa kazi unafafanua jinsi kontena zitaendeshwa, taarifa nyingi zinaweza kupatikana ndani yake.

Pacu inaweza kuchambua ECS (orodhesha-vikundi, orodhesha-vifaa-vya-kontena, orodhesha-huduma, orodhesha-ufafanuzi-wa-kazi), inaweza pia kudumpisha ufafanuzi wa kazi.

### Uchambuzi
```bash
# Clusters info
aws ecs list-clusters
aws ecs describe-clusters --clusters <cluster>

# Container instances
## An Amazon ECS container instance is an Amazon EC2 instance that is running the Amazon ECS container agent and has been registered into an Amazon ECS cluster.
aws ecs list-container-instances --cluster <cluster>
aws ecs describe-container-instances --cluster <cluster> --container-instances <container_instance_arn>

# Services info
aws ecs list-services --cluster <cluster>
aws ecs describe-services --cluster <cluster> --services <services>
aws ecs describe-task-sets --cluster <cluster> --service <service>

# Task definitions
aws ecs list-task-definition-families
aws ecs list-task-definitions
aws ecs list-tasks --cluster <cluster>
aws ecs describe-tasks --cluster <cluster> --tasks <tasks>
## Look for env vars and secrets used from the task definition
aws ecs describe-task-definition --task-definition <TASK_NAME>:<VERSION>
```
### Upatikanaji usiothibitishwa

{% content-ref url="../aws-unauthenticated-enum-access/aws-ecs-unauthenticated-enum.md" %}
[aws-ecs-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-ecs-unauthenticated-enum.md)
{% endcontent-ref %}

### Privesc

Kwenye ukurasa ufuatao unaweza kuangalia jinsi ya **kutumia ruhusa za ECS kuboresha mamlaka**:

{% content-ref url="../aws-privilege-escalation/aws-ecs-privesc.md" %}
[aws-ecs-privesc.md](../aws-privilege-escalation/aws-ecs-privesc.md)
{% endcontent-ref %}

### Baada ya Uvamizi

{% content-ref url="../aws-post-exploitation/aws-ecs-post-exploitation.md" %}
[aws-ecs-post-exploitation.md](../aws-post-exploitation/aws-ecs-post-exploitation.md)
{% endcontent-ref %}

### Uthabiti

{% content-ref url="../aws-persistence/aws-ecs-persistence.md" %}
[aws-ecs-persistence.md](../aws-persistence/aws-ecs-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
Jifunze & zoezi la Udukuzi wa AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Mafunzo ya HackTricks AWS Timu Nyekundu Mtaalam (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze & zoezi la Udukuzi wa GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Mafunzo ya HackTricks GCP Timu Nyekundu Mtaalam (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa michango**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
{% endhint %}
