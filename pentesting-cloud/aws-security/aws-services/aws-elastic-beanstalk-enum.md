# AWS - Elastic Beanstalk Enum

{% hint style="success" %}
Leer en oefen AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer en oefen GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**intekenplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Elastic Beanstalk

Amazon Elastic Beanstalk bied 'n vereenvoudigde platform vir **ontplooiing, bestuur en skaal van webtoepassings en dienste**. Dit ondersteun 'n verskeidenheid programmeertale en raamwerke, soos Java, .NET, PHP, Node.js, Python, Ruby, en Go, sowel as Docker-houers. Die diens is versoenbaar met wydgebruikte bedieners insluitend Apache, Nginx, Passenger, en IIS.

Elastic Beanstalk bied 'n eenvoudige en buigsame manier om **jou toepassings na die AWS-wolk te ontplooi**, sonder om bekommerd te wees oor die onderliggende infrastruktuur. Dit hanteer **outomaties** die besonderhede van kapasiteit **voorsiening**, las **balansering**, **skaal**, en toepassing gesondheid **monitering**, wat jou toelaat om te fokus op die skryf en ontplooiing van jou kode.

Die infrastruktuur wat deur Elastic Beanstalk geskep word, word bestuur deur **Autoscaling** Groepe in **EC2** (met 'n lasbalanser). Wat beteken dat aan die einde van die dag, as jy die **gasheer kompromitteer**, jy moet weet oor EC2:

{% content-ref url="aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/" %}
[aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum](aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/)
{% endcontent-ref %}

Boonop, as Docker gebruik word, is dit moontlik om **ECS** te gebruik.

{% content-ref url="aws-eks-enum.md" %}
[aws-eks-enum.md](aws-eks-enum.md)
{% endcontent-ref %}

### Toepassing & Omgewings

In AWS Elastic Beanstalk, dien die konsepte van 'n "toepassing" en 'n "omgewing" verskillende doeleindes en het verskillende rolle in die ontplooiingsproses.

#### Toepassing

* 'n Toepassing in Elastic Beanstalk is 'n **logiese houer vir jou toepassing se bronkode, omgewings, en konfigurasies**. Dit groepeer verskillende weergawes van jou toepassingkode en laat jou toe om dit as 'n enkele entiteit te bestuur.
* Wanneer jy 'n toepassing skep, verskaf jy 'n naam en beskrywing, maar geen hulpbronne word op hierdie stadium voorsien nie. Dit is bloot 'n manier om jou kode en verwante hulpbronne te organiseer en te bestuur.
* Jy kan **meervoudige toepassingweergawes** binne 'n toepassing h√™. Elke weergawe stem ooreen met 'n spesifieke vrystelling van jou kode, wat na een of meer omgewings ontplooi kan word.

#### Omgewing

* 'n Omgewing is 'n **voorsiene instansie van jou toepassing** wat op AWS-infrastruktuur loop. Dit is **waar jou toepassingkode ontplooi en uitgevoer word**. Elastic Beanstalk voorsien die nodige hulpbronne (bv. EC2-instansies, lasbalansers, outo-skaal groepe, databasisse) gebaseer op die omgewingkonfigurasie.
* **Elke omgewing loop 'n enkele weergawe van jou toepassing**, en jy kan verskeie omgewings h√™ vir verskillende doeleindes, soos ontwikkeling, toetsing, opstelling, en produksie.
* Wanneer jy 'n omgewing skep, kies jy 'n platform (bv. Java, .NET, Node.js, ens.) en 'n omgewingtipe (bv. webbediener of werker). Jy kan ook die omgewingkonfigurasie aanpas om verskeie aspekte van die infrastruktuur en toepassinginstellings te beheer.

### 2 tipes Omgewings

1. **Webbediener Omgewing**: Dit is ontwerp om **webtoepassings en API's te huisves en te bedien**. Hierdie toepassings hanteer tipies inkomende HTTP/HTTPS-versoeke. Die webbediener omgewing voorsien hulpbronne soos **EC2-instansies, lasbalansers, en outo-skaal** groepe om inkomende verkeer te hanteer, kapasiteit te bestuur, en die toepassing se ho√´ beskikbaarheid te verseker.
2. **Werker Omgewing**: Dit is ontwerp om **agtergrond take te verwerk**, wat dikwels tydrowende of hulpbron-intensiewe operasies is wat nie onmiddellike reaksies aan kli√´nte vereis nie. Die werker omgewing voorsien hulpbronne soos **EC2-instansies en outo-skaal groepe**, maar dit **het nie 'n lasbalanser** nie aangesien dit nie direk HTTP/HTTPS-versoeke hanteer nie. In plaas daarvan verbruik dit take van 'n **Amazon Simple Queue Service (SQS) queue**, wat as 'n buffer dien tussen die werker omgewing en die take wat dit verwerk.

### Sekuriteit

Wanneer jy 'n App in Beanstalk skep, is daar 3 baie belangrike sekuriteitsopsies om te kies:

* **EC2 sleutelpaar**: Dit sal die **SSH sleutel** wees wat toegang sal h√™ tot die EC2-instansies wat die app laat loop
* **IAM instansie profiel**: Dit is die **instansie profiel** wat die instansies sal h√™ (**IAM voorregte**)
* Die outomaties gegenereerde rol word genoem **`aws-elasticbeanstalk-ec2-role`** en het interessante toegang oor alle ECS, alle SQS, DynamoDB elasticbeanstalk en elasticbeanstalk S3 met behulp van die AWS bestuurde beleide: [AWSElasticBeanstalkWebTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWebTier), [AWSElasticBeanstalkMulticontainerDocker](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkMulticontainerDocker), [AWSElasticBeanstalkWorkerTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWorkerTier).
* **Diensrol**: Dit is die **rol wat die AWS-diens** sal gebruik om al die nodige aksies uit te voer. Sover ek weet, kan 'n gewone AWS-gebruiker nie toegang tot daardie rol kry nie.
* Hierdie rol wat deur AWS gegenereer is, word genoem **`aws-elasticbeanstalk-service-role`** en gebruik die AWS bestuurde beleide [AWSElasticBeanstalkEnhancedHealth](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkEnhancedHealth) en [AWSElasticBeanstalkManagedUpdatesCustomerRolePolicy](https://us-east-1.console.aws.amazon.com/iamv2/home?region=us-east-1#/roles/details/aws-elasticbeanstalk-service-role?section=permissions)

By verstek is **metadata weergawe 1 gedeaktiveer**:

<figure><img src="../../../.gitbook/assets/image (103).png" alt=""><figcaption></figcaption></figure>

### Blootstelling

Beanstalk data word gestoor in 'n **S3 emmer** met die volgende naam: **`elasticbeanstalk-<region>-<acc-id>`**(as dit in die AWS-konsol geskep is). Binne hierdie emmer sal jy die opgelaaide **bronkode van die toepassing** vind.

Die **URL** van die geskepte webblad is **`http://<webapp-name>-env.<random>.<region>.elasticbeanstalk.com/`**

{% hint style="warning" %}
As jy **lees toegang** oor die emmer kry, kan jy **die bronkode lees** en selfs **sensitiewe geloofsbriewe** daarop vind

as jy **skryf toegang** oor die emmer kry, kan jy **die bronkode verander** om die **IAM rol** wat die toepassing gebruik te **kompromitteer** die volgende keer dat dit uitgevoer word.
{% endhint %}

### Enumerasie

{% code overflow="wrap" %}
```bash
# Find S3 bucket
ACCOUNT_NUMBER=<account_number>
for r in us-east-1 us-east-2 us-west-1 us-west-2 ap-south-1 ap-south-2 ap-northeast-1 ap-northeast-2 ap-northeast-3 ap-southeast-1 ap-southeast-2 ap-southeast-3 ca-central-1 eu-central-1 eu-central-2 eu-west-1 eu-west-2 eu-west-3 eu-north-1 sa-east-1 af-south-1 ap-east-1 eu-south-1 eu-south-2 me-south-1 me-central-1; do aws s3 ls elasticbeanstalk-$r-$ACCOUNT_NUMBER 2>/dev/null && echo "Found in: elasticbeanstalk-$r-$ACCOUNT_NUMBER"; done

# Get apps and URLs
aws elasticbeanstalk describe-applications # List apps
aws elasticbeanstalk describe-application-versions # Get apps & bucket name with source code
aws elasticbeanstalk describe-environments # List envs
aws elasticbeanstalk describe-environments | grep -E "EndpointURL|CNAME"
aws elasticbeanstalk describe-configuration-settings --application-name <app_name> --environment-name <env_name>
aws elasticbeanstalk describe-environment-resources --environment-name <env_name> # Get env info such as SQS used queues
aws elasticbeanstalk describe-instances-health --environment-name <env_name> # Get the instances of an environment

# Get events
aws elasticbeanstalk describe-events
```
{% endcode %}

### Onauthentiseerde Toegang

{% content-ref url="../aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md" %}
[aws-elastic-beanstalk-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md)
{% endcontent-ref %}

### Volharding

{% content-ref url="../aws-persistence/aws-elastic-beanstalk-persistence.md" %}
[aws-elastic-beanstalk-persistence.md](../aws-persistence/aws-elastic-beanstalk-persistence.md)
{% endcontent-ref %}

### Privesc

{% content-ref url="../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md" %}
[aws-elastic-beanstalk-privesc.md](../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md)
{% endcontent-ref %}

### Post Eksploitasie

{% content-ref url="../aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md" %}
[aws-elastic-beanstalk-post-exploitation.md](../aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md)
{% endcontent-ref %}

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**intekenplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
