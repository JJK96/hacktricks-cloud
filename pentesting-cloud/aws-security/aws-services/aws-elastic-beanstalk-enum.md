# AWS - Elastic Beanstalk Enum

{% hint style="success" %}
AWS Hacking öğrenin ve pratik yapın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking öğrenin ve pratik yapın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 Discord grubuna** [**katılın**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'ı takip edin.**
* **HackTricks'e PR göndererek hacking ipuçlarını paylaşın** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub depolarına.

</details>
{% endhint %}

## Elastic Beanstalk

Amazon Elastic Beanstalk, **web uygulamaları ve hizmetleri dağıtmak, yönetmek ve ölçeklendirmek** için basitleştirilmiş bir platform sağlar. Java, .NET, PHP, Node.js, Python, Ruby ve Go gibi çeşitli programlama dilleri ve çerçeveleri destekler, ayrıca Docker konteynerleri de destekler. Hizmet, Apache, Nginx, Passenger ve IIS gibi yaygın olarak kullanılan sunucularla uyumludur.

Elastic Beanstalk, **uygulamalarınızı AWS bulutuna dağıtmanın** basit ve esnek bir yolunu sağlar, altyapının ayrıntılarıyla ilgilenmenize gerek kalmaz. Kapasite **sağlama**, yük **dengeleme**, **ölçeklendirme** ve uygulama sağlığı **izleme** gibi ayrıntıları **otomatik olarak** halleder, böylece kodunuzu yazmaya ve dağıtmaya odaklanabilirsiniz.

Elastic Beanstalk tarafından oluşturulan altyapı, **EC2**'deki **Autoscaling** Grupları tarafından yönetilir (bir yük dengeleyici ile). Bu, günün sonunda, **host'u ele geçirirseniz**, EC2 hakkında bilgi sahibi olmanız gerektiği anlamına gelir:

{% content-ref url="aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/" %}
[aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum](aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/)
{% endcontent-ref %}

Ayrıca, Docker kullanılıyorsa, **ECS** kullanmak mümkündür.

{% content-ref url="aws-eks-enum.md" %}
[aws-eks-enum.md](aws-eks-enum.md)
{% endcontent-ref %}

### Application & Environments

AWS Elastic Beanstalk'ta, "application" ve "environment" kavramları farklı amaçlara hizmet eder ve dağıtım sürecinde farklı rollere sahiptir.

#### Application

* Elastic Beanstalk'ta bir application, **uygulamanızın kaynak kodu, ortamları ve yapılandırmaları için mantıksal bir kapsayıcıdır**. Farklı uygulama kodu sürümlerini bir araya getirir ve bunları tek bir varlık olarak yönetmenizi sağlar.
* Bir application oluşturduğunuzda, bir ad ve açıklama sağlarsınız, ancak bu aşamada hiçbir kaynak sağlanmaz. Bu, kodunuzu ve ilgili kaynakları organize etmek ve yönetmek için basit bir yoldur.
* Bir application içinde **birden fazla uygulama sürümüne** sahip olabilirsiniz. Her sürüm, kodunuzun belirli bir sürümüne karşılık gelir ve bir veya daha fazla ortama dağıtılabilir.

#### Environment

* Bir environment, AWS altyapısında çalışan **uygulamanızın sağlanmış bir örneğidir**. **Uygulama kodunuzun dağıtıldığı ve çalıştırıldığı yerdir**. Elastic Beanstalk, environment yapılandırmasına dayalı olarak gerekli kaynakları (örneğin, EC2 instance'ları, yük dengeleyiciler, otomatik ölçeklendirme grupları, veritabanları) sağlar.
* **Her environment, uygulamanızın tek bir sürümünü çalıştırır** ve geliştirme, test, hazırlık ve üretim gibi farklı amaçlar için birden fazla environment'a sahip olabilirsiniz.
* Bir environment oluşturduğunuzda, bir platform (örneğin, Java, .NET, Node.js, vb.) ve bir environment türü (örneğin, web sunucusu veya işçi) seçersiniz. Ayrıca, altyapı ve uygulama ayarlarının çeşitli yönlerini kontrol etmek için environment yapılandırmasını özelleştirebilirsiniz.

### 2 tür Environment

1. **Web Server Environment**: **Web uygulamalarını ve API'leri barındırmak ve sunmak** için tasarlanmıştır. Bu uygulamalar genellikle gelen HTTP/HTTPS isteklerini işler. Web sunucusu environment'ı, gelen trafiği yönetmek, kapasiteyi yönetmek ve uygulamanın yüksek kullanılabilirliğini sağlamak için **EC2 instance'ları, yük dengeleyiciler ve otomatik ölçeklendirme** grupları gibi kaynakları sağlar.
2. **Worker Environment**: **Arka plan görevlerini** işlemek için tasarlanmıştır, bu görevler genellikle zaman alıcı veya kaynak yoğun işlemlerdir ve müşterilere anında yanıt gerektirmez. İşçi environment'ı, **EC2 instance'ları ve otomatik ölçeklendirme grupları** gibi kaynakları sağlar, ancak **yük dengeleyiciye sahip değildir** çünkü doğrudan HTTP/HTTPS isteklerini işlemez. Bunun yerine, işlediği görevler ile işçi environment'ı arasında bir tampon görevi gören **Amazon Simple Queue Service (SQS) kuyruğundan** görevleri tüketir.

### Güvenlik

Beanstalk'ta bir uygulama oluştururken seçilmesi gereken 3 çok önemli güvenlik seçeneği vardır:

* **EC2 key pair**: Bu, uygulamayı çalıştıran EC2 instance'larına erişebilecek **SSH anahtarı** olacaktır.
* **IAM instance profile**: Bu, instance'ların sahip olacağı **instance profili**dir (**IAM ayrıcalıkları**).
* Otomatik olarak oluşturulan rol, **`aws-elasticbeanstalk-ec2-role`** olarak adlandırılır ve AWS yönetilen politikalarını kullanarak tüm ECS, tüm SQS, DynamoDB elasticbeanstalk ve elasticbeanstalk S3 üzerinde bazı ilginç erişimlere sahiptir: [AWSElasticBeanstalkWebTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWebTier), [AWSElasticBeanstalkMulticontainerDocker](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkMulticontainerDocker), [AWSElasticBeanstalkWorkerTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWorkerTier).
* **Service role**: Bu, AWS hizmetinin gerekli tüm eylemleri gerçekleştirmek için kullanacağı **roldür**. Bildiğim kadarıyla, normal bir AWS kullanıcısı bu role erişemez.
* AWS tarafından oluşturulan bu rol, **`aws-elasticbeanstalk-service-role`** olarak adlandırılır ve AWS yönetilen politikalarını kullanır: [AWSElasticBeanstalkEnhancedHealth](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkEnhancedHealth) ve [AWSElasticBeanstalkManagedUpdatesCustomerRolePolicy](https://us-east-1.console.aws.amazon.com/iamv2/home?region=us-east-1#/roles/details/aws-elasticbeanstalk-service-role?section=permissions)

Varsayılan olarak **metadata version 1 devre dışıdır**:

<figure><img src="../../../.gitbook/assets/image (103).png" alt=""><figcaption></figcaption></figure>

### Maruz Kalma

Beanstalk verileri, **`elasticbeanstalk-<region>-<acc-id>`** (AWS konsolunda oluşturulmuşsa) adında bir **S3 bucket**'ında saklanır. Bu bucket içinde, uygulamanın yüklenmiş **kaynak kodunu** bulacaksınız.

Oluşturulan web sayfasının **URL'si** **`http://<webapp-name>-env.<random>.<region>.elasticbeanstalk.com/`**

{% hint style="warning" %}
Bucket üzerinde **okuma erişimi** elde ederseniz, **kaynak kodunu okuyabilir** ve hatta üzerinde **hassas kimlik bilgilerini** bulabilirsiniz.

Bucket üzerinde **yazma erişimi** elde ederseniz, kaynak kodunu **değiştirerek** uygulamanın bir sonraki çalıştırıldığında kullandığı **IAM rolünü** **ele geçirebilirsiniz**.
{% endhint %}

### Enumeration

{% code overflow="wrap" %}
```bash
# Find S3 bucket
ACCOUNT_NUMBER=<account_number>
for r in us-east-1 us-east-2 us-west-1 us-west-2 ap-south-1 ap-south-2 ap-northeast-1 ap-northeast-2 ap-northeast-3 ap-southeast-1 ap-southeast-2 ap-southeast-3 ca-central-1 eu-central-1 eu-central-2 eu-west-1 eu-west-2 eu-west-3 eu-north-1 sa-east-1 af-south-1 ap-east-1 eu-south-1 eu-south-2 me-south-1 me-central-1; do aws s3 ls elasticbeanstalk-$r-$ACCOUNT_NUMBER 2>/dev/null && echo "Found in: elasticbeanstalk-$r-$ACCOUNT_NUMBER"; done

# Get apps and URLs
aws elasticbeanstalk describe-applications # List apps
aws elasticbeanstalk describe-application-versions # Get apps & bucket name with source code
aws elasticbeanstalk describe-environments # List envs
aws elasticbeanstalk describe-environments | grep -E "EndpointURL|CNAME"
aws elasticbeanstalk describe-configuration-settings --application-name <app_name> --environment-name <env_name>
aws elasticbeanstalk describe-environment-resources --environment-name <env_name> # Get env info such as SQS used queues
aws elasticbeanstalk describe-instances-health --environment-name <env_name> # Get the instances of an environment

# Get events
aws elasticbeanstalk describe-events
```
{% endcode %}

### Kimlik Doğrulaması Olmayan Erişim

{% content-ref url="../aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md" %}
[aws-elastic-beanstalk-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md)
{% endcontent-ref %}

### Kalıcılık

{% content-ref url="../aws-persistence/aws-elastic-beanstalk-persistence.md" %}
[aws-elastic-beanstalk-persistence.md](../aws-persistence/aws-elastic-beanstalk-persistence.md)
{% endcontent-ref %}

### Ayrıcalık Yükseltme

{% content-ref url="../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md" %}
[aws-elastic-beanstalk-privesc.md](../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md)
{% endcontent-ref %}

### Sömürü Sonrası

{% content-ref url="../aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md" %}
[aws-elastic-beanstalk-post-exploitation.md](../aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md)
{% endcontent-ref %}

{% hint style="success" %}
AWS Hacking öğrenin ve pratik yapın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking öğrenin ve pratik yapın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 Discord grubuna** [**katılın**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live) **bizi takip edin.**
* **HackTricks'e PR göndererek hacking ipuçlarını paylaşın** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına.

</details>
{% endhint %}
