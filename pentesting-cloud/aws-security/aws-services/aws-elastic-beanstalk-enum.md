# AWS - Elastic Beanstalk Enum

{% hint style="success" %}
Jifunze na kufanya mazoezi ya AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze na kufanya mazoezi ya GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mipango ya usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Elastic Beanstalk

Amazon Elastic Beanstalk inatoa jukwaa rahisi kwa **kupeleka, kusimamia, na kupanua programu za wavuti na huduma**. Inasaidia lugha na mifumo mbalimbali ya programu, kama Java, .NET, PHP, Node.js, Python, Ruby, na Go, pamoja na kontena za Docker. Huduma hii inaoana na seva zinazotumika sana kama Apache, Nginx, Passenger, na IIS.

Elastic Beanstalk inatoa njia rahisi na rahisi ya **kupeleka programu zako kwenye wingu la AWS**, bila haja ya kuwa na wasiwasi kuhusu miundombinu ya msingi. Inashughulikia **kiotomatiki** maelezo ya **ugavi wa uwezo**, **usawazishaji wa mzigo**, **upanuzi**, na **ufuatiliaji wa afya ya programu**, ikikuruhusu kuzingatia kuandika na kupeleka msimbo wako.

Miundombinu inayoundwa na Elastic Beanstalk inasimamiwa na **Makundi ya Autoscaling** katika **EC2** (na usawazishaji wa mzigo). Hii inamaanisha kwamba mwishowe, ikiwa **utahatarisha mwenyeji**, unapaswa kujua kuhusu EC2:

{% content-ref url="aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/" %}
[aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum](aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/)
{% endcontent-ref %}

Zaidi ya hayo, ikiwa Docker inatumika, inawezekana kutumia **ECS**.

{% content-ref url="aws-eks-enum.md" %}
[aws-eks-enum.md](aws-eks-enum.md)
{% endcontent-ref %}

### Application & Environments

Katika AWS Elastic Beanstalk, dhana za "programu" na "mazingira" zina madhumuni tofauti na zina majukumu tofauti katika mchakato wa kupeleka.

#### Application

* Programu katika Elastic Beanstalk ni **konteina ya kimantiki kwa msimbo wa chanzo cha programu yako, mazingira, na usanidi**. Inakusanya pamoja matoleo tofauti ya msimbo wa programu yako na inakuruhusu kuyasimamia kama chombo kimoja.
* Unapounda programu, unatoa jina na maelezo, lakini **hakuna rasilimali zinazotolewa** katika hatua hii. ni njia tu ya kupanga na kusimamia msimbo wako na rasilimali zinazohusiana.
* Unaweza kuwa na **matoleo mengi ya programu** ndani ya programu. Kila toleo linahusiana na toleo maalum la msimbo wako, ambalo linaweza kupelekwa kwenye mazingira moja au zaidi.

#### Environment

* Mazingira ni **nakala iliyotolewa ya programu yako** inayoendesha kwenye miundombinu ya AWS. Ni **mahali ambapo msimbo wa programu yako unapelekwa na kutekelezwa**. Elastic Beanstalk inatoa rasilimali zinazohitajika (mfano, EC2 instances, load balancers, auto-scaling groups, databases) kulingana na usanidi wa mazingira.
* **Kila mazingira yanaendesha toleo moja la programu yako**, na unaweza kuwa na mazingira mengi kwa madhumuni tofauti, kama maendeleo, majaribio, staging, na uzalishaji.
* Unapounda mazingira, unachagua jukwaa (mfano, Java, .NET, Node.js, nk) na aina ya mazingira (mfano, seva ya wavuti au mfanyakazi). Unaweza pia kubinafsisha usanidi wa mazingira kudhibiti vipengele mbalimbali vya miundombinu na mipangilio ya programu.

### Aina 2 za Mazingira

1. **Mazingira ya Seva ya Wavuti**: Imeundwa **kuhudumia na kuhudumia programu za wavuti na API**. Programu hizi kawaida hushughulikia maombi ya HTTP/HTTPS yanayoingia. Mazingira ya seva ya wavuti yanatoa rasilimali kama **EC2 instances, load balancers, na auto-scaling** groups kushughulikia trafiki inayoingia, kusimamia uwezo, na kuhakikisha upatikanaji wa juu wa programu.
2. **Mazingira ya Mfanyakazi**: Imeundwa kushughulikia **kazi za nyuma**, ambazo mara nyingi ni shughuli zinazochukua muda au rasilimali nyingi ambazo hazihitaji majibu ya haraka kwa wateja. Mazingira ya mfanyakazi yanatoa rasilimali kama **EC2 instances na auto-scaling groups**, lakini **haina load balancer** kwani haishughulikii maombi ya HTTP/HTTPS moja kwa moja. Badala yake, inachukua kazi kutoka kwa **Amazon Simple Queue Service (SQS) queue**, ambayo inafanya kazi kama buffer kati ya mazingira ya mfanyakazi na kazi inazoshughulikia.

### Usalama

Unapounda Programu katika Beanstalk kuna chaguo 3 muhimu sana za usalama kuchagua:

* **EC2 key pair**: Hii itakuwa **SSH key** ambayo itaweza kufikia EC2 instances zinazoendesha programu
* **IAM instance profile**: Hii ni **instance profile** ambayo instances zitakuwa nayo (**IAM privileges**)
* Jukumu lililoundwa kiotomatiki linaitwa **`aws-elasticbeanstalk-ec2-role`** na lina ufikiaji wa kuvutia juu ya ECS zote, SQS zote, DynamoDB elasticbeanstalk na elasticbeanstalk S3 kwa kutumia sera za usimamizi za AWS: [AWSElasticBeanstalkWebTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWebTier), [AWSElasticBeanstalkMulticontainerDocker](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkMulticontainerDocker), [AWSElasticBeanstalkWorkerTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWorkerTier).
* **Service role**: Hii ni **jukumu ambalo huduma ya AWS** itatumia kufanya vitendo vyote vinavyohitajika. Afaik, mtumiaji wa kawaida wa AWS hawezi kufikia jukumu hilo.
* Jukumu hili lililoundwa na AWS linaitwa **`aws-elasticbeanstalk-service-role`** na linatumia sera za usimamizi za AWS [AWSElasticBeanstalkEnhancedHealth](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkEnhancedHealth) na [AWSElasticBeanstalkManagedUpdatesCustomerRolePolicy](https://us-east-1.console.aws.amazon.com/iamv2/home?region=us-east-1#/roles/details/aws-elasticbeanstalk-service-role?section=permissions)

Kwa chaguo-msingi **metadata version 1 imezimwa**:

<figure><img src="../../../.gitbook/assets/image (103).png" alt=""><figcaption></figcaption></figure>

### Ufunuo

Data ya Beanstalk inahifadhiwa katika **S3 bucket** yenye jina lifuatalo: **`elasticbeanstalk-<region>-<acc-id>`**(ikiwa iliundwa katika console ya AWS). Ndani ya bucket hii utapata **msimbo wa chanzo wa programu** uliopakiwa.

**URL** ya ukurasa wa wavuti ulioundwa ni **`http://<webapp-name>-env.<random>.<region>.elasticbeanstalk.com/`**

{% hint style="warning" %}
Ikiwa utapata **ufikiaji wa kusoma** juu ya bucket, unaweza **kusoma msimbo wa chanzo** na hata kupata **nywila nyeti** juu yake

ikiwa utapata **ufikiaji wa kuandika** juu ya bucket, unaweza **kubadilisha msimbo wa chanzo** ili **kuhatarisha** **IAM role** ambayo programu inatumia wakati mwingine inapotekelezwa.
{% endhint %}

### Enumeration

{% code overflow="wrap" %}
```bash
# Find S3 bucket
ACCOUNT_NUMBER=<account_number>
for r in us-east-1 us-east-2 us-west-1 us-west-2 ap-south-1 ap-south-2 ap-northeast-1 ap-northeast-2 ap-northeast-3 ap-southeast-1 ap-southeast-2 ap-southeast-3 ca-central-1 eu-central-1 eu-central-2 eu-west-1 eu-west-2 eu-west-3 eu-north-1 sa-east-1 af-south-1 ap-east-1 eu-south-1 eu-south-2 me-south-1 me-central-1; do aws s3 ls elasticbeanstalk-$r-$ACCOUNT_NUMBER 2>/dev/null && echo "Found in: elasticbeanstalk-$r-$ACCOUNT_NUMBER"; done

# Get apps and URLs
aws elasticbeanstalk describe-applications # List apps
aws elasticbeanstalk describe-application-versions # Get apps & bucket name with source code
aws elasticbeanstalk describe-environments # List envs
aws elasticbeanstalk describe-environments | grep -E "EndpointURL|CNAME"
aws elasticbeanstalk describe-configuration-settings --application-name <app_name> --environment-name <env_name>
aws elasticbeanstalk describe-environment-resources --environment-name <env_name> # Get env info such as SQS used queues
aws elasticbeanstalk describe-instances-health --environment-name <env_name> # Get the instances of an environment

# Get events
aws elasticbeanstalk describe-events
```
{% endcode %}

### Ufikiaji Bila Uthibitisho

{% content-ref url="../aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md" %}
[aws-elastic-beanstalk-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md)
{% endcontent-ref %}

### Uendelevu

{% content-ref url="../aws-persistence/aws-elastic-beanstalk-persistence.md" %}
[aws-elastic-beanstalk-persistence.md](../aws-persistence/aws-elastic-beanstalk-persistence.md)
{% endcontent-ref %}

### Privesc

{% content-ref url="../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md" %}
[aws-elastic-beanstalk-privesc.md](../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md)
{% endcontent-ref %}

### Baada ya Udukuzi

{% content-ref url="../aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md" %}
[aws-elastic-beanstalk-post-exploitation.md](../aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md)
{% endcontent-ref %}

{% hint style="success" %}
Jifunze na fanya mazoezi ya Udukuzi wa AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Jifunze na fanya mazoezi ya Udukuzi wa GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Saidi HackTricks</summary>

* Angalia [**mipango ya usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwenye** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
{% endhint %}
