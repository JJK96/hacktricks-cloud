# Openshift中的Jenkins

**本页面的原始作者是** [**Fares**](https://www.linkedin.com/in/fares-siala/)

本页面提供了一些指针，介绍了如何攻击在Openshift（或Kubernetes）集群中运行的Jenkins实例


## 免责声明

Jenkins实例可以部署在Openshift或Kubernetes集群中。根据您的上下文，您可能需要调整任何显示的有效负载、yaml或技术。有关攻击Jenkins的更多信息，您可以查看[此页面](../../../pentesting-ci-cd/jenkins-security/README.md)

## 先决条件

1a. 在Jenkins实例中具有用户访问权限
或
1b. 具有对SCM存储库的写入权限的用户访问权限，在此存储库中，在推送/合并后触发自动构建

## 工作原理

从根本上讲，幕后几乎所有工作原理与在虚拟机中运行的常规Jenkins实例相同。
主要区别在于整体架构以及在Openshift（或Kubernetes）集群中管理构建的方式。

### 构建

当触发构建时，首先由Jenkins主节点进行管理/编排，然后委派给代理/从节点/工作节点。在这种情况下，主节点只是在命名空间中运行的常规Pod。工作节点/从节点也是如此，但是一旦构建完成，它们就会被销毁，而主节点始终保持运行。
您的构建通常在一个Pod中运行，使用由Jenkins管理员定义的默认Pod模板。

### 触发构建

您有多种触发构建的主要方式，例如：

1. 您可以访问Jenkins的用户界面

一个非常简单和方便的方法是使用现有构建的重放功能。它允许您重放先前执行的构建，同时允许您更新Groovy脚本。这需要对Jenkins文件夹和预定义管道具有特权。
如果您需要隐蔽操作，如果有足够的权限，可以删除您触发的构建。

2. 您可以访问SCM并且自动构建通过webhook配置

您只需编辑构建脚本（例如Jenkinsfile），提交并推送（如果仅在PR合并时触发构建，则最终创建PR）。请记住，这条路径非常喧闹，需要提升的权限来清理您的痕迹。
