---
περιγραφή: >-
Αυτή η σελίδα δείχνει ένα σενάριο ανόδου προνομίων δεδομένου ότι το tekton είναι εγκατεστημένο στο cluster και ότι μπορείτε να δημιουργήσετε ένα namespace (μερικές φορές επαρκούν δικαιώματα επεξεργασίας)

# OpenShift - Tekton

**Ο αρχικός συγγραφέας αυτής της σελίδας είναι** [**Haroun**](www.linkedin.com/in/haroun-al-mounayar-571830211)

### Τι είναι το tekton

Σύμφωνα με το έγγραφο: _Το Tekton είναι ένα ισχυρό και ευέλικτο πλαίσιο ανοικτού κώδικα για τη δημιουργία συστημάτων CI/CD, επιτρέποντας στους προγραμματιστές να χτίζουν, τεστάρουν και αναπτύσσουν σε παρόχους cloud και on-premise συστήματα._ Τόσο το Jenkins όσο και το Tekton μπορούν να χρησιμοποιηθούν για το τεστάρισμα, την κατασκευή και την ανάπτυξη εφαρμογών, ωστόσο το Tekton είναι Cloud Native.

Με το Tekton, τα πάντα εκφράζονται μέσω αρχείων YAML. Οι προγραμματιστές μπορούν να δημιουργήσουν Προσαρμοσμένους Πόρους (CR) τύπου `Pipelines` και να καθορίσουν πολλαπλές `Tasks` σε αυτούς που θέλουν να εκτελέσουν. Για να εκτελεστεί ένας Πίνακας πόρων τύπου `PipelineRun` πρέπει να δημιουργηθεί.

Όταν είναι εγκατεστημένο το tekton, δημιουργείται ένα λογαριασμό υπηρεσίας (sa) με το όνομα pipeline σε κάθε namespace. Όταν εκτελείται ένας Πίνακας, θα δημιουργηθεί ένα pod χρησιμοποιώντας αυτόν τον sa με το όνομα `pipeline` για να εκτελέσει τις εργασίες που έχουν καθοριστεί στο αρχείο YAML.

{% embed url="https://tekton.dev/docs/getting-started/pipelines/" %}
Έγγραφο Tekton σχετικά με τους Πίνακες
{% endembed %}

### Οι δυνατότητες του λογαριασμού υπηρεσίας του Πίνακα

Από προεπιλογή, ο λογαριασμός υπηρεσίας του πίνακα μπορεί να χρησιμοποιήσει τη δυνατότητα `pipelines-scc`. Αυτό οφείλεται στην παγκόσμια προεπιλεγμένη διαμόρφωση του tekton. Πράγματι, η παγκόσμια διαμόρφωση του tekton είναι επίσης ένα αρχείο YAML σε ένα αντικείμενο openshift που ονομάζεται `TektonConfig` και μπορεί να βρεθεί αν έχετε κάποιον ρόλο αναγνώστη στο cluster.
```yaml
apiVersion: operator.tekton.dev/v1alpha1
kind: TektonConfig
metadata:
name: config
spec:
...
...
platforms:
openshift:
scc:
default: "pipelines-scc"
```
### Η Λανθασμένη Ρύθμιση

Το πρόβλημα είναι ότι η προεπιλεγμένη scc που μπορεί να χρησιμοποιήσει το service account του pipeline είναι ελέγξιμη από τον χρήστη. Αυτό μπορεί να επιτευχθεί χρησιμοποιώντας ένα ετικέτα στον ορισμό του namespace. Για παράδειγμα, αν μπορώ να δημιουργήσω ένα namespace με τον ακόλουθο ορισμό yaml:
```yaml
apiVersion: v1
kind: Namespace
metadata:
name: test-namespace
annotations:
operator.tekton.dev/scc: privileged
```
### Η επέκταση του τελεστή tekton θα δώσει στο λογαριασμό υπηρεσίας του pipeline στο `test-namespace` τη δυνατότητα να χρησιμοποιεί το scc privileged. Αυτό θα επιτρέψει την προσάρτηση του κόμβου.

### Η διόρθωση

Τα έγγραφα του Tekton αναφέρουν πώς να περιορίσετε την παράκαμψη του scc προσθέτοντας ένα ετικέτα στο αντικείμενο `TektonConfig`.

{% embed url="https://tekton.dev/docs/operator/sccconfig/" %}
Έγγραφο Tekton σχετικά με το scc
{% endembed %}

Αυτή η ετικέτα ονομάζεται `max-allowed`
```yaml
apiVersion: operator.tekton.dev/v1alpha1
kind: TektonConfig
metadata:
name: config
spec:
...
...
platforms:
openshift:
scc:
default: "restricted-v2"
maxAllowed: "privileged"
```

