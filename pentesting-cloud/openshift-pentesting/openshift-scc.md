# Openshift - SCC

**Bu sayfanın orijinal yazarı** [**Guillaume**](https://www.linkedin.com/in/guillaume-chapela-ab4b9a196)

## Tanım

OpenShift bağlamında SCC, **Security Context Constraints**'in kısaltmasıdır. Security Context Constraints, OpenShift kümelerinde çalışan pod'ların izinlerini kontrol eden politikaları ifade eder. Bir pod'ın hangi eylemleri gerçekleştirebileceği ve hangi kaynaklara erişebileceği de dahil olmak üzere, bir pod'un çalışmasına izin verilen güvenlik parametrelerini tanımlar.

SCC'ler, yöneticilerin kümeler boyunca güvenlik politikalarını uygulamalarına yardımcı olur, pod'ların uygun izinlerle çalıştığından ve kurumsal güvenlik standartlarına uyduğundan emin olur. Bu kısıtlamalar pod güvenliğinin çeşitli yönlerini belirleyebilir, örneğin:

1. Linux yetenekleri: Konteynerlara sağlanan yetenekleri sınırlamak, örneğin ayrıcalıklı eylemleri gerçekleştirme yeteneği.
2. SELinux bağlamı: Konteynerlar için SELinux bağlamlarını zorlamak, işlemlerin sistemdeki kaynaklarla nasıl etkileşimde bulunacağını tanımlar.
3. Salt okunur kök dosya sistemi: Konteynerların belirli dizinlerdeki dosyaları değiştirmesini engellemek.
4. İzin verilen ana dizinler ve birimler: Bir pod'un bağlanabileceği ana dizinler ve birimleri belirtmek.
5. UID/GID olarak çalıştır: Konteyner işlemi tarafından çalıştırılan kullanıcı ve grup kimliklerini belirtmek.
6. Ağ politikaları: Pod'lar için ağ erişimini kontrol etmek, örneğin çıkış trafiğini kısıtlamak.

SCC'leri yapılandırarak, yöneticiler pod'ların uygun düzeyde güvenlik izolasyonu ve erişim kontrolleri ile çalıştığından emin olabilir, böylece kümeler içinde güvenlik açıklarının veya izinsiz erişimin riskini azaltabilir.

Temelde, bir pod dağıtımı istendiğinde her zaman aşağıdaki gibi bir kabul süreci yürütülür:

<figure><img src="../../.gitbook/assets/Managing SCCs in OpenShift-1.png" alt=""><figcaption></figcaption></figure>

Bu varsayılan olarak ek güvenlik katmanı, ayrıcalıklı pod'ların oluşturulmasını, ana dosya sisteminin bağlanmasını veya ayrıcalık yükselmesine yol açabilecek herhangi bir özelliğin ayarlanmasını yasaklar.

{% content-ref url="../kubernetes-security/abusing-roles-clusterroles-in-kubernetes/pod-escape-privileges.md" %}
[pod-escape-privileges.md](../kubernetes-security/abusing-roles-clusterroles-in-kubernetes/pod-escape-privileges.md)
{% endcontent-ref %}

## SCC Listesi

Tüm SCC'leri Openshift Client ile listelemek için:
```bash
$ oc get scc #List all the SCCs

$ oc auth can-i --list | grep securitycontextconstraints #Which scc user can use

$ oc describe scc $SCC #Check SCC definitions
```
Tüm kullanıcılar, en katı SCC'ler olan "**restricted**" ve "**restricted-v2**" varsayılan SCC'lere erişime sahiptir.

## SCC Kullanımı

Bir pod için kullanılan SCC, bir açıklama içinde tanımlanmıştır:
```bash
$ oc get pod MYPOD -o yaml | grep scc
openshift.io/scc: privileged
```
Kullanıcı birden fazla SCC'ye erişime sahip olduğunda, sistem güvenlik bağlamı değerleriyle uyumlu olanı kullanacaktır. Aksi takdirde, yasaklanmış bir hata tetiklenecektir.
```bash
$ oc apply -f evilpod.yaml #Deploy a privileged pod
Error from server (Forbidden): error when creating "evilpod.yaml": pods "evilpod" is forbidden: unable to validate against any security context constrain
```
## SCC Atlatma

{% content-ref url="openshift-privilege-escalation/openshift-scc-bypass.md" %}
[openshift-scc-bypass.md](openshift-privilege-escalation/openshift-scc-bypass.md)
{% endcontent-ref %}

## Referanslar

* [https://www.redhat.com/en/blog/managing-sccs-in-openshift](https://www.redhat.com/en/blog/managing-sccs-in-openshift)
